(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}})();function Xb(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var N2={exports:{}},gm={};var $A;function rB(){if($A)return gm;$A=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,r){var l=null;if(r!==void 0&&(l=""+r),a.key!==void 0&&(l=""+a.key),"key"in a){r={};for(var u in a)u!=="key"&&(r[u]=a[u])}else r=a;return a=r.ref,{$$typeof:i,type:n,key:l,ref:a!==void 0?a:null,props:r}}return gm.Fragment=e,gm.jsx=t,gm.jsxs=t,gm}var eM;function oB(){return eM||(eM=1,N2.exports=rB()),N2.exports}var B=oB(),L2={exports:{}},dn={};var tM;function lB(){if(tM)return dn;tM=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),_=Symbol.iterator;function y(Q){return Q===null||typeof Q!="object"?null:(Q=_&&Q[_]||Q["@@iterator"],typeof Q=="function"?Q:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,E={};function S(Q,de,Te){this.props=Q,this.context=de,this.refs=E,this.updater=Te||b}S.prototype.isReactComponent={},S.prototype.setState=function(Q,de){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,de,"setState")},S.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function w(){}w.prototype=S.prototype;function D(Q,de,Te){this.props=Q,this.context=de,this.refs=E,this.updater=Te||b}var U=D.prototype=new w;U.constructor=D,C(U,S.prototype),U.isPureReactComponent=!0;var F=Array.isArray;function N(){}var z={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function L(Q,de,Te){var Me=Te.ref;return{$$typeof:i,type:Q,key:de,ref:Me!==void 0?Me:null,props:Te}}function P(Q,de){return L(Q.type,de,Q.props)}function q(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===i}function ie(Q){var de={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(Te){return de[Te]})}var se=/\/+/g;function ae(Q,de){return typeof Q=="object"&&Q!==null&&Q.key!=null?ie(""+Q.key):de.toString(36)}function re(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(N,N):(Q.status="pending",Q.then(function(de){Q.status==="pending"&&(Q.status="fulfilled",Q.value=de)},function(de){Q.status==="pending"&&(Q.status="rejected",Q.reason=de)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function H(Q,de,Te,Me,rt){var xe=typeof Q;(xe==="undefined"||xe==="boolean")&&(Q=null);var fe=!1;if(Q===null)fe=!0;else switch(xe){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(Q.$$typeof){case i:case e:fe=!0;break;case x:return fe=Q._init,H(fe(Q._payload),de,Te,Me,rt)}}if(fe)return rt=rt(Q),fe=Me===""?"."+ae(Q,0):Me,F(rt)?(Te="",fe!=null&&(Te=fe.replace(se,"$&/")+"/"),H(rt,de,Te,"",function(ht){return ht})):rt!=null&&(q(rt)&&(rt=P(rt,Te+(rt.key==null||Q&&Q.key===rt.key?"":(""+rt.key).replace(se,"$&/")+"/")+fe)),de.push(rt)),1;fe=0;var Fe=Me===""?".":Me+":";if(F(Q))for(var et=0;et<Q.length;et++)Me=Q[et],xe=Fe+ae(Me,et),fe+=H(Me,de,Te,xe,rt);else if(et=y(Q),typeof et=="function")for(Q=et.call(Q),et=0;!(Me=Q.next()).done;)Me=Me.value,xe=Fe+ae(Me,et++),fe+=H(Me,de,Te,xe,rt);else if(xe==="object"){if(typeof Q.then=="function")return H(re(Q),de,Te,Me,rt);throw de=String(Q),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.")}return fe}function K(Q,de,Te){if(Q==null)return Q;var Me=[],rt=0;return H(Q,Me,"","",function(xe){return de.call(Te,xe,rt++)}),Me}function W(Q){if(Q._status===-1){var de=Q._result;de=de(),de.then(function(Te){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=Te)},function(Te){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=Te)}),Q._status===-1&&(Q._status=0,Q._result=de)}if(Q._status===1)return Q._result.default;throw Q._result}var me=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var de=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(de))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},ve={map:K,forEach:function(Q,de,Te){K(Q,function(){de.apply(this,arguments)},Te)},count:function(Q){var de=0;return K(Q,function(){de++}),de},toArray:function(Q){return K(Q,function(de){return de})||[]},only:function(Q){if(!q(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return dn.Activity=g,dn.Children=ve,dn.Component=S,dn.Fragment=t,dn.Profiler=a,dn.PureComponent=D,dn.StrictMode=n,dn.Suspense=d,dn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=z,dn.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return z.H.useMemoCache(Q)}},dn.cache=function(Q){return function(){return Q.apply(null,arguments)}},dn.cacheSignal=function(){return null},dn.cloneElement=function(Q,de,Te){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var Me=C({},Q.props),rt=Q.key;if(de!=null)for(xe in de.key!==void 0&&(rt=""+de.key),de)!j.call(de,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&de.ref===void 0||(Me[xe]=de[xe]);var xe=arguments.length-2;if(xe===1)Me.children=Te;else if(1<xe){for(var fe=Array(xe),Fe=0;Fe<xe;Fe++)fe[Fe]=arguments[Fe+2];Me.children=fe}return L(Q.type,rt,Me)},dn.createContext=function(Q){return Q={$$typeof:l,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:r,_context:Q},Q},dn.createElement=function(Q,de,Te){var Me,rt={},xe=null;if(de!=null)for(Me in de.key!==void 0&&(xe=""+de.key),de)j.call(de,Me)&&Me!=="key"&&Me!=="__self"&&Me!=="__source"&&(rt[Me]=de[Me]);var fe=arguments.length-2;if(fe===1)rt.children=Te;else if(1<fe){for(var Fe=Array(fe),et=0;et<fe;et++)Fe[et]=arguments[et+2];rt.children=Fe}if(Q&&Q.defaultProps)for(Me in fe=Q.defaultProps,fe)rt[Me]===void 0&&(rt[Me]=fe[Me]);return L(Q,xe,rt)},dn.createRef=function(){return{current:null}},dn.forwardRef=function(Q){return{$$typeof:u,render:Q}},dn.isValidElement=q,dn.lazy=function(Q){return{$$typeof:x,_payload:{_status:-1,_result:Q},_init:W}},dn.memo=function(Q,de){return{$$typeof:p,type:Q,compare:de===void 0?null:de}},dn.startTransition=function(Q){var de=z.T,Te={};z.T=Te;try{var Me=Q(),rt=z.S;rt!==null&&rt(Te,Me),typeof Me=="object"&&Me!==null&&typeof Me.then=="function"&&Me.then(N,me)}catch(xe){me(xe)}finally{de!==null&&Te.types!==null&&(de.types=Te.types),z.T=de}},dn.unstable_useCacheRefresh=function(){return z.H.useCacheRefresh()},dn.use=function(Q){return z.H.use(Q)},dn.useActionState=function(Q,de,Te){return z.H.useActionState(Q,de,Te)},dn.useCallback=function(Q,de){return z.H.useCallback(Q,de)},dn.useContext=function(Q){return z.H.useContext(Q)},dn.useDebugValue=function(){},dn.useDeferredValue=function(Q,de){return z.H.useDeferredValue(Q,de)},dn.useEffect=function(Q,de){return z.H.useEffect(Q,de)},dn.useEffectEvent=function(Q){return z.H.useEffectEvent(Q)},dn.useId=function(){return z.H.useId()},dn.useImperativeHandle=function(Q,de,Te){return z.H.useImperativeHandle(Q,de,Te)},dn.useInsertionEffect=function(Q,de){return z.H.useInsertionEffect(Q,de)},dn.useLayoutEffect=function(Q,de){return z.H.useLayoutEffect(Q,de)},dn.useMemo=function(Q,de){return z.H.useMemo(Q,de)},dn.useOptimistic=function(Q,de){return z.H.useOptimistic(Q,de)},dn.useReducer=function(Q,de,Te){return z.H.useReducer(Q,de,Te)},dn.useRef=function(Q){return z.H.useRef(Q)},dn.useState=function(Q){return z.H.useState(Q)},dn.useSyncExternalStore=function(Q,de,Te){return z.H.useSyncExternalStore(Q,de,Te)},dn.useTransition=function(){return z.H.useTransition()},dn.version="19.2.0",dn}var nM;function Fp(){return nM||(nM=1,L2.exports=lB()),L2.exports}var k=Fp();const Rc=Xb(k);var I2={exports:{}},vm={},P2={exports:{}},F2={};var iM;function cB(){return iM||(iM=1,(function(i){function e(H,K){var W=H.length;H.push(K);e:for(;0<W;){var me=W-1>>>1,ve=H[me];if(0<a(ve,K))H[me]=K,H[W]=ve,W=me;else break e}}function t(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var K=H[0],W=H.pop();if(W!==K){H[0]=W;e:for(var me=0,ve=H.length,Q=ve>>>1;me<Q;){var de=2*(me+1)-1,Te=H[de],Me=de+1,rt=H[Me];if(0>a(Te,W))Me<ve&&0>a(rt,Te)?(H[me]=rt,H[Me]=W,me=Me):(H[me]=Te,H[de]=W,me=de);else if(Me<ve&&0>a(rt,W))H[me]=rt,H[Me]=W,me=Me;else break e}}return K}function a(H,K){var W=H.sortIndex-K.sortIndex;return W!==0?W:H.id-K.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var d=[],p=[],x=1,g=null,_=3,y=!1,b=!1,C=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function U(H){for(var K=t(p);K!==null;){if(K.callback===null)n(p);else if(K.startTime<=H)n(p),K.sortIndex=K.expirationTime,e(d,K);else break;K=t(p)}}function F(H){if(C=!1,U(H),!b)if(t(d)!==null)b=!0,N||(N=!0,ie());else{var K=t(p);K!==null&&re(F,K.startTime-H)}}var N=!1,z=-1,j=5,L=-1;function P(){return E?!0:!(i.unstable_now()-L<j)}function q(){if(E=!1,N){var H=i.unstable_now();L=H;var K=!0;try{e:{b=!1,C&&(C=!1,w(z),z=-1),y=!0;var W=_;try{t:{for(U(H),g=t(d);g!==null&&!(g.expirationTime>H&&P());){var me=g.callback;if(typeof me=="function"){g.callback=null,_=g.priorityLevel;var ve=me(g.expirationTime<=H);if(H=i.unstable_now(),typeof ve=="function"){g.callback=ve,U(H),K=!0;break t}g===t(d)&&n(d),U(H)}else n(d);g=t(d)}if(g!==null)K=!0;else{var Q=t(p);Q!==null&&re(F,Q.startTime-H),K=!1}}break e}finally{g=null,_=W,y=!1}K=void 0}}finally{K?ie():N=!1}}}var ie;if(typeof D=="function")ie=function(){D(q)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ae=se.port2;se.port1.onmessage=q,ie=function(){ae.postMessage(null)}}else ie=function(){S(q,0)};function re(H,K){z=S(function(){H(i.unstable_now())},K)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(H){H.callback=null},i.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<H?Math.floor(1e3/H):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_next=function(H){switch(_){case 1:case 2:case 3:var K=3;break;default:K=_}var W=_;_=K;try{return H()}finally{_=W}},i.unstable_requestPaint=function(){E=!0},i.unstable_runWithPriority=function(H,K){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var W=_;_=H;try{return K()}finally{_=W}},i.unstable_scheduleCallback=function(H,K,W){var me=i.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?me+W:me):W=me,H){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=W+ve,H={id:x++,callback:K,priorityLevel:H,startTime:W,expirationTime:ve,sortIndex:-1},W>me?(H.sortIndex=W,e(p,H),t(d)===null&&H===t(p)&&(C?(w(z),z=-1):C=!0,re(F,W-me))):(H.sortIndex=ve,e(d,H),b||y||(b=!0,N||(N=!0,ie()))),H},i.unstable_shouldYield=P,i.unstable_wrapCallback=function(H){var K=_;return function(){var W=_;_=K;try{return H.apply(this,arguments)}finally{_=W}}}})(F2)),F2}var aM;function uB(){return aM||(aM=1,P2.exports=cB()),P2.exports}var z2={exports:{}},Cs={};var sM;function fB(){if(sM)return Cs;sM=1;var i=Fp();function e(d){var p="https://react.dev/errors/"+d;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function r(d,p,x){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:d,containerInfo:p,implementation:x}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,p){if(d==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Cs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Cs.createPortal=function(d,p){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return r(d,p,null,x)},Cs.flushSync=function(d){var p=l.T,x=n.p;try{if(l.T=null,n.p=2,d)return d()}finally{l.T=p,n.p=x,n.d.f()}},Cs.preconnect=function(d,p){typeof d=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(d,p))},Cs.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},Cs.preinit=function(d,p){if(typeof d=="string"&&p&&typeof p.as=="string"){var x=p.as,g=u(x,p.crossOrigin),_=typeof p.integrity=="string"?p.integrity:void 0,y=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;x==="style"?n.d.S(d,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:g,integrity:_,fetchPriority:y}):x==="script"&&n.d.X(d,{crossOrigin:g,integrity:_,fetchPriority:y,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Cs.preinitModule=function(d,p){if(typeof d=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var x=u(p.as,p.crossOrigin);n.d.M(d,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(d)},Cs.preload=function(d,p){if(typeof d=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var x=p.as,g=u(x,p.crossOrigin);n.d.L(d,x,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Cs.preloadModule=function(d,p){if(typeof d=="string")if(p){var x=u(p.as,p.crossOrigin);n.d.m(d,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(d)},Cs.requestFormReset=function(d){n.d.r(d)},Cs.unstable_batchedUpdates=function(d,p){return d(p)},Cs.useFormState=function(d,p,x){return l.H.useFormState(d,p,x)},Cs.useFormStatus=function(){return l.H.useHostTransitionStatus()},Cs.version="19.2.0",Cs}var rM;function eT(){if(rM)return z2.exports;rM=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),z2.exports=fB(),z2.exports}var oM;function hB(){if(oM)return vm;oM=1;var i=uB(),e=Fp(),t=eT();function n(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function r(s){var o=s,h=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(h=o.return),s=o.return;while(s)}return o.tag===3?h:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function u(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function d(s){if(r(s)!==s)throw Error(n(188))}function p(s){var o=s.alternate;if(!o){if(o=r(s),o===null)throw Error(n(188));return o!==s?null:s}for(var h=s,m=o;;){var A=h.return;if(A===null)break;var T=A.alternate;if(T===null){if(m=A.return,m!==null){h=m;continue}break}if(A.child===T.child){for(T=A.child;T;){if(T===h)return d(A),s;if(T===m)return d(A),o;T=T.sibling}throw Error(n(188))}if(h.return!==m.return)h=A,m=T;else{for(var I=!1,Y=A.child;Y;){if(Y===h){I=!0,h=A,m=T;break}if(Y===m){I=!0,m=A,h=T;break}Y=Y.sibling}if(!I){for(Y=T.child;Y;){if(Y===h){I=!0,h=T,m=A;break}if(Y===m){I=!0,m=T,h=A;break}Y=Y.sibling}if(!I)throw Error(n(189))}}if(h.alternate!==m)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?s:o}function x(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=x(s),o!==null)return o;s=s.sibling}return null}var g=Object.assign,_=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),D=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function ie(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var se=Symbol.for("react.client.reference");function ae(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===se?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case C:return"Fragment";case S:return"Profiler";case E:return"StrictMode";case F:return"Suspense";case N:return"SuspenseList";case L:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case b:return"Portal";case D:return s.displayName||"Context";case w:return(s._context.displayName||"Context")+".Consumer";case U:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case z:return o=s.displayName||null,o!==null?o:ae(s.type)||"Memo";case j:o=s._payload,s=s._init;try{return ae(s(o))}catch{}}return null}var re=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},me=[],ve=-1;function Q(s){return{current:s}}function de(s){0>ve||(s.current=me[ve],me[ve]=null,ve--)}function Te(s,o){ve++,me[ve]=s.current,s.current=o}var Me=Q(null),rt=Q(null),xe=Q(null),fe=Q(null);function Fe(s,o){switch(Te(xe,o),Te(rt,s),Te(Me,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?SA(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=SA(o),s=AA(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}de(Me),Te(Me,s)}function et(){de(Me),de(rt),de(xe)}function ht(s){s.memoizedState!==null&&Te(fe,s);var o=Me.current,h=AA(o,s.type);o!==h&&(Te(rt,s),Te(Me,h))}function yt(s){rt.current===s&&(de(Me),de(rt)),fe.current===s&&(de(fe),hm._currentValue=W)}var Xt,Ot;function ke(s){if(Xt===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);Xt=o&&o[1]||"",Ot=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Xt+s+Ot}var $=!1;function Qe(s,o){if(!s||$)return"";$=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(o){var We=function(){throw Error()};if(Object.defineProperty(We.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(We,[])}catch(Ie){var Be=Ie}Reflect.construct(s,[],We)}else{try{We.call()}catch(Ie){Be=Ie}s.call(We.prototype)}}else{try{throw Error()}catch(Ie){Be=Ie}(We=s())&&typeof We.catch=="function"&&We.catch(function(){})}}catch(Ie){if(Ie&&Be&&typeof Ie.stack=="string")return[Ie.stack,Be.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=m.DetermineComponentFrameRoot(),I=T[0],Y=T[1];if(I&&Y){var ue=I.split(`
`),Ce=Y.split(`
`);for(A=m=0;m<ue.length&&!ue[m].includes("DetermineComponentFrameRoot");)m++;for(;A<Ce.length&&!Ce[A].includes("DetermineComponentFrameRoot");)A++;if(m===ue.length||A===Ce.length)for(m=ue.length-1,A=Ce.length-1;1<=m&&0<=A&&ue[m]!==Ce[A];)A--;for(;1<=m&&0<=A;m--,A--)if(ue[m]!==Ce[A]){if(m!==1||A!==1)do if(m--,A--,0>A||ue[m]!==Ce[A]){var Ve=`
`+ue[m].replace(" at new "," at ");return s.displayName&&Ve.includes("<anonymous>")&&(Ve=Ve.replace("<anonymous>",s.displayName)),Ve}while(1<=m&&0<=A);break}}}finally{$=!1,Error.prepareStackTrace=h}return(h=s?s.displayName||s.name:"")?ke(h):""}function st(s,o){switch(s.tag){case 26:case 27:case 5:return ke(s.type);case 16:return ke("Lazy");case 13:return s.child!==o&&o!==null?ke("Suspense Fallback"):ke("Suspense");case 19:return ke("SuspenseList");case 0:case 15:return Qe(s.type,!1);case 11:return Qe(s.type.render,!1);case 1:return Qe(s.type,!0);case 31:return ke("Activity");default:return""}}function pt(s){try{var o="",h=null;do o+=st(s,h),h=s,s=s.return;while(s);return o}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var it=Object.prototype.hasOwnProperty,bt=i.unstable_scheduleCallback,mt=i.unstable_cancelCallback,Ct=i.unstable_shouldYield,ee=i.unstable_requestPaint,X=i.unstable_now,Ae=i.unstable_getCurrentPriorityLevel,He=i.unstable_ImmediatePriority,Ze=i.unstable_UserBlockingPriority,Le=i.unstable_NormalPriority,Nt=i.unstable_LowPriority,xt=i.unstable_IdlePriority,Vt=i.log,Lt=i.unstable_setDisableYieldValue,Ye=null,qe=null;function It(s){if(typeof Vt=="function"&&Lt(s),qe&&typeof qe.setStrictMode=="function")try{qe.setStrictMode(Ye,s)}catch{}}var Et=Math.clz32?Math.clz32:pe,gt=Math.log,Dt=Math.LN2;function pe(s){return s>>>=0,s===0?32:31-(gt(s)/Dt|0)|0}var Ue=256,ft=262144,vt=4194304;function tt(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Je(s,o,h){var m=s.pendingLanes;if(m===0)return 0;var A=0,T=s.suspendedLanes,I=s.pingedLanes;s=s.warmLanes;var Y=m&134217727;return Y!==0?(m=Y&~T,m!==0?A=tt(m):(I&=Y,I!==0?A=tt(I):h||(h=Y&~s,h!==0&&(A=tt(h))))):(Y=m&~T,Y!==0?A=tt(Y):I!==0?A=tt(I):h||(h=m&~s,h!==0&&(A=tt(h)))),A===0?0:o!==0&&o!==A&&(o&T)===0&&(T=A&-A,h=o&-o,T>=h||T===32&&(h&4194048)!==0)?o:A}function Bt(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Qt(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fn(){var s=vt;return vt<<=1,(vt&62914560)===0&&(vt=4194304),s}function Cn(s){for(var o=[],h=0;31>h;h++)o.push(s);return o}function fa(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Va(s,o,h,m,A,T){var I=s.pendingLanes;s.pendingLanes=h,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=h,s.entangledLanes&=h,s.errorRecoveryDisabledLanes&=h,s.shellSuspendCounter=0;var Y=s.entanglements,ue=s.expirationTimes,Ce=s.hiddenUpdates;for(h=I&~h;0<h;){var Ve=31-Et(h),We=1<<Ve;Y[Ve]=0,ue[Ve]=-1;var Be=Ce[Ve];if(Be!==null)for(Ce[Ve]=null,Ve=0;Ve<Be.length;Ve++){var Ie=Be[Ve];Ie!==null&&(Ie.lane&=-536870913)}h&=~We}m!==0&&zl(s,m,0),T!==0&&A===0&&s.tag!==0&&(s.suspendedLanes|=T&~(I&~o))}function zl(s,o,h){s.pendingLanes|=o,s.suspendedLanes&=~o;var m=31-Et(o);s.entangledLanes|=o,s.entanglements[m]=s.entanglements[m]|1073741824|h&261930}function go(s,o){var h=s.entangledLanes|=o;for(s=s.entanglements;h;){var m=31-Et(h),A=1<<m;A&o|s[m]&o&&(s[m]|=o),h&=~A}}function sr(s,o){var h=o&-o;return h=(h&42)!==0?1:ta(h),(h&(s.suspendedLanes|o))!==0?0:h}function ta(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ms(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ba(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:YA(s.type))}function en(s,o){var h=K.p;try{return K.p=s,o()}finally{K.p=h}}var ha=Math.random().toString(36).slice(2),hn="__reactFiber$"+ha,G="__reactProps$"+ha,Z="__reactContainer$"+ha,he="__reactEvents$"+ha,we="__reactListeners$"+ha,ze="__reactHandles$"+ha,Pe="__reactResources$"+ha,ot="__reactMarker$"+ha;function nt(s){delete s[hn],delete s[G],delete s[he],delete s[we],delete s[ze]}function at(s){var o=s[hn];if(o)return o;for(var h=s.parentNode;h;){if(o=h[Z]||h[hn]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(s=BA(s);s!==null;){if(h=s[hn])return h;s=BA(s)}return o}s=h,h=s.parentNode}return null}function V(s){if(s=s[hn]||s[Z]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function ne(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(n(33))}function le(s){var o=s[Pe];return o||(o=s[Pe]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function _e(s){s[ot]=!0}var oe=new Set,Ne={};function je(s,o){$e(s,o),$e(s+"Capture",o)}function $e(s,o){for(Ne[s]=o,s=0;s<o.length;s++)oe.add(o[s])}var ct=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_t={},Rt={};function Tt(s){return it.call(Rt,s)?!0:it.call(_t,s)?!1:ct.test(s)?Rt[s]=!0:(_t[s]=!0,!1)}function Ut(s,o,h){if(Tt(o))if(h===null)s.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var m=o.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+h)}}function on(s,o,h){if(h===null)s.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+h)}}function Ht(s,o,h,m){if(m===null)s.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttributeNS(o,h,""+m)}}function Jt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function xn(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Gt(s,o,h){var m=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var A=m.get,T=m.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return A.call(this)},set:function(I){h=""+I,T.call(this,I)}}),Object.defineProperty(s,o,{enumerable:m.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function pn(s){if(!s._valueTracker){var o=xn(s)?"checked":"value";s._valueTracker=Gt(s,o,""+s[o])}}function Pt(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var h=o.getValue(),m="";return s&&(m=xn(s)?s.checked?"true":"false":s.value),s=m,s!==h?(o.setValue(s),!0):!1}function Rn(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var zn=/[\n"\\]/g;function Yt(s){return s.replace(zn,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Bi(s,o,h,m,A,T,I,Y){s.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.type=I:s.removeAttribute("type"),o!=null?I==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Jt(o)):s.value!==""+Jt(o)&&(s.value=""+Jt(o)):I!=="submit"&&I!=="reset"||s.removeAttribute("value"),o!=null?jn(s,I,Jt(o)):h!=null?jn(s,I,Jt(h)):m!=null&&s.removeAttribute("value"),A==null&&T!=null&&(s.defaultChecked=!!T),A!=null&&(s.checked=A&&typeof A!="function"&&typeof A!="symbol"),Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?s.name=""+Jt(Y):s.removeAttribute("name")}function Un(s,o,h,m,A,T,I,Y){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.type=T),o!=null||h!=null){if(!(T!=="submit"&&T!=="reset"||o!=null)){pn(s);return}h=h!=null?""+Jt(h):"",o=o!=null?""+Jt(o):h,Y||o===s.value||(s.value=o),s.defaultValue=o}m=m??A,m=typeof m!="function"&&typeof m!="symbol"&&!!m,s.checked=Y?s.checked:!!m,s.defaultChecked=!!m,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(s.name=I),pn(s)}function jn(s,o,h){o==="number"&&Rn(s.ownerDocument)===s||s.defaultValue===""+h||(s.defaultValue=""+h)}function di(s,o,h,m){if(s=s.options,o){o={};for(var A=0;A<h.length;A++)o["$"+h[A]]=!0;for(h=0;h<s.length;h++)A=o.hasOwnProperty("$"+s[h].value),s[h].selected!==A&&(s[h].selected=A),A&&m&&(s[h].defaultSelected=!0)}else{for(h=""+Jt(h),o=null,A=0;A<s.length;A++){if(s[A].value===h){s[A].selected=!0,m&&(s[A].defaultSelected=!0);return}o!==null||s[A].disabled||(o=s[A])}o!==null&&(o.selected=!0)}}function da(s,o,h){if(o!=null&&(o=""+Jt(o),o!==s.value&&(s.value=o),h==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=h!=null?""+Jt(h):""}function Li(s,o,h,m){if(o==null){if(m!=null){if(h!=null)throw Error(n(92));if(re(m)){if(1<m.length)throw Error(n(93));m=m[0]}h=m}h==null&&(h=""),o=h}h=Jt(o),s.defaultValue=h,m=s.textContent,m===h&&m!==""&&m!==null&&(s.value=m),pn(s)}function yr(s,o){if(o){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=o;return}}s.textContent=o}var rr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Qu(s,o,h){var m=o.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?m?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":m?s.setProperty(o,h):typeof h!="number"||h===0||rr.has(o)?o==="float"?s.cssFloat=h:s[o]=(""+h).trim():s[o]=h+"px"}function Yp(s,o,h){if(o!=null&&typeof o!="object")throw Error(n(62));if(s=s.style,h!=null){for(var m in h)!h.hasOwnProperty(m)||o!=null&&o.hasOwnProperty(m)||(m.indexOf("--")===0?s.setProperty(m,""):m==="float"?s.cssFloat="":s[m]="");for(var A in o)m=o[A],o.hasOwnProperty(A)&&h[A]!==m&&Qu(s,A,m)}else for(var T in o)o.hasOwnProperty(T)&&Qu(s,T,o[T])}function $u(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ig=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ef(s){return Pg.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Gr(){}var tf=null;function Ph(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Hl=null,el=null;function qp(s){var o=V(s);if(o&&(s=o.stateNode)){var h=s[G]||null;e:switch(s=o.stateNode,o.type){case"input":if(Bi(s,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),o=h.name,h.type==="radio"&&o!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Yt(""+o)+'"][type="radio"]'),o=0;o<h.length;o++){var m=h[o];if(m!==s&&m.form===s.form){var A=m[G]||null;if(!A)throw Error(n(90));Bi(m,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(o=0;o<h.length;o++)m=h[o],m.form===s.form&&Pt(m)}break e;case"textarea":da(s,h.value,h.defaultValue);break e;case"select":o=h.value,o!=null&&di(s,!!h.multiple,o,!1)}}}var Fh=!1;function Kp(s,o,h){if(Fh)return s(o,h);Fh=!0;try{var m=s(o);return m}finally{if(Fh=!1,(Hl!==null||el!==null)&&(J(),Hl&&(o=Hl,s=el,el=Hl=null,qp(o),s)))for(o=0;o<s.length;o++)qp(s[o])}}function Gl(s,o){var h=s.stateNode;if(h===null)return null;var m=h[G]||null;if(m===null)return null;h=m[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(n(231,o,typeof h));return h}var Vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zh=!1;if(Vr)try{var nf={};Object.defineProperty(nf,"passive",{get:function(){zh=!0}}),window.addEventListener("test",nf,nf),window.removeEventListener("test",nf,nf)}catch{zh=!1}var tl=null,Hh=null,nl=null;function Gh(){if(nl)return nl;var s,o=Hh,h=o.length,m,A="value"in tl?tl.value:tl.textContent,T=A.length;for(s=0;s<h&&o[s]===A[s];s++);var I=h-s;for(m=1;m<=I&&o[h-m]===A[T-m];m++);return nl=A.slice(s,1<m?1-m:void 0)}function Vl(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function af(){return!0}function Jp(){return!1}function ka(s){function o(h,m,A,T,I){this._reactName=h,this._targetInst=A,this.type=m,this.nativeEvent=T,this.target=I,this.currentTarget=null;for(var Y in s)s.hasOwnProperty(Y)&&(h=s[Y],this[Y]=h?h(T):T[Y]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?af:Jp,this.isPropagationStopped=Jp,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=af)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=af)},persist:function(){},isPersistent:af}),o}var il={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sf=ka(il),br=g({},il,{view:0,detail:0}),Vh=ka(br),kh,rf,Nc,of=g({},br,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cf,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Nc&&(Nc&&s.type==="mousemove"?(kh=s.screenX-Nc.screenX,rf=s.screenY-Nc.screenY):rf=kh=0,Nc=s),kh)},movementY:function(s){return"movementY"in s?s.movementY:rf}}),Fg=ka(of),Ba=g({},of,{dataTransfer:0}),zg=ka(Ba),Hg=g({},br,{relatedTarget:0}),jh=ka(Hg),Gg=g({},il,{animationName:0,elapsedTime:0,pseudoElement:0}),Vg=ka(Gg),lf=g({},il,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Wp=ka(lf),kg=g({},il,{data:0}),Zp=ka(kg),jg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$p={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xg(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=$p[s])?!!o[s]:!1}function cf(){return Xg}var e0=g({},br,{key:function(s){if(s.key){var o=jg[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Vl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Qp[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cf,charCode:function(s){return s.type==="keypress"?Vl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Vl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),t0=ka(e0),Yg=g({},of,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xh=ka(Yg),qg=g({},br,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cf}),vo=ka(qg),n0=g({},il,{propertyName:0,elapsedTime:0,pseudoElement:0}),$y=ka(n0),Kg=g({},of,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),al=ka(Kg),xo=g({},il,{newState:0,oldState:0}),i0=ka(xo),a0=[9,13,27,32],kl=Vr&&"CompositionEvent"in window,sl=null;Vr&&"documentMode"in document&&(sl=document.documentMode);var jl=Vr&&"TextEvent"in window&&!sl,Da=Vr&&(!kl||sl&&8<sl&&11>=sl),uf=" ",s0=!1;function Yh(s,o){switch(s){case"keyup":return a0.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var rl=!1;function qh(s,o){switch(s){case"compositionend":return Lc(o);case"keypress":return o.which!==32?null:(s0=!0,uf);case"textInput":return s=o.data,s===uf&&s0?null:s;default:return null}}function Jg(s,o){if(rl)return s==="compositionend"||!kl&&Yh(s,o)?(s=Gh(),nl=Hh=tl=null,rl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Da&&o.locale!=="ko"?null:o.data;default:return null}}var Ls={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function r0(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!Ls[s.type]:o==="textarea"}function Kh(s,o,h,m){Hl?el?el.push(m):el=[m]:Hl=m,o=Hv(o,"onChange"),0<o.length&&(h=new sf("onChange","change",null,h,m),s.push({event:h,listeners:o}))}var Ic=null,Pc=null;function o0(s){gA(s,0)}function Fc(s){var o=ne(s);if(Pt(o))return s}function l0(s,o){if(s==="change")return o}var ff=!1;if(Vr){var Xl;if(Vr){var Ei="oninput"in document;if(!Ei){var Wg=document.createElement("div");Wg.setAttribute("oninput","return;"),Ei=typeof Wg.oninput=="function"}Xl=Ei}else Xl=!1;ff=Xl&&(!document.documentMode||9<document.documentMode)}function Zg(){Ic&&(Ic.detachEvent("onpropertychange",c0),Pc=Ic=null)}function c0(s){if(s.propertyName==="value"&&Fc(Pc)){var o=[];Kh(o,Pc,s,Ph(s)),Kp(o0,o)}}function hf(s,o,h){s==="focusin"?(Zg(),Ic=o,Pc=h,Ic.attachEvent("onpropertychange",c0)):s==="focusout"&&Zg()}function ol(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Fc(Pc)}function Qg(s,o){if(s==="click")return Fc(o)}function $g(s,o){if(s==="input"||s==="change")return Fc(o)}function Yl(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Ti=typeof Object.is=="function"?Object.is:Yl;function zc(s,o){if(Ti(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var h=Object.keys(s),m=Object.keys(o);if(h.length!==m.length)return!1;for(m=0;m<h.length;m++){var A=h[m];if(!it.call(o,A)||!Ti(s[A],o[A]))return!1}return!0}function u0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function f0(s,o){var h=u0(s);s=0;for(var m;h;){if(h.nodeType===3){if(m=s+h.textContent.length,s<=o&&m>=o)return{node:h,offset:o-s};s=m}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=u0(h)}}function Jh(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Jh(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Wh(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Rn(s.document);o instanceof s.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)s=o.contentWindow;else break;o=Rn(s.document)}return o}function Hc(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var ev=Vr&&"documentMode"in document&&11>=document.documentMode,Gc=null,Zh=null,Vc=null,Is=!1;function Qh(s,o,h){var m=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Is||Gc==null||Gc!==Rn(m)||(m=Gc,"selectionStart"in m&&Hc(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Vc&&zc(Vc,m)||(Vc=m,m=Hv(Zh,"onSelect"),0<m.length&&(o=new sf("onSelect","select",null,o,h),s.push({event:o,listeners:m}),o.target=Gc)))}function ll(s,o){var h={};return h[s.toLowerCase()]=o.toLowerCase(),h["Webkit"+s]="webkit"+o,h["Moz"+s]="moz"+o,h}var kc={animationend:ll("Animation","AnimationEnd"),animationiteration:ll("Animation","AnimationIteration"),animationstart:ll("Animation","AnimationStart"),transitionrun:ll("Transition","TransitionRun"),transitionstart:ll("Transition","TransitionStart"),transitioncancel:ll("Transition","TransitionCancel"),transitionend:ll("Transition","TransitionEnd")},df={},is={};Vr&&(is=document.createElement("div").style,"AnimationEvent"in window||(delete kc.animationend.animation,delete kc.animationiteration.animation,delete kc.animationstart.animation),"TransitionEvent"in window||delete kc.transitionend.transition);function cl(s){if(df[s])return df[s];if(!kc[s])return s;var o=kc[s],h;for(h in o)if(o.hasOwnProperty(h)&&h in is)return df[s]=o[h];return s}var gs=cl("animationend"),h0=cl("animationiteration"),kr=cl("animationstart"),jc=cl("transitionrun"),ul=cl("transitionstart"),d0=cl("transitioncancel"),$h=cl("transitionend"),_o=new Map,ed="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ed.push("scrollEnd");function ja(s,o){_o.set(s,o),je(o,[s])}var fl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Sa=[],ql=0,td=0;function hl(){for(var s=ql,o=td=ql=0;o<s;){var h=Sa[o];Sa[o++]=null;var m=Sa[o];Sa[o++]=null;var A=Sa[o];Sa[o++]=null;var T=Sa[o];if(Sa[o++]=null,m!==null&&A!==null){var I=m.pending;I===null?A.next=A:(A.next=I.next,I.next=A),m.pending=A}T!==0&&nd(h,A,T)}}function pf(s,o,h,m){Sa[ql++]=s,Sa[ql++]=o,Sa[ql++]=h,Sa[ql++]=m,td|=m,s.lanes|=m,s=s.alternate,s!==null&&(s.lanes|=m)}function Xc(s,o,h,m){return pf(s,o,h,m),Yc(s)}function dl(s,o){return pf(s,null,null,o),Yc(s)}function nd(s,o,h){s.lanes|=h;var m=s.alternate;m!==null&&(m.lanes|=h);for(var A=!1,T=s.return;T!==null;)T.childLanes|=h,m=T.alternate,m!==null&&(m.childLanes|=h),T.tag===22&&(s=T.stateNode,s===null||s._visibility&1||(A=!0)),s=T,T=T.return;return s.tag===3?(T=s.stateNode,A&&o!==null&&(A=31-Et(h),s=T.hiddenUpdates,m=s[A],m===null?s[A]=[o]:m.push(o),o.lane=h|536870912),T):null}function Yc(s){if(50<uc)throw uc=0,fc=null,Error(n(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var pl={};function tv(s,o,h,m){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function as(s,o,h,m){return new tv(s,o,h,m)}function ss(s){return s=s.prototype,!(!s||!s.isReactComponent)}function jr(s,o){var h=s.alternate;return h===null?(h=as(s.tag,o,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=o,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&65011712,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,o=s.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h.refCleanup=s.refCleanup,h}function Xa(s,o){s.flags&=65011714;var h=s.alternate;return h===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,o=h.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function mf(s,o,h,m,A,T){var I=0;if(m=s,typeof s=="function")ss(s)&&(I=1);else if(typeof s=="string")I=Kw(s,h,Me.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case L:return s=as(31,h,o,A),s.elementType=L,s.lanes=T,s;case C:return yo(h.children,A,T,o);case E:I=8,A|=24;break;case S:return s=as(12,h,o,A|2),s.elementType=S,s.lanes=T,s;case F:return s=as(13,h,o,A),s.elementType=F,s.lanes=T,s;case N:return s=as(19,h,o,A),s.elementType=N,s.lanes=T,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:I=10;break e;case w:I=9;break e;case U:I=11;break e;case z:I=14;break e;case j:I=16,m=null;break e}I=29,h=Error(n(130,s===null?"null":typeof s,"")),m=null}return o=as(I,h,o,A),o.elementType=s,o.type=m,o.lanes=T,o}function yo(s,o,h,m){return s=as(7,s,m,o),s.lanes=h,s}function id(s,o,h){return s=as(6,s,null,o),s.lanes=h,s}function nv(s){var o=as(18,null,null,0);return o.stateNode=s,o}function Sr(s,o,h){return o=as(4,s.children!==null?s.children:[],s.key,o),o.lanes=h,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var p0=new WeakMap;function vs(s,o){if(typeof s=="object"&&s!==null){var h=p0.get(s);return h!==void 0?h:(o={value:s,source:o,stack:pt(o)},p0.set(s,o),o)}return{value:s,source:o,stack:pt(o)}}var Ar=[],Kl=0,gf=null,qc=0,Ps=[],xs=0,Xr=null,Yr=1,qr="";function bo(s,o){Ar[Kl++]=qc,Ar[Kl++]=gf,gf=s,qc=o}function m0(s,o,h){Ps[xs++]=Yr,Ps[xs++]=qr,Ps[xs++]=Xr,Xr=s;var m=Yr;s=qr;var A=32-Et(m)-1;m&=~(1<<A),h+=1;var T=32-Et(o)+A;if(30<T){var I=A-A%5;T=(m&(1<<I)-1).toString(32),m>>=I,A-=I,Yr=1<<32-Et(o)+A|h<<A|m,qr=T+s}else Yr=1<<T|h<<A|m,qr=s}function ad(s){s.return!==null&&(bo(s,1),m0(s,1,0))}function ml(s){for(;s===gf;)gf=Ar[--Kl],Ar[Kl]=null,qc=Ar[--Kl],Ar[Kl]=null;for(;s===Xr;)Xr=Ps[--xs],Ps[xs]=null,qr=Ps[--xs],Ps[xs]=null,Yr=Ps[--xs],Ps[xs]=null}function vf(s,o){Ps[xs++]=Yr,Ps[xs++]=qr,Ps[xs++]=Xr,Yr=o.id,qr=o.overflow,Xr=s}var Aa=null,_i=null,On=!1,So=null,Ma=!1,sd=Error(n(519));function Bn(s){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw xf(vs(o,s)),sd}function rd(s){var o=s.stateNode,h=s.type,m=s.memoizedProps;switch(o[hn]=s,o[G]=m,h){case"dialog":Nn("cancel",o),Nn("close",o);break;case"iframe":case"object":case"embed":Nn("load",o);break;case"video":case"audio":for(h=0;h<om.length;h++)Nn(om[h],o);break;case"source":Nn("error",o);break;case"img":case"image":case"link":Nn("error",o),Nn("load",o);break;case"details":Nn("toggle",o);break;case"input":Nn("invalid",o),Un(o,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Nn("invalid",o);break;case"textarea":Nn("invalid",o),Li(o,m.value,m.defaultValue,m.children)}h=m.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||o.textContent===""+h||m.suppressHydrationWarning===!0||yA(o.textContent,h)?(m.popover!=null&&(Nn("beforetoggle",o),Nn("toggle",o)),m.onScroll!=null&&Nn("scroll",o),m.onScrollEnd!=null&&Nn("scrollend",o),m.onClick!=null&&(o.onclick=Gr),o=!0):o=!1,o||Bn(s,!0)}function iv(s){for(Aa=s.return;Aa;)switch(Aa.tag){case 5:case 31:case 13:Ma=!1;return;case 27:case 3:Ma=!0;return;default:Aa=Aa.return}}function Jl(s){if(s!==Aa)return!1;if(!On)return iv(s),On=!0,!1;var o=s.tag,h;if((h=o!==3&&o!==27)&&((h=o===5)&&(h=s.type,h=!(h!=="form"&&h!=="button")||_2(s.type,s.memoizedProps)),h=!h),h&&_i&&Bn(s),iv(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));_i=wA(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));_i=wA(s)}else o===27?(o=_i,hu(s.type)?(s=M2,M2=null,_i=s):_i=o):_i=Aa?ao(s.stateNode.nextSibling):null;return!0}function Wl(){_i=Aa=null,On=!1}function g0(){var s=So;return s!==null&&(Za===null?Za=s:Za.push.apply(Za,s),So=null),s}function xf(s){So===null?So=[s]:So.push(s)}var v0=Q(null),Ao=null,Ya=null;function Mo(s,o,h){Te(v0,o._currentValue),o._currentValue=h}function or(s){s._currentValue=v0.current,de(v0)}function Eo(s,o,h){for(;s!==null;){var m=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,m!==null&&(m.childLanes|=o)):m!==null&&(m.childLanes&o)!==o&&(m.childLanes|=o),s===h)break;s=s.return}}function od(s,o,h,m){var A=s.child;for(A!==null&&(A.return=s);A!==null;){var T=A.dependencies;if(T!==null){var I=A.child;T=T.firstContext;e:for(;T!==null;){var Y=T;T=A;for(var ue=0;ue<o.length;ue++)if(Y.context===o[ue]){T.lanes|=h,Y=T.alternate,Y!==null&&(Y.lanes|=h),Eo(T.return,h,s),m||(I=null);break e}T=Y.next}}else if(A.tag===18){if(I=A.return,I===null)throw Error(n(341));I.lanes|=h,T=I.alternate,T!==null&&(T.lanes|=h),Eo(I,h,s),I=null}else I=A.child;if(I!==null)I.return=A;else for(I=A;I!==null;){if(I===s){I=null;break}if(A=I.sibling,A!==null){A.return=I.return,I=A;break}I=I.return}A=I}}function gl(s,o,h,m){s=null;for(var A=o,T=!1;A!==null;){if(!T){if((A.flags&524288)!==0)T=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var I=A.alternate;if(I===null)throw Error(n(387));if(I=I.memoizedProps,I!==null){var Y=A.type;Ti(A.pendingProps.value,I.value)||(s!==null?s.push(Y):s=[Y])}}else if(A===fe.current){if(I=A.alternate,I===null)throw Error(n(387));I.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(s!==null?s.push(hm):s=[hm])}A=A.return}s!==null&&od(o,s,h,m),o.flags|=262144}function Kc(s){for(s=s.firstContext;s!==null;){if(!Ti(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Zl(s){Ao=s,Ya=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ea(s){return x0(Ao,s)}function _f(s,o){return Ao===null&&Zl(s),x0(s,o)}function x0(s,o){var h=o._currentValue;if(o={context:o,memoizedValue:h,next:null},Ya===null){if(s===null)throw Error(n(308));Ya=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Ya=Ya.next=o;return h}var av=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(h,m){s.push(m)}};this.abort=function(){o.aborted=!0,s.forEach(function(h){return h()})}},sv=i.unstable_scheduleCallback,_0=i.unstable_NormalPriority,qt={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function y0(){return{controller:new av,data:new Map,refCount:0}}function Ua(s){s.refCount--,s.refCount===0&&sv(_0,function(){s.controller.abort()})}var Ql=null,b0=0,To=0,Mr=null;function Jc(s,o){if(Ql===null){var h=Ql=[];b0=0,To=u2(),Mr={status:"pending",value:void 0,then:function(m){h.push(m)}}}return b0++,o.then(S0,S0),o}function S0(){if(--b0===0&&Ql!==null){Mr!==null&&(Mr.status="fulfilled");var s=Ql;Ql=null,To=0,Mr=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function A0(s,o){var h=[],m={status:"pending",value:null,reason:null,then:function(A){h.push(A)}};return s.then(function(){m.status="fulfilled",m.value=o;for(var A=0;A<h.length;A++)(0,h[A])(o)},function(A){for(m.status="rejected",m.reason=A,A=0;A<h.length;A++)(0,h[A])(void 0)}),m}var rv=H.S;H.S=function(s,o){cu=X(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&Jc(s,o),rv!==null&&rv(s,o)};var vl=Q(null);function Kr(){var s=vl.current;return s!==null?s:ii.pooledCache}function Wc(s,o){o===null?Te(vl,vl.current):Te(vl,o.pool)}function ld(){var s=Kr();return s===null?null:{parent:qt._currentValue,pool:s}}var xl=Error(n(460)),yf=Error(n(474)),Er=Error(n(542)),bf={then:function(){}};function ov(s){return s=s.status,s==="fulfilled"||s==="rejected"}function M0(s,o,h){switch(h=s[h],h===void 0?s.push(o):h!==o&&(o.then(Gr,Gr),o=h),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,E0(s),s;default:if(typeof o.status=="string")o.then(Gr,Gr);else{if(s=ii,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=o,s.status="pending",s.then(function(m){if(o.status==="pending"){var A=o;A.status="fulfilled",A.value=m}},function(m){if(o.status==="pending"){var A=o;A.status="rejected",A.reason=m}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,E0(s),s}throw $t=o,xl}}function $l(s){try{var o=s._init;return o(s._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?($t=h,xl):h}}var $t=null;function cd(){if($t===null)throw Error(n(459));var s=$t;return $t=null,s}function E0(s){if(s===xl||s===Er)throw Error(n(483))}var _l=null,yl=0;function ud(s){var o=yl;return yl+=1,_l===null&&(_l=[]),M0(_l,s,o)}function Sf(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Af(s,o){throw o.$$typeof===_?Error(n(525)):(s=Object.prototype.toString.call(o),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function Zc(s){function o(be,ge){if(s){var Ee=be.deletions;Ee===null?(be.deletions=[ge],be.flags|=16):Ee.push(ge)}}function h(be,ge){if(!s)return null;for(;ge!==null;)o(be,ge),ge=ge.sibling;return null}function m(be){for(var ge=new Map;be!==null;)be.key!==null?ge.set(be.key,be):ge.set(be.index,be),be=be.sibling;return ge}function A(be,ge){return be=jr(be,ge),be.index=0,be.sibling=null,be}function T(be,ge,Ee){return be.index=Ee,s?(Ee=be.alternate,Ee!==null?(Ee=Ee.index,Ee<ge?(be.flags|=67108866,ge):Ee):(be.flags|=67108866,ge)):(be.flags|=1048576,ge)}function I(be){return s&&be.alternate===null&&(be.flags|=67108866),be}function Y(be,ge,Ee,Ke){return ge===null||ge.tag!==6?(ge=id(Ee,be.mode,Ke),ge.return=be,ge):(ge=A(ge,Ee),ge.return=be,ge)}function ue(be,ge,Ee,Ke){var Zt=Ee.type;return Zt===C?Ve(be,ge,Ee.props.children,Ke,Ee.key):ge!==null&&(ge.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===j&&$l(Zt)===ge.type)?(ge=A(ge,Ee.props),Sf(ge,Ee),ge.return=be,ge):(ge=mf(Ee.type,Ee.key,Ee.props,null,be.mode,Ke),Sf(ge,Ee),ge.return=be,ge)}function Ce(be,ge,Ee,Ke){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Ee.containerInfo||ge.stateNode.implementation!==Ee.implementation?(ge=Sr(Ee,be.mode,Ke),ge.return=be,ge):(ge=A(ge,Ee.children||[]),ge.return=be,ge)}function Ve(be,ge,Ee,Ke,Zt){return ge===null||ge.tag!==7?(ge=yo(Ee,be.mode,Ke,Zt),ge.return=be,ge):(ge=A(ge,Ee),ge.return=be,ge)}function We(be,ge,Ee){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return ge=id(""+ge,be.mode,Ee),ge.return=be,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case y:return Ee=mf(ge.type,ge.key,ge.props,null,be.mode,Ee),Sf(Ee,ge),Ee.return=be,Ee;case b:return ge=Sr(ge,be.mode,Ee),ge.return=be,ge;case j:return ge=$l(ge),We(be,ge,Ee)}if(re(ge)||ie(ge))return ge=yo(ge,be.mode,Ee,null),ge.return=be,ge;if(typeof ge.then=="function")return We(be,ud(ge),Ee);if(ge.$$typeof===D)return We(be,_f(be,ge),Ee);Af(be,ge)}return null}function Be(be,ge,Ee,Ke){var Zt=ge!==null?ge.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return Zt!==null?null:Y(be,ge,""+Ee,Ke);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case y:return Ee.key===Zt?ue(be,ge,Ee,Ke):null;case b:return Ee.key===Zt?Ce(be,ge,Ee,Ke):null;case j:return Ee=$l(Ee),Be(be,ge,Ee,Ke)}if(re(Ee)||ie(Ee))return Zt!==null?null:Ve(be,ge,Ee,Ke,null);if(typeof Ee.then=="function")return Be(be,ge,ud(Ee),Ke);if(Ee.$$typeof===D)return Be(be,ge,_f(be,Ee),Ke);Af(be,Ee)}return null}function Ie(be,ge,Ee,Ke,Zt){if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint")return be=be.get(Ee)||null,Y(ge,be,""+Ke,Zt);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case y:return be=be.get(Ke.key===null?Ee:Ke.key)||null,ue(ge,be,Ke,Zt);case b:return be=be.get(Ke.key===null?Ee:Ke.key)||null,Ce(ge,be,Ke,Zt);case j:return Ke=$l(Ke),Ie(be,ge,Ee,Ke,Zt)}if(re(Ke)||ie(Ke))return be=be.get(Ee)||null,Ve(ge,be,Ke,Zt,null);if(typeof Ke.then=="function")return Ie(be,ge,Ee,ud(Ke),Zt);if(Ke.$$typeof===D)return Ie(be,ge,Ee,_f(ge,Ke),Zt);Af(ge,Ke)}return null}function Ft(be,ge,Ee,Ke){for(var Zt=null,si=null,kt=ge,bn=ge=0,Vn=null;kt!==null&&bn<Ee.length;bn++){kt.index>bn?(Vn=kt,kt=null):Vn=kt.sibling;var ri=Be(be,kt,Ee[bn],Ke);if(ri===null){kt===null&&(kt=Vn);break}s&&kt&&ri.alternate===null&&o(be,kt),ge=T(ri,ge,bn),si===null?Zt=ri:si.sibling=ri,si=ri,kt=Vn}if(bn===Ee.length)return h(be,kt),On&&bo(be,bn),Zt;if(kt===null){for(;bn<Ee.length;bn++)kt=We(be,Ee[bn],Ke),kt!==null&&(ge=T(kt,ge,bn),si===null?Zt=kt:si.sibling=kt,si=kt);return On&&bo(be,bn),Zt}for(kt=m(kt);bn<Ee.length;bn++)Vn=Ie(kt,be,bn,Ee[bn],Ke),Vn!==null&&(s&&Vn.alternate!==null&&kt.delete(Vn.key===null?bn:Vn.key),ge=T(Vn,ge,bn),si===null?Zt=Vn:si.sibling=Vn,si=Vn);return s&&kt.forEach(function(vu){return o(be,vu)}),On&&bo(be,bn),Zt}function tn(be,ge,Ee,Ke){if(Ee==null)throw Error(n(151));for(var Zt=null,si=null,kt=ge,bn=ge=0,Vn=null,ri=Ee.next();kt!==null&&!ri.done;bn++,ri=Ee.next()){kt.index>bn?(Vn=kt,kt=null):Vn=kt.sibling;var vu=Be(be,kt,ri.value,Ke);if(vu===null){kt===null&&(kt=Vn);break}s&&kt&&vu.alternate===null&&o(be,kt),ge=T(vu,ge,bn),si===null?Zt=vu:si.sibling=vu,si=vu,kt=Vn}if(ri.done)return h(be,kt),On&&bo(be,bn),Zt;if(kt===null){for(;!ri.done;bn++,ri=Ee.next())ri=We(be,ri.value,Ke),ri!==null&&(ge=T(ri,ge,bn),si===null?Zt=ri:si.sibling=ri,si=ri);return On&&bo(be,bn),Zt}for(kt=m(kt);!ri.done;bn++,ri=Ee.next())ri=Ie(kt,be,bn,ri.value,Ke),ri!==null&&(s&&ri.alternate!==null&&kt.delete(ri.key===null?bn:ri.key),ge=T(ri,ge,bn),si===null?Zt=ri:si.sibling=ri,si=ri);return s&&kt.forEach(function(sB){return o(be,sB)}),On&&bo(be,bn),Zt}function Si(be,ge,Ee,Ke){if(typeof Ee=="object"&&Ee!==null&&Ee.type===C&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case y:e:{for(var Zt=Ee.key;ge!==null;){if(ge.key===Zt){if(Zt=Ee.type,Zt===C){if(ge.tag===7){h(be,ge.sibling),Ke=A(ge,Ee.props.children),Ke.return=be,be=Ke;break e}}else if(ge.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===j&&$l(Zt)===ge.type){h(be,ge.sibling),Ke=A(ge,Ee.props),Sf(Ke,Ee),Ke.return=be,be=Ke;break e}h(be,ge);break}else o(be,ge);ge=ge.sibling}Ee.type===C?(Ke=yo(Ee.props.children,be.mode,Ke,Ee.key),Ke.return=be,be=Ke):(Ke=mf(Ee.type,Ee.key,Ee.props,null,be.mode,Ke),Sf(Ke,Ee),Ke.return=be,be=Ke)}return I(be);case b:e:{for(Zt=Ee.key;ge!==null;){if(ge.key===Zt)if(ge.tag===4&&ge.stateNode.containerInfo===Ee.containerInfo&&ge.stateNode.implementation===Ee.implementation){h(be,ge.sibling),Ke=A(ge,Ee.children||[]),Ke.return=be,be=Ke;break e}else{h(be,ge);break}else o(be,ge);ge=ge.sibling}Ke=Sr(Ee,be.mode,Ke),Ke.return=be,be=Ke}return I(be);case j:return Ee=$l(Ee),Si(be,ge,Ee,Ke)}if(re(Ee))return Ft(be,ge,Ee,Ke);if(ie(Ee)){if(Zt=ie(Ee),typeof Zt!="function")throw Error(n(150));return Ee=Zt.call(Ee),tn(be,ge,Ee,Ke)}if(typeof Ee.then=="function")return Si(be,ge,ud(Ee),Ke);if(Ee.$$typeof===D)return Si(be,ge,_f(be,Ee),Ke);Af(be,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint"?(Ee=""+Ee,ge!==null&&ge.tag===6?(h(be,ge.sibling),Ke=A(ge,Ee),Ke.return=be,be=Ke):(h(be,ge),Ke=id(Ee,be.mode,Ke),Ke.return=be,be=Ke),I(be)):h(be,ge)}return function(be,ge,Ee,Ke){try{yl=0;var Zt=Si(be,ge,Ee,Ke);return _l=null,Zt}catch(kt){if(kt===xl||kt===Er)throw kt;var si=as(29,kt,null,be.mode);return si.lanes=Ke,si.return=be,si}finally{}}}var ec=Zc(!0),lv=Zc(!1),bl=!1;function T0(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function C0(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Jr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Co(s,o,h){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(Hn&2)!==0){var A=m.pending;return A===null?o.next=o:(o.next=A.next,A.next=o),m.pending=o,o=Yc(s),nd(s,null,h),o}return pf(s,m,o,h),Yc(s)}function Sl(s,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194048)!==0)){var m=o.lanes;m&=s.pendingLanes,h|=m,o.lanes=h,go(s,h)}}function fd(s,o){var h=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,h===m)){var A=null,T=null;if(h=h.firstBaseUpdate,h!==null){do{var I={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};T===null?A=T=I:T=T.next=I,h=h.next}while(h!==null);T===null?A=T=o:T=T.next=o}else A=T=o;h={baseState:m.baseState,firstBaseUpdate:A,lastBaseUpdate:T,shared:m.shared,callbacks:m.callbacks},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=o:s.next=o,h.lastBaseUpdate=o}var R0=!1;function Mf(){if(R0){var s=Mr;if(s!==null)throw s}}function tc(s,o,h,m){R0=!1;var A=s.updateQueue;bl=!1;var T=A.firstBaseUpdate,I=A.lastBaseUpdate,Y=A.shared.pending;if(Y!==null){A.shared.pending=null;var ue=Y,Ce=ue.next;ue.next=null,I===null?T=Ce:I.next=Ce,I=ue;var Ve=s.alternate;Ve!==null&&(Ve=Ve.updateQueue,Y=Ve.lastBaseUpdate,Y!==I&&(Y===null?Ve.firstBaseUpdate=Ce:Y.next=Ce,Ve.lastBaseUpdate=ue))}if(T!==null){var We=A.baseState;I=0,Ve=Ce=ue=null,Y=T;do{var Be=Y.lane&-536870913,Ie=Be!==Y.lane;if(Ie?(Dn&Be)===Be:(m&Be)===Be){Be!==0&&Be===To&&(R0=!0),Ve!==null&&(Ve=Ve.next={lane:0,tag:Y.tag,payload:Y.payload,callback:null,next:null});e:{var Ft=s,tn=Y;Be=o;var Si=h;switch(tn.tag){case 1:if(Ft=tn.payload,typeof Ft=="function"){We=Ft.call(Si,We,Be);break e}We=Ft;break e;case 3:Ft.flags=Ft.flags&-65537|128;case 0:if(Ft=tn.payload,Be=typeof Ft=="function"?Ft.call(Si,We,Be):Ft,Be==null)break e;We=g({},We,Be);break e;case 2:bl=!0}}Be=Y.callback,Be!==null&&(s.flags|=64,Ie&&(s.flags|=8192),Ie=A.callbacks,Ie===null?A.callbacks=[Be]:Ie.push(Be))}else Ie={lane:Be,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Ve===null?(Ce=Ve=Ie,ue=We):Ve=Ve.next=Ie,I|=Be;if(Y=Y.next,Y===null){if(Y=A.shared.pending,Y===null)break;Ie=Y,Y=Ie.next,Ie.next=null,A.lastBaseUpdate=Ie,A.shared.pending=null}}while(!0);Ve===null&&(ue=We),A.baseState=ue,A.firstBaseUpdate=Ce,A.lastBaseUpdate=Ve,T===null&&(A.shared.lanes=0),Ks|=I,s.lanes=I,s.memoizedState=We}}function Wr(s,o){if(typeof s!="function")throw Error(n(191,s));s.call(o)}function Oa(s,o){var h=s.callbacks;if(h!==null)for(s.callbacks=null,s=0;s<h.length;s++)Wr(h[s],o)}var Fs=Q(null),rs=Q(0);function w0(s,o){s=Wi,Te(rs,s),Te(Fs,o),Wi=s|o.baseLanes}function B0(){Te(rs,Wi),Te(Fs,Fs.current)}function qa(){Wi=rs.current,de(Fs),de(rs)}var pa=Q(null),lr=null;function Al(s){var o=s.alternate;Te(Ii,Ii.current&1),Te(pa,s),lr===null&&(o===null||Fs.current!==null||o.memoizedState!==null)&&(lr=s)}function D0(s){Te(Ii,Ii.current),Te(pa,s),lr===null&&(lr=s)}function cv(s){s.tag===22?(Te(Ii,Ii.current),Te(pa,s),lr===null&&(lr=s)):Ro()}function Ro(){Te(Ii,Ii.current),Te(pa,pa.current)}function zs(s){de(pa),lr===s&&(lr=null),de(Ii)}var Ii=Q(0);function hd(s){for(var o=s;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||S2(h)||A2(h)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var _s=0,nn=null,pi=null,na=null,dd=!1,Zr=!1,nc=!1,pd=0,Ef=0,Qr=null,e2=0;function Pi(){throw Error(n(321))}function U0(s,o){if(o===null)return!1;for(var h=0;h<o.length&&h<s.length;h++)if(!Ti(s[h],o[h]))return!1;return!0}function O0(s,o,h,m,A,T){return _s=T,nn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,H.H=s===null||s.memoizedState===null?wv:eu,nc=!1,T=h(m,A),nc=!1,Zr&&(T=fv(o,h,m,A)),uv(s),T}function uv(s){H.H=Bf;var o=pi!==null&&pi.next!==null;if(_s=0,na=pi=nn=null,dd=!1,Ef=0,Qr=null,o)throw Error(n(300));s===null||Ci||(s=s.dependencies,s!==null&&Kc(s)&&(Ci=!0))}function fv(s,o,h,m){nn=s;var A=0;do{if(Zr&&(Qr=null),Ef=0,Zr=!1,25<=A)throw Error(n(301));if(A+=1,na=pi=null,s.updateQueue!=null){var T=s.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}H.H=Df,T=o(h,m)}while(Zr);return T}function t2(){var s=H.H,o=s.useState()[0];return o=typeof o.then=="function"?Cf(o):o,s=s.useState()[0],(pi!==null?pi.memoizedState:null)!==s&&(nn.flags|=1024),o}function N0(){var s=pd!==0;return pd=0,s}function L0(s,o,h){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~h}function I0(s){if(dd){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}dd=!1}_s=0,na=pi=nn=null,Zr=!1,Ef=pd=0,Qr=null}function os(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return na===null?nn.memoizedState=na=s:na=na.next=s,na}function Yi(){if(pi===null){var s=nn.alternate;s=s!==null?s.memoizedState:null}else s=pi.next;var o=na===null?nn.memoizedState:na.next;if(o!==null)na=o,pi=s;else{if(s===null)throw nn.alternate===null?Error(n(467)):Error(n(310));pi=s,s={memoizedState:pi.memoizedState,baseState:pi.baseState,baseQueue:pi.baseQueue,queue:pi.queue,next:null},na===null?nn.memoizedState=na=s:na=na.next=s}return na}function Tf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cf(s){var o=Ef;return Ef+=1,Qr===null&&(Qr=[]),s=M0(Qr,s,o),o=nn,(na===null?o.memoizedState:na.next)===null&&(o=o.alternate,H.H=o===null||o.memoizedState===null?wv:eu),s}function md(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Cf(s);if(s.$$typeof===D)return Ea(s)}throw Error(n(438,String(s)))}function P0(s){var o=null,h=nn.updateQueue;if(h!==null&&(o=h.memoCache),o==null){var m=nn.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(o={data:m.data.map(function(A){return A.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),h===null&&(h=Tf(),nn.updateQueue=h),h.memoCache=o,h=o.data[o.index],h===void 0)for(h=o.data[o.index]=Array(s),m=0;m<s;m++)h[m]=P;return o.index++,h}function wo(s,o){return typeof o=="function"?o(s):o}function gd(s){var o=Yi();return F0(o,pi,s)}function F0(s,o,h){var m=s.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=h;var A=s.baseQueue,T=m.pending;if(T!==null){if(A!==null){var I=A.next;A.next=T.next,T.next=I}o.baseQueue=A=T,m.pending=null}if(T=s.baseState,A===null)s.memoizedState=T;else{o=A.next;var Y=I=null,ue=null,Ce=o,Ve=!1;do{var We=Ce.lane&-536870913;if(We!==Ce.lane?(Dn&We)===We:(_s&We)===We){var Be=Ce.revertLane;if(Be===0)ue!==null&&(ue=ue.next={lane:0,revertLane:0,gesture:null,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null}),We===To&&(Ve=!0);else if((_s&Be)===Be){Ce=Ce.next,Be===To&&(Ve=!0);continue}else We={lane:0,revertLane:Ce.revertLane,gesture:null,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null},ue===null?(Y=ue=We,I=T):ue=ue.next=We,nn.lanes|=Be,Ks|=Be;We=Ce.action,nc&&h(T,We),T=Ce.hasEagerState?Ce.eagerState:h(T,We)}else Be={lane:We,revertLane:Ce.revertLane,gesture:Ce.gesture,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null},ue===null?(Y=ue=Be,I=T):ue=ue.next=Be,nn.lanes|=We,Ks|=We;Ce=Ce.next}while(Ce!==null&&Ce!==o);if(ue===null?I=T:ue.next=Y,!Ti(T,s.memoizedState)&&(Ci=!0,Ve&&(h=Mr,h!==null)))throw h;s.memoizedState=T,s.baseState=I,s.baseQueue=ue,m.lastRenderedState=T}return A===null&&(m.lanes=0),[s.memoizedState,m.dispatch]}function vd(s){var o=Yi(),h=o.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=s;var m=h.dispatch,A=h.pending,T=o.memoizedState;if(A!==null){h.pending=null;var I=A=A.next;do T=s(T,I.action),I=I.next;while(I!==A);Ti(T,o.memoizedState)||(Ci=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),h.lastRenderedState=T}return[T,m]}function z0(s,o,h){var m=nn,A=Yi(),T=On;if(T){if(h===void 0)throw Error(n(407));h=h()}else h=o();var I=!Ti((pi||A).memoizedState,h);if(I&&(A.memoizedState=h,Ci=!0),A=A.queue,j0(G0.bind(null,m,A,s),[s]),A.getSnapshot!==o||I||na!==null&&na.memoizedState.tag&1){if(m.flags|=2048,Qc(9,{destroy:void 0},H0.bind(null,m,A,h,o),null),ii===null)throw Error(n(349));T||(_s&127)!==0||hv(m,o,h)}return h}function hv(s,o,h){s.flags|=16384,s={getSnapshot:o,value:h},o=nn.updateQueue,o===null?(o=Tf(),nn.updateQueue=o,o.stores=[s]):(h=o.stores,h===null?o.stores=[s]:h.push(s))}function H0(s,o,h,m){o.value=h,o.getSnapshot=m,V0(o)&&xd(s)}function G0(s,o,h){return h(function(){V0(o)&&xd(s)})}function V0(s){var o=s.getSnapshot;s=s.value;try{var h=o();return!Ti(s,h)}catch{return!0}}function xd(s){var o=dl(s,2);o!==null&&f(o,s,2)}function Rf(s){var o=os();if(typeof s=="function"){var h=s;if(s=h(),nc){It(!0);try{h()}finally{It(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:s},o}function dv(s,o,h,m){return s.baseState=h,F0(s,pi,typeof m=="function"?m:wo)}function n2(s,o,h,m,A){if(Bo(s))throw Error(n(485));if(s=o.action,s!==null){var T={payload:A,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){T.listeners.push(I)}};H.T!==null?h(!0):T.isTransition=!1,m(T),h=o.pending,h===null?(T.next=o.pending=T,pv(o,T)):(T.next=h.next,o.pending=h.next=T)}}function pv(s,o){var h=o.action,m=o.payload,A=s.state;if(o.isTransition){var T=H.T,I={};H.T=I;try{var Y=h(A,m),ue=H.S;ue!==null&&ue(I,Y),mv(s,o,Y)}catch(Ce){_d(s,o,Ce)}finally{T!==null&&I.types!==null&&(T.types=I.types),H.T=T}}else try{T=h(A,m),mv(s,o,T)}catch(Ce){_d(s,o,Ce)}}function mv(s,o,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(m){k0(s,o,m)},function(m){return _d(s,o,m)}):k0(s,o,h)}function k0(s,o,h){o.status="fulfilled",o.value=h,gv(o),s.state=h,o=s.pending,o!==null&&(h=o.next,h===o?s.pending=null:(h=h.next,o.next=h,pv(s,h)))}function _d(s,o,h){var m=s.pending;if(s.pending=null,m!==null){m=m.next;do o.status="rejected",o.reason=h,gv(o),o=o.next;while(o!==m)}s.action=null}function gv(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function vv(s,o){return o}function xv(s,o){if(On){var h=ii.formState;if(h!==null){e:{var m=nn;if(On){if(_i){t:{for(var A=_i,T=Ma;A.nodeType!==8;){if(!T){A=null;break t}if(A=ao(A.nextSibling),A===null){A=null;break t}}T=A.data,A=T==="F!"||T==="F"?A:null}if(A){_i=ao(A.nextSibling),m=A.data==="F!";break e}}Bn(m)}m=!1}m&&(o=h[0])}}return h=os(),h.memoizedState=h.baseState=o,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vv,lastRenderedState:o},h.queue=m,h=Rv.bind(null,nn,m),m.dispatch=h,m=Rf(!1),T=wf.bind(null,nn,!1,m.queue),m=os(),A={state:o,dispatch:null,action:s,pending:null},m.queue=A,h=n2.bind(null,nn,A,T,h),A.dispatch=h,m.memoizedState=s,[o,h,!1]}function _v(s){var o=Yi();return yv(o,pi,s)}function yv(s,o,h){if(o=F0(s,o,vv)[0],s=gd(wo)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var m=Cf(o)}catch(I){throw I===xl?Er:I}else m=o;o=Yi();var A=o.queue,T=A.dispatch;return h!==o.memoizedState&&(nn.flags|=2048,Qc(9,{destroy:void 0},i2.bind(null,A,h),null)),[m,T,s]}function i2(s,o){s.action=o}function bv(s){var o=Yi(),h=pi;if(h!==null)return yv(o,h,s);Yi(),o=o.memoizedState,h=Yi();var m=h.queue.dispatch;return h.memoizedState=s,[o,m,!1]}function Qc(s,o,h,m){return s={tag:s,create:h,deps:m,inst:o,next:null},o=nn.updateQueue,o===null&&(o=Tf(),nn.updateQueue=o),h=o.lastEffect,h===null?o.lastEffect=s.next=s:(m=h.next,h.next=s,s.next=m,o.lastEffect=s),s}function Sv(){return Yi().memoizedState}function yd(s,o,h,m){var A=os();nn.flags|=s,A.memoizedState=Qc(1|o,{destroy:void 0},h,m===void 0?null:m)}function bd(s,o,h,m){var A=Yi();m=m===void 0?null:m;var T=A.memoizedState.inst;pi!==null&&m!==null&&U0(m,pi.memoizedState.deps)?A.memoizedState=Qc(o,T,h,m):(nn.flags|=s,A.memoizedState=Qc(1|o,T,h,m))}function Av(s,o){yd(8390656,8,s,o)}function j0(s,o){bd(2048,8,s,o)}function Mv(s){nn.flags|=4;var o=nn.updateQueue;if(o===null)o=Tf(),nn.updateQueue=o,o.events=[s];else{var h=o.events;h===null?o.events=[s]:h.push(s)}}function Ev(s){var o=Yi().memoizedState;return Mv({ref:o,nextImpl:s}),function(){if((Hn&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function Tv(s,o){return bd(4,2,s,o)}function Hs(s,o){return bd(4,4,s,o)}function X0(s,o){if(typeof o=="function"){s=s();var h=o(s);return function(){typeof h=="function"?h():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Sd(s,o,h){h=h!=null?h.concat([s]):null,bd(4,4,X0.bind(null,o,s),h)}function Ad(){}function Y0(s,o){var h=Yi();o=o===void 0?null:o;var m=h.memoizedState;return o!==null&&U0(o,m[1])?m[0]:(h.memoizedState=[s,o],s)}function q0(s,o){var h=Yi();o=o===void 0?null:o;var m=h.memoizedState;if(o!==null&&U0(o,m[1]))return m[0];if(m=s(),nc){It(!0);try{s()}finally{It(!1)}}return h.memoizedState=[m,o],m}function K0(s,o,h){return h===void 0||(_s&1073741824)!==0&&(Dn&261930)===0?s.memoizedState=o:(s.memoizedState=h,s=c(),nn.lanes|=s,Ks|=s,h)}function J0(s,o,h,m){return Ti(h,o)?h:Fs.current!==null?(s=K0(s,h,m),Ti(s,o)||(Ci=!0),s):(_s&42)===0||(_s&1073741824)!==0&&(Dn&261930)===0?(Ci=!0,s.memoizedState=h):(s=c(),nn.lanes|=s,Ks|=s,o)}function W0(s,o,h,m,A){var T=K.p;K.p=T!==0&&8>T?T:8;var I=H.T,Y={};H.T=Y,wf(s,!1,o,h);try{var ue=A(),Ce=H.S;if(Ce!==null&&Ce(Y,ue),ue!==null&&typeof ue=="object"&&typeof ue.then=="function"){var Ve=A0(ue,m);$c(s,o,Ve,cs(s))}else $c(s,o,m,cs(s))}catch(We){$c(s,o,{then:function(){},status:"rejected",reason:We},cs())}finally{K.p=T,I!==null&&Y.types!==null&&(I.types=Y.types),H.T=I}}function a2(){}function Z0(s,o,h,m){if(s.tag!==5)throw Error(n(476));var A=Cv(s).queue;W0(s,A,o,W,h===null?a2:function(){return Q0(s),h(m)})}function Cv(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:W},next:null};var h={};return o.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:h},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Q0(s){var o=Cv(s);o.next===null&&(o=s.alternate.memoizedState),$c(s,o.next.queue,{},cs())}function $0(){return Ea(hm)}function Na(){return Yi().memoizedState}function em(){return Yi().memoizedState}function s2(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var h=cs();s=Jr(h);var m=Co(o,s,h);m!==null&&(f(m,o,h),Sl(m,o,h)),o={cache:y0()},s.payload=o;return}o=o.return}}function r2(s,o,h){var m=cs();h={lane:m,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Bo(s)?ic(o,h):(h=Xc(s,o,h,m),h!==null&&(f(h,s,m),ys(h,o,m)))}function Rv(s,o,h){var m=cs();$c(s,o,h,m)}function $c(s,o,h,m){var A={lane:m,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Bo(s))ic(o,A);else{var T=s.alternate;if(s.lanes===0&&(T===null||T.lanes===0)&&(T=o.lastRenderedReducer,T!==null))try{var I=o.lastRenderedState,Y=T(I,h);if(A.hasEagerState=!0,A.eagerState=Y,Ti(Y,I))return pf(s,o,A,0),ii===null&&hl(),!1}catch{}finally{}if(h=Xc(s,o,A,m),h!==null)return f(h,s,m),ys(h,o,m),!0}return!1}function wf(s,o,h,m){if(m={lane:2,revertLane:u2(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Bo(s)){if(o)throw Error(n(479))}else o=Xc(s,h,m,2),o!==null&&f(o,s,2)}function Bo(s){var o=s.alternate;return s===nn||o!==null&&o===nn}function ic(s,o){Zr=dd=!0;var h=s.pending;h===null?o.next=o:(o.next=h.next,h.next=o),s.pending=o}function ys(s,o,h){if((h&4194048)!==0){var m=o.lanes;m&=s.pendingLanes,h|=m,o.lanes=h,go(s,h)}}var Bf={readContext:Ea,use:md,useCallback:Pi,useContext:Pi,useEffect:Pi,useImperativeHandle:Pi,useLayoutEffect:Pi,useInsertionEffect:Pi,useMemo:Pi,useReducer:Pi,useRef:Pi,useState:Pi,useDebugValue:Pi,useDeferredValue:Pi,useTransition:Pi,useSyncExternalStore:Pi,useId:Pi,useHostTransitionStatus:Pi,useFormState:Pi,useActionState:Pi,useOptimistic:Pi,useMemoCache:Pi,useCacheRefresh:Pi};Bf.useEffectEvent=Pi;var wv={readContext:Ea,use:md,useCallback:function(s,o){return os().memoizedState=[s,o===void 0?null:o],s},useContext:Ea,useEffect:Av,useImperativeHandle:function(s,o,h){h=h!=null?h.concat([s]):null,yd(4194308,4,X0.bind(null,o,s),h)},useLayoutEffect:function(s,o){return yd(4194308,4,s,o)},useInsertionEffect:function(s,o){yd(4,2,s,o)},useMemo:function(s,o){var h=os();o=o===void 0?null:o;var m=s();if(nc){It(!0);try{s()}finally{It(!1)}}return h.memoizedState=[m,o],m},useReducer:function(s,o,h){var m=os();if(h!==void 0){var A=h(o);if(nc){It(!0);try{h(o)}finally{It(!1)}}}else A=o;return m.memoizedState=m.baseState=A,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:A},m.queue=s,s=s.dispatch=r2.bind(null,nn,s),[m.memoizedState,s]},useRef:function(s){var o=os();return s={current:s},o.memoizedState=s},useState:function(s){s=Rf(s);var o=s.queue,h=Rv.bind(null,nn,o);return o.dispatch=h,[s.memoizedState,h]},useDebugValue:Ad,useDeferredValue:function(s,o){var h=os();return K0(h,s,o)},useTransition:function(){var s=Rf(!1);return s=W0.bind(null,nn,s.queue,!0,!1),os().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,h){var m=nn,A=os();if(On){if(h===void 0)throw Error(n(407));h=h()}else{if(h=o(),ii===null)throw Error(n(349));(Dn&127)!==0||hv(m,o,h)}A.memoizedState=h;var T={value:h,getSnapshot:o};return A.queue=T,Av(G0.bind(null,m,T,s),[s]),m.flags|=2048,Qc(9,{destroy:void 0},H0.bind(null,m,T,h,o),null),h},useId:function(){var s=os(),o=ii.identifierPrefix;if(On){var h=qr,m=Yr;h=(m&~(1<<32-Et(m)-1)).toString(32)+h,o="_"+o+"R_"+h,h=pd++,0<h&&(o+="H"+h.toString(32)),o+="_"}else h=e2++,o="_"+o+"r_"+h.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:$0,useFormState:xv,useActionState:xv,useOptimistic:function(s){var o=os();o.memoizedState=o.baseState=s;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=h,o=wf.bind(null,nn,!0,h),h.dispatch=o,[s,o]},useMemoCache:P0,useCacheRefresh:function(){return os().memoizedState=s2.bind(null,nn)},useEffectEvent:function(s){var o=os(),h={impl:s};return o.memoizedState=h,function(){if((Hn&2)!==0)throw Error(n(440));return h.impl.apply(void 0,arguments)}}},eu={readContext:Ea,use:md,useCallback:Y0,useContext:Ea,useEffect:j0,useImperativeHandle:Sd,useInsertionEffect:Tv,useLayoutEffect:Hs,useMemo:q0,useReducer:gd,useRef:Sv,useState:function(){return gd(wo)},useDebugValue:Ad,useDeferredValue:function(s,o){var h=Yi();return J0(h,pi.memoizedState,s,o)},useTransition:function(){var s=gd(wo)[0],o=Yi().memoizedState;return[typeof s=="boolean"?s:Cf(s),o]},useSyncExternalStore:z0,useId:Na,useHostTransitionStatus:$0,useFormState:_v,useActionState:_v,useOptimistic:function(s,o){var h=Yi();return dv(h,pi,s,o)},useMemoCache:P0,useCacheRefresh:em};eu.useEffectEvent=Ev;var Df={readContext:Ea,use:md,useCallback:Y0,useContext:Ea,useEffect:j0,useImperativeHandle:Sd,useInsertionEffect:Tv,useLayoutEffect:Hs,useMemo:q0,useReducer:vd,useRef:Sv,useState:function(){return vd(wo)},useDebugValue:Ad,useDeferredValue:function(s,o){var h=Yi();return pi===null?K0(h,s,o):J0(h,pi.memoizedState,s,o)},useTransition:function(){var s=vd(wo)[0],o=Yi().memoizedState;return[typeof s=="boolean"?s:Cf(s),o]},useSyncExternalStore:z0,useId:Na,useHostTransitionStatus:$0,useFormState:bv,useActionState:bv,useOptimistic:function(s,o){var h=Yi();return pi!==null?dv(h,pi,s,o):(h.baseState=s,[s,h.queue.dispatch])},useMemoCache:P0,useCacheRefresh:em};Df.useEffectEvent=Ev;function tu(s,o,h,m){o=s.memoizedState,h=h(m,o),h=h==null?o:g({},o,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var Uf={enqueueSetState:function(s,o,h){s=s._reactInternals;var m=cs(),A=Jr(m);A.payload=o,h!=null&&(A.callback=h),o=Co(s,A,m),o!==null&&(f(o,s,m),Sl(o,s,m))},enqueueReplaceState:function(s,o,h){s=s._reactInternals;var m=cs(),A=Jr(m);A.tag=1,A.payload=o,h!=null&&(A.callback=h),o=Co(s,A,m),o!==null&&(f(o,s,m),Sl(o,s,m))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var h=cs(),m=Jr(h);m.tag=2,o!=null&&(m.callback=o),o=Co(s,m,h),o!==null&&(f(o,s,h),Sl(o,s,h))}};function Bv(s,o,h,m,A,T,I){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,T,I):o.prototype&&o.prototype.isPureReactComponent?!zc(h,m)||!zc(A,T):!0}function Dv(s,o,h,m){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,m),o.state!==s&&Uf.enqueueReplaceState(o,o.state,null)}function La(s,o){var h=o;if("ref"in o){h={};for(var m in o)m!=="ref"&&(h[m]=o[m])}if(s=s.defaultProps){h===o&&(h=g({},h));for(var A in s)h[A]===void 0&&(h[A]=s[A])}return h}function tm(s){fl(s)}function Uv(s){console.error(s)}function Md(s){fl(s)}function Ed(s,o){try{var h=s.onUncaughtError;h(o.value,{componentStack:o.stack})}catch(m){setTimeout(function(){throw m})}}function Ov(s,o,h){try{var m=s.onCaughtError;m(h.value,{componentStack:h.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function nm(s,o,h){return h=Jr(h),h.tag=3,h.payload={element:null},h.callback=function(){Ed(s,o)},h}function nu(s){return s=Jr(s),s.tag=3,s}function bs(s,o,h,m){var A=h.type.getDerivedStateFromError;if(typeof A=="function"){var T=m.value;s.payload=function(){return A(T)},s.callback=function(){Ov(o,h,m)}}var I=h.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(s.callback=function(){Ov(o,h,m),typeof A!="function"&&(io===null?io=new Set([this]):io.add(this));var Y=m.stack;this.componentDidCatch(m.value,{componentStack:Y!==null?Y:""})})}function Gs(s,o,h,m,A){if(h.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(o=h.alternate,o!==null&&gl(o,h,A,!0),h=pa.current,h!==null){switch(h.tag){case 31:case 13:return lr===null?ln():h.alternate===null&&ai===0&&(ai=3),h.flags&=-257,h.flags|=65536,h.lanes=A,m===bf?h.flags|=16384:(o=h.updateQueue,o===null?h.updateQueue=new Set([m]):o.add(m),o2(s,m,A)),!1;case 22:return h.flags|=65536,m===bf?h.flags|=16384:(o=h.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([m])},h.updateQueue=o):(h=o.retryQueue,h===null?o.retryQueue=new Set([m]):h.add(m)),o2(s,m,A)),!1}throw Error(n(435,h.tag))}return o2(s,m,A),ln(),!1}if(On)return o=pa.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=A,m!==sd&&(s=Error(n(422),{cause:m}),xf(vs(s,h)))):(m!==sd&&(o=Error(n(423),{cause:m}),xf(vs(o,h))),s=s.current.alternate,s.flags|=65536,A&=-A,s.lanes|=A,m=vs(m,h),A=nm(s.stateNode,m,A),fd(s,A),ai!==4&&(ai=2)),!1;var T=Error(n(520),{cause:m});if(T=vs(T,h),Br===null?Br=[T]:Br.push(T),ai!==4&&(ai=2),o===null)return!0;m=vs(m,h),h=o;do{switch(h.tag){case 3:return h.flags|=65536,s=A&-A,h.lanes|=s,s=nm(h.stateNode,m,s),fd(h,s),!1;case 1:if(o=h.type,T=h.stateNode,(h.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(io===null||!io.has(T))))return h.flags|=65536,A&=-A,h.lanes|=A,A=nu(A),bs(A,s,h,m),fd(h,A),!1}h=h.return}while(h!==null);return!1}var Td=Error(n(461)),Ci=!1;function Fi(s,o,h,m){o.child=s===null?lv(o,null,h,m):ec(o,s.child,h,m)}function Of(s,o,h,m,A){h=h.render;var T=o.ref;if("ref"in m){var I={};for(var Y in m)Y!=="ref"&&(I[Y]=m[Y])}else I=m;return Zl(o),m=O0(s,o,h,I,T,A),Y=N0(),s!==null&&!Ci?(L0(s,o,A),Rr(s,o,A)):(On&&Y&&ad(o),o.flags|=1,Fi(s,o,m,A),o.child)}function Nf(s,o,h,m,A){if(s===null){var T=h.type;return typeof T=="function"&&!ss(T)&&T.defaultProps===void 0&&h.compare===null?(o.tag=15,o.type=T,Vs(s,o,T,m,A)):(s=mf(h.type,null,m,o,o.mode,A),s.ref=o.ref,s.return=o,o.child=s)}if(T=s.child,!El(s,A)){var I=T.memoizedProps;if(h=h.compare,h=h!==null?h:zc,h(I,m)&&s.ref===o.ref)return Rr(s,o,A)}return o.flags|=1,s=jr(T,m),s.ref=o.ref,s.return=o,o.child=s}function Vs(s,o,h,m,A){if(s!==null){var T=s.memoizedProps;if(zc(T,m)&&s.ref===o.ref)if(Ci=!1,o.pendingProps=m=T,El(s,A))(s.flags&131072)!==0&&(Ci=!0);else return o.lanes=s.lanes,Rr(s,o,A)}return iu(s,o,h,m,A)}function ks(s,o,h,m){var A=m.children,T=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((o.flags&128)!==0){if(T=T!==null?T.baseLanes|h:h,s!==null){for(m=o.child=s.child,A=0;m!==null;)A=A|m.lanes|m.childLanes,m=m.sibling;m=A&~T}else m=0,o.child=null;return $r(s,o,T,h,m)}if((h&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Wc(o,T!==null?T.cachePool:null),T!==null?w0(o,T):B0(),cv(o);else return m=o.lanes=536870912,$r(s,o,T!==null?T.baseLanes|h:h,h,m)}else T!==null?(Wc(o,T.cachePool),w0(o,T),Ro(),o.memoizedState=null):(s!==null&&Wc(o,null),B0(),Ro());return Fi(s,o,A,h),o.child}function Tr(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function $r(s,o,h,m,A){var T=Kr();return T=T===null?null:{parent:qt._currentValue,pool:T},o.memoizedState={baseLanes:h,cachePool:T},s!==null&&Wc(o,null),B0(),cv(o),s!==null&&gl(s,o,m,!0),o.childLanes=A,null}function cr(s,o){return o=au({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function Ta(s,o,h){return ec(o,s.child,null,h),s=cr(o,o.pendingProps),s.flags|=2,zs(o),o.memoizedState=null,s}function Lf(s,o,h){var m=o.pendingProps,A=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(On){if(m.mode==="hidden")return s=cr(o,m),o.lanes=536870912,Tr(null,s);if(D0(o),(s=_i)?(s=RA(s,Ma),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:Xr!==null?{id:Yr,overflow:qr}:null,retryLane:536870912,hydrationErrors:null},h=nv(s),h.return=o,o.child=h,Aa=o,_i=null)):s=null,s===null)throw Bn(o);return o.lanes=536870912,null}return cr(o,m)}var T=s.memoizedState;if(T!==null){var I=T.dehydrated;if(D0(o),A)if(o.flags&256)o.flags&=-257,o=Ta(s,o,h);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(n(558));else if(Ci||gl(s,o,h,!1),A=(h&s.childLanes)!==0,Ci||A){if(m=ii,m!==null&&(I=sr(m,h),I!==0&&I!==T.retryLane))throw T.retryLane=I,dl(s,I),f(m,s,I),Td;ln(),o=Ta(s,o,h)}else s=T.treeContext,_i=ao(I.nextSibling),Aa=o,On=!0,So=null,Ma=!1,s!==null&&vf(o,s),o=cr(o,m),o.flags|=4096;return o}return s=jr(s.child,{mode:m.mode,children:m.children}),s.ref=o.ref,o.child=s,s.return=o,s}function Cr(s,o){var h=o.ref;if(h===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(s===null||s.ref!==h)&&(o.flags|=4194816)}}function iu(s,o,h,m,A){return Zl(o),h=O0(s,o,h,m,void 0,A),m=N0(),s!==null&&!Ci?(L0(s,o,A),Rr(s,o,A)):(On&&m&&ad(o),o.flags|=1,Fi(s,o,h,A),o.child)}function Ka(s,o,h,m,A,T){return Zl(o),o.updateQueue=null,h=fv(o,m,h,A),uv(s),m=N0(),s!==null&&!Ci?(L0(s,o,T),Rr(s,o,T)):(On&&m&&ad(o),o.flags|=1,Fi(s,o,h,T),o.child)}function Ia(s,o,h,m,A){if(Zl(o),o.stateNode===null){var T=pl,I=h.contextType;typeof I=="object"&&I!==null&&(T=Ea(I)),T=new h(m,T),o.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Uf,o.stateNode=T,T._reactInternals=o,T=o.stateNode,T.props=m,T.state=o.memoizedState,T.refs={},T0(o),I=h.contextType,T.context=typeof I=="object"&&I!==null?Ea(I):pl,T.state=o.memoizedState,I=h.getDerivedStateFromProps,typeof I=="function"&&(tu(o,h,I,m),T.state=o.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(I=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),I!==T.state&&Uf.enqueueReplaceState(T,T.state,null),tc(o,m,T,A),Mf(),T.state=o.memoizedState),typeof T.componentDidMount=="function"&&(o.flags|=4194308),m=!0}else if(s===null){T=o.stateNode;var Y=o.memoizedProps,ue=La(h,Y);T.props=ue;var Ce=T.context,Ve=h.contextType;I=pl,typeof Ve=="object"&&Ve!==null&&(I=Ea(Ve));var We=h.getDerivedStateFromProps;Ve=typeof We=="function"||typeof T.getSnapshotBeforeUpdate=="function",Y=o.pendingProps!==Y,Ve||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(Y||Ce!==I)&&Dv(o,T,m,I),bl=!1;var Be=o.memoizedState;T.state=Be,tc(o,m,T,A),Mf(),Ce=o.memoizedState,Y||Be!==Ce||bl?(typeof We=="function"&&(tu(o,h,We,m),Ce=o.memoizedState),(ue=bl||Bv(o,h,ue,m,Be,Ce,I))?(Ve||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(o.flags|=4194308)):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=m,o.memoizedState=Ce),T.props=m,T.state=Ce,T.context=I,m=ue):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),m=!1)}else{T=o.stateNode,C0(s,o),I=o.memoizedProps,Ve=La(h,I),T.props=Ve,We=o.pendingProps,Be=T.context,Ce=h.contextType,ue=pl,typeof Ce=="object"&&Ce!==null&&(ue=Ea(Ce)),Y=h.getDerivedStateFromProps,(Ce=typeof Y=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(I!==We||Be!==ue)&&Dv(o,T,m,ue),bl=!1,Be=o.memoizedState,T.state=Be,tc(o,m,T,A),Mf();var Ie=o.memoizedState;I!==We||Be!==Ie||bl||s!==null&&s.dependencies!==null&&Kc(s.dependencies)?(typeof Y=="function"&&(tu(o,h,Y,m),Ie=o.memoizedState),(Ve=bl||Bv(o,h,Ve,m,Be,Ie,ue)||s!==null&&s.dependencies!==null&&Kc(s.dependencies))?(Ce||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(m,Ie,ue),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(m,Ie,ue)),typeof T.componentDidUpdate=="function"&&(o.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof T.componentDidUpdate!="function"||I===s.memoizedProps&&Be===s.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||I===s.memoizedProps&&Be===s.memoizedState||(o.flags|=1024),o.memoizedProps=m,o.memoizedState=Ie),T.props=m,T.state=Ie,T.context=ue,m=Ve):(typeof T.componentDidUpdate!="function"||I===s.memoizedProps&&Be===s.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||I===s.memoizedProps&&Be===s.memoizedState||(o.flags|=1024),m=!1)}return T=m,Cr(s,o),m=(o.flags&128)!==0,T||m?(T=o.stateNode,h=m&&typeof h.getDerivedStateFromError!="function"?null:T.render(),o.flags|=1,s!==null&&m?(o.child=ec(o,s.child,null,A),o.child=ec(o,null,h,A)):Fi(s,o,h,A),o.memoizedState=T.state,s=o.child):s=Rr(s,o,A),s}function Xn(s,o,h,m){return Wl(),o.flags|=256,Fi(s,o,h,m),o.child}var js={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ur(s){return{baseLanes:s,cachePool:ld()}}function If(s,o,h){return s=s!==null?s.childLanes&~h:0,o&&(s|=Gn),s}function Xs(s,o,h){var m=o.pendingProps,A=!1,T=(o.flags&128)!==0,I;if((I=T)||(I=s!==null&&s.memoizedState===null?!1:(Ii.current&2)!==0),I&&(A=!0,o.flags&=-129),I=(o.flags&32)!==0,o.flags&=-33,s===null){if(On){if(A?Al(o):Ro(),(s=_i)?(s=RA(s,Ma),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:Xr!==null?{id:Yr,overflow:qr}:null,retryLane:536870912,hydrationErrors:null},h=nv(s),h.return=o,o.child=h,Aa=o,_i=null)):s=null,s===null)throw Bn(o);return A2(s)?o.lanes=32:o.lanes=536870912,null}var Y=m.children;return m=m.fallback,A?(Ro(),A=o.mode,Y=au({mode:"hidden",children:Y},A),m=yo(m,A,h,null),Y.return=o,m.return=o,Y.sibling=m,o.child=Y,m=o.child,m.memoizedState=ur(h),m.childLanes=If(s,I,h),o.memoizedState=js,Tr(null,m)):(Al(o),Ml(o,Y))}var ue=s.memoizedState;if(ue!==null&&(Y=ue.dehydrated,Y!==null)){if(T)o.flags&256?(Al(o),o.flags&=-257,o=su(s,o,h)):o.memoizedState!==null?(Ro(),o.child=s.child,o.flags|=128,o=null):(Ro(),Y=m.fallback,A=o.mode,m=au({mode:"visible",children:m.children},A),Y=yo(Y,A,h,null),Y.flags|=2,m.return=o,Y.return=o,m.sibling=Y,o.child=m,ec(o,s.child,null,h),m=o.child,m.memoizedState=ur(h),m.childLanes=If(s,I,h),o.memoizedState=js,o=Tr(null,m));else if(Al(o),A2(Y)){if(I=Y.nextSibling&&Y.nextSibling.dataset,I)var Ce=I.dgst;I=Ce,m=Error(n(419)),m.stack="",m.digest=I,xf({value:m,source:null,stack:null}),o=su(s,o,h)}else if(Ci||gl(s,o,h,!1),I=(h&s.childLanes)!==0,Ci||I){if(I=ii,I!==null&&(m=sr(I,h),m!==0&&m!==ue.retryLane))throw ue.retryLane=m,dl(s,m),f(I,s,m),Td;S2(Y)||ln(),o=su(s,o,h)}else S2(Y)?(o.flags|=192,o.child=s.child,o=null):(s=ue.treeContext,_i=ao(Y.nextSibling),Aa=o,On=!0,So=null,Ma=!1,s!==null&&vf(o,s),o=Ml(o,m.children),o.flags|=4096);return o}return A?(Ro(),Y=m.fallback,A=o.mode,ue=s.child,Ce=ue.sibling,m=jr(ue,{mode:"hidden",children:m.children}),m.subtreeFlags=ue.subtreeFlags&65011712,Ce!==null?Y=jr(Ce,Y):(Y=yo(Y,A,h,null),Y.flags|=2),Y.return=o,m.return=o,m.sibling=Y,o.child=m,Tr(null,m),m=o.child,Y=s.child.memoizedState,Y===null?Y=ur(h):(A=Y.cachePool,A!==null?(ue=qt._currentValue,A=A.parent!==ue?{parent:ue,pool:ue}:A):A=ld(),Y={baseLanes:Y.baseLanes|h,cachePool:A}),m.memoizedState=Y,m.childLanes=If(s,I,h),o.memoizedState=js,Tr(s.child,m)):(Al(o),h=s.child,s=h.sibling,h=jr(h,{mode:"visible",children:m.children}),h.return=o,h.sibling=null,s!==null&&(I=o.deletions,I===null?(o.deletions=[s],o.flags|=16):I.push(s)),o.child=h,o.memoizedState=null,h)}function Ml(s,o){return o=au({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function au(s,o){return s=as(22,s,null,o),s.lanes=0,s}function su(s,o,h){return ec(o,s.child,null,h),s=Ml(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function ac(s,o,h){s.lanes|=o;var m=s.alternate;m!==null&&(m.lanes|=o),Eo(s.return,o,h)}function Pf(s,o,h,m,A,T){var I=s.memoizedState;I===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:h,tailMode:A,treeForkCount:T}:(I.isBackwards=o,I.rendering=null,I.renderingStartTime=0,I.last=m,I.tail=h,I.tailMode=A,I.treeForkCount=T)}function Ff(s,o,h){var m=o.pendingProps,A=m.revealOrder,T=m.tail;m=m.children;var I=Ii.current,Y=(I&2)!==0;if(Y?(I=I&1|2,o.flags|=128):I&=1,Te(Ii,I),Fi(s,o,m,h),m=On?qc:0,!Y&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&ac(s,h,o);else if(s.tag===19)ac(s,h,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(A){case"forwards":for(h=o.child,A=null;h!==null;)s=h.alternate,s!==null&&hd(s)===null&&(A=h),h=h.sibling;h=A,h===null?(A=o.child,o.child=null):(A=h.sibling,h.sibling=null),Pf(o,!1,A,h,T,m);break;case"backwards":case"unstable_legacy-backwards":for(h=null,A=o.child,o.child=null;A!==null;){if(s=A.alternate,s!==null&&hd(s)===null){o.child=A;break}s=A.sibling,A.sibling=h,h=A,A=s}Pf(o,!0,h,null,T,m);break;case"together":Pf(o,!1,null,null,void 0,m);break;default:o.memoizedState=null}return o.child}function Rr(s,o,h){if(s!==null&&(o.dependencies=s.dependencies),Ks|=o.lanes,(h&o.childLanes)===0)if(s!==null){if(gl(s,o,h,!1),(h&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(n(153));if(o.child!==null){for(s=o.child,h=jr(s,s.pendingProps),o.child=h,h.return=o;s.sibling!==null;)s=s.sibling,h=h.sibling=jr(s,s.pendingProps),h.return=o;h.sibling=null}return o.child}function El(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Kc(s)))}function zf(s,o,h){switch(o.tag){case 3:Fe(o,o.stateNode.containerInfo),Mo(o,qt,s.memoizedState.cache),Wl();break;case 27:case 5:ht(o);break;case 4:Fe(o,o.stateNode.containerInfo);break;case 10:Mo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,D0(o),null;break;case 13:var m=o.memoizedState;if(m!==null)return m.dehydrated!==null?(Al(o),o.flags|=128,null):(h&o.child.childLanes)!==0?Xs(s,o,h):(Al(o),s=Rr(s,o,h),s!==null?s.sibling:null);Al(o);break;case 19:var A=(s.flags&128)!==0;if(m=(h&o.childLanes)!==0,m||(gl(s,o,h,!1),m=(h&o.childLanes)!==0),A){if(m)return Ff(s,o,h);o.flags|=128}if(A=o.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),Te(Ii,Ii.current),m)break;return null;case 22:return o.lanes=0,ks(s,o,h,o.pendingProps);case 24:Mo(o,qt,s.memoizedState.cache)}return Rr(s,o,h)}function Cd(s,o,h){if(s!==null)if(s.memoizedProps!==o.pendingProps)Ci=!0;else{if(!El(s,h)&&(o.flags&128)===0)return Ci=!1,zf(s,o,h);Ci=(s.flags&131072)!==0}else Ci=!1,On&&(o.flags&1048576)!==0&&m0(o,qc,o.index);switch(o.lanes=0,o.tag){case 16:e:{var m=o.pendingProps;if(s=$l(o.elementType),o.type=s,typeof s=="function")ss(s)?(m=La(s,m),o.tag=1,o=Ia(null,o,s,m,h)):(o.tag=0,o=iu(null,o,s,m,h));else{if(s!=null){var A=s.$$typeof;if(A===U){o.tag=11,o=Of(null,o,s,m,h);break e}else if(A===z){o.tag=14,o=Nf(null,o,s,m,h);break e}}throw o=ae(s)||s,Error(n(306,o,""))}}return o;case 0:return iu(s,o,o.type,o.pendingProps,h);case 1:return m=o.type,A=La(m,o.pendingProps),Ia(s,o,m,A,h);case 3:e:{if(Fe(o,o.stateNode.containerInfo),s===null)throw Error(n(387));m=o.pendingProps;var T=o.memoizedState;A=T.element,C0(s,o),tc(o,m,null,h);var I=o.memoizedState;if(m=I.cache,Mo(o,qt,m),m!==T.cache&&od(o,[qt],h,!0),Mf(),m=I.element,T.isDehydrated)if(T={element:m,isDehydrated:!1,cache:I.cache},o.updateQueue.baseState=T,o.memoizedState=T,o.flags&256){o=Xn(s,o,m,h);break e}else if(m!==A){A=vs(Error(n(424)),o),xf(A),o=Xn(s,o,m,h);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(_i=ao(s.firstChild),Aa=o,On=!0,So=null,Ma=!0,h=lv(o,null,m,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Wl(),m===A){o=Rr(s,o,h);break e}Fi(s,o,m,h)}o=o.child}return o;case 26:return Cr(s,o),s===null?(h=NA(o.type,null,o.pendingProps,null))?o.memoizedState=h:On||(h=o.type,s=o.pendingProps,m=Gv(xe.current).createElement(h),m[hn]=o,m[G]=s,us(m,h,s),_e(m),o.stateNode=m):o.memoizedState=NA(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return ht(o),s===null&&On&&(m=o.stateNode=DA(o.type,o.pendingProps,xe.current),Aa=o,Ma=!0,A=_i,hu(o.type)?(M2=A,_i=ao(m.firstChild)):_i=A),Fi(s,o,o.pendingProps.children,h),Cr(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&On&&((A=m=_i)&&(m=Lw(m,o.type,o.pendingProps,Ma),m!==null?(o.stateNode=m,Aa=o,_i=ao(m.firstChild),Ma=!1,A=!0):A=!1),A||Bn(o)),ht(o),A=o.type,T=o.pendingProps,I=s!==null?s.memoizedProps:null,m=T.children,_2(A,T)?m=null:I!==null&&_2(A,I)&&(o.flags|=32),o.memoizedState!==null&&(A=O0(s,o,t2,null,null,h),hm._currentValue=A),Cr(s,o),Fi(s,o,m,h),o.child;case 6:return s===null&&On&&((s=h=_i)&&(h=Iw(h,o.pendingProps,Ma),h!==null?(o.stateNode=h,Aa=o,_i=null,s=!0):s=!1),s||Bn(o)),null;case 13:return Xs(s,o,h);case 4:return Fe(o,o.stateNode.containerInfo),m=o.pendingProps,s===null?o.child=ec(o,null,m,h):Fi(s,o,m,h),o.child;case 11:return Of(s,o,o.type,o.pendingProps,h);case 7:return Fi(s,o,o.pendingProps,h),o.child;case 8:return Fi(s,o,o.pendingProps.children,h),o.child;case 12:return Fi(s,o,o.pendingProps.children,h),o.child;case 10:return m=o.pendingProps,Mo(o,o.type,m.value),Fi(s,o,m.children,h),o.child;case 9:return A=o.type._context,m=o.pendingProps.children,Zl(o),A=Ea(A),m=m(A),o.flags|=1,Fi(s,o,m,h),o.child;case 14:return Nf(s,o,o.type,o.pendingProps,h);case 15:return Vs(s,o,o.type,o.pendingProps,h);case 19:return Ff(s,o,h);case 31:return Lf(s,o,h);case 22:return ks(s,o,h,o.pendingProps);case 24:return Zl(o),m=Ea(qt),s===null?(A=Kr(),A===null&&(A=ii,T=y0(),A.pooledCache=T,T.refCount++,T!==null&&(A.pooledCacheLanes|=h),A=T),o.memoizedState={parent:m,cache:A},T0(o),Mo(o,qt,A)):((s.lanes&h)!==0&&(C0(s,o),tc(o,null,null,h),Mf()),A=s.memoizedState,T=o.memoizedState,A.parent!==m?(A={parent:m,cache:m},o.memoizedState=A,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=A),Mo(o,qt,m)):(m=T.cache,Mo(o,qt,m),m!==A.cache&&od(o,[qt],h,!0))),Fi(s,o,o.pendingProps.children,h),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Ss(s){s.flags|=4}function Tl(s,o,h,m,A){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(A&335544128)===A)if(s.stateNode.complete)s.flags|=8192;else if(dt())s.flags|=8192;else throw $t=bf,yf}else s.flags&=-16777217}function Do(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!zA(o))if(dt())s.flags|=8192;else throw $t=bf,yf}function ru(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Fn():536870912,s.lanes|=o,Js|=o)}function Hf(s,o){if(!On)switch(s.tailMode){case"hidden":o=s.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function fi(s){var o=s.alternate!==null&&s.alternate.child===s.child,h=0,m=0;if(o)for(var A=s.child;A!==null;)h|=A.lanes|A.childLanes,m|=A.subtreeFlags&65011712,m|=A.flags&65011712,A.return=s,A=A.sibling;else for(A=s.child;A!==null;)h|=A.lanes|A.childLanes,m|=A.subtreeFlags,m|=A.flags,A.return=s,A=A.sibling;return s.subtreeFlags|=m,s.childLanes=h,o}function im(s,o,h){var m=o.pendingProps;switch(ml(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fi(o),null;case 1:return fi(o),null;case 3:return h=o.stateNode,m=null,s!==null&&(m=s.memoizedState.cache),o.memoizedState.cache!==m&&(o.flags|=2048),or(qt),et(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Jl(o)?Ss(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,g0())),fi(o),null;case 26:var A=o.type,T=o.memoizedState;return s===null?(Ss(o),T!==null?(fi(o),Do(o,T)):(fi(o),Tl(o,A,null,m,h))):T?T!==s.memoizedState?(Ss(o),fi(o),Do(o,T)):(fi(o),o.flags&=-16777217):(s=s.memoizedProps,s!==m&&Ss(o),fi(o),Tl(o,A,s,m,h)),null;case 27:if(yt(o),h=xe.current,A=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==m&&Ss(o);else{if(!m){if(o.stateNode===null)throw Error(n(166));return fi(o),null}s=Me.current,Jl(o)?rd(o):(s=DA(A,m,h),o.stateNode=s,Ss(o))}return fi(o),null;case 5:if(yt(o),A=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==m&&Ss(o);else{if(!m){if(o.stateNode===null)throw Error(n(166));return fi(o),null}if(T=Me.current,Jl(o))rd(o);else{var I=Gv(xe.current);switch(T){case 1:T=I.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:T=I.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":T=I.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":T=I.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":T=I.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof m.is=="string"?I.createElement("select",{is:m.is}):I.createElement("select"),m.multiple?T.multiple=!0:m.size&&(T.size=m.size);break;default:T=typeof m.is=="string"?I.createElement(A,{is:m.is}):I.createElement(A)}}T[hn]=o,T[G]=m;e:for(I=o.child;I!==null;){if(I.tag===5||I.tag===6)T.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===o)break e;for(;I.sibling===null;){if(I.return===null||I.return===o)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}o.stateNode=T;e:switch(us(T,A,m),A){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Ss(o)}}return fi(o),Tl(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,h),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==m&&Ss(o);else{if(typeof m!="string"&&o.stateNode===null)throw Error(n(166));if(s=xe.current,Jl(o)){if(s=o.stateNode,h=o.memoizedProps,m=null,A=Aa,A!==null)switch(A.tag){case 27:case 5:m=A.memoizedProps}s[hn]=o,s=!!(s.nodeValue===h||m!==null&&m.suppressHydrationWarning===!0||yA(s.nodeValue,h)),s||Bn(o,!0)}else s=Gv(s).createTextNode(m),s[hn]=o,o.stateNode=s}return fi(o),null;case 31:if(h=o.memoizedState,s===null||s.memoizedState!==null){if(m=Jl(o),h!==null){if(s===null){if(!m)throw Error(n(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[hn]=o}else Wl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;fi(o),s=!1}else h=g0(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=h),s=!0;if(!s)return o.flags&256?(zs(o),o):(zs(o),null);if((o.flags&128)!==0)throw Error(n(558))}return fi(o),null;case 13:if(m=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(A=Jl(o),m!==null&&m.dehydrated!==null){if(s===null){if(!A)throw Error(n(318));if(A=o.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));A[hn]=o}else Wl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;fi(o),A=!1}else A=g0(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=A),A=!0;if(!A)return o.flags&256?(zs(o),o):(zs(o),null)}return zs(o),(o.flags&128)!==0?(o.lanes=h,o):(h=m!==null,s=s!==null&&s.memoizedState!==null,h&&(m=o.child,A=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(A=m.alternate.memoizedState.cachePool.pool),T=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(T=m.memoizedState.cachePool.pool),T!==A&&(m.flags|=2048)),h!==s&&h&&(o.child.flags|=8192),ru(o,o.updateQueue),fi(o),null);case 4:return et(),s===null&&p2(o.stateNode.containerInfo),fi(o),null;case 10:return or(o.type),fi(o),null;case 19:if(de(Ii),m=o.memoizedState,m===null)return fi(o),null;if(A=(o.flags&128)!==0,T=m.rendering,T===null)if(A)Hf(m,!1);else{if(ai!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(T=hd(s),T!==null){for(o.flags|=128,Hf(m,!1),s=T.updateQueue,o.updateQueue=s,ru(o,s),o.subtreeFlags=0,s=h,h=o.child;h!==null;)Xa(h,s),h=h.sibling;return Te(Ii,Ii.current&1|2),On&&bo(o,m.treeForkCount),o.child}s=s.sibling}m.tail!==null&&X()>Ws&&(o.flags|=128,A=!0,Hf(m,!1),o.lanes=4194304)}else{if(!A)if(s=hd(T),s!==null){if(o.flags|=128,A=!0,s=s.updateQueue,o.updateQueue=s,ru(o,s),Hf(m,!0),m.tail===null&&m.tailMode==="hidden"&&!T.alternate&&!On)return fi(o),null}else 2*X()-m.renderingStartTime>Ws&&h!==536870912&&(o.flags|=128,A=!0,Hf(m,!1),o.lanes=4194304);m.isBackwards?(T.sibling=o.child,o.child=T):(s=m.last,s!==null?s.sibling=T:o.child=T,m.last=T)}return m.tail!==null?(s=m.tail,m.rendering=s,m.tail=s.sibling,m.renderingStartTime=X(),s.sibling=null,h=Ii.current,Te(Ii,A?h&1|2:h&1),On&&bo(o,m.treeForkCount),s):(fi(o),null);case 22:case 23:return zs(o),qa(),m=o.memoizedState!==null,s!==null?s.memoizedState!==null!==m&&(o.flags|=8192):m&&(o.flags|=8192),m?(h&536870912)!==0&&(o.flags&128)===0&&(fi(o),o.subtreeFlags&6&&(o.flags|=8192)):fi(o),h=o.updateQueue,h!==null&&ru(o,h.retryQueue),h=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),m=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(m=o.memoizedState.cachePool.pool),m!==h&&(o.flags|=2048),s!==null&&de(vl),null;case 24:return h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),or(qt),fi(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function Rd(s,o){switch(ml(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return or(qt),et(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return yt(o),null;case 31:if(o.memoizedState!==null){if(zs(o),o.alternate===null)throw Error(n(340));Wl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(zs(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Wl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return de(Ii),null;case 4:return et(),null;case 10:return or(o.type),null;case 22:case 23:return zs(o),qa(),s!==null&&de(vl),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return or(qt),null;case 25:return null;default:return null}}function sc(s,o){switch(ml(o),o.tag){case 3:or(qt),et();break;case 26:case 27:case 5:yt(o);break;case 4:et();break;case 31:o.memoizedState!==null&&zs(o);break;case 13:zs(o);break;case 19:de(Ii);break;case 10:or(o.type);break;case 22:case 23:zs(o),qa(),s!==null&&de(vl);break;case 24:or(qt)}}function eo(s,o){try{var h=o.updateQueue,m=h!==null?h.lastEffect:null;if(m!==null){var A=m.next;h=A;do{if((h.tag&s)===s){m=void 0;var T=h.create,I=h.inst;m=T(),I.destroy=m}h=h.next}while(h!==A)}}catch(Y){vi(o,o.return,Y)}}function fr(s,o,h){try{var m=o.updateQueue,A=m!==null?m.lastEffect:null;if(A!==null){var T=A.next;m=T;do{if((m.tag&s)===s){var I=m.inst,Y=I.destroy;if(Y!==void 0){I.destroy=void 0,A=o;var ue=h,Ce=Y;try{Ce()}catch(Ve){vi(A,ue,Ve)}}}m=m.next}while(m!==T)}}catch(Ve){vi(o,o.return,Ve)}}function Cl(s){var o=s.updateQueue;if(o!==null){var h=s.stateNode;try{Oa(o,h)}catch(m){vi(s,s.return,m)}}}function am(s,o,h){h.props=La(s.type,s.memoizedProps),h.state=s.memoizedState;try{h.componentWillUnmount()}catch(m){vi(s,o,m)}}function to(s,o){try{var h=s.ref;if(h!==null){switch(s.tag){case 26:case 27:case 5:var m=s.stateNode;break;case 30:m=s.stateNode;break;default:m=s.stateNode}typeof h=="function"?s.refCleanup=h(m):h.current=m}}catch(A){vi(s,o,A)}}function Ys(s,o){var h=s.ref,m=s.refCleanup;if(h!==null)if(typeof m=="function")try{m()}catch(A){vi(s,o,A)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(A){vi(s,o,A)}else h.current=null}function qs(s){var o=s.type,h=s.memoizedProps,m=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":h.autoFocus&&m.focus();break e;case"img":h.src?m.src=h.src:h.srcSet&&(m.srcset=h.srcSet)}}catch(A){vi(s,s.return,A)}}function hr(s,o,h){try{var m=s.stateNode;ww(m,s.type,h,o),m[G]=o}catch(A){vi(s,s.return,A)}}function ia(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&hu(s.type)||s.tag===4}function no(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||ia(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&hu(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function mn(s,o,h){var m=s.tag;if(m===5||m===6)s=s.stateNode,o?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(s,o):(o=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,o.appendChild(s),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=Gr));else if(m!==4&&(m===27&&hu(s.type)&&(h=s.stateNode,o=null),s=s.child,s!==null))for(mn(s,o,h),s=s.sibling;s!==null;)mn(s,o,h),s=s.sibling}function ei(s,o,h){var m=s.tag;if(m===5||m===6)s=s.stateNode,o?h.insertBefore(s,o):h.appendChild(s);else if(m!==4&&(m===27&&hu(s.type)&&(h=s.stateNode),s=s.child,s!==null))for(ei(s,o,h),s=s.sibling;s!==null;)ei(s,o,h),s=s.sibling}function qi(s){var o=s.stateNode,h=s.memoizedProps;try{for(var m=s.type,A=o.attributes;A.length;)o.removeAttributeNode(A[0]);us(o,m,h),o[hn]=s,o[G]=h}catch(T){vi(s,s.return,T)}}var dr=!1,Ri=!1,Uo=!1,Gf=typeof WeakSet=="function"?WeakSet:Set,zi=null;function ou(s,o){if(s=s.containerInfo,v2=Kv,s=Wh(s),Hc(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&m.rangeCount!==0){h=m.anchorNode;var A=m.anchorOffset,T=m.focusNode;m=m.focusOffset;try{h.nodeType,T.nodeType}catch{h=null;break e}var I=0,Y=-1,ue=-1,Ce=0,Ve=0,We=s,Be=null;t:for(;;){for(var Ie;We!==h||A!==0&&We.nodeType!==3||(Y=I+A),We!==T||m!==0&&We.nodeType!==3||(ue=I+m),We.nodeType===3&&(I+=We.nodeValue.length),(Ie=We.firstChild)!==null;)Be=We,We=Ie;for(;;){if(We===s)break t;if(Be===h&&++Ce===A&&(Y=I),Be===T&&++Ve===m&&(ue=I),(Ie=We.nextSibling)!==null)break;We=Be,Be=We.parentNode}We=Ie}h=Y===-1||ue===-1?null:{start:Y,end:ue}}else h=null}h=h||{start:0,end:0}}else h=null;for(x2={focusedElem:s,selectionRange:h},Kv=!1,zi=o;zi!==null;)if(o=zi,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,zi=s;else for(;zi!==null;){switch(o=zi,T=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(h=0;h<s.length;h++)A=s[h],A.ref.impl=A.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&T!==null){s=void 0,h=o,A=T.memoizedProps,T=T.memoizedState,m=h.stateNode;try{var Ft=La(h.type,A);s=m.getSnapshotBeforeUpdate(Ft,T),m.__reactInternalSnapshotBeforeUpdate=s}catch(tn){vi(h,h.return,tn)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,h=s.nodeType,h===9)b2(s);else if(h===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":b2(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=o.sibling,s!==null){s.return=o.return,zi=s;break}zi=o.return}}function Nv(s,o,h){var m=h.flags;switch(h.tag){case 0:case 11:case 15:Oo(s,h),m&4&&eo(5,h);break;case 1:if(Oo(s,h),m&4)if(s=h.stateNode,o===null)try{s.componentDidMount()}catch(I){vi(h,h.return,I)}else{var A=La(h.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(A,o,s.__reactInternalSnapshotBeforeUpdate)}catch(I){vi(h,h.return,I)}}m&64&&Cl(h),m&512&&to(h,h.return);break;case 3:if(Oo(s,h),m&64&&(s=h.updateQueue,s!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{Oa(s,o)}catch(I){vi(h,h.return,I)}}break;case 27:o===null&&m&4&&qi(h);case 26:case 5:Oo(s,h),o===null&&m&4&&qs(h),m&512&&to(h,h.return);break;case 12:Oo(s,h);break;case 31:Oo(s,h),m&4&&Bd(s,h);break;case 13:Oo(s,h),m&4&&sm(s,h),m&64&&(s=h.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(h=vw.bind(null,h),Pw(s,h))));break;case 22:if(m=h.memoizedState!==null||dr,!m){o=o!==null&&o.memoizedState!==null||Ri,A=dr;var T=Ri;dr=m,(Ri=o)&&!T?ni(s,h,(h.subtreeFlags&8772)!==0):Oo(s,h),dr=A,Ri=T}break;case 30:break;default:Oo(s,h)}}function wd(s){var o=s.alternate;o!==null&&(s.alternate=null,wd(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&nt(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Yn=null,aa=!1;function Ja(s,o,h){for(h=h.child;h!==null;)Rl(s,o,h),h=h.sibling}function Rl(s,o,h){if(qe&&typeof qe.onCommitFiberUnmount=="function")try{qe.onCommitFiberUnmount(Ye,h)}catch{}switch(h.tag){case 26:Ri||Ys(h,o),Ja(s,o,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Ri||Ys(h,o);var m=Yn,A=aa;hu(h.type)&&(Yn=h.stateNode,aa=!1),Ja(s,o,h),cm(h.stateNode),Yn=m,aa=A;break;case 5:Ri||Ys(h,o);case 6:if(m=Yn,A=aa,Yn=null,Ja(s,o,h),Yn=m,aa=A,Yn!==null)if(aa)try{(Yn.nodeType===9?Yn.body:Yn.nodeName==="HTML"?Yn.ownerDocument.body:Yn).removeChild(h.stateNode)}catch(T){vi(h,o,T)}else try{Yn.removeChild(h.stateNode)}catch(T){vi(h,o,T)}break;case 18:Yn!==null&&(aa?(s=Yn,TA(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,h.stateNode),Gd(s)):TA(Yn,h.stateNode));break;case 4:m=Yn,A=aa,Yn=h.stateNode.containerInfo,aa=!0,Ja(s,o,h),Yn=m,aa=A;break;case 0:case 11:case 14:case 15:fr(2,h,o),Ri||fr(4,h,o),Ja(s,o,h);break;case 1:Ri||(Ys(h,o),m=h.stateNode,typeof m.componentWillUnmount=="function"&&am(h,o,m)),Ja(s,o,h);break;case 21:Ja(s,o,h);break;case 22:Ri=(m=Ri)||h.memoizedState!==null,Ja(s,o,h),Ri=m;break;default:Ja(s,o,h)}}function Bd(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Gd(s)}catch(h){vi(o,o.return,h)}}}function sm(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Gd(s)}catch(h){vi(o,o.return,h)}}function Lv(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new Gf),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new Gf),o;default:throw Error(n(435,s.tag))}}function Ki(s,o){var h=Lv(s);o.forEach(function(m){if(!h.has(m)){h.add(m);var A=xw.bind(null,s,m);m.then(A,A)}})}function Wa(s,o){var h=o.deletions;if(h!==null)for(var m=0;m<h.length;m++){var A=h[m],T=s,I=o,Y=I;e:for(;Y!==null;){switch(Y.tag){case 27:if(hu(Y.type)){Yn=Y.stateNode,aa=!1;break e}break;case 5:Yn=Y.stateNode,aa=!1;break e;case 3:case 4:Yn=Y.stateNode.containerInfo,aa=!0;break e}Y=Y.return}if(Yn===null)throw Error(n(160));Rl(T,I,A),Yn=null,aa=!1,T=A.alternate,T!==null&&(T.return=null),A.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)wl(o,s),o=o.sibling}var As=null;function wl(s,o){var h=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Wa(o,s),Hi(s),m&4&&(fr(3,s,s.return),eo(3,s),fr(5,s,s.return));break;case 1:Wa(o,s),Hi(s),m&512&&(Ri||h===null||Ys(h,h.return)),m&64&&dr&&(s=s.updateQueue,s!==null&&(m=s.callbacks,m!==null&&(h=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=h===null?m:h.concat(m))));break;case 26:var A=As;if(Wa(o,s),Hi(s),m&512&&(Ri||h===null||Ys(h,h.return)),m&4){var T=h!==null?h.memoizedState:null;if(m=s.memoizedState,h===null)if(m===null)if(s.stateNode===null){e:{m=s.type,h=s.memoizedProps,A=A.ownerDocument||A;t:switch(m){case"title":T=A.getElementsByTagName("title")[0],(!T||T[ot]||T[hn]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=A.createElement(m),A.head.insertBefore(T,A.querySelector("head > title"))),us(T,m,h),T[hn]=s,_e(T),m=T;break e;case"link":var I=PA("link","href",A).get(m+(h.href||""));if(I){for(var Y=0;Y<I.length;Y++)if(T=I[Y],T.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&T.getAttribute("rel")===(h.rel==null?null:h.rel)&&T.getAttribute("title")===(h.title==null?null:h.title)&&T.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){I.splice(Y,1);break t}}T=A.createElement(m),us(T,m,h),A.head.appendChild(T);break;case"meta":if(I=PA("meta","content",A).get(m+(h.content||""))){for(Y=0;Y<I.length;Y++)if(T=I[Y],T.getAttribute("content")===(h.content==null?null:""+h.content)&&T.getAttribute("name")===(h.name==null?null:h.name)&&T.getAttribute("property")===(h.property==null?null:h.property)&&T.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&T.getAttribute("charset")===(h.charSet==null?null:h.charSet)){I.splice(Y,1);break t}}T=A.createElement(m),us(T,m,h),A.head.appendChild(T);break;default:throw Error(n(468,m))}T[hn]=s,_e(T),m=T}s.stateNode=m}else FA(A,s.type,s.stateNode);else s.stateNode=IA(A,m,s.memoizedProps);else T!==m?(T===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):T.count--,m===null?FA(A,s.type,s.stateNode):IA(A,m,s.memoizedProps)):m===null&&s.stateNode!==null&&hr(s,s.memoizedProps,h.memoizedProps)}break;case 27:Wa(o,s),Hi(s),m&512&&(Ri||h===null||Ys(h,h.return)),h!==null&&m&4&&hr(s,s.memoizedProps,h.memoizedProps);break;case 5:if(Wa(o,s),Hi(s),m&512&&(Ri||h===null||Ys(h,h.return)),s.flags&32){A=s.stateNode;try{yr(A,"")}catch(Ft){vi(s,s.return,Ft)}}m&4&&s.stateNode!=null&&(A=s.memoizedProps,hr(s,A,h!==null?h.memoizedProps:A)),m&1024&&(Uo=!0);break;case 6:if(Wa(o,s),Hi(s),m&4){if(s.stateNode===null)throw Error(n(162));m=s.memoizedProps,h=s.stateNode;try{h.nodeValue=m}catch(Ft){vi(s,s.return,Ft)}}break;case 3:if(jv=null,A=As,As=Vv(o.containerInfo),Wa(o,s),As=A,Hi(s),m&4&&h!==null&&h.memoizedState.isDehydrated)try{Gd(o.containerInfo)}catch(Ft){vi(s,s.return,Ft)}Uo&&(Uo=!1,Iv(s));break;case 4:m=As,As=Vv(s.stateNode.containerInfo),Wa(o,s),Hi(s),As=m;break;case 12:Wa(o,s),Hi(s);break;case 31:Wa(o,s),Hi(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Ki(s,m)));break;case 13:Wa(o,s),Hi(s),s.child.flags&8192&&s.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Io=X()),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Ki(s,m)));break;case 22:A=s.memoizedState!==null;var ue=h!==null&&h.memoizedState!==null,Ce=dr,Ve=Ri;if(dr=Ce||A,Ri=Ve||ue,Wa(o,s),Ri=Ve,dr=Ce,Hi(s),m&8192)e:for(o=s.stateNode,o._visibility=A?o._visibility&-2:o._visibility|1,A&&(h===null||ue||dr||Ri||rc(s)),h=null,o=s;;){if(o.tag===5||o.tag===26){if(h===null){ue=h=o;try{if(T=ue.stateNode,A)I=T.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{Y=ue.stateNode;var We=ue.memoizedProps.style,Be=We!=null&&We.hasOwnProperty("display")?We.display:null;Y.style.display=Be==null||typeof Be=="boolean"?"":(""+Be).trim()}}catch(Ft){vi(ue,ue.return,Ft)}}}else if(o.tag===6){if(h===null){ue=o;try{ue.stateNode.nodeValue=A?"":ue.memoizedProps}catch(Ft){vi(ue,ue.return,Ft)}}}else if(o.tag===18){if(h===null){ue=o;try{var Ie=ue.stateNode;A?CA(Ie,!0):CA(ue.stateNode,!1)}catch(Ft){vi(ue,ue.return,Ft)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;h===o&&(h=null),o=o.return}h===o&&(h=null),o.sibling.return=o.return,o=o.sibling}m&4&&(m=s.updateQueue,m!==null&&(h=m.retryQueue,h!==null&&(m.retryQueue=null,Ki(s,h))));break;case 19:Wa(o,s),Hi(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Ki(s,m)));break;case 30:break;case 21:break;default:Wa(o,s),Hi(s)}}function Hi(s){var o=s.flags;if(o&2){try{for(var h,m=s.return;m!==null;){if(ia(m)){h=m;break}m=m.return}if(h==null)throw Error(n(160));switch(h.tag){case 27:var A=h.stateNode,T=no(s);ei(s,T,A);break;case 5:var I=h.stateNode;h.flags&32&&(yr(I,""),h.flags&=-33);var Y=no(s);ei(s,Y,I);break;case 3:case 4:var ue=h.stateNode.containerInfo,Ce=no(s);mn(s,Ce,ue);break;default:throw Error(n(161))}}catch(Ve){vi(s,s.return,Ve)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Iv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;Iv(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Oo(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Nv(s,o.alternate,o),o=o.sibling}function rc(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:fr(4,o,o.return),rc(o);break;case 1:Ys(o,o.return);var h=o.stateNode;typeof h.componentWillUnmount=="function"&&am(o,o.return,h),rc(o);break;case 27:cm(o.stateNode);case 26:case 5:Ys(o,o.return),rc(o);break;case 22:o.memoizedState===null&&rc(o);break;case 30:rc(o);break;default:rc(o)}s=s.sibling}}function ni(s,o,h){for(h=h&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var m=o.alternate,A=s,T=o,I=T.flags;switch(T.tag){case 0:case 11:case 15:ni(A,T,h),eo(4,T);break;case 1:if(ni(A,T,h),m=T,A=m.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Ce){vi(m,m.return,Ce)}if(m=T,A=m.updateQueue,A!==null){var Y=m.stateNode;try{var ue=A.shared.hiddenCallbacks;if(ue!==null)for(A.shared.hiddenCallbacks=null,A=0;A<ue.length;A++)Wr(ue[A],Y)}catch(Ce){vi(m,m.return,Ce)}}h&&I&64&&Cl(T),to(T,T.return);break;case 27:qi(T);case 26:case 5:ni(A,T,h),h&&m===null&&I&4&&qs(T),to(T,T.return);break;case 12:ni(A,T,h);break;case 31:ni(A,T,h),h&&I&4&&Bd(A,T);break;case 13:ni(A,T,h),h&&I&4&&sm(A,T);break;case 22:T.memoizedState===null&&ni(A,T,h),to(T,T.return);break;case 30:break;default:ni(A,T,h)}o=o.sibling}}function Dd(s,o){var h=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==h&&(s!=null&&s.refCount++,h!=null&&Ua(h))}function No(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Ua(s))}function ma(s,o,h,m){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Di(s,o,h,m),o=o.sibling}function Di(s,o,h,m){var A=o.flags;switch(o.tag){case 0:case 11:case 15:ma(s,o,h,m),A&2048&&eo(9,o);break;case 1:ma(s,o,h,m);break;case 3:ma(s,o,h,m),A&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Ua(s)));break;case 12:if(A&2048){ma(s,o,h,m),s=o.stateNode;try{var T=o.memoizedProps,I=T.id,Y=T.onPostCommit;typeof Y=="function"&&Y(I,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ue){vi(o,o.return,ue)}}else ma(s,o,h,m);break;case 31:ma(s,o,h,m);break;case 13:ma(s,o,h,m);break;case 23:break;case 22:T=o.stateNode,I=o.alternate,o.memoizedState!==null?T._visibility&2?ma(s,o,h,m):lu(s,o):T._visibility&2?ma(s,o,h,m):(T._visibility|=2,Bl(s,o,h,m,(o.subtreeFlags&10256)!==0||!1)),A&2048&&Dd(I,o);break;case 24:ma(s,o,h,m),A&2048&&No(o.alternate,o);break;default:ma(s,o,h,m)}}function Bl(s,o,h,m,A){for(A=A&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var T=s,I=o,Y=h,ue=m,Ce=I.flags;switch(I.tag){case 0:case 11:case 15:Bl(T,I,Y,ue,A),eo(8,I);break;case 23:break;case 22:var Ve=I.stateNode;I.memoizedState!==null?Ve._visibility&2?Bl(T,I,Y,ue,A):lu(T,I):(Ve._visibility|=2,Bl(T,I,Y,ue,A)),A&&Ce&2048&&Dd(I.alternate,I);break;case 24:Bl(T,I,Y,ue,A),A&&Ce&2048&&No(I.alternate,I);break;default:Bl(T,I,Y,ue,A)}o=o.sibling}}function lu(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var h=s,m=o,A=m.flags;switch(m.tag){case 22:lu(h,m),A&2048&&Dd(m.alternate,m);break;case 24:lu(h,m),A&2048&&No(m.alternate,m);break;default:lu(h,m)}o=o.sibling}}var Gi=8192;function oc(s,o,h){if(s.subtreeFlags&Gi)for(s=s.child;s!==null;)Ji(s,o,h),s=s.sibling}function Ji(s,o,h){switch(s.tag){case 26:oc(s,o,h),s.flags&Gi&&s.memoizedState!==null&&Jw(h,As,s.memoizedState,s.memoizedProps);break;case 5:oc(s,o,h);break;case 3:case 4:var m=As;As=Vv(s.stateNode.containerInfo),oc(s,o,h),As=m;break;case 22:s.memoizedState===null&&(m=s.alternate,m!==null&&m.memoizedState!==null?(m=Gi,Gi=16777216,oc(s,o,h),Gi=m):oc(s,o,h));break;default:oc(s,o,h)}}function Ms(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function ls(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var m=o[h];zi=m,Vf(m,s)}Ms(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)lc(s),s=s.sibling}function lc(s){switch(s.tag){case 0:case 11:case 15:ls(s),s.flags&2048&&fr(9,s,s.return);break;case 3:ls(s);break;case 12:ls(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Ud(s)):ls(s);break;default:ls(s)}}function Ud(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var m=o[h];zi=m,Vf(m,s)}Ms(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:fr(8,o,o.return),Ud(o);break;case 22:h=o.stateNode,h._visibility&2&&(h._visibility&=-3,Ud(o));break;default:Ud(o)}s=s.sibling}}function Vf(s,o){for(;zi!==null;){var h=zi;switch(h.tag){case 0:case 11:case 15:fr(8,h,o);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var m=h.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Ua(h.memoizedState.cache)}if(m=h.child,m!==null)m.return=h,zi=m;else e:for(h=s;zi!==null;){m=zi;var A=m.sibling,T=m.return;if(wd(m),m===h){zi=null;break e}if(A!==null){A.return=T,zi=A;break e}zi=T}}}var Od={getCacheForType:function(s){var o=Ea(qt),h=o.data.get(s);return h===void 0&&(h=s(),o.data.set(s,h)),h},cacheSignal:function(){return Ea(qt).controller.signal}},Nd=typeof WeakMap=="function"?WeakMap:Map,Hn=0,ii=null,gn=null,Dn=0,Kt=0,En=null,fn=!1,yn=!1,mi=!1,Wi=0,ai=0,Ks=0,Lo=0,wr=0,Gn=0,Js=0,Br=null,Za=null,Es=!1,Io=0,cu=0,Ws=1/0,uu=null,io=null,Ui=0,Dr=null,Zs=null,pr=0,Po=0,cc=null,Ld=null,uc=0,fc=null;function cs(){return(Hn&2)!==0&&Dn!==0?Dn&-Dn:H.T!==null?u2():ba()}function c(){if(Gn===0)if((Dn&536870912)===0||On){var s=ft;ft<<=1,(ft&3932160)===0&&(ft=262144),Gn=s}else Gn=536870912;return s=pa.current,s!==null&&(s.flags|=32),Gn}function f(s,o,h){(s===ii&&(Kt===2||Kt===9)||s.cancelPendingCommit!==null)&&(Se(s,0),O(s,Dn,Gn,!1)),fa(s,h),((Hn&2)===0||s!==ii)&&(s===ii&&((Hn&2)===0&&(Lo|=h),ai===4&&O(s,Dn,Gn,!1)),Dl(s))}function v(s,o,h){if((Hn&6)!==0)throw Error(n(327));var m=!h&&(o&127)===0&&(o&s.expiredLanes)===0||Bt(s,o),A=m?hc(s,o):Ts(s,o,!0),T=m;do{if(A===0){yn&&!m&&O(s,o,0,!1);break}else{if(h=s.current.alternate,T&&!R(h)){A=Ts(s,o,!1),T=!1;continue}if(A===2){if(T=o,s.errorRecoveryDisabledLanes&T)var I=0;else I=s.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){o=I;e:{var Y=s;A=Br;var ue=Y.current.memoizedState.isDehydrated;if(ue&&(Se(Y,I).flags|=256),I=Ts(Y,I,!1),I!==2){if(mi&&!ue){Y.errorRecoveryDisabledLanes|=T,Lo|=T,A=4;break e}T=Za,Za=A,T!==null&&(Za===null?Za=T:Za.push.apply(Za,T))}A=I}if(T=!1,A!==2)continue}}if(A===1){Se(s,0),O(s,o,0,!0);break}e:{switch(m=s,T=A,T){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:O(m,o,Gn,!fn);break e;case 2:Za=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(A=Io+300-X(),10<A)){if(O(m,o,Gn,!fn),Je(m,0,!0)!==0)break e;pr=o,m.timeoutHandle=MA(M.bind(null,m,h,Za,uu,Es,o,Gn,Lo,Js,fn,T,"Throttled",-0,0),A);break e}M(m,h,Za,uu,Es,o,Gn,Lo,Js,fn,T,null,-0,0)}}break}while(!0);Dl(s)}function M(s,o,h,m,A,T,I,Y,ue,Ce,Ve,We,Be,Ie){if(s.timeoutHandle=-1,We=o.subtreeFlags,We&8192||(We&16785408)===16785408){We={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gr},Ji(o,T,We);var Ft=(T&62914560)===T?Io-X():(T&4194048)===T?cu-X():0;if(Ft=Ww(We,Ft),Ft!==null){pr=T,s.cancelPendingCommit=Ft(an.bind(null,s,o,T,h,m,A,I,Y,ue,Ve,We,null,Be,Ie)),O(s,T,I,!Ce);return}}an(s,o,T,h,m,A,I,Y,ue)}function R(s){for(var o=s;;){var h=o.tag;if((h===0||h===11||h===15)&&o.flags&16384&&(h=o.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var m=0;m<h.length;m++){var A=h[m],T=A.getSnapshot;A=A.value;try{if(!Ti(T(),A))return!1}catch{return!1}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function O(s,o,h,m){o&=~wr,o&=~Lo,s.suspendedLanes|=o,s.pingedLanes&=~o,m&&(s.warmLanes|=o),m=s.expirationTimes;for(var A=o;0<A;){var T=31-Et(A),I=1<<T;m[T]=-1,A&=~I}h!==0&&zl(s,h,o)}function J(){return(Hn&6)===0?(rm(0),!1):!0}function ce(){if(gn!==null){if(Kt===0)var s=gn.return;else s=gn,Ya=Ao=null,I0(s),_l=null,yl=0,s=gn;for(;s!==null;)sc(s.alternate,s),s=s.return;gn=null}}function Se(s,o){var h=s.timeoutHandle;h!==-1&&(s.timeoutHandle=-1,Uw(h)),h=s.cancelPendingCommit,h!==null&&(s.cancelPendingCommit=null,h()),pr=0,ce(),ii=s,gn=h=jr(s.current,null),Dn=o,Kt=0,En=null,fn=!1,yn=Bt(s,o),mi=!1,Js=Gn=wr=Lo=Ks=ai=0,Za=Br=null,Es=!1,(o&8)!==0&&(o|=o&32);var m=s.entangledLanes;if(m!==0)for(s=s.entanglements,m&=o;0<m;){var A=31-Et(m),T=1<<A;o|=s[A],m&=~T}return Wi=o,hl(),h}function Xe(s,o){nn=null,H.H=Bf,o===xl||o===Er?(o=cd(),Kt=3):o===yf?(o=cd(),Kt=4):Kt=o===Td?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,En=o,gn===null&&(ai=1,Ed(s,vs(o,s.current)))}function dt(){var s=pa.current;return s===null?!0:(Dn&4194048)===Dn?lr===null:(Dn&62914560)===Dn||(Dn&536870912)!==0?s===lr:!1}function St(){var s=H.H;return H.H=Bf,s===null?Bf:s}function wt(){var s=H.A;return H.A=Od,s}function ln(){ai=4,fn||(Dn&4194048)!==Dn&&pa.current!==null||(yn=!0),(Ks&134217727)===0&&(Lo&134217727)===0||ii===null||O(ii,Dn,Gn,!1)}function Ts(s,o,h){var m=Hn;Hn|=2;var A=St(),T=wt();(ii!==s||Dn!==o)&&(uu=null,Se(s,o)),o=!1;var I=ai;e:do try{if(Kt!==0&&gn!==null){var Y=gn,ue=En;switch(Kt){case 8:ce(),I=6;break e;case 3:case 2:case 9:case 6:pa.current===null&&(o=!0);var Ce=Kt;if(Kt=0,En=null,lt(s,Y,ue,Ce),h&&yn){I=0;break e}break;default:Ce=Kt,Kt=0,En=null,lt(s,Y,ue,Ce)}}kf(),I=ai;break}catch(Ve){Xe(s,Ve)}while(!0);return o&&s.shellSuspendCounter++,Ya=Ao=null,Hn=m,H.H=A,H.A=T,gn===null&&(ii=null,Dn=0,hl()),I}function kf(){for(;gn!==null;)ye(gn)}function hc(s,o){var h=Hn;Hn|=2;var m=St(),A=wt();ii!==s||Dn!==o?(uu=null,Ws=X()+500,Se(s,o)):yn=Bt(s,o);e:do try{if(Kt!==0&&gn!==null){o=gn;var T=En;t:switch(Kt){case 1:Kt=0,En=null,lt(s,o,T,1);break;case 2:case 9:if(ov(T)){Kt=0,En=null,Oe(o);break}o=function(){Kt!==2&&Kt!==9||ii!==s||(Kt=7),Dl(s)},T.then(o,o);break e;case 3:Kt=7;break e;case 4:Kt=5;break e;case 7:ov(T)?(Kt=0,En=null,Oe(o)):(Kt=0,En=null,lt(s,o,T,7));break;case 5:var I=null;switch(gn.tag){case 26:I=gn.memoizedState;case 5:case 27:var Y=gn;if(I?zA(I):Y.stateNode.complete){Kt=0,En=null;var ue=Y.sibling;if(ue!==null)gn=ue;else{var Ce=Y.return;Ce!==null?(gn=Ce,jt(Ce)):gn=null}break t}}Kt=0,En=null,lt(s,o,T,5);break;case 6:Kt=0,En=null,lt(s,o,T,6);break;case 8:ce(),ai=6;break e;default:throw Error(n(462))}}Re();break}catch(Ve){Xe(s,Ve)}while(!0);return Ya=Ao=null,H.H=m,H.A=A,Hn=h,gn!==null?0:(ii=null,Dn=0,hl(),ai)}function Re(){for(;gn!==null&&!Ct();)ye(gn)}function ye(s){var o=Cd(s.alternate,s,Wi);s.memoizedProps=s.pendingProps,o===null?jt(s):gn=o}function Oe(s){var o=s,h=o.alternate;switch(o.tag){case 15:case 0:o=Ka(h,o,o.pendingProps,o.type,void 0,Dn);break;case 11:o=Ka(h,o,o.pendingProps,o.type.render,o.ref,Dn);break;case 5:I0(o);default:sc(h,o),o=gn=Xa(o,Wi),o=Cd(h,o,Wi)}s.memoizedProps=s.pendingProps,o===null?jt(s):gn=o}function lt(s,o,h,m){Ya=Ao=null,I0(o),_l=null,yl=0;var A=o.return;try{if(Gs(s,A,o,h,Dn)){ai=1,Ed(s,vs(h,s.current)),gn=null;return}}catch(T){if(A!==null)throw gn=A,T;ai=1,Ed(s,vs(h,s.current)),gn=null;return}o.flags&32768?(On||m===1?s=!0:yn||(Dn&536870912)!==0?s=!1:(fn=s=!0,(m===2||m===9||m===3||m===6)&&(m=pa.current,m!==null&&m.tag===13&&(m.flags|=16384))),yi(o,s)):jt(o)}function jt(s){var o=s;do{if((o.flags&32768)!==0){yi(o,fn);return}s=o.return;var h=im(o.alternate,o,Wi);if(h!==null){gn=h;return}if(o=o.sibling,o!==null){gn=o;return}gn=o=s}while(o!==null);ai===0&&(ai=5)}function yi(s,o){do{var h=Rd(s.alternate,s);if(h!==null){h.flags&=32767,gn=h;return}if(h=s.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!o&&(s=s.sibling,s!==null)){gn=s;return}gn=s=h}while(s!==null);ai=6,gn=null}function an(s,o,h,m,A,T,I,Y,ue){s.cancelPendingCommit=null;do Id();while(Ui!==0);if((Hn&6)!==0)throw Error(n(327));if(o!==null){if(o===s.current)throw Error(n(177));if(T=o.lanes|o.childLanes,T|=td,Va(s,h,T,I,Y,ue),s===ii&&(gn=ii=null,Dn=0),Zs=o,Dr=s,pr=h,Po=T,cc=A,Ld=m,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,_w(Le,function(){return oA(),null})):(s.callbackNode=null,s.callbackPriority=0),m=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||m){m=H.T,H.T=null,A=K.p,K.p=2,I=Hn,Hn|=4;try{ou(s,o,h)}finally{Hn=I,K.p=A,H.T=m}}Ui=1,qn(),ga(),Kn()}}function qn(){if(Ui===1){Ui=0;var s=Dr,o=Zs,h=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||h){h=H.T,H.T=null;var m=K.p;K.p=2;var A=Hn;Hn|=4;try{wl(o,s);var T=x2,I=Wh(s.containerInfo),Y=T.focusedElem,ue=T.selectionRange;if(I!==Y&&Y&&Y.ownerDocument&&Jh(Y.ownerDocument.documentElement,Y)){if(ue!==null&&Hc(Y)){var Ce=ue.start,Ve=ue.end;if(Ve===void 0&&(Ve=Ce),"selectionStart"in Y)Y.selectionStart=Ce,Y.selectionEnd=Math.min(Ve,Y.value.length);else{var We=Y.ownerDocument||document,Be=We&&We.defaultView||window;if(Be.getSelection){var Ie=Be.getSelection(),Ft=Y.textContent.length,tn=Math.min(ue.start,Ft),Si=ue.end===void 0?tn:Math.min(ue.end,Ft);!Ie.extend&&tn>Si&&(I=Si,Si=tn,tn=I);var be=f0(Y,tn),ge=f0(Y,Si);if(be&&ge&&(Ie.rangeCount!==1||Ie.anchorNode!==be.node||Ie.anchorOffset!==be.offset||Ie.focusNode!==ge.node||Ie.focusOffset!==ge.offset)){var Ee=We.createRange();Ee.setStart(be.node,be.offset),Ie.removeAllRanges(),tn>Si?(Ie.addRange(Ee),Ie.extend(ge.node,ge.offset)):(Ee.setEnd(ge.node,ge.offset),Ie.addRange(Ee))}}}}for(We=[],Ie=Y;Ie=Ie.parentNode;)Ie.nodeType===1&&We.push({element:Ie,left:Ie.scrollLeft,top:Ie.scrollTop});for(typeof Y.focus=="function"&&Y.focus(),Y=0;Y<We.length;Y++){var Ke=We[Y];Ke.element.scrollLeft=Ke.left,Ke.element.scrollTop=Ke.top}}Kv=!!v2,x2=v2=null}finally{Hn=A,K.p=m,H.T=h}}s.current=o,Ui=2}}function ga(){if(Ui===2){Ui=0;var s=Dr,o=Zs,h=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||h){h=H.T,H.T=null;var m=K.p;K.p=2;var A=Hn;Hn|=4;try{Nv(s,o.alternate,o)}finally{Hn=A,K.p=m,H.T=h}}Ui=3}}function Kn(){if(Ui===4||Ui===3){Ui=0,ee();var s=Dr,o=Zs,h=pr,m=Ld;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Ui=5:(Ui=0,Zs=Dr=null,Fo(s,s.pendingLanes));var A=s.pendingLanes;if(A===0&&(io=null),ms(h),o=o.stateNode,qe&&typeof qe.onCommitFiberRoot=="function")try{qe.onCommitFiberRoot(Ye,o,void 0,(o.current.flags&128)===128)}catch{}if(m!==null){o=H.T,A=K.p,K.p=2,H.T=null;try{for(var T=s.onRecoverableError,I=0;I<m.length;I++){var Y=m[I];T(Y.value,{componentStack:Y.stack})}}finally{H.T=o,K.p=A}}(pr&3)!==0&&Id(),Dl(s),A=s.pendingLanes,(h&261930)!==0&&(A&42)!==0?s===fc?uc++:(uc=0,fc=s):uc=0,rm(0)}}function Fo(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Ua(o)))}function Id(){return qn(),ga(),Kn(),oA()}function oA(){if(Ui!==5)return!1;var s=Dr,o=Po;Po=0;var h=ms(pr),m=H.T,A=K.p;try{K.p=32>h?32:h,H.T=null,h=cc,cc=null;var T=Dr,I=pr;if(Ui=0,Zs=Dr=null,pr=0,(Hn&6)!==0)throw Error(n(331));var Y=Hn;if(Hn|=4,lc(T.current),Di(T,T.current,I,h),Hn=Y,rm(0,!1),qe&&typeof qe.onPostCommitFiberRoot=="function")try{qe.onPostCommitFiberRoot(Ye,T)}catch{}return!0}finally{K.p=A,H.T=m,Fo(s,o)}}function lA(s,o,h){o=vs(h,o),o=nm(s.stateNode,o,2),s=Co(s,o,2),s!==null&&(fa(s,2),Dl(s))}function vi(s,o,h){if(s.tag===3)lA(s,s,h);else for(;o!==null;){if(o.tag===3){lA(o,s,h);break}else if(o.tag===1){var m=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(io===null||!io.has(m))){s=vs(h,s),h=nu(2),m=Co(o,h,2),m!==null&&(bs(h,m,o,s),fa(m,2),Dl(m));break}}o=o.return}}function o2(s,o,h){var m=s.pingCache;if(m===null){m=s.pingCache=new Nd;var A=new Set;m.set(o,A)}else A=m.get(o),A===void 0&&(A=new Set,m.set(o,A));A.has(h)||(mi=!0,A.add(h),s=gw.bind(null,s,o,h),o.then(s,s))}function gw(s,o,h){var m=s.pingCache;m!==null&&m.delete(o),s.pingedLanes|=s.suspendedLanes&h,s.warmLanes&=~h,ii===s&&(Dn&h)===h&&(ai===4||ai===3&&(Dn&62914560)===Dn&&300>X()-Io?(Hn&2)===0&&Se(s,0):wr|=h,Js===Dn&&(Js=0)),Dl(s)}function cA(s,o){o===0&&(o=Fn()),s=dl(s,o),s!==null&&(fa(s,o),Dl(s))}function vw(s){var o=s.memoizedState,h=0;o!==null&&(h=o.retryLane),cA(s,h)}function xw(s,o){var h=0;switch(s.tag){case 31:case 13:var m=s.stateNode,A=s.memoizedState;A!==null&&(h=A.retryLane);break;case 19:m=s.stateNode;break;case 22:m=s.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(o),cA(s,h)}function _w(s,o){return bt(s,o)}var Pv=null,Pd=null,l2=!1,Fv=!1,c2=!1,fu=0;function Dl(s){s!==Pd&&s.next===null&&(Pd===null?Pv=Pd=s:Pd=Pd.next=s),Fv=!0,l2||(l2=!0,bw())}function rm(s,o){if(!c2&&Fv){c2=!0;do for(var h=!1,m=Pv;m!==null;){if(s!==0){var A=m.pendingLanes;if(A===0)var T=0;else{var I=m.suspendedLanes,Y=m.pingedLanes;T=(1<<31-Et(42|s)+1)-1,T&=A&~(I&~Y),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(h=!0,dA(m,T))}else T=Dn,T=Je(m,m===ii?T:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(T&3)===0||Bt(m,T)||(h=!0,dA(m,T));m=m.next}while(h);c2=!1}}function yw(){uA()}function uA(){Fv=l2=!1;var s=0;fu!==0&&Dw()&&(s=fu);for(var o=X(),h=null,m=Pv;m!==null;){var A=m.next,T=fA(m,o);T===0?(m.next=null,h===null?Pv=A:h.next=A,A===null&&(Pd=h)):(h=m,(s!==0||(T&3)!==0)&&(Fv=!0)),m=A}Ui!==0&&Ui!==5||rm(s),fu!==0&&(fu=0)}function fA(s,o){for(var h=s.suspendedLanes,m=s.pingedLanes,A=s.expirationTimes,T=s.pendingLanes&-62914561;0<T;){var I=31-Et(T),Y=1<<I,ue=A[I];ue===-1?((Y&h)===0||(Y&m)!==0)&&(A[I]=Qt(Y,o)):ue<=o&&(s.expiredLanes|=Y),T&=~Y}if(o=ii,h=Dn,h=Je(s,s===o?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m=s.callbackNode,h===0||s===o&&(Kt===2||Kt===9)||s.cancelPendingCommit!==null)return m!==null&&m!==null&&mt(m),s.callbackNode=null,s.callbackPriority=0;if((h&3)===0||Bt(s,h)){if(o=h&-h,o===s.callbackPriority)return o;switch(m!==null&&mt(m),ms(h)){case 2:case 8:h=Ze;break;case 32:h=Le;break;case 268435456:h=xt;break;default:h=Le}return m=hA.bind(null,s),h=bt(h,m),s.callbackPriority=o,s.callbackNode=h,o}return m!==null&&m!==null&&mt(m),s.callbackPriority=2,s.callbackNode=null,2}function hA(s,o){if(Ui!==0&&Ui!==5)return s.callbackNode=null,s.callbackPriority=0,null;var h=s.callbackNode;if(Id()&&s.callbackNode!==h)return null;var m=Dn;return m=Je(s,s===ii?m:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m===0?null:(v(s,m,o),fA(s,X()),s.callbackNode!=null&&s.callbackNode===h?hA.bind(null,s):null)}function dA(s,o){if(Id())return null;v(s,o,!0)}function bw(){Ow(function(){(Hn&6)!==0?bt(He,yw):uA()})}function u2(){if(fu===0){var s=To;s===0&&(s=Ue,Ue<<=1,(Ue&261888)===0&&(Ue=256)),fu=s}return fu}function pA(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ef(""+s)}function mA(s,o){var h=o.ownerDocument.createElement("input");return h.name=o.name,h.value=o.value,s.id&&h.setAttribute("form",s.id),o.parentNode.insertBefore(h,o),s=new FormData(s),h.parentNode.removeChild(h),s}function Sw(s,o,h,m,A){if(o==="submit"&&h&&h.stateNode===A){var T=pA((A[G]||null).action),I=m.submitter;I&&(o=(o=I[G]||null)?pA(o.formAction):I.getAttribute("formAction"),o!==null&&(T=o,I=null));var Y=new sf("action","action",null,m,A);s.push({event:Y,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(fu!==0){var ue=I?mA(A,I):new FormData(A);Z0(h,{pending:!0,data:ue,method:A.method,action:T},null,ue)}}else typeof T=="function"&&(Y.preventDefault(),ue=I?mA(A,I):new FormData(A),Z0(h,{pending:!0,data:ue,method:A.method,action:T},T,ue))},currentTarget:A}]})}}for(var f2=0;f2<ed.length;f2++){var h2=ed[f2],Aw=h2.toLowerCase(),Mw=h2[0].toUpperCase()+h2.slice(1);ja(Aw,"on"+Mw)}ja(gs,"onAnimationEnd"),ja(h0,"onAnimationIteration"),ja(kr,"onAnimationStart"),ja("dblclick","onDoubleClick"),ja("focusin","onFocus"),ja("focusout","onBlur"),ja(jc,"onTransitionRun"),ja(ul,"onTransitionStart"),ja(d0,"onTransitionCancel"),ja($h,"onTransitionEnd"),$e("onMouseEnter",["mouseout","mouseover"]),$e("onMouseLeave",["mouseout","mouseover"]),$e("onPointerEnter",["pointerout","pointerover"]),$e("onPointerLeave",["pointerout","pointerover"]),je("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),je("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),je("onBeforeInput",["compositionend","keypress","textInput","paste"]),je("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),je("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),je("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var om="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ew=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(om));function gA(s,o){o=(o&4)!==0;for(var h=0;h<s.length;h++){var m=s[h],A=m.event;m=m.listeners;e:{var T=void 0;if(o)for(var I=m.length-1;0<=I;I--){var Y=m[I],ue=Y.instance,Ce=Y.currentTarget;if(Y=Y.listener,ue!==T&&A.isPropagationStopped())break e;T=Y,A.currentTarget=Ce;try{T(A)}catch(Ve){fl(Ve)}A.currentTarget=null,T=ue}else for(I=0;I<m.length;I++){if(Y=m[I],ue=Y.instance,Ce=Y.currentTarget,Y=Y.listener,ue!==T&&A.isPropagationStopped())break e;T=Y,A.currentTarget=Ce;try{T(A)}catch(Ve){fl(Ve)}A.currentTarget=null,T=ue}}}}function Nn(s,o){var h=o[he];h===void 0&&(h=o[he]=new Set);var m=s+"__bubble";h.has(m)||(vA(o,s,2,!1),h.add(m))}function d2(s,o,h){var m=0;o&&(m|=4),vA(h,s,m,o)}var zv="_reactListening"+Math.random().toString(36).slice(2);function p2(s){if(!s[zv]){s[zv]=!0,oe.forEach(function(h){h!=="selectionchange"&&(Ew.has(h)||d2(h,!1,s),d2(h,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[zv]||(o[zv]=!0,d2("selectionchange",!1,o))}}function vA(s,o,h,m){switch(YA(o)){case 2:var A=$w;break;case 8:A=eB;break;default:A=w2}h=A.bind(null,o,h,s),A=void 0,!zh||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(A=!0),m?A!==void 0?s.addEventListener(o,h,{capture:!0,passive:A}):s.addEventListener(o,h,!0):A!==void 0?s.addEventListener(o,h,{passive:A}):s.addEventListener(o,h,!1)}function m2(s,o,h,m,A){var T=m;if((o&1)===0&&(o&2)===0&&m!==null)e:for(;;){if(m===null)return;var I=m.tag;if(I===3||I===4){var Y=m.stateNode.containerInfo;if(Y===A)break;if(I===4)for(I=m.return;I!==null;){var ue=I.tag;if((ue===3||ue===4)&&I.stateNode.containerInfo===A)return;I=I.return}for(;Y!==null;){if(I=at(Y),I===null)return;if(ue=I.tag,ue===5||ue===6||ue===26||ue===27){m=T=I;continue e}Y=Y.parentNode}}m=m.return}Kp(function(){var Ce=T,Ve=Ph(h),We=[];e:{var Be=_o.get(s);if(Be!==void 0){var Ie=sf,Ft=s;switch(s){case"keypress":if(Vl(h)===0)break e;case"keydown":case"keyup":Ie=t0;break;case"focusin":Ft="focus",Ie=jh;break;case"focusout":Ft="blur",Ie=jh;break;case"beforeblur":case"afterblur":Ie=jh;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=Fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=zg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=vo;break;case gs:case h0:case kr:Ie=Vg;break;case $h:Ie=$y;break;case"scroll":case"scrollend":Ie=Vh;break;case"wheel":Ie=al;break;case"copy":case"cut":case"paste":Ie=Wp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=Xh;break;case"toggle":case"beforetoggle":Ie=i0}var tn=(o&4)!==0,Si=!tn&&(s==="scroll"||s==="scrollend"),be=tn?Be!==null?Be+"Capture":null:Be;tn=[];for(var ge=Ce,Ee;ge!==null;){var Ke=ge;if(Ee=Ke.stateNode,Ke=Ke.tag,Ke!==5&&Ke!==26&&Ke!==27||Ee===null||be===null||(Ke=Gl(ge,be),Ke!=null&&tn.push(lm(ge,Ke,Ee))),Si)break;ge=ge.return}0<tn.length&&(Be=new Ie(Be,Ft,null,h,Ve),We.push({event:Be,listeners:tn}))}}if((o&7)===0){e:{if(Be=s==="mouseover"||s==="pointerover",Ie=s==="mouseout"||s==="pointerout",Be&&h!==tf&&(Ft=h.relatedTarget||h.fromElement)&&(at(Ft)||Ft[Z]))break e;if((Ie||Be)&&(Be=Ve.window===Ve?Ve:(Be=Ve.ownerDocument)?Be.defaultView||Be.parentWindow:window,Ie?(Ft=h.relatedTarget||h.toElement,Ie=Ce,Ft=Ft?at(Ft):null,Ft!==null&&(Si=r(Ft),tn=Ft.tag,Ft!==Si||tn!==5&&tn!==27&&tn!==6)&&(Ft=null)):(Ie=null,Ft=Ce),Ie!==Ft)){if(tn=Fg,Ke="onMouseLeave",be="onMouseEnter",ge="mouse",(s==="pointerout"||s==="pointerover")&&(tn=Xh,Ke="onPointerLeave",be="onPointerEnter",ge="pointer"),Si=Ie==null?Be:ne(Ie),Ee=Ft==null?Be:ne(Ft),Be=new tn(Ke,ge+"leave",Ie,h,Ve),Be.target=Si,Be.relatedTarget=Ee,Ke=null,at(Ve)===Ce&&(tn=new tn(be,ge+"enter",Ft,h,Ve),tn.target=Ee,tn.relatedTarget=Si,Ke=tn),Si=Ke,Ie&&Ft)t:{for(tn=Tw,be=Ie,ge=Ft,Ee=0,Ke=be;Ke;Ke=tn(Ke))Ee++;Ke=0;for(var Zt=ge;Zt;Zt=tn(Zt))Ke++;for(;0<Ee-Ke;)be=tn(be),Ee--;for(;0<Ke-Ee;)ge=tn(ge),Ke--;for(;Ee--;){if(be===ge||ge!==null&&be===ge.alternate){tn=be;break t}be=tn(be),ge=tn(ge)}tn=null}else tn=null;Ie!==null&&xA(We,Be,Ie,tn,!1),Ft!==null&&Si!==null&&xA(We,Si,Ft,tn,!0)}}e:{if(Be=Ce?ne(Ce):window,Ie=Be.nodeName&&Be.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&Be.type==="file")var si=l0;else if(r0(Be))if(ff)si=$g;else{si=ol;var kt=hf}else Ie=Be.nodeName,!Ie||Ie.toLowerCase()!=="input"||Be.type!=="checkbox"&&Be.type!=="radio"?Ce&&$u(Ce.elementType)&&(si=l0):si=Qg;if(si&&(si=si(s,Ce))){Kh(We,si,h,Ve);break e}kt&&kt(s,Be,Ce),s==="focusout"&&Ce&&Be.type==="number"&&Ce.memoizedProps.value!=null&&jn(Be,"number",Be.value)}switch(kt=Ce?ne(Ce):window,s){case"focusin":(r0(kt)||kt.contentEditable==="true")&&(Gc=kt,Zh=Ce,Vc=null);break;case"focusout":Vc=Zh=Gc=null;break;case"mousedown":Is=!0;break;case"contextmenu":case"mouseup":case"dragend":Is=!1,Qh(We,h,Ve);break;case"selectionchange":if(ev)break;case"keydown":case"keyup":Qh(We,h,Ve)}var bn;if(kl)e:{switch(s){case"compositionstart":var Vn="onCompositionStart";break e;case"compositionend":Vn="onCompositionEnd";break e;case"compositionupdate":Vn="onCompositionUpdate";break e}Vn=void 0}else rl?Yh(s,h)&&(Vn="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(Vn="onCompositionStart");Vn&&(Da&&h.locale!=="ko"&&(rl||Vn!=="onCompositionStart"?Vn==="onCompositionEnd"&&rl&&(bn=Gh()):(tl=Ve,Hh="value"in tl?tl.value:tl.textContent,rl=!0)),kt=Hv(Ce,Vn),0<kt.length&&(Vn=new Zp(Vn,s,null,h,Ve),We.push({event:Vn,listeners:kt}),bn?Vn.data=bn:(bn=Lc(h),bn!==null&&(Vn.data=bn)))),(bn=jl?qh(s,h):Jg(s,h))&&(Vn=Hv(Ce,"onBeforeInput"),0<Vn.length&&(kt=new Zp("onBeforeInput","beforeinput",null,h,Ve),We.push({event:kt,listeners:Vn}),kt.data=bn)),Sw(We,s,Ce,h,Ve)}gA(We,o)})}function lm(s,o,h){return{instance:s,listener:o,currentTarget:h}}function Hv(s,o){for(var h=o+"Capture",m=[];s!==null;){var A=s,T=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||T===null||(A=Gl(s,h),A!=null&&m.unshift(lm(s,A,T)),A=Gl(s,o),A!=null&&m.push(lm(s,A,T))),s.tag===3)return m;s=s.return}return[]}function Tw(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function xA(s,o,h,m,A){for(var T=o._reactName,I=[];h!==null&&h!==m;){var Y=h,ue=Y.alternate,Ce=Y.stateNode;if(Y=Y.tag,ue!==null&&ue===m)break;Y!==5&&Y!==26&&Y!==27||Ce===null||(ue=Ce,A?(Ce=Gl(h,T),Ce!=null&&I.unshift(lm(h,Ce,ue))):A||(Ce=Gl(h,T),Ce!=null&&I.push(lm(h,Ce,ue)))),h=h.return}I.length!==0&&s.push({event:o,listeners:I})}var Cw=/\r\n?/g,Rw=/\u0000|\uFFFD/g;function _A(s){return(typeof s=="string"?s:""+s).replace(Cw,`
`).replace(Rw,"")}function yA(s,o){return o=_A(o),_A(s)===o}function bi(s,o,h,m,A,T){switch(h){case"children":typeof m=="string"?o==="body"||o==="textarea"&&m===""||yr(s,m):(typeof m=="number"||typeof m=="bigint")&&o!=="body"&&yr(s,""+m);break;case"className":on(s,"class",m);break;case"tabIndex":on(s,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":on(s,h,m);break;case"style":Yp(s,m,T);break;case"data":if(o!=="object"){on(s,"data",m);break}case"src":case"href":if(m===""&&(o!=="a"||h!=="href")){s.removeAttribute(h);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(h);break}m=ef(""+m),s.setAttribute(h,m);break;case"action":case"formAction":if(typeof m=="function"){s.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(h==="formAction"?(o!=="input"&&bi(s,o,"name",A.name,A,null),bi(s,o,"formEncType",A.formEncType,A,null),bi(s,o,"formMethod",A.formMethod,A,null),bi(s,o,"formTarget",A.formTarget,A,null)):(bi(s,o,"encType",A.encType,A,null),bi(s,o,"method",A.method,A,null),bi(s,o,"target",A.target,A,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(h);break}m=ef(""+m),s.setAttribute(h,m);break;case"onClick":m!=null&&(s.onclick=Gr);break;case"onScroll":m!=null&&Nn("scroll",s);break;case"onScrollEnd":m!=null&&Nn("scrollend",s);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(h=m.__html,h!=null){if(A.children!=null)throw Error(n(60));s.innerHTML=h}}break;case"multiple":s.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":s.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){s.removeAttribute("xlink:href");break}h=ef(""+m),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(h,""+m):s.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(h,""):s.removeAttribute(h);break;case"capture":case"download":m===!0?s.setAttribute(h,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(h,m):s.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?s.setAttribute(h,m):s.removeAttribute(h);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?s.removeAttribute(h):s.setAttribute(h,m);break;case"popover":Nn("beforetoggle",s),Nn("toggle",s),Ut(s,"popover",m);break;case"xlinkActuate":Ht(s,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Ht(s,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Ht(s,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Ht(s,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Ht(s,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Ht(s,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Ht(s,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Ht(s,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Ht(s,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Ut(s,"is",m);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Ig.get(h)||h,Ut(s,h,m))}}function g2(s,o,h,m,A,T){switch(h){case"style":Yp(s,m,T);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(h=m.__html,h!=null){if(A.children!=null)throw Error(n(60));s.innerHTML=h}}break;case"children":typeof m=="string"?yr(s,m):(typeof m=="number"||typeof m=="bigint")&&yr(s,""+m);break;case"onScroll":m!=null&&Nn("scroll",s);break;case"onScrollEnd":m!=null&&Nn("scrollend",s);break;case"onClick":m!=null&&(s.onclick=Gr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ne.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(A=h.endsWith("Capture"),o=h.slice(2,A?h.length-7:void 0),T=s[G]||null,T=T!=null?T[h]:null,typeof T=="function"&&s.removeEventListener(o,T,A),typeof m=="function")){typeof T!="function"&&T!==null&&(h in s?s[h]=null:s.hasAttribute(h)&&s.removeAttribute(h)),s.addEventListener(o,m,A);break e}h in s?s[h]=m:m===!0?s.setAttribute(h,""):Ut(s,h,m)}}}function us(s,o,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nn("error",s),Nn("load",s);var m=!1,A=!1,T;for(T in h)if(h.hasOwnProperty(T)){var I=h[T];if(I!=null)switch(T){case"src":m=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:bi(s,o,T,I,h,null)}}A&&bi(s,o,"srcSet",h.srcSet,h,null),m&&bi(s,o,"src",h.src,h,null);return;case"input":Nn("invalid",s);var Y=T=I=A=null,ue=null,Ce=null;for(m in h)if(h.hasOwnProperty(m)){var Ve=h[m];if(Ve!=null)switch(m){case"name":A=Ve;break;case"type":I=Ve;break;case"checked":ue=Ve;break;case"defaultChecked":Ce=Ve;break;case"value":T=Ve;break;case"defaultValue":Y=Ve;break;case"children":case"dangerouslySetInnerHTML":if(Ve!=null)throw Error(n(137,o));break;default:bi(s,o,m,Ve,h,null)}}Un(s,T,Y,ue,Ce,I,A,!1);return;case"select":Nn("invalid",s),m=I=T=null;for(A in h)if(h.hasOwnProperty(A)&&(Y=h[A],Y!=null))switch(A){case"value":T=Y;break;case"defaultValue":I=Y;break;case"multiple":m=Y;default:bi(s,o,A,Y,h,null)}o=T,h=I,s.multiple=!!m,o!=null?di(s,!!m,o,!1):h!=null&&di(s,!!m,h,!0);return;case"textarea":Nn("invalid",s),T=A=m=null;for(I in h)if(h.hasOwnProperty(I)&&(Y=h[I],Y!=null))switch(I){case"value":m=Y;break;case"defaultValue":A=Y;break;case"children":T=Y;break;case"dangerouslySetInnerHTML":if(Y!=null)throw Error(n(91));break;default:bi(s,o,I,Y,h,null)}Li(s,m,A,T);return;case"option":for(ue in h)if(h.hasOwnProperty(ue)&&(m=h[ue],m!=null))switch(ue){case"selected":s.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:bi(s,o,ue,m,h,null)}return;case"dialog":Nn("beforetoggle",s),Nn("toggle",s),Nn("cancel",s),Nn("close",s);break;case"iframe":case"object":Nn("load",s);break;case"video":case"audio":for(m=0;m<om.length;m++)Nn(om[m],s);break;case"image":Nn("error",s),Nn("load",s);break;case"details":Nn("toggle",s);break;case"embed":case"source":case"link":Nn("error",s),Nn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ce in h)if(h.hasOwnProperty(Ce)&&(m=h[Ce],m!=null))switch(Ce){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:bi(s,o,Ce,m,h,null)}return;default:if($u(o)){for(Ve in h)h.hasOwnProperty(Ve)&&(m=h[Ve],m!==void 0&&g2(s,o,Ve,m,h,void 0));return}}for(Y in h)h.hasOwnProperty(Y)&&(m=h[Y],m!=null&&bi(s,o,Y,m,h,null))}function ww(s,o,h,m){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,T=null,I=null,Y=null,ue=null,Ce=null,Ve=null;for(Ie in h){var We=h[Ie];if(h.hasOwnProperty(Ie)&&We!=null)switch(Ie){case"checked":break;case"value":break;case"defaultValue":ue=We;default:m.hasOwnProperty(Ie)||bi(s,o,Ie,null,m,We)}}for(var Be in m){var Ie=m[Be];if(We=h[Be],m.hasOwnProperty(Be)&&(Ie!=null||We!=null))switch(Be){case"type":T=Ie;break;case"name":A=Ie;break;case"checked":Ce=Ie;break;case"defaultChecked":Ve=Ie;break;case"value":I=Ie;break;case"defaultValue":Y=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,o));break;default:Ie!==We&&bi(s,o,Be,Ie,m,We)}}Bi(s,I,Y,ue,Ce,Ve,T,A);return;case"select":Ie=I=Y=Be=null;for(T in h)if(ue=h[T],h.hasOwnProperty(T)&&ue!=null)switch(T){case"value":break;case"multiple":Ie=ue;default:m.hasOwnProperty(T)||bi(s,o,T,null,m,ue)}for(A in m)if(T=m[A],ue=h[A],m.hasOwnProperty(A)&&(T!=null||ue!=null))switch(A){case"value":Be=T;break;case"defaultValue":Y=T;break;case"multiple":I=T;default:T!==ue&&bi(s,o,A,T,m,ue)}o=Y,h=I,m=Ie,Be!=null?di(s,!!h,Be,!1):!!m!=!!h&&(o!=null?di(s,!!h,o,!0):di(s,!!h,h?[]:"",!1));return;case"textarea":Ie=Be=null;for(Y in h)if(A=h[Y],h.hasOwnProperty(Y)&&A!=null&&!m.hasOwnProperty(Y))switch(Y){case"value":break;case"children":break;default:bi(s,o,Y,null,m,A)}for(I in m)if(A=m[I],T=h[I],m.hasOwnProperty(I)&&(A!=null||T!=null))switch(I){case"value":Be=A;break;case"defaultValue":Ie=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:A!==T&&bi(s,o,I,A,m,T)}da(s,Be,Ie);return;case"option":for(var Ft in h)if(Be=h[Ft],h.hasOwnProperty(Ft)&&Be!=null&&!m.hasOwnProperty(Ft))switch(Ft){case"selected":s.selected=!1;break;default:bi(s,o,Ft,null,m,Be)}for(ue in m)if(Be=m[ue],Ie=h[ue],m.hasOwnProperty(ue)&&Be!==Ie&&(Be!=null||Ie!=null))switch(ue){case"selected":s.selected=Be&&typeof Be!="function"&&typeof Be!="symbol";break;default:bi(s,o,ue,Be,m,Ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tn in h)Be=h[tn],h.hasOwnProperty(tn)&&Be!=null&&!m.hasOwnProperty(tn)&&bi(s,o,tn,null,m,Be);for(Ce in m)if(Be=m[Ce],Ie=h[Ce],m.hasOwnProperty(Ce)&&Be!==Ie&&(Be!=null||Ie!=null))switch(Ce){case"children":case"dangerouslySetInnerHTML":if(Be!=null)throw Error(n(137,o));break;default:bi(s,o,Ce,Be,m,Ie)}return;default:if($u(o)){for(var Si in h)Be=h[Si],h.hasOwnProperty(Si)&&Be!==void 0&&!m.hasOwnProperty(Si)&&g2(s,o,Si,void 0,m,Be);for(Ve in m)Be=m[Ve],Ie=h[Ve],!m.hasOwnProperty(Ve)||Be===Ie||Be===void 0&&Ie===void 0||g2(s,o,Ve,Be,m,Ie);return}}for(var be in h)Be=h[be],h.hasOwnProperty(be)&&Be!=null&&!m.hasOwnProperty(be)&&bi(s,o,be,null,m,Be);for(We in m)Be=m[We],Ie=h[We],!m.hasOwnProperty(We)||Be===Ie||Be==null&&Ie==null||bi(s,o,We,Be,m,Ie)}function bA(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Bw(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,h=performance.getEntriesByType("resource"),m=0;m<h.length;m++){var A=h[m],T=A.transferSize,I=A.initiatorType,Y=A.duration;if(T&&Y&&bA(I)){for(I=0,Y=A.responseEnd,m+=1;m<h.length;m++){var ue=h[m],Ce=ue.startTime;if(Ce>Y)break;var Ve=ue.transferSize,We=ue.initiatorType;Ve&&bA(We)&&(ue=ue.responseEnd,I+=Ve*(ue<Y?1:(Y-Ce)/(ue-Ce)))}if(--m,o+=8*(T+I)/(A.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var v2=null,x2=null;function Gv(s){return s.nodeType===9?s:s.ownerDocument}function SA(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function AA(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function _2(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var y2=null;function Dw(){var s=window.event;return s&&s.type==="popstate"?s===y2?!1:(y2=s,!0):(y2=null,!1)}var MA=typeof setTimeout=="function"?setTimeout:void 0,Uw=typeof clearTimeout=="function"?clearTimeout:void 0,EA=typeof Promise=="function"?Promise:void 0,Ow=typeof queueMicrotask=="function"?queueMicrotask:typeof EA<"u"?function(s){return EA.resolve(null).then(s).catch(Nw)}:MA;function Nw(s){setTimeout(function(){throw s})}function hu(s){return s==="head"}function TA(s,o){var h=o,m=0;do{var A=h.nextSibling;if(s.removeChild(h),A&&A.nodeType===8)if(h=A.data,h==="/$"||h==="/&"){if(m===0){s.removeChild(A),Gd(o);return}m--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")m++;else if(h==="html")cm(s.ownerDocument.documentElement);else if(h==="head"){h=s.ownerDocument.head,cm(h);for(var T=h.firstChild;T;){var I=T.nextSibling,Y=T.nodeName;T[ot]||Y==="SCRIPT"||Y==="STYLE"||Y==="LINK"&&T.rel.toLowerCase()==="stylesheet"||h.removeChild(T),T=I}}else h==="body"&&cm(s.ownerDocument.body);h=A}while(h);Gd(o)}function CA(s,o){var h=s;s=0;do{var m=h.nextSibling;if(h.nodeType===1?o?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(o?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),m&&m.nodeType===8)if(h=m.data,h==="/$"){if(s===0)break;s--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||s++;h=m}while(h)}function b2(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var h=o;switch(o=o.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":b2(h),nt(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}s.removeChild(h)}}function Lw(s,o,h,m){for(;s.nodeType===1;){var A=h;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!m&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(m){if(!s[ot])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(T=s.getAttribute("rel"),T==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(T!==A.rel||s.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||s.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||s.getAttribute("title")!==(A.title==null?null:A.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(T=s.getAttribute("src"),(T!==(A.src==null?null:A.src)||s.getAttribute("type")!==(A.type==null?null:A.type)||s.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&T&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var T=A.name==null?null:""+A.name;if(A.type==="hidden"&&s.getAttribute("name")===T)return s}else return s;if(s=ao(s.nextSibling),s===null)break}return null}function Iw(s,o,h){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=ao(s.nextSibling),s===null))return null;return s}function RA(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ao(s.nextSibling),s===null))return null;return s}function S2(s){return s.data==="$?"||s.data==="$~"}function A2(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Pw(s,o){var h=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||h.readyState!=="loading")o();else{var m=function(){o(),h.removeEventListener("DOMContentLoaded",m)};h.addEventListener("DOMContentLoaded",m),s._reactRetry=m}}function ao(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var M2=null;function wA(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var h=s.data;if(h==="/$"||h==="/&"){if(o===0)return ao(s.nextSibling);o--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||o++}s=s.nextSibling}return null}function BA(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(o===0)return s;o--}else h!=="/$"&&h!=="/&"||o++}s=s.previousSibling}return null}function DA(s,o,h){switch(o=Gv(h),s){case"html":if(s=o.documentElement,!s)throw Error(n(452));return s;case"head":if(s=o.head,!s)throw Error(n(453));return s;case"body":if(s=o.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function cm(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);nt(s)}var so=new Map,UA=new Set;function Vv(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var dc=K.d;K.d={f:Fw,r:zw,D:Hw,C:Gw,L:Vw,m:kw,X:Xw,S:jw,M:Yw};function Fw(){var s=dc.f(),o=J();return s||o}function zw(s){var o=V(s);o!==null&&o.tag===5&&o.type==="form"?Q0(o):dc.r(s)}var Fd=typeof document>"u"?null:document;function OA(s,o,h){var m=Fd;if(m&&typeof o=="string"&&o){var A=Yt(o);A='link[rel="'+s+'"][href="'+A+'"]',typeof h=="string"&&(A+='[crossorigin="'+h+'"]'),UA.has(A)||(UA.add(A),s={rel:s,crossOrigin:h,href:o},m.querySelector(A)===null&&(o=m.createElement("link"),us(o,"link",s),_e(o),m.head.appendChild(o)))}}function Hw(s){dc.D(s),OA("dns-prefetch",s,null)}function Gw(s,o){dc.C(s,o),OA("preconnect",s,o)}function Vw(s,o,h){dc.L(s,o,h);var m=Fd;if(m&&s&&o){var A='link[rel="preload"][as="'+Yt(o)+'"]';o==="image"&&h&&h.imageSrcSet?(A+='[imagesrcset="'+Yt(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(A+='[imagesizes="'+Yt(h.imageSizes)+'"]')):A+='[href="'+Yt(s)+'"]';var T=A;switch(o){case"style":T=zd(s);break;case"script":T=Hd(s)}so.has(T)||(s=g({rel:"preload",href:o==="image"&&h&&h.imageSrcSet?void 0:s,as:o},h),so.set(T,s),m.querySelector(A)!==null||o==="style"&&m.querySelector(um(T))||o==="script"&&m.querySelector(fm(T))||(o=m.createElement("link"),us(o,"link",s),_e(o),m.head.appendChild(o)))}}function kw(s,o){dc.m(s,o);var h=Fd;if(h&&s){var m=o&&typeof o.as=="string"?o.as:"script",A='link[rel="modulepreload"][as="'+Yt(m)+'"][href="'+Yt(s)+'"]',T=A;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Hd(s)}if(!so.has(T)&&(s=g({rel:"modulepreload",href:s},o),so.set(T,s),h.querySelector(A)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(fm(T)))return}m=h.createElement("link"),us(m,"link",s),_e(m),h.head.appendChild(m)}}}function jw(s,o,h){dc.S(s,o,h);var m=Fd;if(m&&s){var A=le(m).hoistableStyles,T=zd(s);o=o||"default";var I=A.get(T);if(!I){var Y={loading:0,preload:null};if(I=m.querySelector(um(T)))Y.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":o},h),(h=so.get(T))&&E2(s,h);var ue=I=m.createElement("link");_e(ue),us(ue,"link",s),ue._p=new Promise(function(Ce,Ve){ue.onload=Ce,ue.onerror=Ve}),ue.addEventListener("load",function(){Y.loading|=1}),ue.addEventListener("error",function(){Y.loading|=2}),Y.loading|=4,kv(I,o,m)}I={type:"stylesheet",instance:I,count:1,state:Y},A.set(T,I)}}}function Xw(s,o){dc.X(s,o);var h=Fd;if(h&&s){var m=le(h).hoistableScripts,A=Hd(s),T=m.get(A);T||(T=h.querySelector(fm(A)),T||(s=g({src:s,async:!0},o),(o=so.get(A))&&T2(s,o),T=h.createElement("script"),_e(T),us(T,"link",s),h.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(A,T))}}function Yw(s,o){dc.M(s,o);var h=Fd;if(h&&s){var m=le(h).hoistableScripts,A=Hd(s),T=m.get(A);T||(T=h.querySelector(fm(A)),T||(s=g({src:s,async:!0,type:"module"},o),(o=so.get(A))&&T2(s,o),T=h.createElement("script"),_e(T),us(T,"link",s),h.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(A,T))}}function NA(s,o,h,m){var A=(A=xe.current)?Vv(A):null;if(!A)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(o=zd(h.href),h=le(A).hoistableStyles,m=h.get(o),m||(m={type:"style",instance:null,count:0,state:null},h.set(o,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){s=zd(h.href);var T=le(A).hoistableStyles,I=T.get(s);if(I||(A=A.ownerDocument||A,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(s,I),(T=A.querySelector(um(s)))&&!T._p&&(I.instance=T,I.state.loading=5),so.has(s)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},so.set(s,h),T||qw(A,s,h,I.state))),o&&m===null)throw Error(n(528,""));return I}if(o&&m!==null)throw Error(n(529,""));return null;case"script":return o=h.async,h=h.src,typeof h=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Hd(h),h=le(A).hoistableScripts,m=h.get(o),m||(m={type:"script",instance:null,count:0,state:null},h.set(o,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function zd(s){return'href="'+Yt(s)+'"'}function um(s){return'link[rel="stylesheet"]['+s+"]"}function LA(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function qw(s,o,h,m){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?m.loading=1:(o=s.createElement("link"),m.preload=o,o.addEventListener("load",function(){return m.loading|=1}),o.addEventListener("error",function(){return m.loading|=2}),us(o,"link",h),_e(o),s.head.appendChild(o))}function Hd(s){return'[src="'+Yt(s)+'"]'}function fm(s){return"script[async]"+s}function IA(s,o,h){if(o.count++,o.instance===null)switch(o.type){case"style":var m=s.querySelector('style[data-href~="'+Yt(h.href)+'"]');if(m)return o.instance=m,_e(m),m;var A=g({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return m=(s.ownerDocument||s).createElement("style"),_e(m),us(m,"style",A),kv(m,h.precedence,s),o.instance=m;case"stylesheet":A=zd(h.href);var T=s.querySelector(um(A));if(T)return o.state.loading|=4,o.instance=T,_e(T),T;m=LA(h),(A=so.get(A))&&E2(m,A),T=(s.ownerDocument||s).createElement("link"),_e(T);var I=T;return I._p=new Promise(function(Y,ue){I.onload=Y,I.onerror=ue}),us(T,"link",m),o.state.loading|=4,kv(T,h.precedence,s),o.instance=T;case"script":return T=Hd(h.src),(A=s.querySelector(fm(T)))?(o.instance=A,_e(A),A):(m=h,(A=so.get(T))&&(m=g({},h),T2(m,A)),s=s.ownerDocument||s,A=s.createElement("script"),_e(A),us(A,"link",m),s.head.appendChild(A),o.instance=A);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(m=o.instance,o.state.loading|=4,kv(m,h.precedence,s));return o.instance}function kv(s,o,h){for(var m=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=m.length?m[m.length-1]:null,T=A,I=0;I<m.length;I++){var Y=m[I];if(Y.dataset.precedence===o)T=Y;else if(T!==A)break}T?T.parentNode.insertBefore(s,T.nextSibling):(o=h.nodeType===9?h.head:h,o.insertBefore(s,o.firstChild))}function E2(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function T2(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var jv=null;function PA(s,o,h){if(jv===null){var m=new Map,A=jv=new Map;A.set(h,m)}else A=jv,m=A.get(h),m||(m=new Map,A.set(h,m));if(m.has(s))return m;for(m.set(s,null),h=h.getElementsByTagName(s),A=0;A<h.length;A++){var T=h[A];if(!(T[ot]||T[hn]||s==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var I=T.getAttribute(o)||"";I=s+I;var Y=m.get(I);Y?Y.push(T):m.set(I,[T])}}return m}function FA(s,o,h){s=s.ownerDocument||s,s.head.insertBefore(h,o==="title"?s.querySelector("head > title"):null)}function Kw(s,o,h){if(h===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function zA(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function Jw(s,o,h,m){if(h.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var A=zd(m.href),T=o.querySelector(um(A));if(T){o=T._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=Xv.bind(s),o.then(s,s)),h.state.loading|=4,h.instance=T,_e(T);return}T=o.ownerDocument||o,m=LA(m),(A=so.get(A))&&E2(m,A),T=T.createElement("link"),_e(T);var I=T;I._p=new Promise(function(Y,ue){I.onload=Y,I.onerror=ue}),us(T,"link",m),h.instance=T}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(h,o),(o=h.state.preload)&&(h.state.loading&3)===0&&(s.count++,h=Xv.bind(s),o.addEventListener("load",h),o.addEventListener("error",h))}}var C2=0;function Ww(s,o){return s.stylesheets&&s.count===0&&qv(s,s.stylesheets),0<s.count||0<s.imgCount?function(h){var m=setTimeout(function(){if(s.stylesheets&&qv(s,s.stylesheets),s.unsuspend){var T=s.unsuspend;s.unsuspend=null,T()}},6e4+o);0<s.imgBytes&&C2===0&&(C2=62500*Bw());var A=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&qv(s,s.stylesheets),s.unsuspend)){var T=s.unsuspend;s.unsuspend=null,T()}},(s.imgBytes>C2?50:800)+o);return s.unsuspend=h,function(){s.unsuspend=null,clearTimeout(m),clearTimeout(A)}}:null}function Xv(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qv(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Yv=null;function qv(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Yv=new Map,o.forEach(Zw,s),Yv=null,Xv.call(s))}function Zw(s,o){if(!(o.state.loading&4)){var h=Yv.get(s);if(h)var m=h.get(null);else{h=new Map,Yv.set(s,h);for(var A=s.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<A.length;T++){var I=A[T];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(h.set(I.dataset.precedence,I),m=I)}m&&h.set(null,m)}A=o.instance,I=A.getAttribute("data-precedence"),T=h.get(I)||m,T===m&&h.set(null,A),h.set(I,A),this.count++,m=Xv.bind(this),A.addEventListener("load",m),A.addEventListener("error",m),T?T.parentNode.insertBefore(A,T.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(A,s.firstChild)),o.state.loading|=4}}var hm={$$typeof:D,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function Qw(s,o,h,m,A,T,I,Y,ue){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cn(0),this.hiddenUpdates=Cn(null),this.identifierPrefix=m,this.onUncaughtError=A,this.onCaughtError=T,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ue,this.incompleteTransitions=new Map}function HA(s,o,h,m,A,T,I,Y,ue,Ce,Ve,We){return s=new Qw(s,o,h,I,ue,Ce,Ve,We,Y),o=1,T===!0&&(o|=24),T=as(3,null,null,o),s.current=T,T.stateNode=s,o=y0(),o.refCount++,s.pooledCache=o,o.refCount++,T.memoizedState={element:m,isDehydrated:h,cache:o},T0(T),s}function GA(s){return s?(s=pl,s):pl}function VA(s,o,h,m,A,T){A=GA(A),m.context===null?m.context=A:m.pendingContext=A,m=Jr(o),m.payload={element:h},T=T===void 0?null:T,T!==null&&(m.callback=T),h=Co(s,m,o),h!==null&&(f(h,s,o),Sl(h,s,o))}function kA(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<o?h:o}}function R2(s,o){kA(s,o),(s=s.alternate)&&kA(s,o)}function jA(s){if(s.tag===13||s.tag===31){var o=dl(s,67108864);o!==null&&f(o,s,67108864),R2(s,67108864)}}function XA(s){if(s.tag===13||s.tag===31){var o=cs();o=ta(o);var h=dl(s,o);h!==null&&f(h,s,o),R2(s,o)}}var Kv=!0;function $w(s,o,h,m){var A=H.T;H.T=null;var T=K.p;try{K.p=2,w2(s,o,h,m)}finally{K.p=T,H.T=A}}function eB(s,o,h,m){var A=H.T;H.T=null;var T=K.p;try{K.p=8,w2(s,o,h,m)}finally{K.p=T,H.T=A}}function w2(s,o,h,m){if(Kv){var A=B2(m);if(A===null)m2(s,o,m,Jv,h),qA(s,m);else if(nB(A,s,o,h,m))m.stopPropagation();else if(qA(s,m),o&4&&-1<tB.indexOf(s)){for(;A!==null;){var T=V(A);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var I=tt(T.pendingLanes);if(I!==0){var Y=T;for(Y.pendingLanes|=2,Y.entangledLanes|=2;I;){var ue=1<<31-Et(I);Y.entanglements[1]|=ue,I&=~ue}Dl(T),(Hn&6)===0&&(Ws=X()+500,rm(0))}}break;case 31:case 13:Y=dl(T,2),Y!==null&&f(Y,T,2),J(),R2(T,2)}if(T=B2(m),T===null&&m2(s,o,m,Jv,h),T===A)break;A=T}A!==null&&m.stopPropagation()}else m2(s,o,m,null,h)}}function B2(s){return s=Ph(s),D2(s)}var Jv=null;function D2(s){if(Jv=null,s=at(s),s!==null){var o=r(s);if(o===null)s=null;else{var h=o.tag;if(h===13){if(s=l(o),s!==null)return s;s=null}else if(h===31){if(s=u(o),s!==null)return s;s=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Jv=s,null}function YA(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ae()){case He:return 2;case Ze:return 8;case Le:case Nt:return 32;case xt:return 268435456;default:return 32}default:return 32}}var U2=!1,du=null,pu=null,mu=null,dm=new Map,pm=new Map,gu=[],tB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function qA(s,o){switch(s){case"focusin":case"focusout":du=null;break;case"dragenter":case"dragleave":pu=null;break;case"mouseover":case"mouseout":mu=null;break;case"pointerover":case"pointerout":dm.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":pm.delete(o.pointerId)}}function mm(s,o,h,m,A,T){return s===null||s.nativeEvent!==T?(s={blockedOn:o,domEventName:h,eventSystemFlags:m,nativeEvent:T,targetContainers:[A]},o!==null&&(o=V(o),o!==null&&jA(o)),s):(s.eventSystemFlags|=m,o=s.targetContainers,A!==null&&o.indexOf(A)===-1&&o.push(A),s)}function nB(s,o,h,m,A){switch(o){case"focusin":return du=mm(du,s,o,h,m,A),!0;case"dragenter":return pu=mm(pu,s,o,h,m,A),!0;case"mouseover":return mu=mm(mu,s,o,h,m,A),!0;case"pointerover":var T=A.pointerId;return dm.set(T,mm(dm.get(T)||null,s,o,h,m,A)),!0;case"gotpointercapture":return T=A.pointerId,pm.set(T,mm(pm.get(T)||null,s,o,h,m,A)),!0}return!1}function KA(s){var o=at(s.target);if(o!==null){var h=r(o);if(h!==null){if(o=h.tag,o===13){if(o=l(h),o!==null){s.blockedOn=o,en(s.priority,function(){XA(h)});return}}else if(o===31){if(o=u(h),o!==null){s.blockedOn=o,en(s.priority,function(){XA(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Wv(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var h=B2(s.nativeEvent);if(h===null){h=s.nativeEvent;var m=new h.constructor(h.type,h);tf=m,h.target.dispatchEvent(m),tf=null}else return o=V(h),o!==null&&jA(o),s.blockedOn=h,!1;o.shift()}return!0}function JA(s,o,h){Wv(s)&&h.delete(o)}function iB(){U2=!1,du!==null&&Wv(du)&&(du=null),pu!==null&&Wv(pu)&&(pu=null),mu!==null&&Wv(mu)&&(mu=null),dm.forEach(JA),pm.forEach(JA)}function Zv(s,o){s.blockedOn===o&&(s.blockedOn=null,U2||(U2=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,iB)))}var Qv=null;function WA(s){Qv!==s&&(Qv=s,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Qv===s&&(Qv=null);for(var o=0;o<s.length;o+=3){var h=s[o],m=s[o+1],A=s[o+2];if(typeof m!="function"){if(D2(m||h)===null)continue;break}var T=V(h);T!==null&&(s.splice(o,3),o-=3,Z0(T,{pending:!0,data:A,method:h.method,action:m},m,A))}}))}function Gd(s){function o(ue){return Zv(ue,s)}du!==null&&Zv(du,s),pu!==null&&Zv(pu,s),mu!==null&&Zv(mu,s),dm.forEach(o),pm.forEach(o);for(var h=0;h<gu.length;h++){var m=gu[h];m.blockedOn===s&&(m.blockedOn=null)}for(;0<gu.length&&(h=gu[0],h.blockedOn===null);)KA(h),h.blockedOn===null&&gu.shift();if(h=(s.ownerDocument||s).$$reactFormReplay,h!=null)for(m=0;m<h.length;m+=3){var A=h[m],T=h[m+1],I=A[G]||null;if(typeof T=="function")I||WA(h);else if(I){var Y=null;if(T&&T.hasAttribute("formAction")){if(A=T,I=T[G]||null)Y=I.formAction;else if(D2(A)!==null)continue}else Y=I.action;typeof Y=="function"?h[m+1]=Y:(h.splice(m,3),m-=3),WA(h)}}}function ZA(){function s(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(I){return A=I})},focusReset:"manual",scroll:"manual"})}function o(){A!==null&&(A(),A=null),m||setTimeout(h,20)}function h(){if(!m&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,A=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(h,100),function(){m=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),A!==null&&(A(),A=null)}}}function O2(s){this._internalRoot=s}$v.prototype.render=O2.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(n(409));var h=o.current,m=cs();VA(h,m,s,o,null,null)},$v.prototype.unmount=O2.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;VA(s.current,2,null,s,null,null),J(),o[Z]=null}};function $v(s){this._internalRoot=s}$v.prototype.unstable_scheduleHydration=function(s){if(s){var o=ba();s={blockedOn:null,target:s,priority:o};for(var h=0;h<gu.length&&o!==0&&o<gu[h].priority;h++);gu.splice(h,0,s),h===0&&KA(s)}};var QA=e.version;if(QA!=="19.2.0")throw Error(n(527,QA,"19.2.0"));K.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=p(o),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var aB={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ex=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ex.isDisabled&&ex.supportsFiber)try{Ye=ex.inject(aB),qe=ex}catch{}}return vm.createRoot=function(s,o){if(!a(s))throw Error(n(299));var h=!1,m="",A=tm,T=Uv,I=Md;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(A=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(I=o.onRecoverableError)),o=HA(s,1,!1,null,null,h,m,null,A,T,I,ZA),s[Z]=o.current,p2(s),new O2(o)},vm.hydrateRoot=function(s,o,h){if(!a(s))throw Error(n(299));var m=!1,A="",T=tm,I=Uv,Y=Md,ue=null;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(A=h.identifierPrefix),h.onUncaughtError!==void 0&&(T=h.onUncaughtError),h.onCaughtError!==void 0&&(I=h.onCaughtError),h.onRecoverableError!==void 0&&(Y=h.onRecoverableError),h.formState!==void 0&&(ue=h.formState)),o=HA(s,1,!0,o,h??null,m,A,ue,T,I,Y,ZA),o.context=GA(null),h=o.current,m=cs(),m=ta(m),A=Jr(m),A.callback=null,Co(h,A,m),h=m,o.current.lanes=h,fa(o,h),Dl(o),s[Z]=o.current,p2(s),new $v(o)},vm.version="19.2.0",vm}var lM;function dB(){if(lM)return I2.exports;lM=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),I2.exports=hB(),I2.exports}var pB=dB(),H2={exports:{}},pc={};var cM;function mB(){return cM||(cM=1,pc.ConcurrentRoot=1,pc.ContinuousEventPriority=8,pc.DefaultEventPriority=32,pc.DiscreteEventPriority=2,pc.IdleEventPriority=268435456,pc.LegacyRoot=0,pc.NoEventPriority=0),pc}var uM;function gB(){return uM||(uM=1,H2.exports=mB()),H2.exports}var l_=gB();const Dh="181",vB={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},xB={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},tT=0,vb=1,nT=2,_B=3,iT=0,hy=1,jm=2,jo=3,Wo=0,oa=1,Oi=2,es=0,vh=1,ir=2,xb=3,_b=4,aT=5,Nu=100,sT=101,rT=102,oT=103,lT=104,cT=200,uT=201,fT=202,hT=203,d_=204,p_=205,dT=206,pT=207,mT=208,gT=209,vT=210,xT=211,_T=212,yT=213,bT=214,m_=0,ng=1,g_=2,bh=3,v_=4,x_=5,__=6,y_=7,mg=0,ST=1,AT=2,Jo=0,MT=1,ET=2,TT=3,Yb=4,CT=5,RT=6,wT=7,yb="attached",BT="detached",zu=300,Fl=301,Hu=302,Ep=303,ig=304,zp=306,Gu=1e3,ea=1001,Tp=1002,la=1003,dy=1004,yB=1004,uh=1005,bB=1005,In=1006,bp=1007,SB=1007,fo=1008,bb=1008,ca=1009,py=1010,my=1011,Cp=1012,gg=1013,Zo=1014,ji=1015,wa=1016,gy=1017,vy=1018,Sh=1020,qb=35902,Kb=35899,Jb=1021,Wb=1022,_a=1023,Rp=1026,Ah=1027,vg=1028,xg=1029,xy=1030,_y=1031,AB=1032,yy=1033,Xm=33776,Ym=33777,qm=33778,Km=33779,b_=35840,S_=35841,A_=35842,M_=35843,E_=36196,T_=37492,C_=37496,R_=37808,w_=37809,B_=37810,D_=37811,U_=37812,O_=37813,N_=37814,L_=37815,I_=37816,P_=37817,F_=37818,z_=37819,H_=37820,G_=37821,V_=36492,k_=36494,j_=36495,X_=36283,Y_=36284,q_=36285,K_=36286,Zb=2200,Qb=2201,DT=2202,wp=2300,Bp=2301,c_=2302,fh=2400,hh=2401,ag=2402,by=2500,$b=2501,UT=0,eS=1,J_=2,Yu=3200,OT=3201,MB=3202,EB=3203,qu=0,NT=1,qo="",ti="srgb",Fr="srgb-linear",sg="linear",xi="srgb",TB=0,lh=7680,CB=7681,RB=7682,wB=7683,BB=34055,DB=34056,UB=5386,OB=512,NB=513,LB=514,IB=515,PB=516,FB=517,zB=518,Sb=519,LT=512,IT=513,PT=514,tS=515,FT=516,zT=517,HT=518,GT=519,rg=35044,HB=35048,GB=35040,VB=35045,kB=35049,jB=35041,XB=35046,YB=35050,qB=35042,KB="100",Ab="300 es",Ir=2e3,Dp=2001,JB={COMPUTE:"compute",RENDER:"render"},WB={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},ZB={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function VT(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const QB={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function xp(i,e){return new QB[i](e)}function og(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function kT(){const i=og("canvas");return i.style.display="block",i}const fM={};let Vu=null;function $B(i){Vu=i}function eD(){return Vu}function lg(...i){const e="THREE."+i.shift();Vu?Vu("log",e,...i):console.log(e,...i)}function Mt(...i){const e="THREE."+i.shift();Vu?Vu("warn",e,...i):console.warn(e,...i)}function un(...i){const e="THREE."+i.shift();Vu?Vu("error",e,...i):console.error(e,...i)}function Up(...i){const e=i.join(" ");e in fM||(fM[e]=!0,Mt(...i))}function tD(i,e,t){return new Promise(function(n,a){function r(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:a();break;case i.TIMEOUT_EXPIRED:setTimeout(r,t);break;default:n()}}setTimeout(r,t)})}let Hr=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const a=n[e];if(a!==void 0){const r=a.indexOf(t);r!==-1&&a.splice(r,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const a=n.slice(0);for(let r=0,l=a.length;r<l;r++)a[r].call(this,e);e.target=null}}};const Rs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let hM=1234567;const xh=Math.PI/180,Op=180/Math.PI;function Pr(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Rs[i&255]+Rs[i>>8&255]+Rs[i>>16&255]+Rs[i>>24&255]+"-"+Rs[e&255]+Rs[e>>8&255]+"-"+Rs[e>>16&15|64]+Rs[e>>24&255]+"-"+Rs[t&63|128]+Rs[t>>8&255]+"-"+Rs[t>>16&255]+Rs[t>>24&255]+Rs[n&255]+Rs[n>>8&255]+Rs[n>>16&255]+Rs[n>>24&255]).toLowerCase()}function sn(i,e,t){return Math.max(e,Math.min(t,i))}function nS(i,e){return(i%e+e)%e}function nD(i,e,t,n,a){return n+(i-e)*(a-n)/(t-e)}function iD(i,e,t){return i!==e?(t-i)/(e-i):0}function Jm(i,e,t){return(1-t)*i+t*e}function aD(i,e,t,n){return Jm(i,e,1-Math.exp(-t*n))}function sD(i,e=1){return e-Math.abs(nS(i,e*2)-e)}function rD(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function oD(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function lD(i,e){return i+Math.floor(Math.random()*(e-i+1))}function cD(i,e){return i+Math.random()*(e-i)}function uD(i){return i*(.5-Math.random())}function fD(i){i!==void 0&&(hM=i);let e=hM+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function hD(i){return i*xh}function dD(i){return i*Op}function pD(i){return(i&i-1)===0&&i!==0}function mD(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function gD(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function vD(i,e,t,n,a){const r=Math.cos,l=Math.sin,u=r(t/2),d=l(t/2),p=r((e+n)/2),x=l((e+n)/2),g=r((e-n)/2),_=l((e-n)/2),y=r((n-e)/2),b=l((n-e)/2);switch(a){case"XYX":i.set(u*x,d*g,d*_,u*p);break;case"YZY":i.set(d*_,u*x,d*g,u*p);break;case"ZXZ":i.set(d*g,d*_,u*x,u*p);break;case"XZX":i.set(u*x,d*b,d*y,u*p);break;case"YXY":i.set(d*y,u*x,d*b,u*p);break;case"ZYZ":i.set(d*b,d*y,u*x,u*p);break;default:Mt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}function nr(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function _n(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const iS={DEG2RAD:xh,RAD2DEG:Op,generateUUID:Pr,clamp:sn,euclideanModulo:nS,mapLinear:nD,inverseLerp:iD,lerp:Jm,damp:aD,pingpong:sD,smoothstep:rD,smootherstep:oD,randInt:lD,randFloat:cD,randFloatSpread:uD,seededRandom:fD,degToRad:hD,radToDeg:dD,isPowerOfTwo:pD,ceilPowerOfTwo:mD,floorPowerOfTwo:gD,setQuaternionFromProperEuler:vD,normalize:_n,denormalize:nr};class Ge{constructor(e=0,t=0){Ge.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6],this.y=a[1]*t+a[4]*n+a[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=sn(this.x,e.x,t.x),this.y=sn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=sn(this.x,e,t),this.y=sn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(sn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(sn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),a=Math.sin(t),r=this.x-e.x,l=this.y-e.y;return this.x=r*n-l*a+e.x,this.y=r*a+l*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ts{constructor(e=0,t=0,n=0,a=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=a}static slerpFlat(e,t,n,a,r,l,u){let d=n[a+0],p=n[a+1],x=n[a+2],g=n[a+3],_=r[l+0],y=r[l+1],b=r[l+2],C=r[l+3];if(u<=0){e[t+0]=d,e[t+1]=p,e[t+2]=x,e[t+3]=g;return}if(u>=1){e[t+0]=_,e[t+1]=y,e[t+2]=b,e[t+3]=C;return}if(g!==C||d!==_||p!==y||x!==b){let E=d*_+p*y+x*b+g*C;E<0&&(_=-_,y=-y,b=-b,C=-C,E=-E);let S=1-u;if(E<.9995){const w=Math.acos(E),D=Math.sin(w);S=Math.sin(S*w)/D,u=Math.sin(u*w)/D,d=d*S+_*u,p=p*S+y*u,x=x*S+b*u,g=g*S+C*u}else{d=d*S+_*u,p=p*S+y*u,x=x*S+b*u,g=g*S+C*u;const w=1/Math.sqrt(d*d+p*p+x*x+g*g);d*=w,p*=w,x*=w,g*=w}}e[t]=d,e[t+1]=p,e[t+2]=x,e[t+3]=g}static multiplyQuaternionsFlat(e,t,n,a,r,l){const u=n[a],d=n[a+1],p=n[a+2],x=n[a+3],g=r[l],_=r[l+1],y=r[l+2],b=r[l+3];return e[t]=u*b+x*g+d*y-p*_,e[t+1]=d*b+x*_+p*g-u*y,e[t+2]=p*b+x*y+u*_-d*g,e[t+3]=x*b-u*g-d*_-p*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,a){return this._x=e,this._y=t,this._z=n,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,a=e._y,r=e._z,l=e._order,u=Math.cos,d=Math.sin,p=u(n/2),x=u(a/2),g=u(r/2),_=d(n/2),y=d(a/2),b=d(r/2);switch(l){case"XYZ":this._x=_*x*g+p*y*b,this._y=p*y*g-_*x*b,this._z=p*x*b+_*y*g,this._w=p*x*g-_*y*b;break;case"YXZ":this._x=_*x*g+p*y*b,this._y=p*y*g-_*x*b,this._z=p*x*b-_*y*g,this._w=p*x*g+_*y*b;break;case"ZXY":this._x=_*x*g-p*y*b,this._y=p*y*g+_*x*b,this._z=p*x*b+_*y*g,this._w=p*x*g-_*y*b;break;case"ZYX":this._x=_*x*g-p*y*b,this._y=p*y*g+_*x*b,this._z=p*x*b-_*y*g,this._w=p*x*g+_*y*b;break;case"YZX":this._x=_*x*g+p*y*b,this._y=p*y*g+_*x*b,this._z=p*x*b-_*y*g,this._w=p*x*g-_*y*b;break;case"XZY":this._x=_*x*g-p*y*b,this._y=p*y*g-_*x*b,this._z=p*x*b+_*y*g,this._w=p*x*g+_*y*b;break;default:Mt("Quaternion: .setFromEuler() encountered an unknown order: "+l)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,a=Math.sin(n);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],a=t[4],r=t[8],l=t[1],u=t[5],d=t[9],p=t[2],x=t[6],g=t[10],_=n+u+g;if(_>0){const y=.5/Math.sqrt(_+1);this._w=.25/y,this._x=(x-d)*y,this._y=(r-p)*y,this._z=(l-a)*y}else if(n>u&&n>g){const y=2*Math.sqrt(1+n-u-g);this._w=(x-d)/y,this._x=.25*y,this._y=(a+l)/y,this._z=(r+p)/y}else if(u>g){const y=2*Math.sqrt(1+u-n-g);this._w=(r-p)/y,this._x=(a+l)/y,this._y=.25*y,this._z=(d+x)/y}else{const y=2*Math.sqrt(1+g-n-u);this._w=(l-a)/y,this._x=(r+p)/y,this._y=(d+x)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(sn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const a=Math.min(1,t/n);return this.slerp(e,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,a=e._y,r=e._z,l=e._w,u=t._x,d=t._y,p=t._z,x=t._w;return this._x=n*x+l*u+a*p-r*d,this._y=a*x+l*d+r*u-n*p,this._z=r*x+l*p+n*d-a*u,this._w=l*x-n*u-a*d-r*p,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,a=e._y,r=e._z,l=e._w,u=this.dot(e);u<0&&(n=-n,a=-a,r=-r,l=-l,u=-u);let d=1-t;if(u<.9995){const p=Math.acos(u),x=Math.sin(p);d=Math.sin(d*p)/x,t=Math.sin(t*p)/x,this._x=this._x*d+n*t,this._y=this._y*d+a*t,this._z=this._z*d+r*t,this._w=this._w*d+l*t,this._onChangeCallback()}else this._x=this._x*d+n*t,this._y=this._y*d+a*t,this._z=this._z*d+r*t,this._w=this._w*d+l*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),a=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(a*Math.sin(e),a*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class te{constructor(e=0,t=0,n=0){te.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(dM.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(dM.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*a,this.y=r[1]*t+r[4]*n+r[7]*a,this.z=r[2]*t+r[5]*n+r[8]*a,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,a=this.z,r=e.elements,l=1/(r[3]*t+r[7]*n+r[11]*a+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*a+r[12])*l,this.y=(r[1]*t+r[5]*n+r[9]*a+r[13])*l,this.z=(r[2]*t+r[6]*n+r[10]*a+r[14])*l,this}applyQuaternion(e){const t=this.x,n=this.y,a=this.z,r=e.x,l=e.y,u=e.z,d=e.w,p=2*(l*a-u*n),x=2*(u*t-r*a),g=2*(r*n-l*t);return this.x=t+d*p+l*g-u*x,this.y=n+d*x+u*p-r*g,this.z=a+d*g+r*x-l*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*a,this.y=r[1]*t+r[5]*n+r[9]*a,this.z=r[2]*t+r[6]*n+r[10]*a,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=sn(this.x,e.x,t.x),this.y=sn(this.y,e.y,t.y),this.z=sn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=sn(this.x,e,t),this.y=sn(this.y,e,t),this.z=sn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(sn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,a=e.y,r=e.z,l=t.x,u=t.y,d=t.z;return this.x=a*d-r*u,this.y=r*l-n*d,this.z=n*u-a*l,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return G2.copy(this).projectOnVector(e),this.sub(G2)}reflect(e){return this.sub(G2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(sn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,a=this.z-e.z;return t*t+n*n+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const a=Math.sin(t)*e;return this.x=a*Math.sin(n),this.y=Math.cos(t)*e,this.z=a*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),a=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=a,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const G2=new te,dM=new ts;class vn{constructor(e,t,n,a,r,l,u,d,p){vn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,a,r,l,u,d,p)}set(e,t,n,a,r,l,u,d,p){const x=this.elements;return x[0]=e,x[1]=a,x[2]=u,x[3]=t,x[4]=r,x[5]=d,x[6]=n,x[7]=l,x[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,a=t.elements,r=this.elements,l=n[0],u=n[3],d=n[6],p=n[1],x=n[4],g=n[7],_=n[2],y=n[5],b=n[8],C=a[0],E=a[3],S=a[6],w=a[1],D=a[4],U=a[7],F=a[2],N=a[5],z=a[8];return r[0]=l*C+u*w+d*F,r[3]=l*E+u*D+d*N,r[6]=l*S+u*U+d*z,r[1]=p*C+x*w+g*F,r[4]=p*E+x*D+g*N,r[7]=p*S+x*U+g*z,r[2]=_*C+y*w+b*F,r[5]=_*E+y*D+b*N,r[8]=_*S+y*U+b*z,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],a=e[2],r=e[3],l=e[4],u=e[5],d=e[6],p=e[7],x=e[8];return t*l*x-t*u*p-n*r*x+n*u*d+a*r*p-a*l*d}invert(){const e=this.elements,t=e[0],n=e[1],a=e[2],r=e[3],l=e[4],u=e[5],d=e[6],p=e[7],x=e[8],g=x*l-u*p,_=u*d-x*r,y=p*r-l*d,b=t*g+n*_+a*y;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);const C=1/b;return e[0]=g*C,e[1]=(a*p-x*n)*C,e[2]=(u*n-a*l)*C,e[3]=_*C,e[4]=(x*t-a*d)*C,e[5]=(a*r-u*t)*C,e[6]=y*C,e[7]=(n*d-p*t)*C,e[8]=(l*t-n*r)*C,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,a,r,l,u){const d=Math.cos(r),p=Math.sin(r);return this.set(n*d,n*p,-n*(d*l+p*u)+l+e,-a*p,a*d,-a*(-p*l+d*u)+u+t,0,0,1),this}scale(e,t){return this.premultiply(V2.makeScale(e,t)),this}rotate(e){return this.premultiply(V2.makeRotation(-e)),this}translate(e,t){return this.premultiply(V2.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let a=0;a<9;a++)if(t[a]!==n[a])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const V2=new vn,pM=new vn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),mM=new vn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function xD(){const i={enabled:!0,workingColorSpace:Fr,spaces:{},convert:function(a,r,l){return this.enabled===!1||r===l||!r||!l||(this.spaces[r].transfer===xi&&(a.r=Bc(a.r),a.g=Bc(a.g),a.b=Bc(a.b)),this.spaces[r].primaries!==this.spaces[l].primaries&&(a.applyMatrix3(this.spaces[r].toXYZ),a.applyMatrix3(this.spaces[l].fromXYZ)),this.spaces[l].transfer===xi&&(a.r=Sp(a.r),a.g=Sp(a.g),a.b=Sp(a.b))),a},workingToColorSpace:function(a,r){return this.convert(a,this.workingColorSpace,r)},colorSpaceToWorking:function(a,r){return this.convert(a,r,this.workingColorSpace)},getPrimaries:function(a){return this.spaces[a].primaries},getTransfer:function(a){return a===qo?sg:this.spaces[a].transfer},getToneMappingMode:function(a){return this.spaces[a].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(a,r=this.workingColorSpace){return a.fromArray(this.spaces[r].luminanceCoefficients)},define:function(a){Object.assign(this.spaces,a)},_getMatrix:function(a,r,l){return a.copy(this.spaces[r].toXYZ).multiply(this.spaces[l].fromXYZ)},_getDrawingBufferColorSpace:function(a){return this.spaces[a].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(a=this.workingColorSpace){return this.spaces[a].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(a,r){return Up("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(a,r)},toWorkingColorSpace:function(a,r){return Up("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(a,r)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[Fr]:{primaries:e,whitePoint:n,transfer:sg,toXYZ:pM,fromXYZ:mM,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:ti},outputColorSpaceConfig:{drawingBufferColorSpace:ti}},[ti]:{primaries:e,whitePoint:n,transfer:xi,toXYZ:pM,fromXYZ:mM,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:ti}}}),i}const Wn=xD();function Bc(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Sp(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let Vd;class jT{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Vd===void 0&&(Vd=og("canvas")),Vd.width=e.width,Vd.height=e.height;const a=Vd.getContext("2d");e instanceof ImageData?a.putImageData(e,0,0):a.drawImage(e,0,0,e.width,e.height),n=Vd}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=og("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const a=n.getImageData(0,0,e.width,e.height),r=a.data;for(let l=0;l<r.length;l++)r[l]=Bc(r[l]/255)*255;return n.putImageData(a,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Bc(t[n]/255)*255):t[n]=Bc(t[n]);return{data:t,width:e.width,height:e.height}}else return Mt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let _D=0;class Lu{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_D++}),this.uuid=Pr(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},a=this.data;if(a!==null){let r;if(Array.isArray(a)){r=[];for(let l=0,u=a.length;l<u;l++)a[l].isDataTexture?r.push(k2(a[l].image)):r.push(k2(a[l]))}else r=k2(a);n.url=r}return t||(e.images[this.uuid]=n),n}}function k2(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?jT.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(Mt("Texture: Unable to serialize Texture."),{})}let yD=0;const j2=new te;class ui extends Hr{constructor(e=ui.DEFAULT_IMAGE,t=ui.DEFAULT_MAPPING,n=ea,a=ea,r=In,l=fo,u=_a,d=ca,p=ui.DEFAULT_ANISOTROPY,x=qo){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:yD++}),this.uuid=Pr(),this.name="",this.source=new Lu(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=a,this.magFilter=r,this.minFilter=l,this.anisotropy=p,this.format=u,this.internalFormat=null,this.type=d,this.offset=new Ge(0,0),this.repeat=new Ge(1,1),this.center=new Ge(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new vn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=x,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(j2).x}get height(){return this.source.getSize(j2).y}get depth(){return this.source.getSize(j2).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){Mt(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const a=this[t];if(a===void 0){Mt(`Texture.setValues(): property '${t}' does not exist.`);continue}a&&n&&a.isVector2&&n.isVector2||a&&n&&a.isVector3&&n.isVector3||a&&n&&a.isMatrix3&&n.isMatrix3?a.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==zu)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Gu:e.x=e.x-Math.floor(e.x);break;case ea:e.x=e.x<0?0:1;break;case Tp:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Gu:e.y=e.y-Math.floor(e.y);break;case ea:e.y=e.y<0?0:1;break;case Tp:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ui.DEFAULT_IMAGE=null;ui.DEFAULT_MAPPING=zu;ui.DEFAULT_ANISOTROPY=1;class kn{constructor(e=0,t=0,n=0,a=1){kn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=a}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,a){return this.x=e,this.y=t,this.z=n,this.w=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,a=this.z,r=this.w,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*a+l[12]*r,this.y=l[1]*t+l[5]*n+l[9]*a+l[13]*r,this.z=l[2]*t+l[6]*n+l[10]*a+l[14]*r,this.w=l[3]*t+l[7]*n+l[11]*a+l[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,a,r;const d=e.elements,p=d[0],x=d[4],g=d[8],_=d[1],y=d[5],b=d[9],C=d[2],E=d[6],S=d[10];if(Math.abs(x-_)<.01&&Math.abs(g-C)<.01&&Math.abs(b-E)<.01){if(Math.abs(x+_)<.1&&Math.abs(g+C)<.1&&Math.abs(b+E)<.1&&Math.abs(p+y+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const D=(p+1)/2,U=(y+1)/2,F=(S+1)/2,N=(x+_)/4,z=(g+C)/4,j=(b+E)/4;return D>U&&D>F?D<.01?(n=0,a=.707106781,r=.707106781):(n=Math.sqrt(D),a=N/n,r=z/n):U>F?U<.01?(n=.707106781,a=0,r=.707106781):(a=Math.sqrt(U),n=N/a,r=j/a):F<.01?(n=.707106781,a=.707106781,r=0):(r=Math.sqrt(F),n=z/r,a=j/r),this.set(n,a,r,t),this}let w=Math.sqrt((E-b)*(E-b)+(g-C)*(g-C)+(_-x)*(_-x));return Math.abs(w)<.001&&(w=1),this.x=(E-b)/w,this.y=(g-C)/w,this.z=(_-x)/w,this.w=Math.acos((p+y+S-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=sn(this.x,e.x,t.x),this.y=sn(this.y,e.y,t.y),this.z=sn(this.z,e.z,t.z),this.w=sn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=sn(this.x,e,t),this.y=sn(this.y,e,t),this.z=sn(this.z,e,t),this.w=sn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(sn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class aS extends Hr{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:In,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new kn(0,0,e,t),this.scissorTest=!1,this.viewport=new kn(0,0,e,t);const a={width:e,height:t,depth:n.depth},r=new ui(a);this.textures=[];const l=n.count;for(let u=0;u<l;u++)this.textures[u]=r.clone(),this.textures[u].isRenderTargetTexture=!0,this.textures[u].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:In,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let a=0,r=this.textures.length;a<r;a++)this.textures[a].image.width=e,this.textures[a].image.height=t,this.textures[a].image.depth=n,this.textures[a].isData3DTexture!==!0&&(this.textures[a].isArrayTexture=this.textures[a].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const a=Object.assign({},e.textures[t].image);this.textures[t].source=new Lu(a)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ua extends aS{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Sy extends ui{constructor(e=null,t=1,n=1,a=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:a},this.magFilter=la,this.minFilter=la,this.wrapR=ea,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class bD extends ua{constructor(e=1,t=1,n=1,a={}){super(e,t,a),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Sy(null,e,t,n),this._setTextureOptions(a),this.texture.isRenderTargetTexture=!0}}class Ay extends ui{constructor(e=null,t=1,n=1,a=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:a},this.magFilter=la,this.minFilter=la,this.wrapR=ea,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class SD extends ua{constructor(e=1,t=1,n=1,a={}){super(e,t,a),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Ay(null,e,t,n),this._setTextureOptions(a),this.texture.isRenderTargetTexture=!0}}class ns{constructor(e=new te(1/0,1/0,1/0),t=new te(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(zo.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(zo.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=zo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let l=0,u=r.count;l<u;l++)e.isMesh===!0?e.getVertexPosition(l,zo):zo.fromBufferAttribute(r,l),zo.applyMatrix4(e.matrixWorld),this.expandByPoint(zo);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),tx.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),tx.copy(n.boundingBox)),tx.applyMatrix4(e.matrixWorld),this.union(tx)}const a=e.children;for(let r=0,l=a.length;r<l;r++)this.expandByObject(a[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,zo),zo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(xm),nx.subVectors(this.max,xm),kd.subVectors(e.a,xm),jd.subVectors(e.b,xm),Xd.subVectors(e.c,xm),xu.subVectors(jd,kd),_u.subVectors(Xd,jd),jf.subVectors(kd,Xd);let t=[0,-xu.z,xu.y,0,-_u.z,_u.y,0,-jf.z,jf.y,xu.z,0,-xu.x,_u.z,0,-_u.x,jf.z,0,-jf.x,-xu.y,xu.x,0,-_u.y,_u.x,0,-jf.y,jf.x,0];return!X2(t,kd,jd,Xd,nx)||(t=[1,0,0,0,1,0,0,0,1],!X2(t,kd,jd,Xd,nx))?!1:(ix.crossVectors(xu,_u),t=[ix.x,ix.y,ix.z],X2(t,kd,jd,Xd,nx))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,zo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(zo).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(mc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),mc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),mc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),mc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),mc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),mc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),mc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),mc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(mc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const mc=[new te,new te,new te,new te,new te,new te,new te,new te],zo=new te,tx=new ns,kd=new te,jd=new te,Xd=new te,xu=new te,_u=new te,jf=new te,xm=new te,nx=new te,ix=new te,Xf=new te;function X2(i,e,t,n,a){for(let r=0,l=i.length-3;r<=l;r+=3){Xf.fromArray(i,r);const u=a.x*Math.abs(Xf.x)+a.y*Math.abs(Xf.y)+a.z*Math.abs(Xf.z),d=e.dot(Xf),p=t.dot(Xf),x=n.dot(Xf);if(Math.max(-Math.max(d,p,x),Math.min(d,p,x))>u)return!1}return!0}const AD=new ns,_m=new te,Y2=new te;class za{constructor(e=new te,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):AD.setFromPoints(e).getCenter(n);let a=0;for(let r=0,l=e.length;r<l;r++)a=Math.max(a,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(a),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_m.subVectors(e,this.center);const t=_m.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),a=(n-this.radius)*.5;this.center.addScaledVector(_m,a/n),this.radius+=a}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Y2.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_m.copy(e.center).add(Y2)),this.expandByPoint(_m.copy(e.center).sub(Y2))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const gc=new te,q2=new te,ax=new te,yu=new te,K2=new te,sx=new te,J2=new te;class Hp{constructor(e=new te,t=new te(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,gc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=gc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(gc.copy(this.origin).addScaledVector(this.direction,t),gc.distanceToSquared(e))}distanceSqToSegment(e,t,n,a){q2.copy(e).add(t).multiplyScalar(.5),ax.copy(t).sub(e).normalize(),yu.copy(this.origin).sub(q2);const r=e.distanceTo(t)*.5,l=-this.direction.dot(ax),u=yu.dot(this.direction),d=-yu.dot(ax),p=yu.lengthSq(),x=Math.abs(1-l*l);let g,_,y,b;if(x>0)if(g=l*d-u,_=l*u-d,b=r*x,g>=0)if(_>=-b)if(_<=b){const C=1/x;g*=C,_*=C,y=g*(g+l*_+2*u)+_*(l*g+_+2*d)+p}else _=r,g=Math.max(0,-(l*_+u)),y=-g*g+_*(_+2*d)+p;else _=-r,g=Math.max(0,-(l*_+u)),y=-g*g+_*(_+2*d)+p;else _<=-b?(g=Math.max(0,-(-l*r+u)),_=g>0?-r:Math.min(Math.max(-r,-d),r),y=-g*g+_*(_+2*d)+p):_<=b?(g=0,_=Math.min(Math.max(-r,-d),r),y=_*(_+2*d)+p):(g=Math.max(0,-(l*r+u)),_=g>0?r:Math.min(Math.max(-r,-d),r),y=-g*g+_*(_+2*d)+p);else _=l>0?-r:r,g=Math.max(0,-(l*_+u)),y=-g*g+_*(_+2*d)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,g),a&&a.copy(q2).addScaledVector(ax,_),y}intersectSphere(e,t){gc.subVectors(e.center,this.origin);const n=gc.dot(this.direction),a=gc.dot(gc)-n*n,r=e.radius*e.radius;if(a>r)return null;const l=Math.sqrt(r-a),u=n-l,d=n+l;return d<0?null:u<0?this.at(d,t):this.at(u,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,a,r,l,u,d;const p=1/this.direction.x,x=1/this.direction.y,g=1/this.direction.z,_=this.origin;return p>=0?(n=(e.min.x-_.x)*p,a=(e.max.x-_.x)*p):(n=(e.max.x-_.x)*p,a=(e.min.x-_.x)*p),x>=0?(r=(e.min.y-_.y)*x,l=(e.max.y-_.y)*x):(r=(e.max.y-_.y)*x,l=(e.min.y-_.y)*x),n>l||r>a||((r>n||isNaN(n))&&(n=r),(l<a||isNaN(a))&&(a=l),g>=0?(u=(e.min.z-_.z)*g,d=(e.max.z-_.z)*g):(u=(e.max.z-_.z)*g,d=(e.min.z-_.z)*g),n>d||u>a)||((u>n||n!==n)&&(n=u),(d<a||a!==a)&&(a=d),a<0)?null:this.at(n>=0?n:a,t)}intersectsBox(e){return this.intersectBox(e,gc)!==null}intersectTriangle(e,t,n,a,r){K2.subVectors(t,e),sx.subVectors(n,e),J2.crossVectors(K2,sx);let l=this.direction.dot(J2),u;if(l>0){if(a)return null;u=1}else if(l<0)u=-1,l=-l;else return null;yu.subVectors(this.origin,e);const d=u*this.direction.dot(sx.crossVectors(yu,sx));if(d<0)return null;const p=u*this.direction.dot(K2.cross(yu));if(p<0||d+p>l)return null;const x=-u*yu.dot(J2);return x<0?null:this.at(x/l,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Wt{constructor(e,t,n,a,r,l,u,d,p,x,g,_,y,b,C,E){Wt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,a,r,l,u,d,p,x,g,_,y,b,C,E)}set(e,t,n,a,r,l,u,d,p,x,g,_,y,b,C,E){const S=this.elements;return S[0]=e,S[4]=t,S[8]=n,S[12]=a,S[1]=r,S[5]=l,S[9]=u,S[13]=d,S[2]=p,S[6]=x,S[10]=g,S[14]=_,S[3]=y,S[7]=b,S[11]=C,S[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Wt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,a=1/Yd.setFromMatrixColumn(e,0).length(),r=1/Yd.setFromMatrixColumn(e,1).length(),l=1/Yd.setFromMatrixColumn(e,2).length();return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*l,t[9]=n[9]*l,t[10]=n[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,a=e.y,r=e.z,l=Math.cos(n),u=Math.sin(n),d=Math.cos(a),p=Math.sin(a),x=Math.cos(r),g=Math.sin(r);if(e.order==="XYZ"){const _=l*x,y=l*g,b=u*x,C=u*g;t[0]=d*x,t[4]=-d*g,t[8]=p,t[1]=y+b*p,t[5]=_-C*p,t[9]=-u*d,t[2]=C-_*p,t[6]=b+y*p,t[10]=l*d}else if(e.order==="YXZ"){const _=d*x,y=d*g,b=p*x,C=p*g;t[0]=_+C*u,t[4]=b*u-y,t[8]=l*p,t[1]=l*g,t[5]=l*x,t[9]=-u,t[2]=y*u-b,t[6]=C+_*u,t[10]=l*d}else if(e.order==="ZXY"){const _=d*x,y=d*g,b=p*x,C=p*g;t[0]=_-C*u,t[4]=-l*g,t[8]=b+y*u,t[1]=y+b*u,t[5]=l*x,t[9]=C-_*u,t[2]=-l*p,t[6]=u,t[10]=l*d}else if(e.order==="ZYX"){const _=l*x,y=l*g,b=u*x,C=u*g;t[0]=d*x,t[4]=b*p-y,t[8]=_*p+C,t[1]=d*g,t[5]=C*p+_,t[9]=y*p-b,t[2]=-p,t[6]=u*d,t[10]=l*d}else if(e.order==="YZX"){const _=l*d,y=l*p,b=u*d,C=u*p;t[0]=d*x,t[4]=C-_*g,t[8]=b*g+y,t[1]=g,t[5]=l*x,t[9]=-u*x,t[2]=-p*x,t[6]=y*g+b,t[10]=_-C*g}else if(e.order==="XZY"){const _=l*d,y=l*p,b=u*d,C=u*p;t[0]=d*x,t[4]=-g,t[8]=p*x,t[1]=_*g+C,t[5]=l*x,t[9]=y*g-b,t[2]=b*g-y,t[6]=u*x,t[10]=C*g+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(MD,e,ED)}lookAt(e,t,n){const a=this.elements;return Ur.subVectors(e,t),Ur.lengthSq()===0&&(Ur.z=1),Ur.normalize(),bu.crossVectors(n,Ur),bu.lengthSq()===0&&(Math.abs(n.z)===1?Ur.x+=1e-4:Ur.z+=1e-4,Ur.normalize(),bu.crossVectors(n,Ur)),bu.normalize(),rx.crossVectors(Ur,bu),a[0]=bu.x,a[4]=rx.x,a[8]=Ur.x,a[1]=bu.y,a[5]=rx.y,a[9]=Ur.y,a[2]=bu.z,a[6]=rx.z,a[10]=Ur.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,a=t.elements,r=this.elements,l=n[0],u=n[4],d=n[8],p=n[12],x=n[1],g=n[5],_=n[9],y=n[13],b=n[2],C=n[6],E=n[10],S=n[14],w=n[3],D=n[7],U=n[11],F=n[15],N=a[0],z=a[4],j=a[8],L=a[12],P=a[1],q=a[5],ie=a[9],se=a[13],ae=a[2],re=a[6],H=a[10],K=a[14],W=a[3],me=a[7],ve=a[11],Q=a[15];return r[0]=l*N+u*P+d*ae+p*W,r[4]=l*z+u*q+d*re+p*me,r[8]=l*j+u*ie+d*H+p*ve,r[12]=l*L+u*se+d*K+p*Q,r[1]=x*N+g*P+_*ae+y*W,r[5]=x*z+g*q+_*re+y*me,r[9]=x*j+g*ie+_*H+y*ve,r[13]=x*L+g*se+_*K+y*Q,r[2]=b*N+C*P+E*ae+S*W,r[6]=b*z+C*q+E*re+S*me,r[10]=b*j+C*ie+E*H+S*ve,r[14]=b*L+C*se+E*K+S*Q,r[3]=w*N+D*P+U*ae+F*W,r[7]=w*z+D*q+U*re+F*me,r[11]=w*j+D*ie+U*H+F*ve,r[15]=w*L+D*se+U*K+F*Q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],a=e[8],r=e[12],l=e[1],u=e[5],d=e[9],p=e[13],x=e[2],g=e[6],_=e[10],y=e[14],b=e[3],C=e[7],E=e[11],S=e[15];return b*(+r*d*g-a*p*g-r*u*_+n*p*_+a*u*y-n*d*y)+C*(+t*d*y-t*p*_+r*l*_-a*l*y+a*p*x-r*d*x)+E*(+t*p*g-t*u*y-r*l*g+n*l*y+r*u*x-n*p*x)+S*(-a*u*x-t*d*g+t*u*_+a*l*g-n*l*_+n*d*x)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const a=this.elements;return e.isVector3?(a[12]=e.x,a[13]=e.y,a[14]=e.z):(a[12]=e,a[13]=t,a[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],a=e[2],r=e[3],l=e[4],u=e[5],d=e[6],p=e[7],x=e[8],g=e[9],_=e[10],y=e[11],b=e[12],C=e[13],E=e[14],S=e[15],w=g*E*p-C*_*p+C*d*y-u*E*y-g*d*S+u*_*S,D=b*_*p-x*E*p-b*d*y+l*E*y+x*d*S-l*_*S,U=x*C*p-b*g*p+b*u*y-l*C*y-x*u*S+l*g*S,F=b*g*d-x*C*d-b*u*_+l*C*_+x*u*E-l*g*E,N=t*w+n*D+a*U+r*F;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const z=1/N;return e[0]=w*z,e[1]=(C*_*r-g*E*r-C*a*y+n*E*y+g*a*S-n*_*S)*z,e[2]=(u*E*r-C*d*r+C*a*p-n*E*p-u*a*S+n*d*S)*z,e[3]=(g*d*r-u*_*r-g*a*p+n*_*p+u*a*y-n*d*y)*z,e[4]=D*z,e[5]=(x*E*r-b*_*r+b*a*y-t*E*y-x*a*S+t*_*S)*z,e[6]=(b*d*r-l*E*r-b*a*p+t*E*p+l*a*S-t*d*S)*z,e[7]=(l*_*r-x*d*r+x*a*p-t*_*p-l*a*y+t*d*y)*z,e[8]=U*z,e[9]=(b*g*r-x*C*r-b*n*y+t*C*y+x*n*S-t*g*S)*z,e[10]=(l*C*r-b*u*r+b*n*p-t*C*p-l*n*S+t*u*S)*z,e[11]=(x*u*r-l*g*r-x*n*p+t*g*p+l*n*y-t*u*y)*z,e[12]=F*z,e[13]=(x*C*a-b*g*a+b*n*_-t*C*_-x*n*E+t*g*E)*z,e[14]=(b*u*a-l*C*a-b*n*d+t*C*d+l*n*E-t*u*E)*z,e[15]=(l*g*a-x*u*a+x*n*d-t*g*d-l*n*_+t*u*_)*z,this}scale(e){const t=this.elements,n=e.x,a=e.y,r=e.z;return t[0]*=n,t[4]*=a,t[8]*=r,t[1]*=n,t[5]*=a,t[9]*=r,t[2]*=n,t[6]*=a,t[10]*=r,t[3]*=n,t[7]*=a,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],a=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,a))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),a=Math.sin(t),r=1-n,l=e.x,u=e.y,d=e.z,p=r*l,x=r*u;return this.set(p*l+n,p*u-a*d,p*d+a*u,0,p*u+a*d,x*u+n,x*d-a*l,0,p*d-a*u,x*d+a*l,r*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,a,r,l){return this.set(1,n,r,0,e,1,l,0,t,a,1,0,0,0,0,1),this}compose(e,t,n){const a=this.elements,r=t._x,l=t._y,u=t._z,d=t._w,p=r+r,x=l+l,g=u+u,_=r*p,y=r*x,b=r*g,C=l*x,E=l*g,S=u*g,w=d*p,D=d*x,U=d*g,F=n.x,N=n.y,z=n.z;return a[0]=(1-(C+S))*F,a[1]=(y+U)*F,a[2]=(b-D)*F,a[3]=0,a[4]=(y-U)*N,a[5]=(1-(_+S))*N,a[6]=(E+w)*N,a[7]=0,a[8]=(b+D)*z,a[9]=(E-w)*z,a[10]=(1-(_+C))*z,a[11]=0,a[12]=e.x,a[13]=e.y,a[14]=e.z,a[15]=1,this}decompose(e,t,n){const a=this.elements;let r=Yd.set(a[0],a[1],a[2]).length();const l=Yd.set(a[4],a[5],a[6]).length(),u=Yd.set(a[8],a[9],a[10]).length();this.determinant()<0&&(r=-r),e.x=a[12],e.y=a[13],e.z=a[14],Ho.copy(this);const p=1/r,x=1/l,g=1/u;return Ho.elements[0]*=p,Ho.elements[1]*=p,Ho.elements[2]*=p,Ho.elements[4]*=x,Ho.elements[5]*=x,Ho.elements[6]*=x,Ho.elements[8]*=g,Ho.elements[9]*=g,Ho.elements[10]*=g,t.setFromRotationMatrix(Ho),n.x=r,n.y=l,n.z=u,this}makePerspective(e,t,n,a,r,l,u=Ir,d=!1){const p=this.elements,x=2*r/(t-e),g=2*r/(n-a),_=(t+e)/(t-e),y=(n+a)/(n-a);let b,C;if(d)b=r/(l-r),C=l*r/(l-r);else if(u===Ir)b=-(l+r)/(l-r),C=-2*l*r/(l-r);else if(u===Dp)b=-l/(l-r),C=-l*r/(l-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return p[0]=x,p[4]=0,p[8]=_,p[12]=0,p[1]=0,p[5]=g,p[9]=y,p[13]=0,p[2]=0,p[6]=0,p[10]=b,p[14]=C,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,n,a,r,l,u=Ir,d=!1){const p=this.elements,x=2/(t-e),g=2/(n-a),_=-(t+e)/(t-e),y=-(n+a)/(n-a);let b,C;if(d)b=1/(l-r),C=l/(l-r);else if(u===Ir)b=-2/(l-r),C=-(l+r)/(l-r);else if(u===Dp)b=-1/(l-r),C=-r/(l-r);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return p[0]=x,p[4]=0,p[8]=0,p[12]=_,p[1]=0,p[5]=g,p[9]=0,p[13]=y,p[2]=0,p[6]=0,p[10]=b,p[14]=C,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let a=0;a<16;a++)if(t[a]!==n[a])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Yd=new te,Ho=new Wt,MD=new te(0,0,0),ED=new te(1,1,1),bu=new te,rx=new te,Ur=new te,gM=new Wt,vM=new ts;class zr{constructor(e=0,t=0,n=0,a=zr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=a}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,a=this._order){return this._x=e,this._y=t,this._z=n,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const a=e.elements,r=a[0],l=a[4],u=a[8],d=a[1],p=a[5],x=a[9],g=a[2],_=a[6],y=a[10];switch(t){case"XYZ":this._y=Math.asin(sn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-x,y),this._z=Math.atan2(-l,r)):(this._x=Math.atan2(_,p),this._z=0);break;case"YXZ":this._x=Math.asin(-sn(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(u,y),this._z=Math.atan2(d,p)):(this._y=Math.atan2(-g,r),this._z=0);break;case"ZXY":this._x=Math.asin(sn(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-g,y),this._z=Math.atan2(-l,p)):(this._y=0,this._z=Math.atan2(d,r));break;case"ZYX":this._y=Math.asin(-sn(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(_,y),this._z=Math.atan2(d,r)):(this._x=0,this._z=Math.atan2(-l,p));break;case"YZX":this._z=Math.asin(sn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-x,p),this._y=Math.atan2(-g,r)):(this._x=0,this._y=Math.atan2(u,y));break;case"XZY":this._z=Math.asin(-sn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(_,p),this._y=Math.atan2(u,r)):(this._x=Math.atan2(-x,y),this._y=0);break;default:Mt("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return gM.makeRotationFromQuaternion(e),this.setFromRotationMatrix(gM,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return vM.setFromEuler(this),this.setFromQuaternion(vM,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}zr.DEFAULT_ORDER="XYZ";class Np{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let TD=0;const xM=new te,qd=new ts,vc=new Wt,ox=new te,ym=new te,CD=new te,RD=new ts,_M=new te(1,0,0),yM=new te(0,1,0),bM=new te(0,0,1),SM={type:"added"},wD={type:"removed"},Kd={type:"childadded",child:null},W2={type:"childremoved",child:null};class Pn extends Hr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:TD++}),this.uuid=Pr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Pn.DEFAULT_UP.clone();const e=new te,t=new zr,n=new ts,a=new te(1,1,1);function r(){n.setFromEuler(t,!1)}function l(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Wt},normalMatrix:{value:new vn}}),this.matrix=new Wt,this.matrixWorld=new Wt,this.matrixAutoUpdate=Pn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Pn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Np,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return qd.setFromAxisAngle(e,t),this.quaternion.multiply(qd),this}rotateOnWorldAxis(e,t){return qd.setFromAxisAngle(e,t),this.quaternion.premultiply(qd),this}rotateX(e){return this.rotateOnAxis(_M,e)}rotateY(e){return this.rotateOnAxis(yM,e)}rotateZ(e){return this.rotateOnAxis(bM,e)}translateOnAxis(e,t){return xM.copy(e).applyQuaternion(this.quaternion),this.position.add(xM.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(_M,e)}translateY(e){return this.translateOnAxis(yM,e)}translateZ(e){return this.translateOnAxis(bM,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(vc.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ox.copy(e):ox.set(e,t,n);const a=this.parent;this.updateWorldMatrix(!0,!1),ym.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?vc.lookAt(ym,ox,this.up):vc.lookAt(ox,ym,this.up),this.quaternion.setFromRotationMatrix(vc),a&&(vc.extractRotation(a.matrixWorld),qd.setFromRotationMatrix(vc),this.quaternion.premultiply(qd.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(un("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(SM),Kd.child=e,this.dispatchEvent(Kd),Kd.child=null):un("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(wD),W2.child=e,this.dispatchEvent(W2),W2.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),vc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),vc.multiply(e.parent.matrixWorld)),e.applyMatrix4(vc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(SM),Kd.child=e,this.dispatchEvent(Kd),Kd.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,a=this.children.length;n<a;n++){const l=this.children[n].getObjectByProperty(e,t);if(l!==void 0)return l}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const a=this.children;for(let r=0,l=a.length;r<l;r++)a[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ym,e,CD),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ym,RD,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,a=t.length;n<a;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,a=t.length;n<a;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,a=t.length;n<a;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const a=this.children;for(let r=0,l=a.length;r<l;r++)a[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(a.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(a.type="BatchedMesh",a.perObjectFrustumCulled=this.perObjectFrustumCulled,a.sortObjects=this.sortObjects,a.drawRanges=this._drawRanges,a.reservedRanges=this._reservedRanges,a.geometryInfo=this._geometryInfo.map(u=>({...u,boundingBox:u.boundingBox?u.boundingBox.toJSON():void 0,boundingSphere:u.boundingSphere?u.boundingSphere.toJSON():void 0})),a.instanceInfo=this._instanceInfo.map(u=>({...u})),a.availableInstanceIds=this._availableInstanceIds.slice(),a.availableGeometryIds=this._availableGeometryIds.slice(),a.nextIndexStart=this._nextIndexStart,a.nextVertexStart=this._nextVertexStart,a.geometryCount=this._geometryCount,a.maxInstanceCount=this._maxInstanceCount,a.maxVertexCount=this._maxVertexCount,a.maxIndexCount=this._maxIndexCount,a.geometryInitialized=this._geometryInitialized,a.matricesTexture=this._matricesTexture.toJSON(e),a.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(a.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(a.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(a.boundingBox=this.boundingBox.toJSON()));function r(u,d){return u[d.uuid]===void 0&&(u[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(a.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=r(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const d=u.shapes;if(Array.isArray(d))for(let p=0,x=d.length;p<x;p++){const g=d[p];r(e.shapes,g)}else r(e.shapes,d)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let d=0,p=this.material.length;d<p;d++)u.push(r(e.materials,this.material[d]));a.material=u}else a.material=r(e.materials,this.material);if(this.children.length>0){a.children=[];for(let u=0;u<this.children.length;u++)a.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){a.animations=[];for(let u=0;u<this.animations.length;u++){const d=this.animations[u];a.animations.push(r(e.animations,d))}}if(t){const u=l(e.geometries),d=l(e.materials),p=l(e.textures),x=l(e.images),g=l(e.shapes),_=l(e.skeletons),y=l(e.animations),b=l(e.nodes);u.length>0&&(n.geometries=u),d.length>0&&(n.materials=d),p.length>0&&(n.textures=p),x.length>0&&(n.images=x),g.length>0&&(n.shapes=g),_.length>0&&(n.skeletons=_),y.length>0&&(n.animations=y),b.length>0&&(n.nodes=b)}return n.object=a,n;function l(u){const d=[];for(const p in u){const x=u[p];delete x.metadata,d.push(x)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const a=e.children[n];this.add(a.clone())}return this}}Pn.DEFAULT_UP=new te(0,1,0);Pn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Pn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Go=new te,xc=new te,Z2=new te,_c=new te,Jd=new te,Wd=new te,AM=new te,Q2=new te,$2=new te,e1=new te,t1=new kn,n1=new kn,i1=new kn;class xr{constructor(e=new te,t=new te,n=new te){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,a){a.subVectors(n,t),Go.subVectors(e,t),a.cross(Go);const r=a.lengthSq();return r>0?a.multiplyScalar(1/Math.sqrt(r)):a.set(0,0,0)}static getBarycoord(e,t,n,a,r){Go.subVectors(a,t),xc.subVectors(n,t),Z2.subVectors(e,t);const l=Go.dot(Go),u=Go.dot(xc),d=Go.dot(Z2),p=xc.dot(xc),x=xc.dot(Z2),g=l*p-u*u;if(g===0)return r.set(0,0,0),null;const _=1/g,y=(p*d-u*x)*_,b=(l*x-u*d)*_;return r.set(1-y-b,b,y)}static containsPoint(e,t,n,a){return this.getBarycoord(e,t,n,a,_c)===null?!1:_c.x>=0&&_c.y>=0&&_c.x+_c.y<=1}static getInterpolation(e,t,n,a,r,l,u,d){return this.getBarycoord(e,t,n,a,_c)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(r,_c.x),d.addScaledVector(l,_c.y),d.addScaledVector(u,_c.z),d)}static getInterpolatedAttribute(e,t,n,a,r,l){return t1.setScalar(0),n1.setScalar(0),i1.setScalar(0),t1.fromBufferAttribute(e,t),n1.fromBufferAttribute(e,n),i1.fromBufferAttribute(e,a),l.setScalar(0),l.addScaledVector(t1,r.x),l.addScaledVector(n1,r.y),l.addScaledVector(i1,r.z),l}static isFrontFacing(e,t,n,a){return Go.subVectors(n,t),xc.subVectors(e,t),Go.cross(xc).dot(a)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,a){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[a]),this}setFromAttributeAndIndices(e,t,n,a){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,a),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Go.subVectors(this.c,this.b),xc.subVectors(this.a,this.b),Go.cross(xc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return xr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return xr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,a,r){return xr.getInterpolation(e,this.a,this.b,this.c,t,n,a,r)}containsPoint(e){return xr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return xr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,a=this.b,r=this.c;let l,u;Jd.subVectors(a,n),Wd.subVectors(r,n),Q2.subVectors(e,n);const d=Jd.dot(Q2),p=Wd.dot(Q2);if(d<=0&&p<=0)return t.copy(n);$2.subVectors(e,a);const x=Jd.dot($2),g=Wd.dot($2);if(x>=0&&g<=x)return t.copy(a);const _=d*g-x*p;if(_<=0&&d>=0&&x<=0)return l=d/(d-x),t.copy(n).addScaledVector(Jd,l);e1.subVectors(e,r);const y=Jd.dot(e1),b=Wd.dot(e1);if(b>=0&&y<=b)return t.copy(r);const C=y*p-d*b;if(C<=0&&p>=0&&b<=0)return u=p/(p-b),t.copy(n).addScaledVector(Wd,u);const E=x*b-y*g;if(E<=0&&g-x>=0&&y-b>=0)return AM.subVectors(r,a),u=(g-x)/(g-x+(y-b)),t.copy(a).addScaledVector(AM,u);const S=1/(E+C+_);return l=C*S,u=_*S,t.copy(n).addScaledVector(Jd,l).addScaledVector(Wd,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const XT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Su={h:0,s:0,l:0},lx={h:0,s:0,l:0};function a1(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class ut{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const a=e;a&&a.isColor?this.copy(a):typeof a=="number"?this.setHex(a):typeof a=="string"&&this.setStyle(a)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ti){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Wn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,a=Wn.workingColorSpace){return this.r=e,this.g=t,this.b=n,Wn.colorSpaceToWorking(this,a),this}setHSL(e,t,n,a=Wn.workingColorSpace){if(e=nS(e,1),t=sn(t,0,1),n=sn(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,l=2*n-r;this.r=a1(l,r,e+1/3),this.g=a1(l,r,e),this.b=a1(l,r,e-1/3)}return Wn.colorSpaceToWorking(this,a),this}setStyle(e,t=ti){function n(r){r!==void 0&&parseFloat(r)<1&&Mt("Color: Alpha component of "+e+" will be ignored.")}let a;if(a=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const l=a[1],u=a[2];switch(l){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:Mt("Color: Unknown color model "+e)}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=a[1],l=r.length;if(l===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(l===6)return this.setHex(parseInt(r,16),t);Mt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ti){const n=XT[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Mt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Bc(e.r),this.g=Bc(e.g),this.b=Bc(e.b),this}copyLinearToSRGB(e){return this.r=Sp(e.r),this.g=Sp(e.g),this.b=Sp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ti){return Wn.workingToColorSpace(ws.copy(this),e),Math.round(sn(ws.r*255,0,255))*65536+Math.round(sn(ws.g*255,0,255))*256+Math.round(sn(ws.b*255,0,255))}getHexString(e=ti){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Wn.workingColorSpace){Wn.workingToColorSpace(ws.copy(this),t);const n=ws.r,a=ws.g,r=ws.b,l=Math.max(n,a,r),u=Math.min(n,a,r);let d,p;const x=(u+l)/2;if(u===l)d=0,p=0;else{const g=l-u;switch(p=x<=.5?g/(l+u):g/(2-l-u),l){case n:d=(a-r)/g+(a<r?6:0);break;case a:d=(r-n)/g+2;break;case r:d=(n-a)/g+4;break}d/=6}return e.h=d,e.s=p,e.l=x,e}getRGB(e,t=Wn.workingColorSpace){return Wn.workingToColorSpace(ws.copy(this),t),e.r=ws.r,e.g=ws.g,e.b=ws.b,e}getStyle(e=ti){Wn.workingToColorSpace(ws.copy(this),e);const t=ws.r,n=ws.g,a=ws.b;return e!==ti?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${a.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(a*255)})`}offsetHSL(e,t,n){return this.getHSL(Su),this.setHSL(Su.h+e,Su.s+t,Su.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Su),e.getHSL(lx);const n=Jm(Su.h,lx.h,t),a=Jm(Su.s,lx.s,t),r=Jm(Su.l,lx.l,t);return this.setHSL(n,a,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,a=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*a,this.g=r[1]*t+r[4]*n+r[7]*a,this.b=r[2]*t+r[5]*n+r[8]*a,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ws=new ut;ut.NAMES=XT;let BD=0;class ya extends Hr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:BD++}),this.uuid=Pr(),this.name="",this.type="Material",this.blending=vh,this.side=Wo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=d_,this.blendDst=p_,this.blendEquation=Nu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ut(0,0,0),this.blendAlpha=0,this.depthFunc=bh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Sb,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lh,this.stencilZFail=lh,this.stencilZPass=lh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){Mt(`Material: parameter '${t}' has value of undefined.`);continue}const a=this[t];if(a===void 0){Mt(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}a&&a.isColor?a.set(n):a&&a.isVector3&&n&&n.isVector3?a.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==vh&&(n.blending=this.blending),this.side!==Wo&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==d_&&(n.blendSrc=this.blendSrc),this.blendDst!==p_&&(n.blendDst=this.blendDst),this.blendEquation!==Nu&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==bh&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Sb&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==lh&&(n.stencilFail=this.stencilFail),this.stencilZFail!==lh&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==lh&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function a(r){const l=[];for(const u in r){const d=r[u];delete d.metadata,l.push(d)}return l}if(t){const r=a(e.textures),l=a(e.images);r.length>0&&(n.textures=r),l.length>0&&(n.images=l)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const a=t.length;n=new Array(a);for(let r=0;r!==a;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class $a extends ya{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zr,this.combine=mg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Tc=DD();function DD(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),a=new Uint32Array(512);for(let d=0;d<256;++d){const p=d-127;p<-27?(n[d]=0,n[d|256]=32768,a[d]=24,a[d|256]=24):p<-14?(n[d]=1024>>-p-14,n[d|256]=1024>>-p-14|32768,a[d]=-p-1,a[d|256]=-p-1):p<=15?(n[d]=p+15<<10,n[d|256]=p+15<<10|32768,a[d]=13,a[d|256]=13):p<128?(n[d]=31744,n[d|256]=64512,a[d]=24,a[d|256]=24):(n[d]=31744,n[d|256]=64512,a[d]=13,a[d|256]=13)}const r=new Uint32Array(2048),l=new Uint32Array(64),u=new Uint32Array(64);for(let d=1;d<1024;++d){let p=d<<13,x=0;for(;(p&8388608)===0;)p<<=1,x-=8388608;p&=-8388609,x+=947912704,r[d]=p|x}for(let d=1024;d<2048;++d)r[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)l[d]=d<<23;l[31]=1199570944,l[32]=2147483648;for(let d=33;d<63;++d)l[d]=2147483648+(d-32<<23);l[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(u[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:a,mantissaTable:r,exponentTable:l,offsetTable:u}}function vr(i){Math.abs(i)>65504&&Mt("DataUtils.toHalfFloat(): Value out of range."),i=sn(i,-65504,65504),Tc.floatView[0]=i;const e=Tc.uint32View[0],t=e>>23&511;return Tc.baseTable[t]+((e&8388607)>>Tc.shiftTable[t])}function Gm(i){const e=i>>10;return Tc.uint32View[0]=Tc.mantissaTable[Tc.offsetTable[e]+(i&1023)]+Tc.exponentTable[e],Tc.floatView[0]}class dh{static toHalfFloat(e){return vr(e)}static fromHalfFloat(e){return Gm(e)}}const Ca=new te,cx=new Ge;let UD=0;class Mn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:UD++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=rg,this.updateRanges=[],this.gpuType=ji,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let a=0,r=this.itemSize;a<r;a++)this.array[e+a]=t.array[n+a];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)cx.fromBufferAttribute(this,t),cx.applyMatrix3(e),this.setXY(t,cx.x,cx.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Ca.fromBufferAttribute(this,t),Ca.applyMatrix3(e),this.setXYZ(t,Ca.x,Ca.y,Ca.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Ca.fromBufferAttribute(this,t),Ca.applyMatrix4(e),this.setXYZ(t,Ca.x,Ca.y,Ca.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ca.fromBufferAttribute(this,t),Ca.applyNormalMatrix(e),this.setXYZ(t,Ca.x,Ca.y,Ca.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ca.fromBufferAttribute(this,t),Ca.transformDirection(e),this.setXYZ(t,Ca.x,Ca.y,Ca.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=nr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=_n(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=nr(t,this.array)),t}setX(e,t){return this.normalized&&(t=_n(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=nr(t,this.array)),t}setY(e,t){return this.normalized&&(t=_n(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=nr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=_n(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=nr(t,this.array)),t}setW(e,t){return this.normalized&&(t=_n(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,a){return e*=this.itemSize,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array),a=_n(a,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=a,this}setXYZW(e,t,n,a,r){return e*=this.itemSize,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array),a=_n(a,this.array),r=_n(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=a,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==rg&&(e.usage=this.usage),e}}class OD extends Mn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class ND extends Mn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class LD extends Mn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class ID extends Mn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class sS extends Mn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class PD extends Mn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class rS extends Mn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class FD extends Mn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Gm(this.array[e*this.itemSize]);return this.normalized&&(t=nr(t,this.array)),t}setX(e,t){return this.normalized&&(t=_n(t,this.array)),this.array[e*this.itemSize]=vr(t),this}getY(e){let t=Gm(this.array[e*this.itemSize+1]);return this.normalized&&(t=nr(t,this.array)),t}setY(e,t){return this.normalized&&(t=_n(t,this.array)),this.array[e*this.itemSize+1]=vr(t),this}getZ(e){let t=Gm(this.array[e*this.itemSize+2]);return this.normalized&&(t=nr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=_n(t,this.array)),this.array[e*this.itemSize+2]=vr(t),this}getW(e){let t=Gm(this.array[e*this.itemSize+3]);return this.normalized&&(t=nr(t,this.array)),t}setW(e,t){return this.normalized&&(t=_n(t,this.array)),this.array[e*this.itemSize+3]=vr(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array)),this.array[e+0]=vr(t),this.array[e+1]=vr(n),this}setXYZ(e,t,n,a){return e*=this.itemSize,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array),a=_n(a,this.array)),this.array[e+0]=vr(t),this.array[e+1]=vr(n),this.array[e+2]=vr(a),this}setXYZW(e,t,n,a,r){return e*=this.itemSize,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array),a=_n(a,this.array),r=_n(r,this.array)),this.array[e+0]=vr(t),this.array[e+1]=vr(n),this.array[e+2]=vr(a),this.array[e+3]=vr(r),this}}class zt extends Mn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let zD=0;const ro=new Wt,s1=new Pn,Zd=new te,Or=new ns,bm=new ns,Qa=new te;class rn extends Hr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:zD++}),this.uuid=Pr(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(VT(e)?rS:sS)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new vn().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const a=this.attributes.tangent;return a!==void 0&&(a.transformDirection(e),a.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ro.makeRotationFromQuaternion(e),this.applyMatrix4(ro),this}rotateX(e){return ro.makeRotationX(e),this.applyMatrix4(ro),this}rotateY(e){return ro.makeRotationY(e),this.applyMatrix4(ro),this}rotateZ(e){return ro.makeRotationZ(e),this.applyMatrix4(ro),this}translate(e,t,n){return ro.makeTranslation(e,t,n),this.applyMatrix4(ro),this}scale(e,t,n){return ro.makeScale(e,t,n),this.applyMatrix4(ro),this}lookAt(e){return s1.lookAt(e),s1.updateMatrix(),this.applyMatrix4(s1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zd).negate(),this.translate(Zd.x,Zd.y,Zd.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let a=0,r=e.length;a<r;a++){const l=e[a];n.push(l.x,l.y,l.z||0)}this.setAttribute("position",new zt(n,3))}else{const n=Math.min(e.length,t.count);for(let a=0;a<n;a++){const r=e[a];t.setXYZ(a,r.x,r.y,r.z||0)}e.length>t.count&&Mt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ns);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){un("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new te(-1/0,-1/0,-1/0),new te(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,a=t.length;n<a;n++){const r=t[n];Or.setFromBufferAttribute(r),this.morphTargetsRelative?(Qa.addVectors(this.boundingBox.min,Or.min),this.boundingBox.expandByPoint(Qa),Qa.addVectors(this.boundingBox.max,Or.max),this.boundingBox.expandByPoint(Qa)):(this.boundingBox.expandByPoint(Or.min),this.boundingBox.expandByPoint(Or.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&un('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new za);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){un("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new te,1/0);return}if(e){const n=this.boundingSphere.center;if(Or.setFromBufferAttribute(e),t)for(let r=0,l=t.length;r<l;r++){const u=t[r];bm.setFromBufferAttribute(u),this.morphTargetsRelative?(Qa.addVectors(Or.min,bm.min),Or.expandByPoint(Qa),Qa.addVectors(Or.max,bm.max),Or.expandByPoint(Qa)):(Or.expandByPoint(bm.min),Or.expandByPoint(bm.max))}Or.getCenter(n);let a=0;for(let r=0,l=e.count;r<l;r++)Qa.fromBufferAttribute(e,r),a=Math.max(a,n.distanceToSquared(Qa));if(t)for(let r=0,l=t.length;r<l;r++){const u=t[r],d=this.morphTargetsRelative;for(let p=0,x=u.count;p<x;p++)Qa.fromBufferAttribute(u,p),d&&(Zd.fromBufferAttribute(e,p),Qa.add(Zd)),a=Math.max(a,n.distanceToSquared(Qa))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&un('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){un("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,a=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Mn(new Float32Array(4*n.count),4));const l=this.getAttribute("tangent"),u=[],d=[];for(let j=0;j<n.count;j++)u[j]=new te,d[j]=new te;const p=new te,x=new te,g=new te,_=new Ge,y=new Ge,b=new Ge,C=new te,E=new te;function S(j,L,P){p.fromBufferAttribute(n,j),x.fromBufferAttribute(n,L),g.fromBufferAttribute(n,P),_.fromBufferAttribute(r,j),y.fromBufferAttribute(r,L),b.fromBufferAttribute(r,P),x.sub(p),g.sub(p),y.sub(_),b.sub(_);const q=1/(y.x*b.y-b.x*y.y);isFinite(q)&&(C.copy(x).multiplyScalar(b.y).addScaledVector(g,-y.y).multiplyScalar(q),E.copy(g).multiplyScalar(y.x).addScaledVector(x,-b.x).multiplyScalar(q),u[j].add(C),u[L].add(C),u[P].add(C),d[j].add(E),d[L].add(E),d[P].add(E))}let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let j=0,L=w.length;j<L;++j){const P=w[j],q=P.start,ie=P.count;for(let se=q,ae=q+ie;se<ae;se+=3)S(e.getX(se+0),e.getX(se+1),e.getX(se+2))}const D=new te,U=new te,F=new te,N=new te;function z(j){F.fromBufferAttribute(a,j),N.copy(F);const L=u[j];D.copy(L),D.sub(F.multiplyScalar(F.dot(L))).normalize(),U.crossVectors(N,L);const q=U.dot(d[j])<0?-1:1;l.setXYZW(j,D.x,D.y,D.z,q)}for(let j=0,L=w.length;j<L;++j){const P=w[j],q=P.start,ie=P.count;for(let se=q,ae=q+ie;se<ae;se+=3)z(e.getX(se+0)),z(e.getX(se+1)),z(e.getX(se+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Mn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let _=0,y=n.count;_<y;_++)n.setXYZ(_,0,0,0);const a=new te,r=new te,l=new te,u=new te,d=new te,p=new te,x=new te,g=new te;if(e)for(let _=0,y=e.count;_<y;_+=3){const b=e.getX(_+0),C=e.getX(_+1),E=e.getX(_+2);a.fromBufferAttribute(t,b),r.fromBufferAttribute(t,C),l.fromBufferAttribute(t,E),x.subVectors(l,r),g.subVectors(a,r),x.cross(g),u.fromBufferAttribute(n,b),d.fromBufferAttribute(n,C),p.fromBufferAttribute(n,E),u.add(x),d.add(x),p.add(x),n.setXYZ(b,u.x,u.y,u.z),n.setXYZ(C,d.x,d.y,d.z),n.setXYZ(E,p.x,p.y,p.z)}else for(let _=0,y=t.count;_<y;_+=3)a.fromBufferAttribute(t,_+0),r.fromBufferAttribute(t,_+1),l.fromBufferAttribute(t,_+2),x.subVectors(l,r),g.subVectors(a,r),x.cross(g),n.setXYZ(_+0,x.x,x.y,x.z),n.setXYZ(_+1,x.x,x.y,x.z),n.setXYZ(_+2,x.x,x.y,x.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Qa.fromBufferAttribute(e,t),Qa.normalize(),e.setXYZ(t,Qa.x,Qa.y,Qa.z)}toNonIndexed(){function e(u,d){const p=u.array,x=u.itemSize,g=u.normalized,_=new p.constructor(d.length*x);let y=0,b=0;for(let C=0,E=d.length;C<E;C++){u.isInterleavedBufferAttribute?y=d[C]*u.data.stride+u.offset:y=d[C]*x;for(let S=0;S<x;S++)_[b++]=p[y++]}return new Mn(_,x,g)}if(this.index===null)return Mt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new rn,n=this.index.array,a=this.attributes;for(const u in a){const d=a[u],p=e(d,n);t.setAttribute(u,p)}const r=this.morphAttributes;for(const u in r){const d=[],p=r[u];for(let x=0,g=p.length;x<g;x++){const _=p[x],y=e(_,n);d.push(y)}t.morphAttributes[u]=d}t.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,d=l.length;u<d;u++){const p=l[u];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const p in d)d[p]!==void 0&&(e[p]=d[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n){const p=n[d];e.data.attributes[d]=p.toJSON(e.data)}const a={};let r=!1;for(const d in this.morphAttributes){const p=this.morphAttributes[d],x=[];for(let g=0,_=p.length;g<_;g++){const y=p[g];x.push(y.toJSON(e.data))}x.length>0&&(a[d]=x,r=!0)}r&&(e.data.morphAttributes=a,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere=u.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const a=e.attributes;for(const p in a){const x=a[p];this.setAttribute(p,x.clone(t))}const r=e.morphAttributes;for(const p in r){const x=[],g=r[p];for(let _=0,y=g.length;_<y;_++)x.push(g[_].clone(t));this.morphAttributes[p]=x}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let p=0,x=l.length;p<x;p++){const g=l[p];this.addGroup(g.start,g.count,g.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const MM=new Wt,Yf=new Hp,ux=new za,EM=new te,fx=new te,hx=new te,dx=new te,r1=new te,px=new te,TM=new te,mx=new te;class Xi extends Pn{constructor(e=new rn,t=new $a){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const a=t[n[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,l=a.length;r<l;r++){const u=a[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=r}}}}getVertexPosition(e,t){const n=this.geometry,a=n.attributes.position,r=n.morphAttributes.position,l=n.morphTargetsRelative;t.fromBufferAttribute(a,e);const u=this.morphTargetInfluences;if(r&&u){px.set(0,0,0);for(let d=0,p=r.length;d<p;d++){const x=u[d],g=r[d];x!==0&&(r1.fromBufferAttribute(g,e),l?px.addScaledVector(r1,x):px.addScaledVector(r1.sub(t),x))}t.add(px)}return t}raycast(e,t){const n=this.geometry,a=this.material,r=this.matrixWorld;a!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),ux.copy(n.boundingSphere),ux.applyMatrix4(r),Yf.copy(e.ray).recast(e.near),!(ux.containsPoint(Yf.origin)===!1&&(Yf.intersectSphere(ux,EM)===null||Yf.origin.distanceToSquared(EM)>(e.far-e.near)**2))&&(MM.copy(r).invert(),Yf.copy(e.ray).applyMatrix4(MM),!(n.boundingBox!==null&&Yf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Yf)))}_computeIntersections(e,t,n){let a;const r=this.geometry,l=this.material,u=r.index,d=r.attributes.position,p=r.attributes.uv,x=r.attributes.uv1,g=r.attributes.normal,_=r.groups,y=r.drawRange;if(u!==null)if(Array.isArray(l))for(let b=0,C=_.length;b<C;b++){const E=_[b],S=l[E.materialIndex],w=Math.max(E.start,y.start),D=Math.min(u.count,Math.min(E.start+E.count,y.start+y.count));for(let U=w,F=D;U<F;U+=3){const N=u.getX(U),z=u.getX(U+1),j=u.getX(U+2);a=gx(this,S,e,n,p,x,g,N,z,j),a&&(a.faceIndex=Math.floor(U/3),a.face.materialIndex=E.materialIndex,t.push(a))}}else{const b=Math.max(0,y.start),C=Math.min(u.count,y.start+y.count);for(let E=b,S=C;E<S;E+=3){const w=u.getX(E),D=u.getX(E+1),U=u.getX(E+2);a=gx(this,l,e,n,p,x,g,w,D,U),a&&(a.faceIndex=Math.floor(E/3),t.push(a))}}else if(d!==void 0)if(Array.isArray(l))for(let b=0,C=_.length;b<C;b++){const E=_[b],S=l[E.materialIndex],w=Math.max(E.start,y.start),D=Math.min(d.count,Math.min(E.start+E.count,y.start+y.count));for(let U=w,F=D;U<F;U+=3){const N=U,z=U+1,j=U+2;a=gx(this,S,e,n,p,x,g,N,z,j),a&&(a.faceIndex=Math.floor(U/3),a.face.materialIndex=E.materialIndex,t.push(a))}}else{const b=Math.max(0,y.start),C=Math.min(d.count,y.start+y.count);for(let E=b,S=C;E<S;E+=3){const w=E,D=E+1,U=E+2;a=gx(this,l,e,n,p,x,g,w,D,U),a&&(a.faceIndex=Math.floor(E/3),t.push(a))}}}}function HD(i,e,t,n,a,r,l,u){let d;if(e.side===oa?d=n.intersectTriangle(l,r,a,!0,u):d=n.intersectTriangle(a,r,l,e.side===Wo,u),d===null)return null;mx.copy(u),mx.applyMatrix4(i.matrixWorld);const p=t.ray.origin.distanceTo(mx);return p<t.near||p>t.far?null:{distance:p,point:mx.clone(),object:i}}function gx(i,e,t,n,a,r,l,u,d,p){i.getVertexPosition(u,fx),i.getVertexPosition(d,hx),i.getVertexPosition(p,dx);const x=HD(i,e,t,n,fx,hx,dx,TM);if(x){const g=new te;xr.getBarycoord(TM,fx,hx,dx,g),a&&(x.uv=xr.getInterpolatedAttribute(a,u,d,p,g,new Ge)),r&&(x.uv1=xr.getInterpolatedAttribute(r,u,d,p,g,new Ge)),l&&(x.normal=xr.getInterpolatedAttribute(l,u,d,p,g,new te),x.normal.dot(n.direction)>0&&x.normal.multiplyScalar(-1));const _={a:u,b:d,c:p,normal:new te,materialIndex:0};xr.getNormal(fx,hx,dx,_.normal),x.face=_,x.barycoord=g}return x}class Uh extends rn{constructor(e=1,t=1,n=1,a=1,r=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:a,heightSegments:r,depthSegments:l};const u=this;a=Math.floor(a),r=Math.floor(r),l=Math.floor(l);const d=[],p=[],x=[],g=[];let _=0,y=0;b("z","y","x",-1,-1,n,t,e,l,r,0),b("z","y","x",1,-1,n,t,-e,l,r,1),b("x","z","y",1,1,e,n,t,a,l,2),b("x","z","y",1,-1,e,n,-t,a,l,3),b("x","y","z",1,-1,e,t,n,a,r,4),b("x","y","z",-1,-1,e,t,-n,a,r,5),this.setIndex(d),this.setAttribute("position",new zt(p,3)),this.setAttribute("normal",new zt(x,3)),this.setAttribute("uv",new zt(g,2));function b(C,E,S,w,D,U,F,N,z,j,L){const P=U/z,q=F/j,ie=U/2,se=F/2,ae=N/2,re=z+1,H=j+1;let K=0,W=0;const me=new te;for(let ve=0;ve<H;ve++){const Q=ve*q-se;for(let de=0;de<re;de++){const Te=de*P-ie;me[C]=Te*w,me[E]=Q*D,me[S]=ae,p.push(me.x,me.y,me.z),me[C]=0,me[E]=0,me[S]=N>0?1:-1,x.push(me.x,me.y,me.z),g.push(de/z),g.push(1-ve/j),K+=1}}for(let ve=0;ve<j;ve++)for(let Q=0;Q<z;Q++){const de=_+Q+re*ve,Te=_+Q+re*(ve+1),Me=_+(Q+1)+re*(ve+1),rt=_+(Q+1)+re*ve;d.push(de,Te,rt),d.push(Te,Me,rt),W+=6}u.addGroup(y,W,L),y+=W,_+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Uh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Lp(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const a=i[t][n];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?a.isRenderTargetTexture?(Mt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=a.clone():Array.isArray(a)?e[t][n]=a.slice():e[t][n]=a}}return e}function $s(i){const e={};for(let t=0;t<i.length;t++){const n=Lp(i[t]);for(const a in n)e[a]=n[a]}return e}function GD(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function YT(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Wn.workingColorSpace}const qT={clone:Lp,merge:$s};var VD=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,kD=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class hi extends ya{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=VD,this.fragmentShader=kD,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Lp(e.uniforms),this.uniformsGroups=GD(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const a in this.uniforms){const l=this.uniforms[a].value;l&&l.isTexture?t.uniforms[a]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?t.uniforms[a]={type:"c",value:l.getHex()}:l&&l.isVector2?t.uniforms[a]={type:"v2",value:l.toArray()}:l&&l.isVector3?t.uniforms[a]={type:"v3",value:l.toArray()}:l&&l.isVector4?t.uniforms[a]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?t.uniforms[a]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?t.uniforms[a]={type:"m4",value:l.toArray()}:t.uniforms[a]={value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const a in this.extensions)this.extensions[a]===!0&&(n[a]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class My extends Pn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Wt,this.projectionMatrix=new Wt,this.projectionMatrixInverse=new Wt,this.coordinateSystem=Ir,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Au=new te,CM=new Ge,RM=new Ge;class Ra extends My{constructor(e=50,t=1,n=.1,a=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=a,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Op*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(xh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Op*2*Math.atan(Math.tan(xh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Au.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Au.x,Au.y).multiplyScalar(-e/Au.z),Au.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Au.x,Au.y).multiplyScalar(-e/Au.z)}getViewSize(e,t){return this.getViewBounds(e,CM,RM),t.subVectors(RM,CM)}setViewOffset(e,t,n,a,r,l){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=a,this.view.width=r,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(xh*.5*this.fov)/this.zoom,n=2*t,a=this.aspect*n,r=-.5*a;const l=this.view;if(this.view!==null&&this.view.enabled){const d=l.fullWidth,p=l.fullHeight;r+=l.offsetX*a/d,t-=l.offsetY*n/p,a*=l.width/d,n*=l.height/p}const u=this.filmOffset;u!==0&&(r+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+a,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Qd=-90,$d=1;class KT extends Pn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const a=new Ra(Qd,$d,e,t);a.layers=this.layers,this.add(a);const r=new Ra(Qd,$d,e,t);r.layers=this.layers,this.add(r);const l=new Ra(Qd,$d,e,t);l.layers=this.layers,this.add(l);const u=new Ra(Qd,$d,e,t);u.layers=this.layers,this.add(u);const d=new Ra(Qd,$d,e,t);d.layers=this.layers,this.add(d);const p=new Ra(Qd,$d,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,a,r,l,u,d]=t;for(const p of t)this.remove(p);if(e===Ir)n.up.set(0,1,0),n.lookAt(1,0,0),a.up.set(0,1,0),a.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),l.up.set(0,0,1),l.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===Dp)n.up.set(0,-1,0),n.lookAt(-1,0,0),a.up.set(0,-1,0),a.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),l.up.set(0,0,-1),l.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:a}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,l,u,d,p,x]=this.children,g=e.getRenderTarget(),_=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),b=e.xr.enabled;e.xr.enabled=!1;const C=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,a),e.render(t,r),e.setRenderTarget(n,1,a),e.render(t,l),e.setRenderTarget(n,2,a),e.render(t,u),e.setRenderTarget(n,3,a),e.render(t,d),e.setRenderTarget(n,4,a),e.render(t,p),n.texture.generateMipmaps=C,e.setRenderTarget(n,5,a),e.render(t,x),e.setRenderTarget(g,_,y),e.xr.enabled=b,n.texture.needsPMREMUpdate=!0}}class _g extends ui{constructor(e=[],t=Fl,n,a,r,l,u,d,p,x){super(e,t,n,a,r,l,u,d,p,x),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class oS extends ua{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},a=[n,n,n,n,n,n];this.texture=new _g(a),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},a=new Uh(5,5,5),r=new hi({name:"CubemapFromEquirect",uniforms:Lp(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:oa,blending:es});r.uniforms.tEquirect.value=t;const l=new Xi(a,r),u=t.minFilter;return t.minFilter===fo&&(t.minFilter=In),new KT(1,10,this).update(e,l),t.minFilter=u,l.geometry.dispose(),l.material.dispose(),this}clear(e,t=!0,n=!0,a=!0){const r=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(t,n,a);e.setRenderTarget(r)}}class wc extends Pn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const jD={type:"move"};class u_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new wc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new wc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new te,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new te),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new wc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new te,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new te),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let a=null,r=null,l=null;const u=this._targetRay,d=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){l=!0;for(const C of e.hand.values()){const E=t.getJointPose(C,n),S=this._getHandJoint(p,C);E!==null&&(S.matrix.fromArray(E.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=E.radius),S.visible=E!==null}const x=p.joints["index-finger-tip"],g=p.joints["thumb-tip"],_=x.position.distanceTo(g.position),y=.02,b=.005;p.inputState.pinching&&_>y+b?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&_<=y-b&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(d.matrix.fromArray(r.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,r.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(r.linearVelocity)):d.hasLinearVelocity=!1,r.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(r.angularVelocity)):d.hasAngularVelocity=!1));u!==null&&(a=t.getPose(e.targetRaySpace,n),a===null&&r!==null&&(a=r),a!==null&&(u.matrix.fromArray(a.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,a.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(a.linearVelocity)):u.hasLinearVelocity=!1,a.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(a.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(jD)))}return u!==null&&(u.visible=a!==null),d!==null&&(d.visible=r!==null),p!==null&&(p.visible=l!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new wc;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Ey{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new ut(e),this.density=t}clone(){return new Ey(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Ty{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new ut(e),this.near=t,this.far=n}clone(){return new Ty(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let Mh=class extends Pn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new zr,this.environmentIntensity=1,this.environmentRotation=new zr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};class yg{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=rg,this.updateRanges=[],this.version=0,this.uuid=Pr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let a=0,r=this.stride;a<r;a++)this.array[e+a]=t.array[n+a];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Pr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Pr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Qs=new te;class ku{constructor(e,t,n,a=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=a}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Qs.fromBufferAttribute(this,t),Qs.applyMatrix4(e),this.setXYZ(t,Qs.x,Qs.y,Qs.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Qs.fromBufferAttribute(this,t),Qs.applyNormalMatrix(e),this.setXYZ(t,Qs.x,Qs.y,Qs.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Qs.fromBufferAttribute(this,t),Qs.transformDirection(e),this.setXYZ(t,Qs.x,Qs.y,Qs.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=nr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=_n(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=_n(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=_n(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=_n(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=_n(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=nr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=nr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=nr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=nr(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array),a=_n(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=a,this}setXYZW(e,t,n,a,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=_n(t,this.array),n=_n(n,this.array),a=_n(a,this.array),r=_n(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=a,this.data.array[e+3]=r,this}clone(e){if(e===void 0){lg("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const a=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[a+r])}return new Mn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ku(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){lg("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const a=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[a+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class lS extends ya{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let ep;const Sm=new te,tp=new te,np=new te,ip=new Ge,Am=new Ge,JT=new Wt,vx=new te,Mm=new te,xx=new te,wM=new Ge,o1=new Ge,BM=new Ge;class WT extends Pn{constructor(e=new lS){if(super(),this.isSprite=!0,this.type="Sprite",ep===void 0){ep=new rn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new yg(t,5);ep.setIndex([0,1,2,0,2,3]),ep.setAttribute("position",new ku(n,3,0,!1)),ep.setAttribute("uv",new ku(n,2,3,!1))}this.geometry=ep,this.material=e,this.center=new Ge(.5,.5),this.count=1}raycast(e,t){e.camera===null&&un('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),tp.setFromMatrixScale(this.matrixWorld),JT.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),np.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&tp.multiplyScalar(-np.z);const n=this.material.rotation;let a,r;n!==0&&(r=Math.cos(n),a=Math.sin(n));const l=this.center;_x(vx.set(-.5,-.5,0),np,l,tp,a,r),_x(Mm.set(.5,-.5,0),np,l,tp,a,r),_x(xx.set(.5,.5,0),np,l,tp,a,r),wM.set(0,0),o1.set(1,0),BM.set(1,1);let u=e.ray.intersectTriangle(vx,Mm,xx,!1,Sm);if(u===null&&(_x(Mm.set(-.5,.5,0),np,l,tp,a,r),o1.set(0,1),u=e.ray.intersectTriangle(vx,xx,Mm,!1,Sm),u===null))return;const d=e.ray.origin.distanceTo(Sm);d<e.near||d>e.far||t.push({distance:d,point:Sm.clone(),uv:xr.getInterpolation(Sm,vx,Mm,xx,wM,o1,BM,new Ge),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function _x(i,e,t,n,a,r){ip.subVectors(i,t).addScalar(.5).multiply(n),a!==void 0?(Am.x=r*ip.x-a*ip.y,Am.y=a*ip.x+r*ip.y):Am.copy(ip),i.copy(e),i.x+=Am.x,i.y+=Am.y,i.applyMatrix4(JT)}const yx=new te,DM=new te;class ZT extends Pn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,a=t.length;n<a;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const a=this.levels;let r;for(r=0;r<a.length&&!(t<a[r].distance);r++);return a.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const a=t.splice(n,1);return this.remove(a[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,a;for(n=1,a=t.length;n<a;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){yx.setFromMatrixPosition(this.matrixWorld);const a=e.ray.origin.distanceTo(yx);this.getObjectForDistance(a).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){yx.setFromMatrixPosition(e.matrixWorld),DM.setFromMatrixPosition(this.matrixWorld);const n=yx.distanceTo(DM)/e.zoom;t[0].object.visible=!0;let a,r;for(a=1,r=t.length;a<r;a++){let l=t[a].distance;if(t[a].object.visible&&(l-=l*t[a].hysteresis),n>=l)t[a-1].object.visible=!1,t[a].object.visible=!0;else break}for(this._currentLevel=a-1;a<r;a++)t[a].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let a=0,r=n.length;a<r;a++){const l=n[a];t.object.levels.push({object:l.object.uuid,distance:l.distance,hysteresis:l.hysteresis})}return t}}const UM=new te,OM=new kn,NM=new kn,XD=new te,LM=new Wt,bx=new te,l1=new za,IM=new Wt,c1=new Hp;class cS extends Xi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=yb,this.bindMatrix=new Wt,this.bindMatrixInverse=new Wt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ns),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,bx),this.boundingBox.expandByPoint(bx)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new za),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,bx),this.boundingSphere.expandByPoint(bx)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,a=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),l1.copy(this.boundingSphere),l1.applyMatrix4(a),e.ray.intersectsSphere(l1)!==!1&&(IM.copy(a).invert(),c1.copy(e.ray).applyMatrix4(IM),!(this.boundingBox!==null&&c1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,c1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new kn,t=this.geometry.attributes.skinWeight;for(let n=0,a=t.count;n<a;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===yb?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===BT?this.bindMatrixInverse.copy(this.bindMatrix).invert():Mt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,a=this.geometry;OM.fromBufferAttribute(a.attributes.skinIndex,e),NM.fromBufferAttribute(a.attributes.skinWeight,e),UM.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const l=NM.getComponent(r);if(l!==0){const u=OM.getComponent(r);LM.multiplyMatrices(n.bones[u].matrixWorld,n.boneInverses[u]),t.addScaledVector(XD.copy(UM).applyMatrix4(LM),l)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Cy extends Pn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ho extends ui{constructor(e=null,t=1,n=1,a,r,l,u,d,p=la,x=la,g,_){super(null,l,u,d,p,x,a,r,g,_),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const PM=new Wt,YD=new Wt;class bg{constructor(e=[],t=[]){this.uuid=Pr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Mt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,a=this.bones.length;n<a;n++)this.boneInverses.push(new Wt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Wt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,a=this.boneTexture;for(let r=0,l=e.length;r<l;r++){const u=e[r]?e[r].matrixWorld:YD;PM.multiplyMatrices(u,t[r]),PM.toArray(n,r*16)}a!==null&&(a.needsUpdate=!0)}clone(){return new bg(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new ho(t,e,e,_a,ji);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const a=this.bones[t];if(a.name===e)return a}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,a=e.bones.length;n<a;n++){const r=e.bones[n];let l=t[r];l===void 0&&(Mt("Skeleton: No bone found with UUID:",r),l=new Cy),this.bones.push(l),this.boneInverses.push(new Wt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let a=0,r=t.length;a<r;a++){const l=t[a];e.bones.push(l.uuid);const u=n[a];e.boneInverses.push(u.toArray())}return e}}class Eh extends Mn{constructor(e,t,n,a=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=a}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const ap=new Wt,FM=new Wt,Sx=[],zM=new ns,qD=new Wt,Em=new Xi,Tm=new za;class uS extends Xi{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Eh(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let a=0;a<n;a++)this.setMatrixAt(a,qD)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ns),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,ap),zM.copy(e.boundingBox).applyMatrix4(ap),this.boundingBox.union(zM)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new za),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,ap),Tm.copy(e.boundingSphere).applyMatrix4(ap),this.boundingSphere.union(Tm)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,a=this.morphTexture.source.data.data,r=n.length+1,l=e*r+1;for(let u=0;u<n.length;u++)n[u]=a[l+u]}raycast(e,t){const n=this.matrixWorld,a=this.count;if(Em.geometry=this.geometry,Em.material=this.material,Em.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Tm.copy(this.boundingSphere),Tm.applyMatrix4(n),e.ray.intersectsSphere(Tm)!==!1))for(let r=0;r<a;r++){this.getMatrixAt(r,ap),FM.multiplyMatrices(n,ap),Em.matrixWorld=FM,Em.raycast(e,Sx);for(let l=0,u=Sx.length;l<u;l++){const d=Sx[l];d.instanceId=r,d.object=this,t.push(d)}Sx.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Eh(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,a=n.length+1;this.morphTexture===null&&(this.morphTexture=new ho(new Float32Array(a*this.count),a,this.count,vg,ji));const r=this.morphTexture.source.data.data;let l=0;for(let p=0;p<n.length;p++)l+=n[p];const u=this.geometry.morphTargetsRelative?1:1-l,d=a*e;r[d]=u,r.set(n,d+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const u1=new te,KD=new te,JD=new vn;class Ou{constructor(e=new te(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,a){return this.normal.set(e,t,n),this.constant=a,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const a=u1.subVectors(n,t).cross(KD.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(u1),a=this.normal.dot(n);if(a===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/a;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||JD.getNormalMatrix(e),a=this.coplanarPoint(u1).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-a.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const qf=new za,WD=new Ge(.5,.5),Ax=new te;class Gp{constructor(e=new Ou,t=new Ou,n=new Ou,a=new Ou,r=new Ou,l=new Ou){this.planes=[e,t,n,a,r,l]}set(e,t,n,a,r,l){const u=this.planes;return u[0].copy(e),u[1].copy(t),u[2].copy(n),u[3].copy(a),u[4].copy(r),u[5].copy(l),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Ir,n=!1){const a=this.planes,r=e.elements,l=r[0],u=r[1],d=r[2],p=r[3],x=r[4],g=r[5],_=r[6],y=r[7],b=r[8],C=r[9],E=r[10],S=r[11],w=r[12],D=r[13],U=r[14],F=r[15];if(a[0].setComponents(p-l,y-x,S-b,F-w).normalize(),a[1].setComponents(p+l,y+x,S+b,F+w).normalize(),a[2].setComponents(p+u,y+g,S+C,F+D).normalize(),a[3].setComponents(p-u,y-g,S-C,F-D).normalize(),n)a[4].setComponents(d,_,E,U).normalize(),a[5].setComponents(p-d,y-_,S-E,F-U).normalize();else if(a[4].setComponents(p-d,y-_,S-E,F-U).normalize(),t===Ir)a[5].setComponents(p+d,y+_,S+E,F+U).normalize();else if(t===Dp)a[5].setComponents(d,_,E,U).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),qf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),qf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(qf)}intersectsSprite(e){qf.center.set(0,0,0);const t=WD.distanceTo(e.center);return qf.radius=.7071067811865476+t,qf.applyMatrix4(e.matrixWorld),this.intersectsSphere(qf)}intersectsSphere(e){const t=this.planes,n=e.center,a=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<a)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const a=t[n];if(Ax.x=a.normal.x>0?e.max.x:e.min.x,Ax.y=a.normal.y>0?e.max.y:e.min.y,Ax.z=a.normal.z>0?e.max.z:e.min.z,a.distanceToPoint(Ax)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Ul=new Wt,Ol=new Gp;class Ry{constructor(){this.coordinateSystem=Ir}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const a=t.cameras[n];if(Ul.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),Ol.setFromProjectionMatrix(Ul,a.coordinateSystem,a.reversedDepth),Ol.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const a=t.cameras[n];if(Ul.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),Ol.setFromProjectionMatrix(Ul,a.coordinateSystem,a.reversedDepth),Ol.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const a=t.cameras[n];if(Ul.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),Ol.setFromProjectionMatrix(Ul,a.coordinateSystem,a.reversedDepth),Ol.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const a=t.cameras[n];if(Ul.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),Ol.setFromProjectionMatrix(Ul,a.coordinateSystem,a.reversedDepth),Ol.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const a=t.cameras[n];if(Ul.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),Ol.setFromProjectionMatrix(Ul,a.coordinateSystem,a.reversedDepth),Ol.containsPoint(e))return!0}return!1}clone(){return new Ry}}function f1(i,e){return i-e}function ZD(i,e){return i.z-e.z}function QD(i,e){return e.z-i.z}class $D{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,a){const r=this.pool,l=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const u=r[this.index];l.push(u),this.index++,u.start=e,u.count=t,u.z=n,u.index=a}reset(){this.list.length=0,this.index=0}}const mr=new Wt,eU=new ut(1,1,1),HM=new Gp,tU=new Ry,Mx=new ns,Kf=new za,Cm=new te,GM=new te,nU=new te,h1=new $D,Bs=new Xi,Ex=[];function iU(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const a=i.count;for(let r=0;r<a;r++)for(let l=0;l<n;l++)e.setComponent(r+t,l,i.getComponent(r,l))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function Jf(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class QT extends Xi{constructor(e,t,n=t*2,a){super(new rn,a),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new ho(t,e,e,_a,ji);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new ho(t,e,e,xg,Zo);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new ho(t,e,e,_a,ji);n.colorSpace=Wn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,a=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const l=e.getAttribute(r),{array:u,itemSize:d,normalized:p}=l,x=new u.constructor(n*d),g=new Mn(x,d,p);t.setAttribute(r,g)}if(e.getIndex()!==null){const r=n>65535?new Uint32Array(a):new Uint16Array(a);t.setIndex(new Mn(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const a=e.getAttribute(n),r=t.getAttribute(n);if(a.itemSize!==r.itemSize||a.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ns);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,a=t.length;n<a;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,mr),this.getBoundingBoxAt(r,Mx).applyMatrix4(mr),e.union(Mx)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new za);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,a=t.length;n<a;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,mr),this.getBoundingSphereAt(r,Kf).applyMatrix4(mr),e.union(Kf)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let a=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(f1),a=this._availableInstanceIds.shift(),this._instanceInfo[a]=n):(a=this._instanceInfo.length,this._instanceInfo.push(n));const r=this._matricesTexture;mr.identity().toArray(r.image.data,a*16),r.needsUpdate=!0;const l=this._colorsTexture;return l&&(eU.toArray(l.image.data,a*4),l.needsUpdate=!0),this._visibilityChanged=!0,a}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const a={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;a.vertexStart=this._nextVertexStart,a.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const l=e.getIndex();if(l!==null&&(a.indexStart=this._nextIndexStart,a.reservedIndexCount=n===-1?l.count:n),a.indexStart!==-1&&a.indexStart+a.reservedIndexCount>this._maxIndexCount||a.vertexStart+a.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let d;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(f1),d=this._availableGeometryIds.shift(),r[d]=a):(d=this._geometryCount,this._geometryCount++,r.push(a)),this.setGeometryAt(d,e),this._nextIndexStart=a.indexStart+a.reservedIndexCount,this._nextVertexStart=a.vertexStart+a.reservedVertexCount,d}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,a=n.getIndex()!==null,r=n.getIndex(),l=t.getIndex(),u=this._geometryInfo[e];if(a&&l.count>u.reservedIndexCount||t.attributes.position.count>u.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const d=u.vertexStart,p=u.reservedVertexCount;u.vertexCount=t.getAttribute("position").count;for(const x in n.attributes){const g=t.getAttribute(x),_=n.getAttribute(x);iU(g,_,d);const y=g.itemSize;for(let b=g.count,C=p;b<C;b++){const E=d+b;for(let S=0;S<y;S++)_.setComponent(E,S,0)}_.needsUpdate=!0,_.addUpdateRange(d*y,p*y)}if(a){const x=u.indexStart,g=u.reservedIndexCount;u.indexCount=t.getIndex().count;for(let _=0;_<l.count;_++)r.setX(x+_,d+l.getX(_));for(let _=l.count,y=g;_<y;_++)r.setX(x+_,d);r.needsUpdate=!0,r.addUpdateRange(x,u.reservedIndexCount)}return u.start=a?u.indexStart:u.vertexStart,u.count=a?u.indexCount:u.vertexCount,u.boundingBox=null,t.boundingBox!==null&&(u.boundingBox=t.boundingBox.clone()),u.boundingSphere=null,t.boundingSphere!==null&&(u.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let a=0,r=n.length;a<r;a++)n[a].active&&n[a].geometryIndex===e&&this.deleteInstance(a);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,a=n.map((l,u)=>u).sort((l,u)=>n[l].vertexStart-n[u].vertexStart),r=this.geometry;for(let l=0,u=n.length;l<u;l++){const d=a[l],p=n[d];if(p.active!==!1){if(r.index!==null){if(p.indexStart!==t){const{indexStart:x,vertexStart:g,reservedIndexCount:_}=p,y=r.index,b=y.array,C=e-g;for(let E=x;E<x+_;E++)b[E]=b[E]+C;y.array.copyWithin(t,x,x+_),y.addUpdateRange(t,_),p.indexStart=t}t+=p.reservedIndexCount}if(p.vertexStart!==e){const{vertexStart:x,reservedVertexCount:g}=p,_=r.attributes;for(const y in _){const b=_[y],{array:C,itemSize:E}=b;C.copyWithin(e*E,x*E,(x+g)*E),b.addUpdateRange(e*E,g*E)}p.vertexStart=e}e+=p.reservedVertexCount,p.start=r.index?p.indexStart:p.vertexStart,this._nextIndexStart=r.index?p.indexStart+p.reservedIndexCount:0,this._nextVertexStart=p.vertexStart+p.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,a=this._geometryInfo[e];if(a.boundingBox===null){const r=new ns,l=n.index,u=n.attributes.position;for(let d=a.start,p=a.start+a.count;d<p;d++){let x=d;l&&(x=l.getX(x)),r.expandByPoint(Cm.fromBufferAttribute(u,x))}a.boundingBox=r}return t.copy(a.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,a=this._geometryInfo[e];if(a.boundingSphere===null){const r=new za;this.getBoundingBoxAt(e,Mx),Mx.getCenter(r.center);const l=n.index,u=n.attributes.position;let d=0;for(let p=a.start,x=a.start+a.count;p<x;p++){let g=p;l&&(g=l.getX(g)),Cm.fromBufferAttribute(u,g),d=Math.max(d,r.center.distanceToSquared(Cm))}r.radius=Math.sqrt(d),a.boundingSphere=r}return t.copy(a.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,a=this._matricesTexture.image.data;return t.toArray(a,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(f1);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const a=new Int32Array(e),r=new Int32Array(e);Jf(this._multiDrawCounts,a),Jf(this._multiDrawStarts,r),this._multiDrawCounts=a,this._multiDrawStarts=r,this._maxInstanceCount=e;const l=this._indirectTexture,u=this._matricesTexture,d=this._colorsTexture;l.dispose(),this._initIndirectTexture(),Jf(l.image.data,this._indirectTexture.image.data),u.dispose(),this._initMatricesTexture(),Jf(u.image.data,this._matricesTexture.image.data),d&&(d.dispose(),this._initColorsTexture(),Jf(d.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(u=>u.active);if(Math.max(...n.map(u=>u.vertexStart+u.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(d=>d.indexStart+d.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new rn,this._initializeGeometry(r));const l=this.geometry;r.index&&Jf(r.index.array,l.index.array);for(const u in r.attributes)Jf(r.attributes[u].array,l.attributes[u].array)}raycast(e,t){const n=this._instanceInfo,a=this._geometryInfo,r=this.matrixWorld,l=this.geometry;Bs.material=this.material,Bs.geometry.index=l.index,Bs.geometry.attributes=l.attributes,Bs.geometry.boundingBox===null&&(Bs.geometry.boundingBox=new ns),Bs.geometry.boundingSphere===null&&(Bs.geometry.boundingSphere=new za);for(let u=0,d=n.length;u<d;u++){if(!n[u].visible||!n[u].active)continue;const p=n[u].geometryIndex,x=a[p];Bs.geometry.setDrawRange(x.start,x.count),this.getMatrixAt(u,Bs.matrixWorld).premultiply(r),this.getBoundingBoxAt(p,Bs.geometry.boundingBox),this.getBoundingSphereAt(p,Bs.geometry.boundingSphere),Bs.raycast(e,Ex);for(let g=0,_=Ex.length;g<_;g++){const y=Ex[g];y.object=this,y.batchId=u,t.push(y)}Ex.length=0}Bs.material=null,Bs.geometry.index=null,Bs.geometry.attributes={},Bs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,a,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const l=a.getIndex(),u=l===null?1:l.array.BYTES_PER_ELEMENT,d=this._instanceInfo,p=this._multiDrawStarts,x=this._multiDrawCounts,g=this._geometryInfo,_=this.perObjectFrustumCulled,y=this._indirectTexture,b=y.image.data,C=n.isArrayCamera?tU:HM;_&&!n.isArrayCamera&&(mr.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),HM.setFromProjectionMatrix(mr,n.coordinateSystem,n.reversedDepth));let E=0;if(this.sortObjects){mr.copy(this.matrixWorld).invert(),Cm.setFromMatrixPosition(n.matrixWorld).applyMatrix4(mr),GM.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(mr);for(let D=0,U=d.length;D<U;D++)if(d[D].visible&&d[D].active){const F=d[D].geometryIndex;this.getMatrixAt(D,mr),this.getBoundingSphereAt(F,Kf).applyMatrix4(mr);let N=!1;if(_&&(N=!C.intersectsSphere(Kf,n)),!N){const z=g[F],j=nU.subVectors(Kf.center,Cm).dot(GM);h1.push(z.start,z.count,j,D)}}const S=h1.list,w=this.customSort;w===null?S.sort(r.transparent?QD:ZD):w.call(this,S,n);for(let D=0,U=S.length;D<U;D++){const F=S[D];p[E]=F.start*u,x[E]=F.count,b[E]=F.index,E++}h1.reset()}else for(let S=0,w=d.length;S<w;S++)if(d[S].visible&&d[S].active){const D=d[S].geometryIndex;let U=!1;if(_&&(this.getMatrixAt(S,mr),this.getBoundingSphereAt(D,Kf).applyMatrix4(mr),U=!C.intersectsSphere(Kf,n)),!U){const F=g[D];p[E]=F.start*u,x[E]=F.count,b[E]=S,E++}}y.needsUpdate=!0,this._multiDrawCount=E,this._visibilityChanged=!1}onBeforeShadow(e,t,n,a,r,l){this.onBeforeRender(e,null,a,r,l)}}class Os extends ya{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ut(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const W_=new te,Z_=new te,VM=new Wt,Rm=new Hp,Tx=new za,d1=new te,kM=new te;class Uc extends Pn{constructor(e=new rn,t=new Os){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let a=1,r=t.count;a<r;a++)W_.fromBufferAttribute(t,a-1),Z_.fromBufferAttribute(t,a),n[a]=n[a-1],n[a]+=W_.distanceTo(Z_);e.setAttribute("lineDistance",new zt(n,1))}else Mt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,a=this.matrixWorld,r=e.params.Line.threshold,l=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Tx.copy(n.boundingSphere),Tx.applyMatrix4(a),Tx.radius+=r,e.ray.intersectsSphere(Tx)===!1)return;VM.copy(a).invert(),Rm.copy(e.ray).applyMatrix4(VM);const u=r/((this.scale.x+this.scale.y+this.scale.z)/3),d=u*u,p=this.isLineSegments?2:1,x=n.index,_=n.attributes.position;if(x!==null){const y=Math.max(0,l.start),b=Math.min(x.count,l.start+l.count);for(let C=y,E=b-1;C<E;C+=p){const S=x.getX(C),w=x.getX(C+1),D=Cx(this,e,Rm,d,S,w,C);D&&t.push(D)}if(this.isLineLoop){const C=x.getX(b-1),E=x.getX(y),S=Cx(this,e,Rm,d,C,E,b-1);S&&t.push(S)}}else{const y=Math.max(0,l.start),b=Math.min(_.count,l.start+l.count);for(let C=y,E=b-1;C<E;C+=p){const S=Cx(this,e,Rm,d,C,C+1,C);S&&t.push(S)}if(this.isLineLoop){const C=Cx(this,e,Rm,d,b-1,y,b-1);C&&t.push(C)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const a=t[n[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,l=a.length;r<l;r++){const u=a[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=r}}}}}function Cx(i,e,t,n,a,r,l){const u=i.geometry.attributes.position;if(W_.fromBufferAttribute(u,a),Z_.fromBufferAttribute(u,r),t.distanceSqToSegment(W_,Z_,d1,kM)>n)return;d1.applyMatrix4(i.matrixWorld);const p=e.ray.origin.distanceTo(d1);if(!(p<e.near||p>e.far))return{distance:p,point:kM.clone().applyMatrix4(i.matrixWorld),index:l,face:null,faceIndex:null,barycoord:null,object:i}}const jM=new te,XM=new te;class Qo extends Uc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let a=0,r=t.count;a<r;a+=2)jM.fromBufferAttribute(t,a),XM.fromBufferAttribute(t,a+1),n[a]=a===0?0:n[a-1],n[a+1]=n[a]+jM.distanceTo(XM);e.setAttribute("lineDistance",new zt(n,1))}else Mt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class fS extends Uc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Vp extends ya{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const YM=new Wt,Mb=new Hp,Rx=new za,wx=new te;class hS extends Pn{constructor(e=new rn,t=new Vp){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,a=this.matrixWorld,r=e.params.Points.threshold,l=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Rx.copy(n.boundingSphere),Rx.applyMatrix4(a),Rx.radius+=r,e.ray.intersectsSphere(Rx)===!1)return;YM.copy(a).invert(),Mb.copy(e.ray).applyMatrix4(YM);const u=r/((this.scale.x+this.scale.y+this.scale.z)/3),d=u*u,p=n.index,g=n.attributes.position;if(p!==null){const _=Math.max(0,l.start),y=Math.min(p.count,l.start+l.count);for(let b=_,C=y;b<C;b++){const E=p.getX(b);wx.fromBufferAttribute(g,E),qM(wx,E,d,a,e,t,this)}}else{const _=Math.max(0,l.start),y=Math.min(g.count,l.start+l.count);for(let b=_,C=y;b<C;b++)wx.fromBufferAttribute(g,b),qM(wx,b,d,a,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const a=t[n[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,l=a.length;r<l;r++){const u=a[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=r}}}}}function qM(i,e,t,n,a,r,l){const u=Mb.distanceSqToPoint(i);if(u<t){const d=new te;Mb.closestPointToPoint(i,d),d.applyMatrix4(n);const p=a.ray.origin.distanceTo(d);if(p<a.near||p>a.far)return;r.push({distance:p,distanceToRay:Math.sqrt(u),point:d,index:e,face:null,faceIndex:null,barycoord:null,object:l})}}class $T extends ui{constructor(e,t,n,a,r=In,l=In,u,d,p){super(e,t,n,a,r,l,u,d,p),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const x=this;function g(){x.needsUpdate=!0,x._requestVideoFrameCallbackId=e.requestVideoFrameCallback(g)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(g))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class aU extends $T{constructor(e,t,n,a,r,l,u,d){super({},e,t,n,a,r,l,u,d),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class sU extends ui{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=la,this.minFilter=la,this.generateMipmaps=!1,this.needsUpdate=!0}}class wy extends ui{constructor(e,t,n,a,r,l,u,d,p,x,g,_){super(null,l,u,d,p,x,a,r,g,_),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class rU extends wy{constructor(e,t,n,a,r,l){super(e,t,n,r,l),this.isCompressedArrayTexture=!0,this.image.depth=a,this.wrapR=ea,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class oU extends wy{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Fl),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class eC extends ui{constructor(e,t,n,a,r,l,u,d,p){super(e,t,n,a,r,l,u,d,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class By extends ui{constructor(e,t,n=Zo,a,r,l,u=la,d=la,p,x=Rp,g=1){if(x!==Rp&&x!==Ah)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const _={width:e,height:t,depth:g};super(_,a,r,l,u,d,x,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Lu(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class dS extends ui{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class Dy extends rn{constructor(e=1,t=1,n=4,a=8,r=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:a,heightSegments:r},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),a=Math.max(3,Math.floor(a)),r=Math.max(1,Math.floor(r));const l=[],u=[],d=[],p=[],x=t/2,g=Math.PI/2*e,_=t,y=2*g+_,b=n*2+r,C=a+1,E=new te,S=new te;for(let w=0;w<=b;w++){let D=0,U=0,F=0,N=0;if(w<=n){const L=w/n,P=L*Math.PI/2;U=-x-e*Math.cos(P),F=e*Math.sin(P),N=-e*Math.cos(P),D=L*g}else if(w<=n+r){const L=(w-n)/r;U=-x+L*t,F=e,N=0,D=g+L*_}else{const L=(w-n-r)/n,P=L*Math.PI/2;U=x+e*Math.sin(P),F=e*Math.cos(P),N=e*Math.sin(P),D=g+_+L*g}const z=Math.max(0,Math.min(1,D/y));let j=0;w===0?j=.5/a:w===b&&(j=-.5/a);for(let L=0;L<=a;L++){const P=L/a,q=P*Math.PI*2,ie=Math.sin(q),se=Math.cos(q);S.x=-F*se,S.y=U,S.z=F*ie,u.push(S.x,S.y,S.z),E.set(-F*se,N,F*ie),E.normalize(),d.push(E.x,E.y,E.z),p.push(P+j,z)}if(w>0){const L=(w-1)*C;for(let P=0;P<a;P++){const q=L+P,ie=L+P+1,se=w*C+P,ae=w*C+P+1;l.push(q,ie,se),l.push(ie,ae,se)}}}this.setIndex(l),this.setAttribute("position",new zt(u,3)),this.setAttribute("normal",new zt(d,3)),this.setAttribute("uv",new zt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Dy(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Uy extends rn{constructor(e=1,t=32,n=0,a=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:a},t=Math.max(3,t);const r=[],l=[],u=[],d=[],p=new te,x=new Ge;l.push(0,0,0),u.push(0,0,1),d.push(.5,.5);for(let g=0,_=3;g<=t;g++,_+=3){const y=n+g/t*a;p.x=e*Math.cos(y),p.y=e*Math.sin(y),l.push(p.x,p.y,p.z),u.push(0,0,1),x.x=(l[_]/e+1)/2,x.y=(l[_+1]/e+1)/2,d.push(x.x,x.y)}for(let g=1;g<=t;g++)r.push(g,g+1,0);this.setIndex(r),this.setAttribute("position",new zt(l,3)),this.setAttribute("normal",new zt(u,3)),this.setAttribute("uv",new zt(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Uy(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Sg extends rn{constructor(e=1,t=1,n=1,a=32,r=1,l=!1,u=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:a,heightSegments:r,openEnded:l,thetaStart:u,thetaLength:d};const p=this;a=Math.floor(a),r=Math.floor(r);const x=[],g=[],_=[],y=[];let b=0;const C=[],E=n/2;let S=0;w(),l===!1&&(e>0&&D(!0),t>0&&D(!1)),this.setIndex(x),this.setAttribute("position",new zt(g,3)),this.setAttribute("normal",new zt(_,3)),this.setAttribute("uv",new zt(y,2));function w(){const U=new te,F=new te;let N=0;const z=(t-e)/n;for(let j=0;j<=r;j++){const L=[],P=j/r,q=P*(t-e)+e;for(let ie=0;ie<=a;ie++){const se=ie/a,ae=se*d+u,re=Math.sin(ae),H=Math.cos(ae);F.x=q*re,F.y=-P*n+E,F.z=q*H,g.push(F.x,F.y,F.z),U.set(re,z,H).normalize(),_.push(U.x,U.y,U.z),y.push(se,1-P),L.push(b++)}C.push(L)}for(let j=0;j<a;j++)for(let L=0;L<r;L++){const P=C[L][j],q=C[L+1][j],ie=C[L+1][j+1],se=C[L][j+1];(e>0||L!==0)&&(x.push(P,q,se),N+=3),(t>0||L!==r-1)&&(x.push(q,ie,se),N+=3)}p.addGroup(S,N,0),S+=N}function D(U){const F=b,N=new Ge,z=new te;let j=0;const L=U===!0?e:t,P=U===!0?1:-1;for(let ie=1;ie<=a;ie++)g.push(0,E*P,0),_.push(0,P,0),y.push(.5,.5),b++;const q=b;for(let ie=0;ie<=a;ie++){const ae=ie/a*d+u,re=Math.cos(ae),H=Math.sin(ae);z.x=L*H,z.y=E*P,z.z=L*re,g.push(z.x,z.y,z.z),_.push(0,P,0),N.x=re*.5+.5,N.y=H*.5*P+.5,y.push(N.x,N.y),b++}for(let ie=0;ie<a;ie++){const se=F+ie,ae=q+ie;U===!0?x.push(ae,ae+1,se):x.push(ae+1,ae,se),j+=3}p.addGroup(S,j,U===!0?1:2),S+=j}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sg(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ag extends Sg{constructor(e=1,t=1,n=32,a=1,r=!1,l=0,u=Math.PI*2){super(0,e,t,n,a,r,l,u),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:a,openEnded:r,thetaStart:l,thetaLength:u}}static fromJSON(e){return new Ag(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ku extends rn{constructor(e=[],t=[],n=1,a=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:a};const r=[],l=[];u(a),p(n),x(),this.setAttribute("position",new zt(r,3)),this.setAttribute("normal",new zt(r.slice(),3)),this.setAttribute("uv",new zt(l,2)),a===0?this.computeVertexNormals():this.normalizeNormals();function u(w){const D=new te,U=new te,F=new te;for(let N=0;N<t.length;N+=3)y(t[N+0],D),y(t[N+1],U),y(t[N+2],F),d(D,U,F,w)}function d(w,D,U,F){const N=F+1,z=[];for(let j=0;j<=N;j++){z[j]=[];const L=w.clone().lerp(U,j/N),P=D.clone().lerp(U,j/N),q=N-j;for(let ie=0;ie<=q;ie++)ie===0&&j===N?z[j][ie]=L:z[j][ie]=L.clone().lerp(P,ie/q)}for(let j=0;j<N;j++)for(let L=0;L<2*(N-j)-1;L++){const P=Math.floor(L/2);L%2===0?(_(z[j][P+1]),_(z[j+1][P]),_(z[j][P])):(_(z[j][P+1]),_(z[j+1][P+1]),_(z[j+1][P]))}}function p(w){const D=new te;for(let U=0;U<r.length;U+=3)D.x=r[U+0],D.y=r[U+1],D.z=r[U+2],D.normalize().multiplyScalar(w),r[U+0]=D.x,r[U+1]=D.y,r[U+2]=D.z}function x(){const w=new te;for(let D=0;D<r.length;D+=3){w.x=r[D+0],w.y=r[D+1],w.z=r[D+2];const U=E(w)/2/Math.PI+.5,F=S(w)/Math.PI+.5;l.push(U,1-F)}b(),g()}function g(){for(let w=0;w<l.length;w+=6){const D=l[w+0],U=l[w+2],F=l[w+4],N=Math.max(D,U,F),z=Math.min(D,U,F);N>.9&&z<.1&&(D<.2&&(l[w+0]+=1),U<.2&&(l[w+2]+=1),F<.2&&(l[w+4]+=1))}}function _(w){r.push(w.x,w.y,w.z)}function y(w,D){const U=w*3;D.x=e[U+0],D.y=e[U+1],D.z=e[U+2]}function b(){const w=new te,D=new te,U=new te,F=new te,N=new Ge,z=new Ge,j=new Ge;for(let L=0,P=0;L<r.length;L+=9,P+=6){w.set(r[L+0],r[L+1],r[L+2]),D.set(r[L+3],r[L+4],r[L+5]),U.set(r[L+6],r[L+7],r[L+8]),N.set(l[P+0],l[P+1]),z.set(l[P+2],l[P+3]),j.set(l[P+4],l[P+5]),F.copy(w).add(D).add(U).divideScalar(3);const q=E(F);C(N,P+0,w,q),C(z,P+2,D,q),C(j,P+4,U,q)}}function C(w,D,U,F){F<0&&w.x===1&&(l[D]=w.x-1),U.x===0&&U.z===0&&(l[D]=F/2/Math.PI+.5)}function E(w){return Math.atan2(w.z,-w.x)}function S(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ku(e.vertices,e.indices,e.radius,e.details)}}class Oy extends Ku{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,a=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-a,-n,0,-a,n,0,a,-n,0,a,n,-a,-n,0,-a,n,0,a,-n,0,a,n,0,-n,0,-a,n,0,-a,-n,0,a,n,0,a],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,l,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Oy(e.radius,e.detail)}}const Bx=new te,Dx=new te,p1=new te,Ux=new xr;class tC extends rn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const a=Math.pow(10,4),r=Math.cos(xh*t),l=e.getIndex(),u=e.getAttribute("position"),d=l?l.count:u.count,p=[0,0,0],x=["a","b","c"],g=new Array(3),_={},y=[];for(let b=0;b<d;b+=3){l?(p[0]=l.getX(b),p[1]=l.getX(b+1),p[2]=l.getX(b+2)):(p[0]=b,p[1]=b+1,p[2]=b+2);const{a:C,b:E,c:S}=Ux;if(C.fromBufferAttribute(u,p[0]),E.fromBufferAttribute(u,p[1]),S.fromBufferAttribute(u,p[2]),Ux.getNormal(p1),g[0]=`${Math.round(C.x*a)},${Math.round(C.y*a)},${Math.round(C.z*a)}`,g[1]=`${Math.round(E.x*a)},${Math.round(E.y*a)},${Math.round(E.z*a)}`,g[2]=`${Math.round(S.x*a)},${Math.round(S.y*a)},${Math.round(S.z*a)}`,!(g[0]===g[1]||g[1]===g[2]||g[2]===g[0]))for(let w=0;w<3;w++){const D=(w+1)%3,U=g[w],F=g[D],N=Ux[x[w]],z=Ux[x[D]],j=`${U}_${F}`,L=`${F}_${U}`;L in _&&_[L]?(p1.dot(_[L].normal)<=r&&(y.push(N.x,N.y,N.z),y.push(z.x,z.y,z.z)),_[L]=null):j in _||(_[j]={index0:p[w],index1:p[D],normal:p1.clone()})}}for(const b in _)if(_[b]){const{index0:C,index1:E}=_[b];Bx.fromBufferAttribute(u,C),Dx.fromBufferAttribute(u,E),y.push(Bx.x,Bx.y,Bx.z),y.push(Dx.x,Dx.y,Dx.z)}this.setAttribute("position",new zt(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class $o{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Mt("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,a=this.getPoint(0),r=0;t.push(0);for(let l=1;l<=e;l++)n=this.getPoint(l/e),r+=n.distanceTo(a),t.push(r),a=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let a=0;const r=n.length;let l;t?l=t:l=e*n[r-1];let u=0,d=r-1,p;for(;u<=d;)if(a=Math.floor(u+(d-u)/2),p=n[a]-l,p<0)u=a+1;else if(p>0)d=a-1;else{d=a;break}if(a=d,n[a]===l)return a/(r-1);const x=n[a],_=n[a+1]-x,y=(l-x)/_;return(a+y)/(r-1)}getTangent(e,t){let a=e-1e-4,r=e+1e-4;a<0&&(a=0),r>1&&(r=1);const l=this.getPoint(a),u=this.getPoint(r),d=t||(l.isVector2?new Ge:new te);return d.copy(u).sub(l).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new te,a=[],r=[],l=[],u=new te,d=new Wt;for(let y=0;y<=e;y++){const b=y/e;a[y]=this.getTangentAt(b,new te)}r[0]=new te,l[0]=new te;let p=Number.MAX_VALUE;const x=Math.abs(a[0].x),g=Math.abs(a[0].y),_=Math.abs(a[0].z);x<=p&&(p=x,n.set(1,0,0)),g<=p&&(p=g,n.set(0,1,0)),_<=p&&n.set(0,0,1),u.crossVectors(a[0],n).normalize(),r[0].crossVectors(a[0],u),l[0].crossVectors(a[0],r[0]);for(let y=1;y<=e;y++){if(r[y]=r[y-1].clone(),l[y]=l[y-1].clone(),u.crossVectors(a[y-1],a[y]),u.length()>Number.EPSILON){u.normalize();const b=Math.acos(sn(a[y-1].dot(a[y]),-1,1));r[y].applyMatrix4(d.makeRotationAxis(u,b))}l[y].crossVectors(a[y],r[y])}if(t===!0){let y=Math.acos(sn(r[0].dot(r[e]),-1,1));y/=e,a[0].dot(u.crossVectors(r[0],r[e]))>0&&(y=-y);for(let b=1;b<=e;b++)r[b].applyMatrix4(d.makeRotationAxis(a[b],y*b)),l[b].crossVectors(a[b],r[b])}return{tangents:a,normals:r,binormals:l}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ny extends $o{constructor(e=0,t=0,n=1,a=1,r=0,l=Math.PI*2,u=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=a,this.aStartAngle=r,this.aEndAngle=l,this.aClockwise=u,this.aRotation=d}getPoint(e,t=new Ge){const n=t,a=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const l=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=a;for(;r>a;)r-=a;r<Number.EPSILON&&(l?r=0:r=a),this.aClockwise===!0&&!l&&(r===a?r=-a:r=r-a);const u=this.aStartAngle+e*r;let d=this.aX+this.xRadius*Math.cos(u),p=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const x=Math.cos(this.aRotation),g=Math.sin(this.aRotation),_=d-this.aX,y=p-this.aY;d=_*x-y*g+this.aX,p=_*g+y*x+this.aY}return n.set(d,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class nC extends Ny{constructor(e,t,n,a,r,l){super(e,t,n,n,a,r,l),this.isArcCurve=!0,this.type="ArcCurve"}}function pS(){let i=0,e=0,t=0,n=0;function a(r,l,u,d){i=r,e=u,t=-3*r+3*l-2*u-d,n=2*r-2*l+u+d}return{initCatmullRom:function(r,l,u,d,p){a(l,u,p*(u-r),p*(d-l))},initNonuniformCatmullRom:function(r,l,u,d,p,x,g){let _=(l-r)/p-(u-r)/(p+x)+(u-l)/x,y=(u-l)/x-(d-l)/(x+g)+(d-u)/g;_*=x,y*=x,a(l,u,_,y)},calc:function(r){const l=r*r,u=l*r;return i+e*r+t*l+n*u}}}const Ox=new te,m1=new pS,g1=new pS,v1=new pS;class iC extends $o{constructor(e=[],t=!1,n="centripetal",a=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=a}getPoint(e,t=new te){const n=t,a=this.points,r=a.length,l=(r-(this.closed?0:1))*e;let u=Math.floor(l),d=l-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/r)+1)*r:d===0&&u===r-1&&(u=r-2,d=1);let p,x;this.closed||u>0?p=a[(u-1)%r]:(Ox.subVectors(a[0],a[1]).add(a[0]),p=Ox);const g=a[u%r],_=a[(u+1)%r];if(this.closed||u+2<r?x=a[(u+2)%r]:(Ox.subVectors(a[r-1],a[r-2]).add(a[r-1]),x=Ox),this.curveType==="centripetal"||this.curveType==="chordal"){const y=this.curveType==="chordal"?.5:.25;let b=Math.pow(p.distanceToSquared(g),y),C=Math.pow(g.distanceToSquared(_),y),E=Math.pow(_.distanceToSquared(x),y);C<1e-4&&(C=1),b<1e-4&&(b=C),E<1e-4&&(E=C),m1.initNonuniformCatmullRom(p.x,g.x,_.x,x.x,b,C,E),g1.initNonuniformCatmullRom(p.y,g.y,_.y,x.y,b,C,E),v1.initNonuniformCatmullRom(p.z,g.z,_.z,x.z,b,C,E)}else this.curveType==="catmullrom"&&(m1.initCatmullRom(p.x,g.x,_.x,x.x,this.tension),g1.initCatmullRom(p.y,g.y,_.y,x.y,this.tension),v1.initCatmullRom(p.z,g.z,_.z,x.z,this.tension));return n.set(m1.calc(d),g1.calc(d),v1.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const a=e.points[t];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const a=this.points[t];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const a=e.points[t];this.points.push(new te().fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function KM(i,e,t,n,a){const r=(n-e)*.5,l=(a-t)*.5,u=i*i,d=i*u;return(2*t-2*n+r+l)*d+(-3*t+3*n-2*r-l)*u+r*i+t}function lU(i,e){const t=1-i;return t*t*e}function cU(i,e){return 2*(1-i)*i*e}function uU(i,e){return i*i*e}function Wm(i,e,t,n){return lU(i,e)+cU(i,t)+uU(i,n)}function fU(i,e){const t=1-i;return t*t*t*e}function hU(i,e){const t=1-i;return 3*t*t*i*e}function dU(i,e){return 3*(1-i)*i*i*e}function pU(i,e){return i*i*i*e}function Zm(i,e,t,n,a){return fU(i,e)+hU(i,t)+dU(i,n)+pU(i,a)}class mS extends $o{constructor(e=new Ge,t=new Ge,n=new Ge,a=new Ge){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=a}getPoint(e,t=new Ge){const n=t,a=this.v0,r=this.v1,l=this.v2,u=this.v3;return n.set(Zm(e,a.x,r.x,l.x,u.x),Zm(e,a.y,r.y,l.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class aC extends $o{constructor(e=new te,t=new te,n=new te,a=new te){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=a}getPoint(e,t=new te){const n=t,a=this.v0,r=this.v1,l=this.v2,u=this.v3;return n.set(Zm(e,a.x,r.x,l.x,u.x),Zm(e,a.y,r.y,l.y,u.y),Zm(e,a.z,r.z,l.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class gS extends $o{constructor(e=new Ge,t=new Ge){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ge){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ge){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class sC extends $o{constructor(e=new te,t=new te){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new te){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new te){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vS extends $o{constructor(e=new Ge,t=new Ge,n=new Ge){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Ge){const n=t,a=this.v0,r=this.v1,l=this.v2;return n.set(Wm(e,a.x,r.x,l.x),Wm(e,a.y,r.y,l.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xS extends $o{constructor(e=new te,t=new te,n=new te){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new te){const n=t,a=this.v0,r=this.v1,l=this.v2;return n.set(Wm(e,a.x,r.x,l.x),Wm(e,a.y,r.y,l.y),Wm(e,a.z,r.z,l.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _S extends $o{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ge){const n=t,a=this.points,r=(a.length-1)*e,l=Math.floor(r),u=r-l,d=a[l===0?l:l-1],p=a[l],x=a[l>a.length-2?a.length-1:l+1],g=a[l>a.length-3?a.length-1:l+2];return n.set(KM(u,d.x,p.x,x.x,g.x),KM(u,d.y,p.y,x.y,g.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const a=e.points[t];this.points.push(a.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const a=this.points[t];e.points.push(a.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const a=e.points[t];this.points.push(new Ge().fromArray(a))}return this}}var Q_=Object.freeze({__proto__:null,ArcCurve:nC,CatmullRomCurve3:iC,CubicBezierCurve:mS,CubicBezierCurve3:aC,EllipseCurve:Ny,LineCurve:gS,LineCurve3:sC,QuadraticBezierCurve:vS,QuadraticBezierCurve3:xS,SplineCurve:_S});class rC extends $o{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Q_[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),a=this.getCurveLengths();let r=0;for(;r<a.length;){if(a[r]>=n){const l=a[r]-n,u=this.curves[r],d=u.getLength(),p=d===0?0:1-l/d;return u.getPointAt(p,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,a=this.curves.length;n<a;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let a=0,r=this.curves;a<r.length;a++){const l=r[a],u=l.isEllipseCurve?e*2:l.isLineCurve||l.isLineCurve3?1:l.isSplineCurve?e*l.points.length:e,d=l.getPoints(u);for(let p=0;p<d.length;p++){const x=d[p];n&&n.equals(x)||(t.push(x),n=x)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const a=e.curves[t];this.curves.push(a.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const a=this.curves[t];e.curves.push(a.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const a=e.curves[t];this.curves.push(new Q_[a.type]().fromJSON(a))}return this}}class $_ extends rC{constructor(e){super(),this.type="Path",this.currentPoint=new Ge,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new gS(this.currentPoint.clone(),new Ge(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,a){const r=new vS(this.currentPoint.clone(),new Ge(e,t),new Ge(n,a));return this.curves.push(r),this.currentPoint.set(n,a),this}bezierCurveTo(e,t,n,a,r,l){const u=new mS(this.currentPoint.clone(),new Ge(e,t),new Ge(n,a),new Ge(r,l));return this.curves.push(u),this.currentPoint.set(r,l),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new _S(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,a,r,l){const u=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+u,t+d,n,a,r,l),this}absarc(e,t,n,a,r,l){return this.absellipse(e,t,n,n,a,r,l),this}ellipse(e,t,n,a,r,l,u,d){const p=this.currentPoint.x,x=this.currentPoint.y;return this.absellipse(e+p,t+x,n,a,r,l,u,d),this}absellipse(e,t,n,a,r,l,u,d){const p=new Ny(e,t,n,a,r,l,u,d);if(this.curves.length>0){const g=p.getPoint(0);g.equals(this.currentPoint)||this.lineTo(g.x,g.y)}this.curves.push(p);const x=p.getPoint(1);return this.currentPoint.copy(x),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class _h extends $_{constructor(e){super(e),this.uuid=Pr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,a=this.holes.length;n<a;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const a=e.holes[t];this.holes.push(a.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const a=this.holes[t];e.holes.push(a.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const a=e.holes[t];this.holes.push(new $_().fromJSON(a))}return this}}function mU(i,e,t=2){const n=e&&e.length,a=n?e[0]*t:i.length;let r=oC(i,0,a,t,!0);const l=[];if(!r||r.next===r.prev)return l;let u,d,p;if(n&&(r=yU(i,e,r,t)),i.length>80*t){u=i[0],d=i[1];let x=u,g=d;for(let _=t;_<a;_+=t){const y=i[_],b=i[_+1];y<u&&(u=y),b<d&&(d=b),y>x&&(x=y),b>g&&(g=b)}p=Math.max(x-u,g-d),p=p!==0?32767/p:0}return cg(r,l,t,u,d,p,0),l}function oC(i,e,t,n,a){let r;if(a===DU(i,e,t,n)>0)for(let l=e;l<t;l+=n)r=JM(l/n|0,i[l],i[l+1],r);else for(let l=t-n;l>=e;l-=n)r=JM(l/n|0,i[l],i[l+1],r);return r&&Ip(r,r.next)&&(fg(r),r=r.next),r}function Th(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(Ip(t,t.next)||$i(t.prev,t,t.next)===0)){if(fg(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function cg(i,e,t,n,a,r,l){if(!i)return;!l&&r&&EU(i,n,a,r);let u=i;for(;i.prev!==i.next;){const d=i.prev,p=i.next;if(r?vU(i,n,a,r):gU(i)){e.push(d.i,i.i,p.i),fg(i),i=p.next,u=p.next;continue}if(i=p,i===u){l?l===1?(i=xU(Th(i),e),cg(i,e,t,n,a,r,2)):l===2&&_U(i,e,t,n,a,r):cg(Th(i),e,t,n,a,r,1);break}}}function gU(i){const e=i.prev,t=i,n=i.next;if($i(e,t,n)>=0)return!1;const a=e.x,r=t.x,l=n.x,u=e.y,d=t.y,p=n.y,x=Math.min(a,r,l),g=Math.min(u,d,p),_=Math.max(a,r,l),y=Math.max(u,d,p);let b=n.next;for(;b!==e;){if(b.x>=x&&b.x<=_&&b.y>=g&&b.y<=y&&Vm(a,u,r,d,l,p,b.x,b.y)&&$i(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function vU(i,e,t,n){const a=i.prev,r=i,l=i.next;if($i(a,r,l)>=0)return!1;const u=a.x,d=r.x,p=l.x,x=a.y,g=r.y,_=l.y,y=Math.min(u,d,p),b=Math.min(x,g,_),C=Math.max(u,d,p),E=Math.max(x,g,_),S=Eb(y,b,e,t,n),w=Eb(C,E,e,t,n);let D=i.prevZ,U=i.nextZ;for(;D&&D.z>=S&&U&&U.z<=w;){if(D.x>=y&&D.x<=C&&D.y>=b&&D.y<=E&&D!==a&&D!==l&&Vm(u,x,d,g,p,_,D.x,D.y)&&$i(D.prev,D,D.next)>=0||(D=D.prevZ,U.x>=y&&U.x<=C&&U.y>=b&&U.y<=E&&U!==a&&U!==l&&Vm(u,x,d,g,p,_,U.x,U.y)&&$i(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;D&&D.z>=S;){if(D.x>=y&&D.x<=C&&D.y>=b&&D.y<=E&&D!==a&&D!==l&&Vm(u,x,d,g,p,_,D.x,D.y)&&$i(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;U&&U.z<=w;){if(U.x>=y&&U.x<=C&&U.y>=b&&U.y<=E&&U!==a&&U!==l&&Vm(u,x,d,g,p,_,U.x,U.y)&&$i(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function xU(i,e){let t=i;do{const n=t.prev,a=t.next.next;!Ip(n,a)&&cC(n,t,t.next,a)&&ug(n,a)&&ug(a,n)&&(e.push(n.i,t.i,a.i),fg(t),fg(t.next),t=i=a),t=t.next}while(t!==i);return Th(t)}function _U(i,e,t,n,a,r){let l=i;do{let u=l.next.next;for(;u!==l.prev;){if(l.i!==u.i&&RU(l,u)){let d=uC(l,u);l=Th(l,l.next),d=Th(d,d.next),cg(l,e,t,n,a,r,0),cg(d,e,t,n,a,r,0);return}u=u.next}l=l.next}while(l!==i)}function yU(i,e,t,n){const a=[];for(let r=0,l=e.length;r<l;r++){const u=e[r]*n,d=r<l-1?e[r+1]*n:i.length,p=oC(i,u,d,n,!1);p===p.next&&(p.steiner=!0),a.push(CU(p))}a.sort(bU);for(let r=0;r<a.length;r++)t=SU(a[r],t);return t}function bU(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),a=(e.next.y-e.y)/(e.next.x-e.x);t=n-a}return t}function SU(i,e){const t=AU(i,e);if(!t)return e;const n=uC(t,i);return Th(n,n.next),Th(t,t.next)}function AU(i,e){let t=e;const n=i.x,a=i.y;let r=-1/0,l;if(Ip(i,t))return t;do{if(Ip(i,t.next))return t.next;if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){const g=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(g<=n&&g>r&&(r=g,l=t.x<t.next.x?t:t.next,g===n))return l}t=t.next}while(t!==e);if(!l)return null;const u=l,d=l.x,p=l.y;let x=1/0;t=l;do{if(n>=t.x&&t.x>=d&&n!==t.x&&lC(a<p?n:r,a,d,p,a<p?r:n,a,t.x,t.y)){const g=Math.abs(a-t.y)/(n-t.x);ug(t,i)&&(g<x||g===x&&(t.x>l.x||t.x===l.x&&MU(l,t)))&&(l=t,x=g)}t=t.next}while(t!==u);return l}function MU(i,e){return $i(i.prev,i,e.prev)<0&&$i(e.next,i,i.next)<0}function EU(i,e,t,n){let a=i;do a.z===0&&(a.z=Eb(a.x,a.y,e,t,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==i);a.prevZ.nextZ=null,a.prevZ=null,TU(a)}function TU(i){let e,t=1;do{let n=i,a;i=null;let r=null;for(e=0;n;){e++;let l=n,u=0;for(let p=0;p<t&&(u++,l=l.nextZ,!!l);p++);let d=t;for(;u>0||d>0&&l;)u!==0&&(d===0||!l||n.z<=l.z)?(a=n,n=n.nextZ,u--):(a=l,l=l.nextZ,d--),r?r.nextZ=a:i=a,a.prevZ=r,r=a;n=l}r.nextZ=null,t*=2}while(e>1);return i}function Eb(i,e,t,n,a){return i=(i-t)*a|0,e=(e-n)*a|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function CU(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function lC(i,e,t,n,a,r,l,u){return(a-l)*(e-u)>=(i-l)*(r-u)&&(i-l)*(n-u)>=(t-l)*(e-u)&&(t-l)*(r-u)>=(a-l)*(n-u)}function Vm(i,e,t,n,a,r,l,u){return!(i===l&&e===u)&&lC(i,e,t,n,a,r,l,u)}function RU(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!wU(i,e)&&(ug(i,e)&&ug(e,i)&&BU(i,e)&&($i(i.prev,i,e.prev)||$i(i,e.prev,e))||Ip(i,e)&&$i(i.prev,i,i.next)>0&&$i(e.prev,e,e.next)>0)}function $i(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Ip(i,e){return i.x===e.x&&i.y===e.y}function cC(i,e,t,n){const a=Lx($i(i,e,t)),r=Lx($i(i,e,n)),l=Lx($i(t,n,i)),u=Lx($i(t,n,e));return!!(a!==r&&l!==u||a===0&&Nx(i,t,e)||r===0&&Nx(i,n,e)||l===0&&Nx(t,i,n)||u===0&&Nx(t,e,n))}function Nx(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function Lx(i){return i>0?1:i<0?-1:0}function wU(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&cC(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function ug(i,e){return $i(i.prev,i,i.next)<0?$i(i,e,i.next)>=0&&$i(i,i.prev,e)>=0:$i(i,e,i.prev)<0||$i(i,i.next,e)<0}function BU(i,e){let t=i,n=!1;const a=(i.x+e.x)/2,r=(i.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&a<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function uC(i,e){const t=Tb(i.i,i.x,i.y),n=Tb(e.i,e.x,e.y),a=i.next,r=e.prev;return i.next=e,e.prev=i,t.next=a,a.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function JM(i,e,t,n){const a=Tb(i,e,t);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function fg(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Tb(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function DU(i,e,t,n){let a=0;for(let r=e,l=t-n;r<t;r+=n)a+=(i[l]-i[r])*(i[r+1]+i[l+1]),l=r;return a}class UU{static triangulate(e,t,n=2){return mU(e,t,n)}}class Ko{static area(e){const t=e.length;let n=0;for(let a=t-1,r=0;r<t;a=r++)n+=e[a].x*e[r].y-e[r].x*e[a].y;return n*.5}static isClockWise(e){return Ko.area(e)<0}static triangulateShape(e,t){const n=[],a=[],r=[];WM(e),ZM(n,e);let l=e.length;t.forEach(WM);for(let d=0;d<t.length;d++)a.push(l),l+=t[d].length,ZM(n,t[d]);const u=UU.triangulate(n,a);for(let d=0;d<u.length;d+=3)r.push(u.slice(d,d+3));return r}}function WM(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function ZM(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class Ly extends rn{constructor(e=new _h([new Ge(.5,.5),new Ge(-.5,.5),new Ge(-.5,-.5),new Ge(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,a=[],r=[];for(let u=0,d=e.length;u<d;u++){const p=e[u];l(p)}this.setAttribute("position",new zt(a,3)),this.setAttribute("uv",new zt(r,2)),this.computeVertexNormals();function l(u){const d=[],p=t.curveSegments!==void 0?t.curveSegments:12,x=t.steps!==void 0?t.steps:1,g=t.depth!==void 0?t.depth:1;let _=t.bevelEnabled!==void 0?t.bevelEnabled:!0,y=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:y-.1,C=t.bevelOffset!==void 0?t.bevelOffset:0,E=t.bevelSegments!==void 0?t.bevelSegments:3;const S=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:OU;let D,U=!1,F,N,z,j;S&&(D=S.getSpacedPoints(x),U=!0,_=!1,F=S.computeFrenetFrames(x,!1),N=new te,z=new te,j=new te),_||(E=0,y=0,b=0,C=0);const L=u.extractPoints(p);let P=L.shape;const q=L.holes;if(!Ko.isClockWise(P)){P=P.reverse();for(let ke=0,$=q.length;ke<$;ke++){const Qe=q[ke];Ko.isClockWise(Qe)&&(q[ke]=Qe.reverse())}}function se(ke){const Qe=10000000000000001e-36;let st=ke[0];for(let pt=1;pt<=ke.length;pt++){const it=pt%ke.length,bt=ke[it],mt=bt.x-st.x,Ct=bt.y-st.y,ee=mt*mt+Ct*Ct,X=Math.max(Math.abs(bt.x),Math.abs(bt.y),Math.abs(st.x),Math.abs(st.y)),Ae=Qe*X*X;if(ee<=Ae){ke.splice(it,1),pt--;continue}st=bt}}se(P),q.forEach(se);const ae=q.length,re=P;for(let ke=0;ke<ae;ke++){const $=q[ke];P=P.concat($)}function H(ke,$,Qe){return $||un("ExtrudeGeometry: vec does not exist"),ke.clone().addScaledVector($,Qe)}const K=P.length;function W(ke,$,Qe){let st,pt,it;const bt=ke.x-$.x,mt=ke.y-$.y,Ct=Qe.x-ke.x,ee=Qe.y-ke.y,X=bt*bt+mt*mt,Ae=bt*ee-mt*Ct;if(Math.abs(Ae)>Number.EPSILON){const He=Math.sqrt(X),Ze=Math.sqrt(Ct*Ct+ee*ee),Le=$.x-mt/He,Nt=$.y+bt/He,xt=Qe.x-ee/Ze,Vt=Qe.y+Ct/Ze,Lt=((xt-Le)*ee-(Vt-Nt)*Ct)/(bt*ee-mt*Ct);st=Le+bt*Lt-ke.x,pt=Nt+mt*Lt-ke.y;const Ye=st*st+pt*pt;if(Ye<=2)return new Ge(st,pt);it=Math.sqrt(Ye/2)}else{let He=!1;bt>Number.EPSILON?Ct>Number.EPSILON&&(He=!0):bt<-Number.EPSILON?Ct<-Number.EPSILON&&(He=!0):Math.sign(mt)===Math.sign(ee)&&(He=!0),He?(st=-mt,pt=bt,it=Math.sqrt(X)):(st=bt,pt=mt,it=Math.sqrt(X/2))}return new Ge(st/it,pt/it)}const me=[];for(let ke=0,$=re.length,Qe=$-1,st=ke+1;ke<$;ke++,Qe++,st++)Qe===$&&(Qe=0),st===$&&(st=0),me[ke]=W(re[ke],re[Qe],re[st]);const ve=[];let Q,de=me.concat();for(let ke=0,$=ae;ke<$;ke++){const Qe=q[ke];Q=[];for(let st=0,pt=Qe.length,it=pt-1,bt=st+1;st<pt;st++,it++,bt++)it===pt&&(it=0),bt===pt&&(bt=0),Q[st]=W(Qe[st],Qe[it],Qe[bt]);ve.push(Q),de=de.concat(Q)}let Te;if(E===0)Te=Ko.triangulateShape(re,q);else{const ke=[],$=[];for(let Qe=0;Qe<E;Qe++){const st=Qe/E,pt=y*Math.cos(st*Math.PI/2),it=b*Math.sin(st*Math.PI/2)+C;for(let bt=0,mt=re.length;bt<mt;bt++){const Ct=H(re[bt],me[bt],it);et(Ct.x,Ct.y,-pt),st===0&&ke.push(Ct)}for(let bt=0,mt=ae;bt<mt;bt++){const Ct=q[bt];Q=ve[bt];const ee=[];for(let X=0,Ae=Ct.length;X<Ae;X++){const He=H(Ct[X],Q[X],it);et(He.x,He.y,-pt),st===0&&ee.push(He)}st===0&&$.push(ee)}}Te=Ko.triangulateShape(ke,$)}const Me=Te.length,rt=b+C;for(let ke=0;ke<K;ke++){const $=_?H(P[ke],de[ke],rt):P[ke];U?(z.copy(F.normals[0]).multiplyScalar($.x),N.copy(F.binormals[0]).multiplyScalar($.y),j.copy(D[0]).add(z).add(N),et(j.x,j.y,j.z)):et($.x,$.y,0)}for(let ke=1;ke<=x;ke++)for(let $=0;$<K;$++){const Qe=_?H(P[$],de[$],rt):P[$];U?(z.copy(F.normals[ke]).multiplyScalar(Qe.x),N.copy(F.binormals[ke]).multiplyScalar(Qe.y),j.copy(D[ke]).add(z).add(N),et(j.x,j.y,j.z)):et(Qe.x,Qe.y,g/x*ke)}for(let ke=E-1;ke>=0;ke--){const $=ke/E,Qe=y*Math.cos($*Math.PI/2),st=b*Math.sin($*Math.PI/2)+C;for(let pt=0,it=re.length;pt<it;pt++){const bt=H(re[pt],me[pt],st);et(bt.x,bt.y,g+Qe)}for(let pt=0,it=q.length;pt<it;pt++){const bt=q[pt];Q=ve[pt];for(let mt=0,Ct=bt.length;mt<Ct;mt++){const ee=H(bt[mt],Q[mt],st);U?et(ee.x,ee.y+D[x-1].y,D[x-1].x+Qe):et(ee.x,ee.y,g+Qe)}}}xe(),fe();function xe(){const ke=a.length/3;if(_){let $=0,Qe=K*$;for(let st=0;st<Me;st++){const pt=Te[st];ht(pt[2]+Qe,pt[1]+Qe,pt[0]+Qe)}$=x+E*2,Qe=K*$;for(let st=0;st<Me;st++){const pt=Te[st];ht(pt[0]+Qe,pt[1]+Qe,pt[2]+Qe)}}else{for(let $=0;$<Me;$++){const Qe=Te[$];ht(Qe[2],Qe[1],Qe[0])}for(let $=0;$<Me;$++){const Qe=Te[$];ht(Qe[0]+K*x,Qe[1]+K*x,Qe[2]+K*x)}}n.addGroup(ke,a.length/3-ke,0)}function fe(){const ke=a.length/3;let $=0;Fe(re,$),$+=re.length;for(let Qe=0,st=q.length;Qe<st;Qe++){const pt=q[Qe];Fe(pt,$),$+=pt.length}n.addGroup(ke,a.length/3-ke,1)}function Fe(ke,$){let Qe=ke.length;for(;--Qe>=0;){const st=Qe;let pt=Qe-1;pt<0&&(pt=ke.length-1);for(let it=0,bt=x+E*2;it<bt;it++){const mt=K*it,Ct=K*(it+1),ee=$+st+mt,X=$+pt+mt,Ae=$+pt+Ct,He=$+st+Ct;yt(ee,X,Ae,He)}}}function et(ke,$,Qe){d.push(ke),d.push($),d.push(Qe)}function ht(ke,$,Qe){Xt(ke),Xt($),Xt(Qe);const st=a.length/3,pt=w.generateTopUV(n,a,st-3,st-2,st-1);Ot(pt[0]),Ot(pt[1]),Ot(pt[2])}function yt(ke,$,Qe,st){Xt(ke),Xt($),Xt(st),Xt($),Xt(Qe),Xt(st);const pt=a.length/3,it=w.generateSideWallUV(n,a,pt-6,pt-3,pt-2,pt-1);Ot(it[0]),Ot(it[1]),Ot(it[3]),Ot(it[1]),Ot(it[2]),Ot(it[3])}function Xt(ke){a.push(d[ke*3+0]),a.push(d[ke*3+1]),a.push(d[ke*3+2])}function Ot(ke){r.push(ke.x),r.push(ke.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return NU(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,l=e.shapes.length;r<l;r++){const u=t[e.shapes[r]];n.push(u)}const a=e.options.extrudePath;return a!==void 0&&(e.options.extrudePath=new Q_[a.type]().fromJSON(a)),new Ly(n,e.options)}}const OU={generateTopUV:function(i,e,t,n,a){const r=e[t*3],l=e[t*3+1],u=e[n*3],d=e[n*3+1],p=e[a*3],x=e[a*3+1];return[new Ge(r,l),new Ge(u,d),new Ge(p,x)]},generateSideWallUV:function(i,e,t,n,a,r){const l=e[t*3],u=e[t*3+1],d=e[t*3+2],p=e[n*3],x=e[n*3+1],g=e[n*3+2],_=e[a*3],y=e[a*3+1],b=e[a*3+2],C=e[r*3],E=e[r*3+1],S=e[r*3+2];return Math.abs(u-x)<Math.abs(l-p)?[new Ge(l,1-d),new Ge(p,1-g),new Ge(_,1-b),new Ge(C,1-S)]:[new Ge(u,1-d),new Ge(x,1-g),new Ge(y,1-b),new Ge(E,1-S)]}};function NU(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,a=i.length;n<a;n++){const r=i[n];t.shapes.push(r.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Mg extends Ku{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,a=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(a,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Mg(e.radius,e.detail)}}class Iy extends rn{constructor(e=[new Ge(0,-.5),new Ge(.5,0),new Ge(0,.5)],t=12,n=0,a=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:a},t=Math.floor(t),a=sn(a,0,Math.PI*2);const r=[],l=[],u=[],d=[],p=[],x=1/t,g=new te,_=new Ge,y=new te,b=new te,C=new te;let E=0,S=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:E=e[w+1].x-e[w].x,S=e[w+1].y-e[w].y,y.x=S*1,y.y=-E,y.z=S*0,C.copy(y),y.normalize(),d.push(y.x,y.y,y.z);break;case e.length-1:d.push(C.x,C.y,C.z);break;default:E=e[w+1].x-e[w].x,S=e[w+1].y-e[w].y,y.x=S*1,y.y=-E,y.z=S*0,b.copy(y),y.x+=C.x,y.y+=C.y,y.z+=C.z,y.normalize(),d.push(y.x,y.y,y.z),C.copy(b)}for(let w=0;w<=t;w++){const D=n+w*x*a,U=Math.sin(D),F=Math.cos(D);for(let N=0;N<=e.length-1;N++){g.x=e[N].x*U,g.y=e[N].y,g.z=e[N].x*F,l.push(g.x,g.y,g.z),_.x=w/t,_.y=N/(e.length-1),u.push(_.x,_.y);const z=d[3*N+0]*U,j=d[3*N+1],L=d[3*N+0]*F;p.push(z,j,L)}}for(let w=0;w<t;w++)for(let D=0;D<e.length-1;D++){const U=D+w*e.length,F=U,N=U+e.length,z=U+e.length+1,j=U+1;r.push(F,N,j),r.push(z,j,N)}this.setIndex(r),this.setAttribute("position",new zt(l,3)),this.setAttribute("uv",new zt(u,2)),this.setAttribute("normal",new zt(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Iy(e.points,e.segments,e.phiStart,e.phiLength)}}class Eg extends Ku{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],a=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,a,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Eg(e.radius,e.detail)}}class Ju extends rn{constructor(e=1,t=1,n=1,a=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:a};const r=e/2,l=t/2,u=Math.floor(n),d=Math.floor(a),p=u+1,x=d+1,g=e/u,_=t/d,y=[],b=[],C=[],E=[];for(let S=0;S<x;S++){const w=S*_-l;for(let D=0;D<p;D++){const U=D*g-r;b.push(U,-w,0),C.push(0,0,1),E.push(D/u),E.push(1-S/d)}}for(let S=0;S<d;S++)for(let w=0;w<u;w++){const D=w+p*S,U=w+p*(S+1),F=w+1+p*(S+1),N=w+1+p*S;y.push(D,U,N),y.push(U,F,N)}this.setIndex(y),this.setAttribute("position",new zt(b,3)),this.setAttribute("normal",new zt(C,3)),this.setAttribute("uv",new zt(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ju(e.width,e.height,e.widthSegments,e.heightSegments)}}class Py extends rn{constructor(e=.5,t=1,n=32,a=1,r=0,l=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:a,thetaStart:r,thetaLength:l},n=Math.max(3,n),a=Math.max(1,a);const u=[],d=[],p=[],x=[];let g=e;const _=(t-e)/a,y=new te,b=new Ge;for(let C=0;C<=a;C++){for(let E=0;E<=n;E++){const S=r+E/n*l;y.x=g*Math.cos(S),y.y=g*Math.sin(S),d.push(y.x,y.y,y.z),p.push(0,0,1),b.x=(y.x/t+1)/2,b.y=(y.y/t+1)/2,x.push(b.x,b.y)}g+=_}for(let C=0;C<a;C++){const E=C*(n+1);for(let S=0;S<n;S++){const w=S+E,D=w,U=w+n+1,F=w+n+2,N=w+1;u.push(D,U,N),u.push(U,F,N)}}this.setIndex(u),this.setAttribute("position",new zt(d,3)),this.setAttribute("normal",new zt(p,3)),this.setAttribute("uv",new zt(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Py(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Fy extends rn{constructor(e=new _h([new Ge(0,.5),new Ge(-.5,-.5),new Ge(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],a=[],r=[],l=[];let u=0,d=0;if(Array.isArray(e)===!1)p(e);else for(let x=0;x<e.length;x++)p(e[x]),this.addGroup(u,d,x),u+=d,d=0;this.setIndex(n),this.setAttribute("position",new zt(a,3)),this.setAttribute("normal",new zt(r,3)),this.setAttribute("uv",new zt(l,2));function p(x){const g=a.length/3,_=x.extractPoints(t);let y=_.shape;const b=_.holes;Ko.isClockWise(y)===!1&&(y=y.reverse());for(let E=0,S=b.length;E<S;E++){const w=b[E];Ko.isClockWise(w)===!0&&(b[E]=w.reverse())}const C=Ko.triangulateShape(y,b);for(let E=0,S=b.length;E<S;E++){const w=b[E];y=y.concat(w)}for(let E=0,S=y.length;E<S;E++){const w=y[E];a.push(w.x,w.y,0),r.push(0,0,1),l.push(w.x,w.y)}for(let E=0,S=C.length;E<S;E++){const w=C[E],D=w[0]+g,U=w[1]+g,F=w[2]+g;n.push(D,U,F),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return LU(t,e)}static fromJSON(e,t){const n=[];for(let a=0,r=e.shapes.length;a<r;a++){const l=t[e.shapes[a]];n.push(l)}return new Fy(n,e.curveSegments)}}function LU(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const a=i[t];e.shapes.push(a.uuid)}else e.shapes.push(i.uuid);return e}class Oh extends rn{constructor(e=1,t=32,n=16,a=0,r=Math.PI*2,l=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:a,phiLength:r,thetaStart:l,thetaLength:u},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(l+u,Math.PI);let p=0;const x=[],g=new te,_=new te,y=[],b=[],C=[],E=[];for(let S=0;S<=n;S++){const w=[],D=S/n;let U=0;S===0&&l===0?U=.5/t:S===n&&d===Math.PI&&(U=-.5/t);for(let F=0;F<=t;F++){const N=F/t;g.x=-e*Math.cos(a+N*r)*Math.sin(l+D*u),g.y=e*Math.cos(l+D*u),g.z=e*Math.sin(a+N*r)*Math.sin(l+D*u),b.push(g.x,g.y,g.z),_.copy(g).normalize(),C.push(_.x,_.y,_.z),E.push(N+U,1-D),w.push(p++)}x.push(w)}for(let S=0;S<n;S++)for(let w=0;w<t;w++){const D=x[S][w+1],U=x[S][w],F=x[S+1][w],N=x[S+1][w+1];(S!==0||l>0)&&y.push(D,U,N),(S!==n-1||d<Math.PI)&&y.push(U,F,N)}this.setIndex(y),this.setAttribute("position",new zt(b,3)),this.setAttribute("normal",new zt(C,3)),this.setAttribute("uv",new zt(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Oh(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class zy extends Ku{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],a=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,a,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new zy(e.radius,e.detail)}}class Hy extends rn{constructor(e=1,t=.4,n=12,a=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:a,arc:r},n=Math.floor(n),a=Math.floor(a);const l=[],u=[],d=[],p=[],x=new te,g=new te,_=new te;for(let y=0;y<=n;y++)for(let b=0;b<=a;b++){const C=b/a*r,E=y/n*Math.PI*2;g.x=(e+t*Math.cos(E))*Math.cos(C),g.y=(e+t*Math.cos(E))*Math.sin(C),g.z=t*Math.sin(E),u.push(g.x,g.y,g.z),x.x=e*Math.cos(C),x.y=e*Math.sin(C),_.subVectors(g,x).normalize(),d.push(_.x,_.y,_.z),p.push(b/a),p.push(y/n)}for(let y=1;y<=n;y++)for(let b=1;b<=a;b++){const C=(a+1)*y+b-1,E=(a+1)*(y-1)+b-1,S=(a+1)*(y-1)+b,w=(a+1)*y+b;l.push(C,E,w),l.push(E,S,w)}this.setIndex(l),this.setAttribute("position",new zt(u,3)),this.setAttribute("normal",new zt(d,3)),this.setAttribute("uv",new zt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hy(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Gy extends rn{constructor(e=1,t=.4,n=64,a=8,r=2,l=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:a,p:r,q:l},n=Math.floor(n),a=Math.floor(a);const u=[],d=[],p=[],x=[],g=new te,_=new te,y=new te,b=new te,C=new te,E=new te,S=new te;for(let D=0;D<=n;++D){const U=D/n*r*Math.PI*2;w(U,r,l,e,y),w(U+.01,r,l,e,b),E.subVectors(b,y),S.addVectors(b,y),C.crossVectors(E,S),S.crossVectors(C,E),C.normalize(),S.normalize();for(let F=0;F<=a;++F){const N=F/a*Math.PI*2,z=-t*Math.cos(N),j=t*Math.sin(N);g.x=y.x+(z*S.x+j*C.x),g.y=y.y+(z*S.y+j*C.y),g.z=y.z+(z*S.z+j*C.z),d.push(g.x,g.y,g.z),_.subVectors(g,y).normalize(),p.push(_.x,_.y,_.z),x.push(D/n),x.push(F/a)}}for(let D=1;D<=n;D++)for(let U=1;U<=a;U++){const F=(a+1)*(D-1)+(U-1),N=(a+1)*D+(U-1),z=(a+1)*D+U,j=(a+1)*(D-1)+U;u.push(F,N,j),u.push(N,z,j)}this.setIndex(u),this.setAttribute("position",new zt(d,3)),this.setAttribute("normal",new zt(p,3)),this.setAttribute("uv",new zt(x,2));function w(D,U,F,N,z){const j=Math.cos(D),L=Math.sin(D),P=F/U*D,q=Math.cos(P);z.x=N*(2+q)*.5*j,z.y=N*(2+q)*L*.5,z.z=N*Math.sin(P)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gy(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Vy extends rn{constructor(e=new xS(new te(-1,-1,0),new te(-1,1,0),new te(1,1,0)),t=64,n=1,a=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:a,closed:r};const l=e.computeFrenetFrames(t,r);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;const u=new te,d=new te,p=new Ge;let x=new te;const g=[],_=[],y=[],b=[];C(),this.setIndex(b),this.setAttribute("position",new zt(g,3)),this.setAttribute("normal",new zt(_,3)),this.setAttribute("uv",new zt(y,2));function C(){for(let D=0;D<t;D++)E(D);E(r===!1?t:0),w(),S()}function E(D){x=e.getPointAt(D/t,x);const U=l.normals[D],F=l.binormals[D];for(let N=0;N<=a;N++){const z=N/a*Math.PI*2,j=Math.sin(z),L=-Math.cos(z);d.x=L*U.x+j*F.x,d.y=L*U.y+j*F.y,d.z=L*U.z+j*F.z,d.normalize(),_.push(d.x,d.y,d.z),u.x=x.x+n*d.x,u.y=x.y+n*d.y,u.z=x.z+n*d.z,g.push(u.x,u.y,u.z)}}function S(){for(let D=1;D<=t;D++)for(let U=1;U<=a;U++){const F=(a+1)*(D-1)+(U-1),N=(a+1)*D+(U-1),z=(a+1)*D+U,j=(a+1)*(D-1)+U;b.push(F,N,j),b.push(N,z,j)}}function w(){for(let D=0;D<=t;D++)for(let U=0;U<=a;U++)p.x=D/t,p.y=U/a,y.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Vy(new Q_[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class fC extends rn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,a=new te,r=new te;if(e.index!==null){const l=e.attributes.position,u=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:u.count,materialIndex:0}]);for(let p=0,x=d.length;p<x;++p){const g=d[p],_=g.start,y=g.count;for(let b=_,C=_+y;b<C;b+=3)for(let E=0;E<3;E++){const S=u.getX(b+E),w=u.getX(b+(E+1)%3);a.fromBufferAttribute(l,S),r.fromBufferAttribute(l,w),QM(a,r,n)===!0&&(t.push(a.x,a.y,a.z),t.push(r.x,r.y,r.z))}}}else{const l=e.attributes.position;for(let u=0,d=l.count/3;u<d;u++)for(let p=0;p<3;p++){const x=3*u+p,g=3*u+(p+1)%3;a.fromBufferAttribute(l,x),r.fromBufferAttribute(l,g),QM(a,r,n)===!0&&(t.push(a.x,a.y,a.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new zt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function QM(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,a=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(a)===!0?!1:(t.add(n),t.add(a),!0)}var $M=Object.freeze({__proto__:null,BoxGeometry:Uh,CapsuleGeometry:Dy,CircleGeometry:Uy,ConeGeometry:Ag,CylinderGeometry:Sg,DodecahedronGeometry:Oy,EdgesGeometry:tC,ExtrudeGeometry:Ly,IcosahedronGeometry:Mg,LatheGeometry:Iy,OctahedronGeometry:Eg,PlaneGeometry:Ju,PolyhedronGeometry:Ku,RingGeometry:Py,ShapeGeometry:Fy,SphereGeometry:Oh,TetrahedronGeometry:zy,TorusGeometry:Hy,TorusKnotGeometry:Gy,TubeGeometry:Vy,WireframeGeometry:fC});class hC extends ya{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ut(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class dC extends hi{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class ra extends ya{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zr,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class po extends ra{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ge(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return sn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ut(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ut(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ut(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class pC extends ya{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ut(16777215),this.specular=new ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zr,this.combine=mg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mC extends ya{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ut(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class yS extends ya{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class gC extends ya{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zr,this.combine=mg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bS extends ya{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Yu,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class SS extends ya{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class vC extends ya{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class xC extends Os{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function ph(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function _C(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function yC(i){function e(a,r){return i[a]-i[r]}const t=i.length,n=new Array(t);for(let a=0;a!==t;++a)n[a]=a;return n.sort(e),n}function Cb(i,e,t){const n=i.length,a=new i.constructor(n);for(let r=0,l=0;l!==n;++r){const u=t[r]*e;for(let d=0;d!==e;++d)a[l++]=i[u+d]}return a}function AS(i,e,t,n){let a=1,r=i[0];for(;r!==void 0&&r[n]===void 0;)r=i[a++];if(r===void 0)return;let l=r[n];if(l!==void 0)if(Array.isArray(l))do l=r[n],l!==void 0&&(e.push(r.time),t.push(...l)),r=i[a++];while(r!==void 0);else if(l.toArray!==void 0)do l=r[n],l!==void 0&&(e.push(r.time),l.toArray(t,t.length)),r=i[a++];while(r!==void 0);else do l=r[n],l!==void 0&&(e.push(r.time),t.push(l)),r=i[a++];while(r!==void 0)}function IU(i,e,t,n,a=30){const r=i.clone();r.name=e;const l=[];for(let d=0;d<r.tracks.length;++d){const p=r.tracks[d],x=p.getValueSize(),g=[],_=[];for(let y=0;y<p.times.length;++y){const b=p.times[y]*a;if(!(b<t||b>=n)){g.push(p.times[y]);for(let C=0;C<x;++C)_.push(p.values[y*x+C])}}g.length!==0&&(p.times=ph(g,p.times.constructor),p.values=ph(_,p.values.constructor),l.push(p))}r.tracks=l;let u=1/0;for(let d=0;d<r.tracks.length;++d)u>r.tracks[d].times[0]&&(u=r.tracks[d].times[0]);for(let d=0;d<r.tracks.length;++d)r.tracks[d].shift(-1*u);return r.resetDuration(),r}function PU(i,e=0,t=i,n=30){n<=0&&(n=30);const a=t.tracks.length,r=e/n;for(let l=0;l<a;++l){const u=t.tracks[l],d=u.ValueTypeName;if(d==="bool"||d==="string")continue;const p=i.tracks.find(function(S){return S.name===u.name&&S.ValueTypeName===d});if(p===void 0)continue;let x=0;const g=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(x=g/3);let _=0;const y=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=y/3);const b=u.times.length-1;let C;if(r<=u.times[0]){const S=x,w=g-x;C=u.values.slice(S,w)}else if(r>=u.times[b]){const S=b*g+x,w=S+g-x;C=u.values.slice(S,w)}else{const S=u.createInterpolant(),w=x,D=g-x;S.evaluate(r),C=S.resultBuffer.slice(w,D)}d==="quaternion"&&new ts().fromArray(C).normalize().conjugate().toArray(C);const E=p.times.length;for(let S=0;S<E;++S){const w=S*y+_;if(d==="quaternion")ts.multiplyQuaternionsFlat(p.values,w,C,0,p.values,w);else{const D=y-_*2;for(let U=0;U<D;++U)p.values[w+U]-=C[U]}}}return i.blendMode=$b,i}class FU{static convertArray(e,t){return ph(e,t)}static isTypedArray(e){return _C(e)}static getKeyframeOrder(e){return yC(e)}static sortedArray(e,t,n){return Cb(e,t,n)}static flattenJSON(e,t,n,a){AS(e,t,n,a)}static subclip(e,t,n,a,r=30){return IU(e,t,n,a,r)}static makeClipAdditive(e,t=0,n=e,a=30){return PU(e,t,n,a)}}class kp{constructor(e,t,n,a){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=a!==void 0?a:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,a=t[n],r=t[n-1];e:{t:{let l;n:{i:if(!(e<a)){for(let u=n+2;;){if(a===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===u)break;if(r=a,a=t[++n],e<a)break t}l=t.length;break n}if(!(e>=r)){const u=t[1];e<u&&(n=2,r=u);for(let d=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(a=r,r=t[--n-1],e>=r)break t}l=n,n=0;break n}break e}for(;n<l;){const u=n+l>>>1;e<t[u]?l=u:n=u+1}if(a=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(a===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,a)}return this.interpolate_(n,r,e,a)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,a=this.valueSize,r=e*a;for(let l=0;l!==a;++l)t[l]=n[r+l];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class bC extends kp{constructor(e,t,n,a){super(e,t,n,a),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:fh,endingEnd:fh}}intervalChanged_(e,t,n){const a=this.parameterPositions;let r=e-2,l=e+1,u=a[r],d=a[l];if(u===void 0)switch(this.getSettings_().endingStart){case hh:r=e,u=2*t-n;break;case ag:r=a.length-2,u=t+a[r]-a[r+1];break;default:r=e,u=n}if(d===void 0)switch(this.getSettings_().endingEnd){case hh:l=e,d=2*n-t;break;case ag:l=1,d=n+a[1]-a[0];break;default:l=e-1,d=t}const p=(n-t)*.5,x=this.valueSize;this._weightPrev=p/(t-u),this._weightNext=p/(d-n),this._offsetPrev=r*x,this._offsetNext=l*x}interpolate_(e,t,n,a){const r=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=e*u,p=d-u,x=this._offsetPrev,g=this._offsetNext,_=this._weightPrev,y=this._weightNext,b=(n-t)/(a-t),C=b*b,E=C*b,S=-_*E+2*_*C-_*b,w=(1+_)*E+(-1.5-2*_)*C+(-.5+_)*b+1,D=(-1-y)*E+(1.5+y)*C+.5*b,U=y*E-y*C;for(let F=0;F!==u;++F)r[F]=S*l[x+F]+w*l[p+F]+D*l[d+F]+U*l[g+F];return r}}class MS extends kp{constructor(e,t,n,a){super(e,t,n,a)}interpolate_(e,t,n,a){const r=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=e*u,p=d-u,x=(n-t)/(a-t),g=1-x;for(let _=0;_!==u;++_)r[_]=l[p+_]*g+l[d+_]*x;return r}}class SC extends kp{constructor(e,t,n,a){super(e,t,n,a)}interpolate_(e){return this.copySampleValue_(e-1)}}class mo{constructor(e,t,n,a){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ph(t,this.TimeBufferType),this.values=ph(n,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:ph(e.times,Array),values:ph(e.values,Array)};const a=e.getInterpolation();a!==e.DefaultInterpolation&&(n.interpolation=a)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new SC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new MS(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new bC(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case wp:t=this.InterpolantFactoryMethodDiscrete;break;case Bp:t=this.InterpolantFactoryMethodLinear;break;case c_:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return Mt("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return wp;case this.InterpolantFactoryMethodLinear:return Bp;case this.InterpolantFactoryMethodSmooth:return c_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,a=t.length;n!==a;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,a=t.length;n!==a;++n)t[n]*=e}return this}trim(e,t){const n=this.times,a=n.length;let r=0,l=a-1;for(;r!==a&&n[r]<e;)++r;for(;l!==-1&&n[l]>t;)--l;if(++l,r!==0||l!==a){r>=l&&(l=Math.max(l,1),r=l-1);const u=this.getValueSize();this.times=n.slice(r,l),this.values=this.values.slice(r*u,l*u)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(un("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,a=this.values,r=n.length;r===0&&(un("KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let u=0;u!==r;u++){const d=n[u];if(typeof d=="number"&&isNaN(d)){un("KeyframeTrack: Time is not a valid number.",this,u,d),e=!1;break}if(l!==null&&l>d){un("KeyframeTrack: Out of order keys.",this,u,d,l),e=!1;break}l=d}if(a!==void 0&&_C(a))for(let u=0,d=a.length;u!==d;++u){const p=a[u];if(isNaN(p)){un("KeyframeTrack: Value is not a valid number.",this,u,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),a=this.getInterpolation()===c_,r=e.length-1;let l=1;for(let u=1;u<r;++u){let d=!1;const p=e[u],x=e[u+1];if(p!==x&&(u!==1||p!==e[0]))if(a)d=!0;else{const g=u*n,_=g-n,y=g+n;for(let b=0;b!==n;++b){const C=t[g+b];if(C!==t[_+b]||C!==t[y+b]){d=!0;break}}}if(d){if(u!==l){e[l]=e[u];const g=u*n,_=l*n;for(let y=0;y!==n;++y)t[_+y]=t[g+y]}++l}}if(r>0){e[l]=e[r];for(let u=r*n,d=l*n,p=0;p!==n;++p)t[d+p]=t[u+p];++l}return l!==e.length?(this.times=e.slice(0,l),this.values=t.slice(0,l*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,a=new n(this.name,e,t);return a.createInterpolant=this.createInterpolant,a}}mo.prototype.ValueTypeName="";mo.prototype.TimeBufferType=Float32Array;mo.prototype.ValueBufferType=Float32Array;mo.prototype.DefaultInterpolation=Bp;class Nh extends mo{constructor(e,t,n){super(e,t,n)}}Nh.prototype.ValueTypeName="bool";Nh.prototype.ValueBufferType=Array;Nh.prototype.DefaultInterpolation=wp;Nh.prototype.InterpolantFactoryMethodLinear=void 0;Nh.prototype.InterpolantFactoryMethodSmooth=void 0;class ES extends mo{constructor(e,t,n,a){super(e,t,n,a)}}ES.prototype.ValueTypeName="color";class Ch extends mo{constructor(e,t,n,a){super(e,t,n,a)}}Ch.prototype.ValueTypeName="number";class AC extends kp{constructor(e,t,n,a){super(e,t,n,a)}interpolate_(e,t,n,a){const r=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=(n-t)/(a-t);let p=e*u;for(let x=p+u;p!==x;p+=4)ts.slerpFlat(r,0,l,p-u,l,p,d);return r}}class ju extends mo{constructor(e,t,n,a){super(e,t,n,a)}InterpolantFactoryMethodLinear(e){return new AC(this.times,this.values,this.getValueSize(),e)}}ju.prototype.ValueTypeName="quaternion";ju.prototype.InterpolantFactoryMethodSmooth=void 0;class Lh extends mo{constructor(e,t,n){super(e,t,n)}}Lh.prototype.ValueTypeName="string";Lh.prototype.ValueBufferType=Array;Lh.prototype.DefaultInterpolation=wp;Lh.prototype.InterpolantFactoryMethodLinear=void 0;Lh.prototype.InterpolantFactoryMethodSmooth=void 0;class Xu extends mo{constructor(e,t,n,a){super(e,t,n,a)}}Xu.prototype.ValueTypeName="vector";class Rh{constructor(e="",t=-1,n=[],a=by){this.name=e,this.tracks=n,this.duration=t,this.blendMode=a,this.uuid=Pr(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,a=1/(e.fps||1);for(let l=0,u=n.length;l!==u;++l)t.push(HU(n[l]).scale(a));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r.userData=JSON.parse(e.userData||"{}"),r}static toJSON(e){const t=[],n=e.tracks,a={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let r=0,l=n.length;r!==l;++r)t.push(mo.toJSON(n[r]));return a}static CreateFromMorphTargetSequence(e,t,n,a){const r=t.length,l=[];for(let u=0;u<r;u++){let d=[],p=[];d.push((u+r-1)%r,u,(u+1)%r),p.push(0,1,0);const x=yC(d);d=Cb(d,1,x),p=Cb(p,1,x),!a&&d[0]===0&&(d.push(r),p.push(p[0])),l.push(new Ch(".morphTargetInfluences["+t[u].name+"]",d,p).scale(1/n))}return new this(e,-1,l)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const a=e;n=a.geometry&&a.geometry.animations||a.animations}for(let a=0;a<n.length;a++)if(n[a].name===t)return n[a];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const a={},r=/^([\w-]*?)([\d]+)$/;for(let u=0,d=e.length;u<d;u++){const p=e[u],x=p.name.match(r);if(x&&x.length>1){const g=x[1];let _=a[g];_||(a[g]=_=[]),_.push(p)}}const l=[];for(const u in a)l.push(this.CreateFromMorphTargetSequence(u,a[u],t,n));return l}static parseAnimation(e,t){if(Mt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return un("AnimationClip: No animation in JSONLoader data."),null;const n=function(g,_,y,b,C){if(y.length!==0){const E=[],S=[];AS(y,E,S,b),E.length!==0&&C.push(new g(_,E,S))}},a=[],r=e.name||"default",l=e.fps||30,u=e.blendMode;let d=e.length||-1;const p=e.hierarchy||[];for(let g=0;g<p.length;g++){const _=p[g].keys;if(!(!_||_.length===0))if(_[0].morphTargets){const y={};let b;for(b=0;b<_.length;b++)if(_[b].morphTargets)for(let C=0;C<_[b].morphTargets.length;C++)y[_[b].morphTargets[C]]=-1;for(const C in y){const E=[],S=[];for(let w=0;w!==_[b].morphTargets.length;++w){const D=_[b];E.push(D.time),S.push(D.morphTarget===C?1:0)}a.push(new Ch(".morphTargetInfluence["+C+"]",E,S))}d=y.length*l}else{const y=".bones["+t[g].name+"]";n(Xu,y+".position",_,"pos",a),n(ju,y+".quaternion",_,"rot",a),n(Xu,y+".scale",_,"scl",a)}}return a.length===0?null:new this(r,d,a,u)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,a=e.length;n!==a;++n){const r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function zU(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ch;case"vector":case"vector2":case"vector3":case"vector4":return Xu;case"color":return ES;case"quaternion":return ju;case"bool":case"boolean":return Nh;case"string":return Lh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function HU(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=zU(i.type);if(i.times===void 0){const t=[],n=[];AS(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Pl={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class ky{constructor(e,t,n){const a=this;let r=!1,l=0,u=0,d;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(x){u++,r===!1&&a.onStart!==void 0&&a.onStart(x,l,u),r=!0},this.itemEnd=function(x){l++,a.onProgress!==void 0&&a.onProgress(x,l,u),l===u&&(r=!1,a.onLoad!==void 0&&a.onLoad())},this.itemError=function(x){a.onError!==void 0&&a.onError(x)},this.resolveURL=function(x){return d?d(x):x},this.setURLModifier=function(x){return d=x,this},this.addHandler=function(x,g){return p.push(x,g),this},this.removeHandler=function(x){const g=p.indexOf(x);return g!==-1&&p.splice(g,2),this},this.getHandler=function(x){for(let g=0,_=p.length;g<_;g+=2){const y=p[g],b=p[g+1];if(y.global&&(y.lastIndex=0),y.test(x))return b}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const _p=new ky;class ds{constructor(e){this.manager=e!==void 0?e:_p,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(a,r){n.load(e,a,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}ds.DEFAULT_MATERIAL_NAME="__DEFAULT";const yc={};class GU extends Error{constructor(e,t){super(e),this.response=t}}class hs extends ds{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Pl.get(`file:${e}`);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(yc[e]!==void 0){yc[e].push({onLoad:t,onProgress:n,onError:a});return}yc[e]=[],yc[e].push({onLoad:t,onProgress:n,onError:a});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),u=this.mimeType,d=this.responseType;fetch(l).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&Mt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const x=yc[e],g=p.body.getReader(),_=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),y=_?parseInt(_):0,b=y!==0;let C=0;const E=new ReadableStream({start(S){w();function w(){g.read().then(({done:D,value:U})=>{if(D)S.close();else{C+=U.byteLength;const F=new ProgressEvent("progress",{lengthComputable:b,loaded:C,total:y});for(let N=0,z=x.length;N<z;N++){const j=x[N];j.onProgress&&j.onProgress(F)}S.enqueue(U),w()}},D=>{S.error(D)})}}});return new Response(E)}else throw new GU(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(d){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(x=>new DOMParser().parseFromString(x,u));case"json":return p.json();default:if(u==="")return p.text();{const g=/charset="?([^;"\s]*)"?/i.exec(u),_=g&&g[1]?g[1].toLowerCase():void 0,y=new TextDecoder(_);return p.arrayBuffer().then(b=>y.decode(b))}}}).then(p=>{Pl.add(`file:${e}`,p);const x=yc[e];delete yc[e];for(let g=0,_=x.length;g<_;g++){const y=x[g];y.onLoad&&y.onLoad(p)}}).catch(p=>{const x=yc[e];if(x===void 0)throw this.manager.itemError(e),p;delete yc[e];for(let g=0,_=x.length;g<_;g++){const y=x[g];y.onError&&y.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class VU extends ds{constructor(e){super(e)}load(e,t,n,a){const r=this,l=new hs(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{t(r.parse(JSON.parse(u)))}catch(d){a?a(d):un(d),r.manager.itemError(e)}},n,a)}parse(e){const t=[];for(let n=0;n<e.length;n++){const a=Rh.parse(e[n]);t.push(a)}return t}}class kU extends ds{constructor(e){super(e)}load(e,t,n,a){const r=this,l=[],u=new wy,d=new hs(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(r.withCredentials);let p=0;function x(g){d.load(e[g],function(_){const y=r.parse(_,!0);l[g]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},p+=1,p===6&&(y.mipmapCount===1&&(u.minFilter=In),u.image=l,u.format=y.format,u.needsUpdate=!0,t&&t(u))},n,a)}if(Array.isArray(e))for(let g=0,_=e.length;g<_;++g)x(g);else d.load(e,function(g){const _=r.parse(g,!0);if(_.isCubemap){const y=_.mipmaps.length/_.mipmapCount;for(let b=0;b<y;b++){l[b]={mipmaps:[]};for(let C=0;C<_.mipmapCount;C++)l[b].mipmaps.push(_.mipmaps[b*_.mipmapCount+C]),l[b].format=_.format,l[b].width=_.width,l[b].height=_.height}u.image=l}else u.image.width=_.width,u.image.height=_.height,u.mipmaps=_.mipmaps;_.mipmapCount===1&&(u.minFilter=In),u.format=_.format,u.needsUpdate=!0,t&&t(u)},n,a);return u}}const sp=new WeakMap;class hg extends ds{constructor(e){super(e)}load(e,t,n,a){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,l=Pl.get(`image:${e}`);if(l!==void 0){if(l.complete===!0)r.manager.itemStart(e),setTimeout(function(){t&&t(l),r.manager.itemEnd(e)},0);else{let g=sp.get(l);g===void 0&&(g=[],sp.set(l,g)),g.push({onLoad:t,onError:a})}return l}const u=og("img");function d(){x(),t&&t(this);const g=sp.get(this)||[];for(let _=0;_<g.length;_++){const y=g[_];y.onLoad&&y.onLoad(this)}sp.delete(this),r.manager.itemEnd(e)}function p(g){x(),a&&a(g),Pl.remove(`image:${e}`);const _=sp.get(this)||[];for(let y=0;y<_.length;y++){const b=_[y];b.onError&&b.onError(g)}sp.delete(this),r.manager.itemError(e),r.manager.itemEnd(e)}function x(){u.removeEventListener("load",d,!1),u.removeEventListener("error",p,!1)}return u.addEventListener("load",d,!1),u.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),Pl.add(`image:${e}`,u),r.manager.itemStart(e),u.src=e,u}}class MC extends ds{constructor(e){super(e)}load(e,t,n,a){const r=new _g;r.colorSpace=ti;const l=new hg(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);let u=0;function d(p){l.load(e[p],function(x){r.images[p]=x,u++,u===6&&(r.needsUpdate=!0,t&&t(r))},void 0,a)}for(let p=0;p<e.length;++p)d(p);return r}}class TS extends ds{constructor(e){super(e)}load(e,t,n,a){const r=this,l=new ho,u=new hs(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(r.withCredentials),u.load(e,function(d){let p;try{p=r.parse(d)}catch(x){if(a!==void 0)a(x);else{x(x);return}}p.image!==void 0?l.image=p.image:p.data!==void 0&&(l.image.width=p.width,l.image.height=p.height,l.image.data=p.data),l.wrapS=p.wrapS!==void 0?p.wrapS:ea,l.wrapT=p.wrapT!==void 0?p.wrapT:ea,l.magFilter=p.magFilter!==void 0?p.magFilter:In,l.minFilter=p.minFilter!==void 0?p.minFilter:In,l.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.colorSpace!==void 0&&(l.colorSpace=p.colorSpace),p.flipY!==void 0&&(l.flipY=p.flipY),p.format!==void 0&&(l.format=p.format),p.type!==void 0&&(l.type=p.type),p.mipmaps!==void 0&&(l.mipmaps=p.mipmaps,l.minFilter=fo),p.mipmapCount===1&&(l.minFilter=In),p.generateMipmaps!==void 0&&(l.generateMipmaps=p.generateMipmaps),l.needsUpdate=!0,t&&t(l,p)},n,a),l}}class EC extends ds{constructor(e){super(e)}load(e,t,n,a){const r=new ui,l=new hg(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,function(u){r.image=u,r.needsUpdate=!0,t!==void 0&&t(r)},n,a),r}}class Wu extends Pn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ut(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class TC extends Wu{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Pn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ut(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const x1=new Wt,e3=new te,t3=new te;class CS{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ge(512,512),this.mapType=ca,this.map=null,this.mapPass=null,this.matrix=new Wt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Gp,this._frameExtents=new Ge(1,1),this._viewportCount=1,this._viewports=[new kn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;e3.setFromMatrixPosition(e.matrixWorld),t.position.copy(e3),t3.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(t3),t.updateMatrixWorld(),x1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(x1,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(x1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class jU extends CS{constructor(){super(new Ra(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Op*2*e.angle*this.focus,a=this.mapSize.width/this.mapSize.height*this.aspect,r=e.distance||t.far;(n!==t.fov||a!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=a,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class RS extends Wu{constructor(e,t,n=0,a=Math.PI/3,r=0,l=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Pn.DEFAULT_UP),this.updateMatrix(),this.target=new Pn,this.distance=n,this.angle=a,this.penumbra=r,this.decay=l,this.map=null,this.shadow=new jU}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const n3=new Wt,wm=new te,_1=new te;class XU extends CS{constructor(){super(new Ra(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ge(4,2),this._viewportCount=6,this._viewports=[new kn(2,1,1,1),new kn(0,1,1,1),new kn(3,1,1,1),new kn(1,1,1,1),new kn(3,0,1,1),new kn(1,0,1,1)],this._cubeDirections=[new te(1,0,0),new te(-1,0,0),new te(0,0,1),new te(0,0,-1),new te(0,1,0),new te(0,-1,0)],this._cubeUps=[new te(0,1,0),new te(0,1,0),new te(0,1,0),new te(0,1,0),new te(0,0,1),new te(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,a=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),wm.setFromMatrixPosition(e.matrixWorld),n.position.copy(wm),_1.copy(n.position),_1.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(_1),n.updateMatrixWorld(),a.makeTranslation(-wm.x,-wm.y,-wm.z),n3.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n3,n.coordinateSystem,n.reversedDepth)}}class wS extends Wu{constructor(e,t,n=0,a=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=a,this.shadow=new XU}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Zu extends My{constructor(e=-1,t=1,n=1,a=-1,r=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=a,this.near=r,this.far=l,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,a,r,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=a,this.view.width=r,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,a=(this.top+this.bottom)/2;let r=n-e,l=n+e,u=a+t,d=a-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,x=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=p*this.view.offsetX,l=r+p*this.view.width,u-=x*this.view.offsetY,d=u-x*this.view.height}this.projectionMatrix.makeOrthographic(r,l,u,d,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class YU extends CS{constructor(){super(new Zu(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class BS extends Wu{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Pn.DEFAULT_UP),this.updateMatrix(),this.target=new Pn,this.shadow=new YU}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class CC extends Wu{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class RC extends Wu{constructor(e,t,n=10,a=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=a}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class wC{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new te)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,a=e.y,r=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.282095),t.addScaledVector(l[1],.488603*a),t.addScaledVector(l[2],.488603*r),t.addScaledVector(l[3],.488603*n),t.addScaledVector(l[4],1.092548*(n*a)),t.addScaledVector(l[5],1.092548*(a*r)),t.addScaledVector(l[6],.315392*(3*r*r-1)),t.addScaledVector(l[7],1.092548*(n*r)),t.addScaledVector(l[8],.546274*(n*n-a*a)),t}getIrradianceAt(e,t){const n=e.x,a=e.y,r=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.886227),t.addScaledVector(l[1],2*.511664*a),t.addScaledVector(l[2],2*.511664*r),t.addScaledVector(l[3],2*.511664*n),t.addScaledVector(l[4],2*.429043*n*a),t.addScaledVector(l[5],2*.429043*a*r),t.addScaledVector(l[6],.743125*r*r-.247708),t.addScaledVector(l[7],2*.429043*n*r),t.addScaledVector(l[8],.429043*(n*n-a*a)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let a=0;a<9;a++)n[a].fromArray(e,t+a*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let a=0;a<9;a++)n[a].toArray(e,t+a*3);return e}static getBasisAt(e,t){const n=e.x,a=e.y,r=e.z;t[0]=.282095,t[1]=.488603*a,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*a,t[5]=1.092548*a*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-a*a)}}class BC extends Wu{constructor(e=new wC,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class jy extends ds{constructor(e){super(e),this.textures={}}load(e,t,n,a){const r=this,l=new hs(r.manager);l.setPath(r.path),l.setRequestHeader(r.requestHeader),l.setWithCredentials(r.withCredentials),l.load(e,function(u){try{t(r.parse(JSON.parse(u)))}catch(d){a?a(d):un(d),r.manager.itemError(e)}},n,a)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&Mt("MaterialLoader: Undefined texture",r),t[r]}const a=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(a.uuid=e.uuid),e.name!==void 0&&(a.name=e.name),e.color!==void 0&&a.color!==void 0&&a.color.setHex(e.color),e.roughness!==void 0&&(a.roughness=e.roughness),e.metalness!==void 0&&(a.metalness=e.metalness),e.sheen!==void 0&&(a.sheen=e.sheen),e.sheenColor!==void 0&&(a.sheenColor=new ut().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(a.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&a.emissive!==void 0&&a.emissive.setHex(e.emissive),e.specular!==void 0&&a.specular!==void 0&&a.specular.setHex(e.specular),e.specularIntensity!==void 0&&(a.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&a.specularColor!==void 0&&a.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(a.shininess=e.shininess),e.clearcoat!==void 0&&(a.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(a.dispersion=e.dispersion),e.iridescence!==void 0&&(a.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(a.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(a.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(a.transmission=e.transmission),e.thickness!==void 0&&(a.thickness=e.thickness),e.attenuationDistance!==void 0&&(a.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&a.attenuationColor!==void 0&&a.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(a.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(a.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(a.fog=e.fog),e.flatShading!==void 0&&(a.flatShading=e.flatShading),e.blending!==void 0&&(a.blending=e.blending),e.combine!==void 0&&(a.combine=e.combine),e.side!==void 0&&(a.side=e.side),e.shadowSide!==void 0&&(a.shadowSide=e.shadowSide),e.opacity!==void 0&&(a.opacity=e.opacity),e.transparent!==void 0&&(a.transparent=e.transparent),e.alphaTest!==void 0&&(a.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(a.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(a.depthFunc=e.depthFunc),e.depthTest!==void 0&&(a.depthTest=e.depthTest),e.depthWrite!==void 0&&(a.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(a.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(a.blendSrc=e.blendSrc),e.blendDst!==void 0&&(a.blendDst=e.blendDst),e.blendEquation!==void 0&&(a.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(a.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(a.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(a.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&a.blendColor!==void 0&&a.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(a.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(a.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(a.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(a.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(a.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(a.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(a.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(a.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(a.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(a.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(a.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(a.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(a.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(a.rotation=e.rotation),e.linewidth!==void 0&&(a.linewidth=e.linewidth),e.dashSize!==void 0&&(a.dashSize=e.dashSize),e.gapSize!==void 0&&(a.gapSize=e.gapSize),e.scale!==void 0&&(a.scale=e.scale),e.polygonOffset!==void 0&&(a.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(a.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(a.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(a.dithering=e.dithering),e.alphaToCoverage!==void 0&&(a.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(a.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(a.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(a.visible=e.visible),e.toneMapped!==void 0&&(a.toneMapped=e.toneMapped),e.userData!==void 0&&(a.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?a.vertexColors=e.vertexColors>0:a.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const l=e.uniforms[r];switch(a.uniforms[r]={},l.type){case"t":a.uniforms[r].value=n(l.value);break;case"c":a.uniforms[r].value=new ut().setHex(l.value);break;case"v2":a.uniforms[r].value=new Ge().fromArray(l.value);break;case"v3":a.uniforms[r].value=new te().fromArray(l.value);break;case"v4":a.uniforms[r].value=new kn().fromArray(l.value);break;case"m3":a.uniforms[r].value=new vn().fromArray(l.value);break;case"m4":a.uniforms[r].value=new Wt().fromArray(l.value);break;default:a.uniforms[r].value=l.value}}if(e.defines!==void 0&&(a.defines=e.defines),e.vertexShader!==void 0&&(a.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(a.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(a.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)a.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(a.lights=e.lights),e.clipping!==void 0&&(a.clipping=e.clipping),e.size!==void 0&&(a.size=e.size),e.sizeAttenuation!==void 0&&(a.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(a.map=n(e.map)),e.matcap!==void 0&&(a.matcap=n(e.matcap)),e.alphaMap!==void 0&&(a.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(a.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(a.bumpScale=e.bumpScale),e.normalMap!==void 0&&(a.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(a.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),a.normalScale=new Ge().fromArray(r)}return e.displacementMap!==void 0&&(a.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(a.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(a.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(a.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(a.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(a.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(a.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(a.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(a.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(a.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(a.envMap=n(e.envMap)),e.envMapRotation!==void 0&&a.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(a.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(a.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(a.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(a.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(a.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(a.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(a.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(a.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(a.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(a.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(a.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(a.clearcoatNormalScale=new Ge().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(a.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(a.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(a.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(a.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(a.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(a.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(a.sheenRoughnessMap=n(e.sheenRoughnessMap)),a}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return jy.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:hC,SpriteMaterial:lS,RawShaderMaterial:dC,ShaderMaterial:hi,PointsMaterial:Vp,MeshPhysicalMaterial:po,MeshStandardMaterial:ra,MeshPhongMaterial:pC,MeshToonMaterial:mC,MeshNormalMaterial:yS,MeshLambertMaterial:gC,MeshDepthMaterial:bS,MeshDistanceMaterial:SS,MeshBasicMaterial:$a,MeshMatcapMaterial:vC,LineDashedMaterial:xC,LineBasicMaterial:Os,Material:ya};return new t[e]}}class Fu{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class DC extends rn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class UC extends ds{constructor(e){super(e)}load(e,t,n,a){const r=this,l=new hs(r.manager);l.setPath(r.path),l.setRequestHeader(r.requestHeader),l.setWithCredentials(r.withCredentials),l.load(e,function(u){try{t(r.parse(JSON.parse(u)))}catch(d){a?a(d):un(d),r.manager.itemError(e)}},n,a)}parse(e){const t={},n={};function a(y,b){if(t[b]!==void 0)return t[b];const E=y.interleavedBuffers[b],S=r(y,E.buffer),w=xp(E.type,S),D=new yg(w,E.stride);return D.uuid=E.uuid,t[b]=D,D}function r(y,b){if(n[b]!==void 0)return n[b];const E=y.arrayBuffers[b],S=new Uint32Array(E).buffer;return n[b]=S,S}const l=e.isInstancedBufferGeometry?new DC:new rn,u=e.data.index;if(u!==void 0){const y=xp(u.type,u.array);l.setIndex(new Mn(y,1))}const d=e.data.attributes;for(const y in d){const b=d[y];let C;if(b.isInterleavedBufferAttribute){const E=a(e.data,b.data);C=new ku(E,b.itemSize,b.offset,b.normalized)}else{const E=xp(b.type,b.array),S=b.isInstancedBufferAttribute?Eh:Mn;C=new S(E,b.itemSize,b.normalized)}b.name!==void 0&&(C.name=b.name),b.usage!==void 0&&C.setUsage(b.usage),l.setAttribute(y,C)}const p=e.data.morphAttributes;if(p)for(const y in p){const b=p[y],C=[];for(let E=0,S=b.length;E<S;E++){const w=b[E];let D;if(w.isInterleavedBufferAttribute){const U=a(e.data,w.data);D=new ku(U,w.itemSize,w.offset,w.normalized)}else{const U=xp(w.type,w.array);D=new Mn(U,w.itemSize,w.normalized)}w.name!==void 0&&(D.name=w.name),C.push(D)}l.morphAttributes[y]=C}e.data.morphTargetsRelative&&(l.morphTargetsRelative=!0);const g=e.data.groups||e.data.drawcalls||e.data.offsets;if(g!==void 0)for(let y=0,b=g.length;y!==b;++y){const C=g[y];l.addGroup(C.start,C.count,C.materialIndex)}const _=e.data.boundingSphere;return _!==void 0&&(l.boundingSphere=new za().fromJSON(_)),e.name&&(l.name=e.name),e.userData&&(l.userData=e.userData),l}}class qU extends ds{constructor(e){super(e)}load(e,t,n,a){const r=this,l=this.path===""?Fu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||l;const u=new hs(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(d){let p=null;try{p=JSON.parse(d)}catch(g){a!==void 0&&a(g),g("ObjectLoader: Can't parse "+e+".",g.message);return}const x=p.metadata;if(x===void 0||x.type===void 0||x.type.toLowerCase()==="geometry"){a!==void 0&&a(new Error("THREE.ObjectLoader: Can't load "+e)),un("ObjectLoader: Can't load "+e);return}r.parse(p,t)},n,a)}async loadAsync(e,t){const n=this,a=this.path===""?Fu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const r=new hs(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const l=await r.loadAsync(e,t),u=JSON.parse(l),d=u.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(u)}parse(e,t){const n=this.parseAnimations(e.animations),a=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,a),l=this.parseImages(e.images,function(){t!==void 0&&t(p)}),u=this.parseTextures(e.textures,l),d=this.parseMaterials(e.materials,u),p=this.parseObject(e.object,r,d,u,n),x=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,x),this.bindLightTargets(p),t!==void 0){let g=!1;for(const _ in l)if(l[_].data instanceof HTMLImageElement){g=!0;break}g===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),l=this.parseTextures(e.textures,r),u=this.parseMaterials(e.materials,l),d=this.parseObject(e.object,a,u,l,t),p=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,p),this.bindLightTargets(d),d}parseShapes(e){const t={};if(e!==void 0)for(let n=0,a=e.length;n<a;n++){const r=new _h().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},a={};if(t.traverse(function(r){r.isBone&&(a[r.uuid]=r)}),e!==void 0)for(let r=0,l=e.length;r<l;r++){const u=new bg().fromJSON(e[r],a);n[u.uuid]=u}return n}parseGeometries(e,t){const n={};if(e!==void 0){const a=new UC;for(let r=0,l=e.length;r<l;r++){let u;const d=e[r];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":u=a.parse(d);break;default:d.type in $M?u=$M[d.type].fromJSON(d,t):Mt(`ObjectLoader: Unsupported geometry type "${d.type}"`)}u.uuid=d.uuid,d.name!==void 0&&(u.name=d.name),d.userData!==void 0&&(u.userData=d.userData),n[d.uuid]=u}}return n}parseMaterials(e,t){const n={},a={};if(e!==void 0){const r=new jy;r.setTextures(t);for(let l=0,u=e.length;l<u;l++){const d=e[l];n[d.uuid]===void 0&&(n[d.uuid]=r.parse(d)),a[d.uuid]=n[d.uuid]}}return a}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const a=e[n],r=Rh.parse(a);t[r.uuid]=r}return t}parseImages(e,t){const n=this,a={};let r;function l(d){return n.manager.itemStart(d),r.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}function u(d){if(typeof d=="string"){const p=d,x=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;return l(x)}else return d.data?{data:xp(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new ky(t);r=new hg(d),r.setCrossOrigin(this.crossOrigin);for(let p=0,x=e.length;p<x;p++){const g=e[p],_=g.url;if(Array.isArray(_)){const y=[];for(let b=0,C=_.length;b<C;b++){const E=_[b],S=u(E);S!==null&&(S instanceof HTMLImageElement?y.push(S):y.push(new ho(S.data,S.width,S.height)))}a[g.uuid]=new Lu(y)}else{const y=u(g.url);a[g.uuid]=new Lu(y)}}}return a}async parseImagesAsync(e){const t=this,n={};let a;async function r(l){if(typeof l=="string"){const u=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:t.resourcePath+u;return await a.loadAsync(d)}else return l.data?{data:xp(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){a=new hg(this.manager),a.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){const d=e[l],p=d.url;if(Array.isArray(p)){const x=[];for(let g=0,_=p.length;g<_;g++){const y=p[g],b=await r(y);b!==null&&(b instanceof HTMLImageElement?x.push(b):x.push(new ho(b.data,b.width,b.height)))}n[d.uuid]=new Lu(x)}else{const x=await r(d.url);n[d.uuid]=new Lu(x)}}}return n}parseTextures(e,t){function n(r,l){return typeof r=="number"?r:(Mt("ObjectLoader.parseTexture: Constant should be in numeric form.",r),l[r])}const a={};if(e!==void 0)for(let r=0,l=e.length;r<l;r++){const u=e[r];u.image===void 0&&Mt('ObjectLoader: No "image" specified for',u.uuid),t[u.image]===void 0&&Mt("ObjectLoader: Undefined image",u.image);const d=t[u.image],p=d.data;let x;Array.isArray(p)?(x=new _g,p.length===6&&(x.needsUpdate=!0)):(p&&p.data?x=new ho:x=new ui,p&&(x.needsUpdate=!0)),x.source=d,x.uuid=u.uuid,u.name!==void 0&&(x.name=u.name),u.mapping!==void 0&&(x.mapping=n(u.mapping,KU)),u.channel!==void 0&&(x.channel=u.channel),u.offset!==void 0&&x.offset.fromArray(u.offset),u.repeat!==void 0&&x.repeat.fromArray(u.repeat),u.center!==void 0&&x.center.fromArray(u.center),u.rotation!==void 0&&(x.rotation=u.rotation),u.wrap!==void 0&&(x.wrapS=n(u.wrap[0],i3),x.wrapT=n(u.wrap[1],i3)),u.format!==void 0&&(x.format=u.format),u.internalFormat!==void 0&&(x.internalFormat=u.internalFormat),u.type!==void 0&&(x.type=u.type),u.colorSpace!==void 0&&(x.colorSpace=u.colorSpace),u.minFilter!==void 0&&(x.minFilter=n(u.minFilter,a3)),u.magFilter!==void 0&&(x.magFilter=n(u.magFilter,a3)),u.anisotropy!==void 0&&(x.anisotropy=u.anisotropy),u.flipY!==void 0&&(x.flipY=u.flipY),u.generateMipmaps!==void 0&&(x.generateMipmaps=u.generateMipmaps),u.premultiplyAlpha!==void 0&&(x.premultiplyAlpha=u.premultiplyAlpha),u.unpackAlignment!==void 0&&(x.unpackAlignment=u.unpackAlignment),u.compareFunction!==void 0&&(x.compareFunction=u.compareFunction),u.userData!==void 0&&(x.userData=u.userData),a[u.uuid]=x}return a}parseObject(e,t,n,a,r){let l;function u(_){return t[_]===void 0&&Mt("ObjectLoader: Undefined geometry",_),t[_]}function d(_){if(_!==void 0){if(Array.isArray(_)){const y=[];for(let b=0,C=_.length;b<C;b++){const E=_[b];n[E]===void 0&&Mt("ObjectLoader: Undefined material",E),y.push(n[E])}return y}return n[_]===void 0&&Mt("ObjectLoader: Undefined material",_),n[_]}}function p(_){return a[_]===void 0&&Mt("ObjectLoader: Undefined texture",_),a[_]}let x,g;switch(e.type){case"Scene":l=new Mh,e.background!==void 0&&(Number.isInteger(e.background)?l.background=new ut(e.background):l.background=p(e.background)),e.environment!==void 0&&(l.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?l.fog=new Ty(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(l.fog=new Ey(e.fog.color,e.fog.density)),e.fog.name!==""&&(l.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(l.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(l.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&l.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(l.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&l.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":l=new Ra(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(l.focus=e.focus),e.zoom!==void 0&&(l.zoom=e.zoom),e.filmGauge!==void 0&&(l.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(l.filmOffset=e.filmOffset),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"OrthographicCamera":l=new Zu(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(l.zoom=e.zoom),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"AmbientLight":l=new CC(e.color,e.intensity);break;case"DirectionalLight":l=new BS(e.color,e.intensity),l.target=e.target||"";break;case"PointLight":l=new wS(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":l=new RC(e.color,e.intensity,e.width,e.height);break;case"SpotLight":l=new RS(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),l.target=e.target||"";break;case"HemisphereLight":l=new TC(e.color,e.groundColor,e.intensity);break;case"LightProbe":l=new BC().fromJSON(e);break;case"SkinnedMesh":x=u(e.geometry),g=d(e.material),l=new cS(x,g),e.bindMode!==void 0&&(l.bindMode=e.bindMode),e.bindMatrix!==void 0&&l.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(l.skeleton=e.skeleton);break;case"Mesh":x=u(e.geometry),g=d(e.material),l=new Xi(x,g);break;case"InstancedMesh":x=u(e.geometry),g=d(e.material);const _=e.count,y=e.instanceMatrix,b=e.instanceColor;l=new uS(x,g,_),l.instanceMatrix=new Eh(new Float32Array(y.array),16),b!==void 0&&(l.instanceColor=new Eh(new Float32Array(b.array),b.itemSize));break;case"BatchedMesh":x=u(e.geometry),g=d(e.material),l=new QT(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,g),l.geometry=x,l.perObjectFrustumCulled=e.perObjectFrustumCulled,l.sortObjects=e.sortObjects,l._drawRanges=e.drawRanges,l._reservedRanges=e.reservedRanges,l._geometryInfo=e.geometryInfo.map(C=>{let E=null,S=null;return C.boundingBox!==void 0&&(E=new ns().fromJSON(C.boundingBox)),C.boundingSphere!==void 0&&(S=new za().fromJSON(C.boundingSphere)),{...C,boundingBox:E,boundingSphere:S}}),l._instanceInfo=e.instanceInfo,l._availableInstanceIds=e._availableInstanceIds,l._availableGeometryIds=e._availableGeometryIds,l._nextIndexStart=e.nextIndexStart,l._nextVertexStart=e.nextVertexStart,l._geometryCount=e.geometryCount,l._maxInstanceCount=e.maxInstanceCount,l._maxVertexCount=e.maxVertexCount,l._maxIndexCount=e.maxIndexCount,l._geometryInitialized=e.geometryInitialized,l._matricesTexture=p(e.matricesTexture.uuid),l._indirectTexture=p(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(l._colorsTexture=p(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(l.boundingSphere=new za().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(l.boundingBox=new ns().fromJSON(e.boundingBox));break;case"LOD":l=new ZT;break;case"Line":l=new Uc(u(e.geometry),d(e.material));break;case"LineLoop":l=new fS(u(e.geometry),d(e.material));break;case"LineSegments":l=new Qo(u(e.geometry),d(e.material));break;case"PointCloud":case"Points":l=new hS(u(e.geometry),d(e.material));break;case"Sprite":l=new WT(d(e.material));break;case"Group":l=new wc;break;case"Bone":l=new Cy;break;default:l=new Pn}if(l.uuid=e.uuid,e.name!==void 0&&(l.name=e.name),e.matrix!==void 0?(l.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(l.matrixAutoUpdate=e.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(e.position!==void 0&&l.position.fromArray(e.position),e.rotation!==void 0&&l.rotation.fromArray(e.rotation),e.quaternion!==void 0&&l.quaternion.fromArray(e.quaternion),e.scale!==void 0&&l.scale.fromArray(e.scale)),e.up!==void 0&&l.up.fromArray(e.up),e.castShadow!==void 0&&(l.castShadow=e.castShadow),e.receiveShadow!==void 0&&(l.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(l.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(l.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(l.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(l.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&l.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(l.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(l.visible=e.visible),e.frustumCulled!==void 0&&(l.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(l.renderOrder=e.renderOrder),e.userData!==void 0&&(l.userData=e.userData),e.layers!==void 0&&(l.layers.mask=e.layers),e.children!==void 0){const _=e.children;for(let y=0;y<_.length;y++)l.add(this.parseObject(_[y],t,n,a,r))}if(e.animations!==void 0){const _=e.animations;for(let y=0;y<_.length;y++){const b=_[y];l.animations.push(r[b])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(l.autoUpdate=e.autoUpdate);const _=e.levels;for(let y=0;y<_.length;y++){const b=_[y],C=l.getObjectByProperty("uuid",b.object);C!==void 0&&l.addLevel(C,b.distance,b.hysteresis)}}return l}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const a=t[n.skeleton];a===void 0?Mt("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(a,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,a=e.getObjectByProperty("uuid",n);a!==void 0?t.target=a:t.target=new Pn}})}}const KU={UVMapping:zu,CubeReflectionMapping:Fl,CubeRefractionMapping:Hu,EquirectangularReflectionMapping:Ep,EquirectangularRefractionMapping:ig,CubeUVReflectionMapping:zp},i3={RepeatWrapping:Gu,ClampToEdgeWrapping:ea,MirroredRepeatWrapping:Tp},a3={NearestFilter:la,NearestMipmapNearestFilter:dy,NearestMipmapLinearFilter:uh,LinearFilter:In,LinearMipmapNearestFilter:bp,LinearMipmapLinearFilter:fo},y1=new WeakMap;class OC extends ds{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Mt("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Mt("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,l=Pl.get(`image-bitmap:${e}`);if(l!==void 0){if(r.manager.itemStart(e),l.then){l.then(p=>{if(y1.has(l)===!0)a&&a(y1.get(l)),r.manager.itemError(e),r.manager.itemEnd(e);else return t&&t(p),r.manager.itemEnd(e),p});return}return setTimeout(function(){t&&t(l),r.manager.itemEnd(e)},0),l}const u={};u.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",u.headers=this.requestHeader,u.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const d=fetch(e,u).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(p){return Pl.add(`image-bitmap:${e}`,p),t&&t(p),r.manager.itemEnd(e),p}).catch(function(p){a&&a(p),y1.set(d,p),Pl.remove(`image-bitmap:${e}`),r.manager.itemError(e),r.manager.itemEnd(e)});Pl.add(`image-bitmap:${e}`,d),r.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let Ix;class DS{static getContext(){return Ix===void 0&&(Ix=new(window.AudioContext||window.webkitAudioContext)),Ix}static setContext(e){Ix=e}}class JU extends ds{constructor(e){super(e)}load(e,t,n,a){const r=this,l=new hs(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(d){try{const p=d.slice(0);DS.getContext().decodeAudioData(p,function(g){t(g)}).catch(u)}catch(p){u(p)}},n,a);function u(d){a?a(d):un(d),r.manager.itemError(e)}}}const s3=new Wt,r3=new Wt,Wf=new Wt;class WU{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ra,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ra,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Wf.copy(e.projectionMatrix);const a=t.eyeSep/2,r=a*t.near/t.focus,l=t.near*Math.tan(xh*t.fov*.5)/t.zoom;let u,d;r3.elements[12]=-a,s3.elements[12]=a,u=-l*t.aspect+r,d=l*t.aspect+r,Wf.elements[0]=2*t.near/(d-u),Wf.elements[8]=(d+u)/(d-u),this.cameraL.projectionMatrix.copy(Wf),u=-l*t.aspect-r,d=l*t.aspect-r,Wf.elements[0]=2*t.near/(d-u),Wf.elements[8]=(d+u)/(d-u),this.cameraR.projectionMatrix.copy(Wf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(r3),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(s3)}}class NC extends Ra{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class US{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const Zf=new te,b1=new ts,ZU=new te,Qf=new te,$f=new te;class QU extends Pn{constructor(){super(),this.type="AudioListener",this.context=DS.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new US}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Zf,b1,ZU),Qf.set(0,0,-1).applyQuaternion(b1),$f.set(0,1,0).applyQuaternion(b1),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Zf.x,n),t.positionY.linearRampToValueAtTime(Zf.y,n),t.positionZ.linearRampToValueAtTime(Zf.z,n),t.forwardX.linearRampToValueAtTime(Qf.x,n),t.forwardY.linearRampToValueAtTime(Qf.y,n),t.forwardZ.linearRampToValueAtTime(Qf.z,n),t.upX.linearRampToValueAtTime($f.x,n),t.upY.linearRampToValueAtTime($f.y,n),t.upZ.linearRampToValueAtTime($f.z,n)}else t.setPosition(Zf.x,Zf.y,Zf.z),t.setOrientation(Qf.x,Qf.y,Qf.z,$f.x,$f.y,$f.z)}}class LC extends Pn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){Mt("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){Mt("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){Mt("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){Mt("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){Mt("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(Mt("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){Mt("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(Mt("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const eh=new te,o3=new ts,$U=new te,th=new te;class eO extends LC{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(eh,o3,$U),th.set(0,0,1).applyQuaternion(o3);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(eh.x,n),t.positionY.linearRampToValueAtTime(eh.y,n),t.positionZ.linearRampToValueAtTime(eh.z,n),t.orientationX.linearRampToValueAtTime(th.x,n),t.orientationY.linearRampToValueAtTime(th.y,n),t.orientationZ.linearRampToValueAtTime(th.z,n)}else t.setPosition(eh.x,eh.y,eh.z),t.setOrientation(th.x,th.y,th.z)}}class tO{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class IC{constructor(e,t,n){this.binding=e,this.valueSize=n;let a,r,l;switch(t){case"quaternion":a=this._slerp,r=this._slerpAdditive,l=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":a=this._select,r=this._select,l=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:a=this._lerp,r=this._lerpAdditive,l=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=a,this._mixBufferRegionAdditive=r,this._setIdentity=l,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,a=this.valueSize,r=e*a+a;let l=this.cumulativeWeight;if(l===0){for(let u=0;u!==a;++u)n[r+u]=n[u];l=t}else{l+=t;const u=t/l;this._mixBufferRegion(n,r,0,u,a)}this.cumulativeWeight=l}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,a=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,a,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,a=e*t+t,r=this.cumulativeWeight,l=this.cumulativeWeightAdditive,u=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const d=t*this._origIndex;this._mixBufferRegion(n,a,d,1-r,t)}l>0&&this._mixBufferRegionAdditive(n,a,this._addIndex*t,1,t);for(let d=t,p=t+t;d!==p;++d)if(n[d]!==n[d+t]){u.setValue(n,a);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,a=n*this._origIndex;e.getValue(t,a);for(let r=n,l=a;r!==l;++r)t[r]=t[a+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,a,r){if(a>=.5)for(let l=0;l!==r;++l)e[t+l]=e[n+l]}_slerp(e,t,n,a){ts.slerpFlat(e,t,e,t,e,n,a)}_slerpAdditive(e,t,n,a,r){const l=this._workIndex*r;ts.multiplyQuaternionsFlat(e,l,e,t,e,n),ts.slerpFlat(e,t,e,t,e,l,a)}_lerp(e,t,n,a,r){const l=1-a;for(let u=0;u!==r;++u){const d=t+u;e[d]=e[d]*l+e[n+u]*a}}_lerpAdditive(e,t,n,a,r){for(let l=0;l!==r;++l){const u=t+l;e[u]=e[u]+e[n+l]*a}}}const OS="\\[\\]\\.:\\/",nO=new RegExp("["+OS+"]","g"),NS="[^"+OS+"]",iO="[^"+OS.replace("\\.","")+"]",aO=/((?:WC+[\/:])*)/.source.replace("WC",NS),sO=/(WCOD+)?/.source.replace("WCOD",iO),rO=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",NS),oO=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",NS),lO=new RegExp("^"+aO+sO+rO+oO+"$"),cO=["material","materials","bones","map"];class uO{constructor(e,t,n){const a=n||Qn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,a)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,a=this._bindings[n];a!==void 0&&a.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let a=this._targetGroup.nCachedObjects_,r=n.length;a!==r;++a)n[a].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Qn{constructor(e,t,n){this.path=t,this.parsedPath=n||Qn.parseTrackName(t),this.node=Qn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Qn.Composite(e,t,n):new Qn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(nO,"")}static parseTrackName(e){const t=lO.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},a=n.nodeName&&n.nodeName.lastIndexOf(".");if(a!==void 0&&a!==-1){const r=n.nodeName.substring(a+1);cO.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,a),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let l=0;l<r.length;l++){const u=r[l];if(u.name===t||u.uuid===t)return u;const d=n(u.children);if(d)return d}return null},a=n(e.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let a=0,r=n.length;a!==r;++a)e[t++]=n[a]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let a=0,r=n.length;a!==r;++a)n[a]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let a=0,r=n.length;a!==r;++a)n[a]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let a=0,r=n.length;a!==r;++a)n[a]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,a=t.propertyName;let r=t.propertyIndex;if(e||(e=Qn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Mt("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){un("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){un("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){un("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let x=0;x<e.length;x++)if(e[x].name===p){p=x;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){un("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){un("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){un("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){un("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const l=e[a];if(l===void 0){const p=t.nodeName;un("PropertyBinding: Trying to update property for track: "+p+"."+a+" but it wasn't found.",e);return}let u=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?u=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(r!==void 0){if(a==="morphTargetInfluences"){if(!e.geometry){un("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){un("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}d=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=r}else l.fromArray!==void 0&&l.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(d=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=a;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Qn.Composite=uO;Qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Qn.prototype.GetterByBindingType=[Qn.prototype._getValue_direct,Qn.prototype._getValue_array,Qn.prototype._getValue_arrayElement,Qn.prototype._getValue_toArray];Qn.prototype.SetterByBindingTypeAndVersioning=[[Qn.prototype._setValue_direct,Qn.prototype._setValue_direct_setNeedsUpdate,Qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_array,Qn.prototype._setValue_array_setNeedsUpdate,Qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_arrayElement,Qn.prototype._setValue_arrayElement_setNeedsUpdate,Qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_fromArray,Qn.prototype._setValue_fromArray_setNeedsUpdate,Qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class fO{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Pr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,a=arguments.length;n!==a;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,a=this._parsedPaths,r=this._bindings,l=r.length;let u,d=e.length,p=this.nCachedObjects_;for(let x=0,g=arguments.length;x!==g;++x){const _=arguments[x],y=_.uuid;let b=t[y];if(b===void 0){b=d++,t[y]=b,e.push(_);for(let C=0,E=l;C!==E;++C)r[C].push(new Qn(_,n[C],a[C]))}else if(b<p){u=e[b];const C=--p,E=e[C];t[E.uuid]=b,e[b]=E,t[y]=C,e[C]=_;for(let S=0,w=l;S!==w;++S){const D=r[S],U=D[C];let F=D[b];D[b]=U,F===void 0&&(F=new Qn(_,n[S],a[S])),D[C]=F}}else e[b]!==u&&un("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,a=n.length;let r=this.nCachedObjects_;for(let l=0,u=arguments.length;l!==u;++l){const d=arguments[l],p=d.uuid,x=t[p];if(x!==void 0&&x>=r){const g=r++,_=e[g];t[_.uuid]=x,e[x]=_,t[p]=g,e[g]=d;for(let y=0,b=a;y!==b;++y){const C=n[y],E=C[g],S=C[x];C[x]=E,C[g]=S}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,a=n.length;let r=this.nCachedObjects_,l=e.length;for(let u=0,d=arguments.length;u!==d;++u){const p=arguments[u],x=p.uuid,g=t[x];if(g!==void 0)if(delete t[x],g<r){const _=--r,y=e[_],b=--l,C=e[b];t[y.uuid]=g,e[g]=y,t[C.uuid]=_,e[_]=C,e.pop();for(let E=0,S=a;E!==S;++E){const w=n[E],D=w[_],U=w[b];w[g]=D,w[_]=U,w.pop()}}else{const _=--l,y=e[_];_>0&&(t[y.uuid]=g),e[g]=y,e.pop();for(let b=0,C=a;b!==C;++b){const E=n[b];E[g]=E[_],E.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let a=n[e];const r=this._bindings;if(a!==void 0)return r[a];const l=this._paths,u=this._parsedPaths,d=this._objects,p=d.length,x=this.nCachedObjects_,g=new Array(p);a=r.length,n[e]=a,l.push(e),u.push(t),r.push(g);for(let _=x,y=d.length;_!==y;++_){const b=d[_];g[_]=new Qn(b,e,t)}return g}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const a=this._paths,r=this._parsedPaths,l=this._bindings,u=l.length-1,d=l[u],p=e[u];t[p]=n,l[n]=d,l.pop(),r[n]=r[u],r.pop(),a[n]=a[u],a.pop()}}}class PC{constructor(e,t,n=null,a=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=a;const r=t.tracks,l=r.length,u=new Array(l),d={endingStart:fh,endingEnd:fh};for(let p=0;p!==l;++p){const x=r[p].createInterpolant(null);u[p]=x,x.settings=d}this._interpolantSettings=d,this._interpolants=u,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Qb,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const a=this._clip.duration,r=e._clip.duration,l=r/a,u=a/r;e.warp(1,l,t),this.warp(u,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const a=this._mixer,r=a.time,l=this.timeScale;let u=this._timeScaleInterpolant;u===null&&(u=a._lendControlInterpolant(),this._timeScaleInterpolant=u);const d=u.parameterPositions,p=u.sampleValues;return d[0]=r,d[1]=r+n,p[0]=e/l,p[1]=t/l,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,a){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const d=(e-r)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);const l=this._updateTime(t),u=this._updateWeight(e);if(u>0){const d=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case $b:for(let x=0,g=d.length;x!==g;++x)d[x].evaluate(l),p[x].accumulateAdditive(u);break;case by:default:for(let x=0,g=d.length;x!==g;++x)d[x].evaluate(l),p[x].accumulate(a,u)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const a=n.evaluate(e)[0];t*=a,e>n.parameterPositions[1]&&(this.stopFading(),a===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const a=n.evaluate(e)[0];t*=a,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let a=this.time+e,r=this._loopCount;const l=n===DT;if(e===0)return r===-1?a:l&&(r&1)===1?t-a:a;if(n===Zb){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(a>=t)a=t;else if(a<0)a=0;else{this.time=a;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,l)):this._setEndings(this.repetitions===0,!0,l)),a>=t||a<0){const u=Math.floor(a/t);a-=t*u,r+=Math.abs(u);const d=this.repetitions-r;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a=e>0?t:0,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const p=e<0;this._setEndings(p,!p,l)}else this._setEndings(!1,!1,l);this._loopCount=r,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=a;if(l&&(r&1)===1)return t-a}return a}_setEndings(e,t,n){const a=this._interpolantSettings;n?(a.endingStart=hh,a.endingEnd=hh):(e?a.endingStart=this.zeroSlopeAtStart?hh:fh:a.endingStart=ag,t?a.endingEnd=this.zeroSlopeAtEnd?hh:fh:a.endingEnd=ag)}_scheduleFading(e,t,n){const a=this._mixer,r=a.time;let l=this._weightInterpolant;l===null&&(l=a._lendControlInterpolant(),this._weightInterpolant=l);const u=l.parameterPositions,d=l.sampleValues;return u[0]=r,d[0]=t,u[1]=r+e,d[1]=n,this}}const hO=new Float32Array(1);class LS extends Hr{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,a=e._clip.tracks,r=a.length,l=e._propertyBindings,u=e._interpolants,d=n.uuid,p=this._bindingsByRootAndName;let x=p[d];x===void 0&&(x={},p[d]=x);for(let g=0;g!==r;++g){const _=a[g],y=_.name;let b=x[y];if(b!==void 0)++b.referenceCount,l[g]=b;else{if(b=l[g],b!==void 0){b._cacheIndex===null&&(++b.referenceCount,this._addInactiveBinding(b,d,y));continue}const C=t&&t._propertyBindings[g].binding.parsedPath;b=new IC(Qn.create(n,y,C),_.ValueTypeName,_.getValueSize()),++b.referenceCount,this._addInactiveBinding(b,d,y),l[g]=b}u[g].resultBuffer=b.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,a=e._clip.uuid,r=this._actionsByClip[a];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,a,n)}const t=e._propertyBindings;for(let n=0,a=t.length;n!==a;++n){const r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,a=t.length;n!==a;++n){const r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const a=this._actions,r=this._actionsByClip;let l=r[t];if(l===void 0)l={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=l;else{const u=l.knownActions;e._byClipCacheIndex=u.length,u.push(e)}e._cacheIndex=a.length,a.push(e),l.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],a=e._cacheIndex;n._cacheIndex=a,t[a]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,l=this._actionsByClip,u=l[r],d=u.knownActions,p=d[d.length-1],x=e._byClipCacheIndex;p._byClipCacheIndex=x,d[x]=p,d.pop(),e._byClipCacheIndex=null;const g=u.actionByRoot,_=(e._localRoot||this._root).uuid;delete g[_],d.length===0&&delete l[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,a=t.length;n!==a;++n){const r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,a=this._nActiveActions++,r=t[a];e._cacheIndex=a,t[a]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,a=--this._nActiveActions,r=t[a];e._cacheIndex=a,t[a]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const a=this._bindingsByRootAndName,r=this._bindings;let l=a[t];l===void 0&&(l={},a[t]=l),l[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,a=n.rootNode.uuid,r=n.path,l=this._bindingsByRootAndName,u=l[a],d=t[t.length-1],p=e._cacheIndex;d._cacheIndex=p,t[p]=d,t.pop(),delete u[r],Object.keys(u).length===0&&delete l[a]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,a=this._nActiveBindings++,r=t[a];e._cacheIndex=a,t[a]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,a=--this._nActiveBindings,r=t[a];e._cacheIndex=a,t[a]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new MS(new Float32Array(2),new Float32Array(2),1,hO),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,a=--this._nActiveControlInterpolants,r=t[a];e.__cacheIndex=a,t[a]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const a=t||this._root,r=a.uuid;let l=typeof e=="string"?Rh.findByName(a,e):e;const u=l!==null?l.uuid:e,d=this._actionsByClip[u];let p=null;if(n===void 0&&(l!==null?n=l.blendMode:n=by),d!==void 0){const g=d.actionByRoot[r];if(g!==void 0&&g.blendMode===n)return g;p=d.knownActions[0],l===null&&(l=p._clip)}if(l===null)return null;const x=new PC(this,l,t,n);return this._bindAction(x,p),this._addInactiveAction(x,u,r),x}existingAction(e,t){const n=t||this._root,a=n.uuid,r=typeof e=="string"?Rh.findByName(n,e):e,l=r?r.uuid:e,u=this._actionsByClip[l];return u!==void 0&&u.actionByRoot[a]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,a=this.time+=e,r=Math.sign(e),l=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(a,e,r,l);const u=this._bindings,d=this._nActiveBindings;for(let p=0;p!==d;++p)u[p].apply(l);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,a=this._actionsByClip,r=a[n];if(r!==void 0){const l=r.knownActions;for(let u=0,d=l.length;u!==d;++u){const p=l[u];this._deactivateAction(p);const x=p._cacheIndex,g=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,g._cacheIndex=x,t[x]=g,t.pop(),this._removeInactiveBindingsForAction(p)}delete a[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const l in n){const u=n[l].actionByRoot,d=u[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const a=this._bindingsByRootAndName,r=a[t];if(r!==void 0)for(const l in r){const u=r[l];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class dO extends aS{constructor(e=1,t=1,n=1,a={}){super(e,t,a),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Ay(null,e,t,n),this._setTextureOptions(a),this.texture.isRenderTargetTexture=!0}}class Zn{constructor(e){this.value=e}clone(){return new Zn(this.value.clone===void 0?this.value:this.value.clone())}}let pO=0;class mO extends Hr{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:pO++}),this.name="",this.usage=rg,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,a=t.length;n<a;n++){const r=Array.isArray(t[n])?t[n]:[t[n]];for(let l=0;l<r.length;l++)this.uniforms.push(r[l].clone())}return this}clone(){return new this.constructor().copy(this)}}class gO extends yg{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class vO{constructor(e,t,n,a,r,l=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=a,this.count=r,this.normalized=l,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const l3=new Wt;class Xy{constructor(e,t,n=0,a=1/0){this.ray=new Hp(e,t),this.near=n,this.far=a,this.camera=null,this.layers=new Np,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):un("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return l3.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(l3),this}intersectObject(e,t=!0,n=[]){return Rb(e,this,n,t),n.sort(c3),n}intersectObjects(e,t=!0,n=[]){for(let a=0,r=e.length;a<r;a++)Rb(e[a],this,n,t);return n.sort(c3),n}}function c3(i,e){return i.distance-e.distance}function Rb(i,e,t,n){let a=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(a=!1),a===!0&&n===!0){const r=i.children;for(let l=0,u=r.length;l<u;l++)Rb(r[l],e,t,!0)}}let xO=class{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=_O.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}};function _O(){this._document.hidden===!1&&this.reset()}class FC{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=sn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(sn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class yO{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class IS{constructor(e,t,n,a){IS.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,a)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,a){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=a,this}}const u3=new Ge;class bO{constructor(e=new Ge(1/0,1/0),t=new Ge(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=u3.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,u3).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const f3=new te,Px=new te,rp=new te,op=new te,S1=new te,SO=new te,AO=new te;class MO{constructor(e=new te,t=new te){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){f3.subVectors(e,this.start),Px.subVectors(this.end,this.start);const n=Px.dot(Px);let r=Px.dot(f3)/n;return t&&(r=sn(r,0,1)),r}closestPointToPoint(e,t,n){const a=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(a).add(this.start)}distanceSqToLine3(e,t=SO,n=AO){const a=10000000000000001e-32;let r,l;const u=this.start,d=e.start,p=this.end,x=e.end;rp.subVectors(p,u),op.subVectors(x,d),S1.subVectors(u,d);const g=rp.dot(rp),_=op.dot(op),y=op.dot(S1);if(g<=a&&_<=a)return t.copy(u),n.copy(d),t.sub(n),t.dot(t);if(g<=a)r=0,l=y/_,l=sn(l,0,1);else{const b=rp.dot(S1);if(_<=a)l=0,r=sn(-b/g,0,1);else{const C=rp.dot(op),E=g*_-C*C;E!==0?r=sn((C*y-b*_)/E,0,1):r=0,l=(C*r+y)/_,l<0?(l=0,r=sn(-b/g,0,1)):l>1&&(l=1,r=sn((C-b)/g,0,1))}}return t.copy(u).add(rp.multiplyScalar(r)),n.copy(d).add(op.multiplyScalar(l)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const h3=new te;class EO extends Pn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new rn,a=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let l=0,u=1,d=32;l<d;l++,u++){const p=l/d*Math.PI*2,x=u/d*Math.PI*2;a.push(Math.cos(p),Math.sin(p),1,Math.cos(x),Math.sin(x),1)}n.setAttribute("position",new zt(a,3));const r=new Os({fog:!1,toneMapped:!1});this.cone=new Qo(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),h3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(h3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Mu=new te,Fx=new Wt,A1=new Wt;class zC extends Qo{constructor(e){const t=HC(e),n=new rn,a=[],r=[];for(let p=0;p<t.length;p++){const x=t[p];x.parent&&x.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),r.push(0,0,0),r.push(0,0,0))}n.setAttribute("position",new zt(a,3)),n.setAttribute("color",new zt(r,3));const l=new Os({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const u=new ut(255),d=new ut(65280);this.setColors(u,d)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,a=n.getAttribute("position");A1.copy(this.root.matrixWorld).invert();for(let r=0,l=0;r<t.length;r++){const u=t[r];u.parent&&u.parent.isBone&&(Fx.multiplyMatrices(A1,u.matrixWorld),Mu.setFromMatrixPosition(Fx),a.setXYZ(l,Mu.x,Mu.y,Mu.z),Fx.multiplyMatrices(A1,u.parent.matrixWorld),Mu.setFromMatrixPosition(Fx),a.setXYZ(l+1,Mu.x,Mu.y,Mu.z),l+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const a=this.geometry.getAttribute("color");for(let r=0;r<a.count;r+=2)a.setXYZ(r,e.r,e.g,e.b),a.setXYZ(r+1,t.r,t.g,t.b);return a.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function HC(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...HC(i.children[t]));return e}class TO extends Xi{constructor(e,t,n){const a=new Oh(t,4,2),r=new $a({wireframe:!0,fog:!1,toneMapped:!1});super(a,r),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const CO=new te,d3=new ut,p3=new ut;class RO extends Pn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const a=new Eg(t);a.rotateY(Math.PI*.5),this.material=new $a({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=a.getAttribute("position"),l=new Float32Array(r.count*3);a.setAttribute("color",new Mn(l,3)),this.add(new Xi(a,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");d3.copy(this.light.color),p3.copy(this.light.groundColor);for(let n=0,a=t.count;n<a;n++){const r=n<a/2?d3:p3;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(CO.setFromMatrixPosition(this.light.matrixWorld).negate())}}class wO extends Qo{constructor(e=10,t=10,n=4473924,a=8947848){n=new ut(n),a=new ut(a);const r=t/2,l=e/t,u=e/2,d=[],p=[];for(let _=0,y=0,b=-u;_<=t;_++,b+=l){d.push(-u,0,b,u,0,b),d.push(b,0,-u,b,0,u);const C=_===r?n:a;C.toArray(p,y),y+=3,C.toArray(p,y),y+=3,C.toArray(p,y),y+=3,C.toArray(p,y),y+=3}const x=new rn;x.setAttribute("position",new zt(d,3)),x.setAttribute("color",new zt(p,3));const g=new Os({vertexColors:!0,toneMapped:!1});super(x,g),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class BO extends Qo{constructor(e=10,t=16,n=8,a=64,r=4473924,l=8947848){r=new ut(r),l=new ut(l);const u=[],d=[];if(t>1)for(let g=0;g<t;g++){const _=g/t*(Math.PI*2),y=Math.sin(_)*e,b=Math.cos(_)*e;u.push(0,0,0),u.push(y,0,b);const C=g&1?r:l;d.push(C.r,C.g,C.b),d.push(C.r,C.g,C.b)}for(let g=0;g<n;g++){const _=g&1?r:l,y=e-e/n*g;for(let b=0;b<a;b++){let C=b/a*(Math.PI*2),E=Math.sin(C)*y,S=Math.cos(C)*y;u.push(E,0,S),d.push(_.r,_.g,_.b),C=(b+1)/a*(Math.PI*2),E=Math.sin(C)*y,S=Math.cos(C)*y,u.push(E,0,S),d.push(_.r,_.g,_.b)}}const p=new rn;p.setAttribute("position",new zt(u,3)),p.setAttribute("color",new zt(d,3));const x=new Os({vertexColors:!0,toneMapped:!1});super(p,x),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const m3=new te,zx=new te,g3=new te;class DO extends Pn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let a=new rn;a.setAttribute("position",new zt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Os({fog:!1,toneMapped:!1});this.lightPlane=new Uc(a,r),this.add(this.lightPlane),a=new rn,a.setAttribute("position",new zt([0,0,0,0,0,1],3)),this.targetLine=new Uc(a,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),m3.setFromMatrixPosition(this.light.matrixWorld),zx.setFromMatrixPosition(this.light.target.matrixWorld),g3.subVectors(zx,m3),this.lightPlane.lookAt(zx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(zx),this.targetLine.scale.z=g3.length()}}const Hx=new te,sa=new My;class UO extends Qo{constructor(e){const t=new rn,n=new Os({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],r=[],l={};u("n1","n2"),u("n2","n4"),u("n4","n3"),u("n3","n1"),u("f1","f2"),u("f2","f4"),u("f4","f3"),u("f3","f1"),u("n1","f1"),u("n2","f2"),u("n3","f3"),u("n4","f4"),u("p","n1"),u("p","n2"),u("p","n3"),u("p","n4"),u("u1","u2"),u("u2","u3"),u("u3","u1"),u("c","t"),u("p","c"),u("cn1","cn2"),u("cn3","cn4"),u("cf1","cf2"),u("cf3","cf4");function u(b,C){d(b),d(C)}function d(b){a.push(0,0,0),r.push(0,0,0),l[b]===void 0&&(l[b]=[]),l[b].push(a.length/3-1)}t.setAttribute("position",new zt(a,3)),t.setAttribute("color",new zt(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=l,this.update();const p=new ut(16755200),x=new ut(16711680),g=new ut(43775),_=new ut(16777215),y=new ut(3355443);this.setColors(p,x,g,_,y)}setColors(e,t,n,a,r){const u=this.geometry.getAttribute("color");return u.setXYZ(0,e.r,e.g,e.b),u.setXYZ(1,e.r,e.g,e.b),u.setXYZ(2,e.r,e.g,e.b),u.setXYZ(3,e.r,e.g,e.b),u.setXYZ(4,e.r,e.g,e.b),u.setXYZ(5,e.r,e.g,e.b),u.setXYZ(6,e.r,e.g,e.b),u.setXYZ(7,e.r,e.g,e.b),u.setXYZ(8,e.r,e.g,e.b),u.setXYZ(9,e.r,e.g,e.b),u.setXYZ(10,e.r,e.g,e.b),u.setXYZ(11,e.r,e.g,e.b),u.setXYZ(12,e.r,e.g,e.b),u.setXYZ(13,e.r,e.g,e.b),u.setXYZ(14,e.r,e.g,e.b),u.setXYZ(15,e.r,e.g,e.b),u.setXYZ(16,e.r,e.g,e.b),u.setXYZ(17,e.r,e.g,e.b),u.setXYZ(18,e.r,e.g,e.b),u.setXYZ(19,e.r,e.g,e.b),u.setXYZ(20,e.r,e.g,e.b),u.setXYZ(21,e.r,e.g,e.b),u.setXYZ(22,e.r,e.g,e.b),u.setXYZ(23,e.r,e.g,e.b),u.setXYZ(24,t.r,t.g,t.b),u.setXYZ(25,t.r,t.g,t.b),u.setXYZ(26,t.r,t.g,t.b),u.setXYZ(27,t.r,t.g,t.b),u.setXYZ(28,t.r,t.g,t.b),u.setXYZ(29,t.r,t.g,t.b),u.setXYZ(30,t.r,t.g,t.b),u.setXYZ(31,t.r,t.g,t.b),u.setXYZ(32,n.r,n.g,n.b),u.setXYZ(33,n.r,n.g,n.b),u.setXYZ(34,n.r,n.g,n.b),u.setXYZ(35,n.r,n.g,n.b),u.setXYZ(36,n.r,n.g,n.b),u.setXYZ(37,n.r,n.g,n.b),u.setXYZ(38,a.r,a.g,a.b),u.setXYZ(39,a.r,a.g,a.b),u.setXYZ(40,r.r,r.g,r.b),u.setXYZ(41,r.r,r.g,r.b),u.setXYZ(42,r.r,r.g,r.b),u.setXYZ(43,r.r,r.g,r.b),u.setXYZ(44,r.r,r.g,r.b),u.setXYZ(45,r.r,r.g,r.b),u.setXYZ(46,r.r,r.g,r.b),u.setXYZ(47,r.r,r.g,r.b),u.setXYZ(48,r.r,r.g,r.b),u.setXYZ(49,r.r,r.g,r.b),u.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,a=1;let r,l;if(sa.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)r=1,l=0;else if(this.camera.coordinateSystem===Ir)r=-1,l=1;else if(this.camera.coordinateSystem===Dp)r=0,l=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);va("c",t,e,sa,0,0,r),va("t",t,e,sa,0,0,l),va("n1",t,e,sa,-n,-a,r),va("n2",t,e,sa,n,-a,r),va("n3",t,e,sa,-n,a,r),va("n4",t,e,sa,n,a,r),va("f1",t,e,sa,-n,-a,l),va("f2",t,e,sa,n,-a,l),va("f3",t,e,sa,-n,a,l),va("f4",t,e,sa,n,a,l),va("u1",t,e,sa,n*.7,a*1.1,r),va("u2",t,e,sa,-n*.7,a*1.1,r),va("u3",t,e,sa,0,a*2,r),va("cf1",t,e,sa,-n,0,l),va("cf2",t,e,sa,n,0,l),va("cf3",t,e,sa,0,-a,l),va("cf4",t,e,sa,0,a,l),va("cn1",t,e,sa,-n,0,r),va("cn2",t,e,sa,n,0,r),va("cn3",t,e,sa,0,-a,r),va("cn4",t,e,sa,0,a,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function va(i,e,t,n,a,r,l){Hx.set(a,r,l).unproject(n);const u=e[i];if(u!==void 0){const d=t.getAttribute("position");for(let p=0,x=u.length;p<x;p++)d.setXYZ(u[p],Hx.x,Hx.y,Hx.z)}}const Gx=new ns;class OO extends Qo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new Float32Array(24),r=new rn;r.setIndex(new Mn(n,1)),r.setAttribute("position",new Mn(a,3)),super(r,new Os({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Gx.setFromObject(this.object),Gx.isEmpty())return;const e=Gx.min,t=Gx.max,n=this.geometry.attributes.position,a=n.array;a[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=e.x,a[4]=t.y,a[5]=t.z,a[6]=e.x,a[7]=e.y,a[8]=t.z,a[9]=t.x,a[10]=e.y,a[11]=t.z,a[12]=t.x,a[13]=t.y,a[14]=e.z,a[15]=e.x,a[16]=t.y,a[17]=e.z,a[18]=e.x,a[19]=e.y,a[20]=e.z,a[21]=t.x,a[22]=e.y,a[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class NO extends Qo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new rn;r.setIndex(new Mn(n,1)),r.setAttribute("position",new zt(a,3)),super(r,new Os({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class LO extends Uc{constructor(e,t=1,n=16776960){const a=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],l=new rn;l.setAttribute("position",new zt(r,3)),l.computeBoundingSphere(),super(l,new Os({color:a,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const u=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new rn;d.setAttribute("position",new zt(u,3)),d.computeBoundingSphere(),this.add(new Xi(d,new $a({color:a,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const v3=new te;let Vx,M1;class IO extends Pn{constructor(e=new te(0,0,1),t=new te(0,0,0),n=1,a=16776960,r=n*.2,l=r*.2){super(),this.type="ArrowHelper",Vx===void 0&&(Vx=new rn,Vx.setAttribute("position",new zt([0,0,0,0,1,0],3)),M1=new Ag(.5,1,5,1),M1.translate(0,-.5,0)),this.position.copy(t),this.line=new Uc(Vx,new Os({color:a,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Xi(M1,new $a({color:a,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,l)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{v3.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(v3,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class PO extends Qo{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],a=new rn;a.setAttribute("position",new zt(t,3)),a.setAttribute("color",new zt(n,3));const r=new Os({vertexColors:!0,toneMapped:!1});super(a,r),this.type="AxesHelper"}setColors(e,t,n){const a=new ut,r=this.geometry.attributes.color.array;return a.set(e),a.toArray(r,0),a.toArray(r,3),a.set(t),a.toArray(r,6),a.toArray(r,9),a.set(n),a.toArray(r,12),a.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class FO{constructor(){this.type="ShapePath",this.color=new ut,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new $_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,a){return this.currentPath.quadraticCurveTo(e,t,n,a),this}bezierCurveTo(e,t,n,a,r,l){return this.currentPath.bezierCurveTo(e,t,n,a,r,l),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S){const w=[];for(let D=0,U=S.length;D<U;D++){const F=S[D],N=new _h;N.curves=F.curves,w.push(N)}return w}function n(S,w){const D=w.length;let U=!1;for(let F=D-1,N=0;N<D;F=N++){let z=w[F],j=w[N],L=j.x-z.x,P=j.y-z.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(z=w[N],L=-L,j=w[F],P=-P),S.y<z.y||S.y>j.y)continue;if(S.y===z.y){if(S.x===z.x)return!0}else{const q=P*(S.x-z.x)-L*(S.y-z.y);if(q===0)return!0;if(q<0)continue;U=!U}}else{if(S.y!==z.y)continue;if(j.x<=S.x&&S.x<=z.x||z.x<=S.x&&S.x<=j.x)return!0}}return U}const a=Ko.isClockWise,r=this.subPaths;if(r.length===0)return[];let l,u,d;const p=[];if(r.length===1)return u=r[0],d=new _h,d.curves=u.curves,p.push(d),p;let x=!a(r[0].getPoints());x=e?!x:x;const g=[],_=[];let y=[],b=0,C;_[b]=void 0,y[b]=[];for(let S=0,w=r.length;S<w;S++)u=r[S],C=u.getPoints(),l=a(C),l=e?!l:l,l?(!x&&_[b]&&b++,_[b]={s:new _h,p:C},_[b].s.curves=u.curves,x&&b++,y[b]=[]):y[b].push({h:u,p:C[0]});if(!_[0])return t(r);if(_.length>1){let S=!1,w=0;for(let D=0,U=_.length;D<U;D++)g[D]=[];for(let D=0,U=_.length;D<U;D++){const F=y[D];for(let N=0;N<F.length;N++){const z=F[N];let j=!0;for(let L=0;L<_.length;L++)n(z.p,_[L].p)&&(D!==L&&w++,j?(j=!1,g[L].push(z)):S=!0);j&&g[D].push(z)}}w>0&&S===!1&&(y=g)}let E;for(let S=0,w=_.length;S<w;S++){d=_[S].s,p.push(d),E=y[S];for(let D=0,U=E.length;D<U;D++)d.holes.push(E[D].h)}return p}}class zO extends Hr{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Mt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function HO(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function GO(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function VO(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function wb(i,e,t,n){const a=kO(n);switch(t){case Jb:return i*e;case vg:return i*e/a.components*a.byteLength;case xg:return i*e/a.components*a.byteLength;case xy:return i*e*2/a.components*a.byteLength;case _y:return i*e*2/a.components*a.byteLength;case Wb:return i*e*3/a.components*a.byteLength;case _a:return i*e*4/a.components*a.byteLength;case yy:return i*e*4/a.components*a.byteLength;case Xm:case Ym:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case qm:case Km:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case S_:case M_:return Math.max(i,16)*Math.max(e,8)/4;case b_:case A_:return Math.max(i,8)*Math.max(e,8)/2;case E_:case T_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case C_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case R_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case w_:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case B_:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case D_:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case U_:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case O_:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case N_:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case L_:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case I_:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case P_:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case F_:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case z_:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case H_:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case G_:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case V_:case k_:case j_:return Math.ceil(i/4)*Math.ceil(e/4)*16;case X_:case Y_:return Math.ceil(i/4)*Math.ceil(e/4)*8;case q_:case K_:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function kO(i){switch(i){case ca:case py:return{byteLength:1,components:1};case Cp:case my:case wa:return{byteLength:2,components:1};case gy:case vy:return{byteLength:2,components:4};case Zo:case gg:case ji:return{byteLength:4,components:1};case qb:case Kb:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class jO{static contain(e,t){return HO(e,t)}static cover(e,t){return GO(e,t)}static fill(e){return VO(e)}static getByteLength(e,t,n,a){return wb(e,t,n,a)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Dh}}));typeof window<"u"&&(window.__THREE__?Mt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Dh);function GC(){let i=null,e=!1,t=null,n=null;function a(r,l){t(r,l),n=i.requestAnimationFrame(a)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(a),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){i=r}}}function XO(i){const e=new WeakMap;function t(u,d){const p=u.array,x=u.usage,g=p.byteLength,_=i.createBuffer();i.bindBuffer(d,_),i.bufferData(d,p,x),u.onUploadCallback();let y;if(p instanceof Float32Array)y=i.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)y=i.HALF_FLOAT;else if(p instanceof Uint16Array)u.isFloat16BufferAttribute?y=i.HALF_FLOAT:y=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)y=i.SHORT;else if(p instanceof Uint32Array)y=i.UNSIGNED_INT;else if(p instanceof Int32Array)y=i.INT;else if(p instanceof Int8Array)y=i.BYTE;else if(p instanceof Uint8Array)y=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)y=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:_,type:y,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version,size:g}}function n(u,d,p){const x=d.array,g=d.updateRanges;if(i.bindBuffer(p,u),g.length===0)i.bufferSubData(p,0,x);else{g.sort((y,b)=>y.start-b.start);let _=0;for(let y=1;y<g.length;y++){const b=g[_],C=g[y];C.start<=b.start+b.count+1?b.count=Math.max(b.count,C.start+C.count-b.start):(++_,g[_]=C)}g.length=_+1;for(let y=0,b=g.length;y<b;y++){const C=g[y];i.bufferSubData(p,C.start*x.BYTES_PER_ELEMENT,x,C.start,C.count)}d.clearUpdateRanges()}d.onUploadCallback()}function a(u){return u.isInterleavedBufferAttribute&&(u=u.data),e.get(u)}function r(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=e.get(u);d&&(i.deleteBuffer(d.buffer),e.delete(u))}function l(u,d){if(u.isInterleavedBufferAttribute&&(u=u.data),u.isGLBufferAttribute){const x=e.get(u);(!x||x.version<u.version)&&e.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}const p=e.get(u);if(p===void 0)e.set(u,t(u,d));else if(p.version<u.version){if(p.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,u,d),p.version=u.version}}return{get:a,remove:r,update:l}}var YO=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,qO=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,KO=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,JO=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,WO=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,ZO=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,QO=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,$O=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,eN=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,tN=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,nN=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,iN=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,aN=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,sN=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,rN=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,oN=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,lN=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,cN=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,uN=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,fN=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,hN=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,dN=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,pN=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,mN=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,gN=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,vN=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,xN=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,_N=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,yN=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,bN=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,SN="gl_FragColor = linearToOutputTexel( gl_FragColor );",AN=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,MN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,EN=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,TN=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,CN=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,RN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,wN=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,BN=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,DN=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,UN=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ON=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,NN=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,LN=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,IN=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,PN=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,FN=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,zN=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,HN=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,GN=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,VN=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,kN=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,jN=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 uv = vec2( roughness, dotNV );
	return texture2D( dfgLUT, uv ).rg;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNV * dotNV), 0.0, dotNV), material.roughness );
	vec2 dfgL = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNL * dotNL), 0.0, dotNL), material.roughness );
	vec3 FssEss_V = material.specularColor * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColor * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColor + ( 1.0 - material.specularColor ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,XN=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,YN=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,qN=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,KN=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,JN=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,WN=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,ZN=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,QN=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,$N=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,eL=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,tL=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,nL=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,iL=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,aL=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,sL=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,rL=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,oL=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,lL=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,cL=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,uL=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,fL=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,hL=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,dL=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,pL=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,mL=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,gL=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,vL=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,xL=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,_L=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,yL=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,bL=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,SL=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,AL=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,ML=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,EL=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,TL=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,CL=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow( sampler2D shadow, vec2 uv, float compare ) {
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare, distribution.x );
		#endif
		if ( hard_shadow != 1.0 ) {
			float distance = compare - distribution.x;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,RL=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,wL=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,BL=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,DL=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,UL=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,OL=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,NL=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,LL=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,IL=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,PL=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,FL=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,zL=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,HL=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,GL=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,VL=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,kL=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,jL=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const XL=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,YL=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,qL=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,KL=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,JL=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,WL=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ZL=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,QL=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,$L=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,e4=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,t4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,n4=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,i4=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,a4=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,s4=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,r4=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,o4=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,l4=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,c4=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,u4=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,f4=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,h4=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,d4=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,p4=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,m4=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,g4=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,v4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,x4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_4=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,y4=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,b4=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,S4=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,A4=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,M4=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,An={alphahash_fragment:YO,alphahash_pars_fragment:qO,alphamap_fragment:KO,alphamap_pars_fragment:JO,alphatest_fragment:WO,alphatest_pars_fragment:ZO,aomap_fragment:QO,aomap_pars_fragment:$O,batching_pars_vertex:eN,batching_vertex:tN,begin_vertex:nN,beginnormal_vertex:iN,bsdfs:aN,iridescence_fragment:sN,bumpmap_pars_fragment:rN,clipping_planes_fragment:oN,clipping_planes_pars_fragment:lN,clipping_planes_pars_vertex:cN,clipping_planes_vertex:uN,color_fragment:fN,color_pars_fragment:hN,color_pars_vertex:dN,color_vertex:pN,common:mN,cube_uv_reflection_fragment:gN,defaultnormal_vertex:vN,displacementmap_pars_vertex:xN,displacementmap_vertex:_N,emissivemap_fragment:yN,emissivemap_pars_fragment:bN,colorspace_fragment:SN,colorspace_pars_fragment:AN,envmap_fragment:MN,envmap_common_pars_fragment:EN,envmap_pars_fragment:TN,envmap_pars_vertex:CN,envmap_physical_pars_fragment:FN,envmap_vertex:RN,fog_vertex:wN,fog_pars_vertex:BN,fog_fragment:DN,fog_pars_fragment:UN,gradientmap_pars_fragment:ON,lightmap_pars_fragment:NN,lights_lambert_fragment:LN,lights_lambert_pars_fragment:IN,lights_pars_begin:PN,lights_toon_fragment:zN,lights_toon_pars_fragment:HN,lights_phong_fragment:GN,lights_phong_pars_fragment:VN,lights_physical_fragment:kN,lights_physical_pars_fragment:jN,lights_fragment_begin:XN,lights_fragment_maps:YN,lights_fragment_end:qN,logdepthbuf_fragment:KN,logdepthbuf_pars_fragment:JN,logdepthbuf_pars_vertex:WN,logdepthbuf_vertex:ZN,map_fragment:QN,map_pars_fragment:$N,map_particle_fragment:eL,map_particle_pars_fragment:tL,metalnessmap_fragment:nL,metalnessmap_pars_fragment:iL,morphinstance_vertex:aL,morphcolor_vertex:sL,morphnormal_vertex:rL,morphtarget_pars_vertex:oL,morphtarget_vertex:lL,normal_fragment_begin:cL,normal_fragment_maps:uL,normal_pars_fragment:fL,normal_pars_vertex:hL,normal_vertex:dL,normalmap_pars_fragment:pL,clearcoat_normal_fragment_begin:mL,clearcoat_normal_fragment_maps:gL,clearcoat_pars_fragment:vL,iridescence_pars_fragment:xL,opaque_fragment:_L,packing:yL,premultiplied_alpha_fragment:bL,project_vertex:SL,dithering_fragment:AL,dithering_pars_fragment:ML,roughnessmap_fragment:EL,roughnessmap_pars_fragment:TL,shadowmap_pars_fragment:CL,shadowmap_pars_vertex:RL,shadowmap_vertex:wL,shadowmask_pars_fragment:BL,skinbase_vertex:DL,skinning_pars_vertex:UL,skinning_vertex:OL,skinnormal_vertex:NL,specularmap_fragment:LL,specularmap_pars_fragment:IL,tonemapping_fragment:PL,tonemapping_pars_fragment:FL,transmission_fragment:zL,transmission_pars_fragment:HL,uv_pars_fragment:GL,uv_pars_vertex:VL,uv_vertex:kL,worldpos_vertex:jL,background_vert:XL,background_frag:YL,backgroundCube_vert:qL,backgroundCube_frag:KL,cube_vert:JL,cube_frag:WL,depth_vert:ZL,depth_frag:QL,distanceRGBA_vert:$L,distanceRGBA_frag:e4,equirect_vert:t4,equirect_frag:n4,linedashed_vert:i4,linedashed_frag:a4,meshbasic_vert:s4,meshbasic_frag:r4,meshlambert_vert:o4,meshlambert_frag:l4,meshmatcap_vert:c4,meshmatcap_frag:u4,meshnormal_vert:f4,meshnormal_frag:h4,meshphong_vert:d4,meshphong_frag:p4,meshphysical_vert:m4,meshphysical_frag:g4,meshtoon_vert:v4,meshtoon_frag:x4,points_vert:_4,points_frag:y4,shadow_vert:b4,shadow_frag:S4,sprite_vert:A4,sprite_frag:M4},At={common:{diffuse:{value:new ut(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new vn},alphaMap:{value:null},alphaMapTransform:{value:new vn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new vn}},envmap:{envMap:{value:null},envMapRotation:{value:new vn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new vn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new vn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new vn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new vn},normalScale:{value:new Ge(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new vn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new vn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new vn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new vn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new vn},alphaTest:{value:0},uvTransform:{value:new vn}},sprite:{diffuse:{value:new ut(16777215)},opacity:{value:1},center:{value:new Ge(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new vn},alphaMap:{value:null},alphaMapTransform:{value:new vn},alphaTest:{value:0}}},Yo={basic:{uniforms:$s([At.common,At.specularmap,At.envmap,At.aomap,At.lightmap,At.fog]),vertexShader:An.meshbasic_vert,fragmentShader:An.meshbasic_frag},lambert:{uniforms:$s([At.common,At.specularmap,At.envmap,At.aomap,At.lightmap,At.emissivemap,At.bumpmap,At.normalmap,At.displacementmap,At.fog,At.lights,{emissive:{value:new ut(0)}}]),vertexShader:An.meshlambert_vert,fragmentShader:An.meshlambert_frag},phong:{uniforms:$s([At.common,At.specularmap,At.envmap,At.aomap,At.lightmap,At.emissivemap,At.bumpmap,At.normalmap,At.displacementmap,At.fog,At.lights,{emissive:{value:new ut(0)},specular:{value:new ut(1118481)},shininess:{value:30}}]),vertexShader:An.meshphong_vert,fragmentShader:An.meshphong_frag},standard:{uniforms:$s([At.common,At.envmap,At.aomap,At.lightmap,At.emissivemap,At.bumpmap,At.normalmap,At.displacementmap,At.roughnessmap,At.metalnessmap,At.fog,At.lights,{emissive:{value:new ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:An.meshphysical_vert,fragmentShader:An.meshphysical_frag},toon:{uniforms:$s([At.common,At.aomap,At.lightmap,At.emissivemap,At.bumpmap,At.normalmap,At.displacementmap,At.gradientmap,At.fog,At.lights,{emissive:{value:new ut(0)}}]),vertexShader:An.meshtoon_vert,fragmentShader:An.meshtoon_frag},matcap:{uniforms:$s([At.common,At.bumpmap,At.normalmap,At.displacementmap,At.fog,{matcap:{value:null}}]),vertexShader:An.meshmatcap_vert,fragmentShader:An.meshmatcap_frag},points:{uniforms:$s([At.points,At.fog]),vertexShader:An.points_vert,fragmentShader:An.points_frag},dashed:{uniforms:$s([At.common,At.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:An.linedashed_vert,fragmentShader:An.linedashed_frag},depth:{uniforms:$s([At.common,At.displacementmap]),vertexShader:An.depth_vert,fragmentShader:An.depth_frag},normal:{uniforms:$s([At.common,At.bumpmap,At.normalmap,At.displacementmap,{opacity:{value:1}}]),vertexShader:An.meshnormal_vert,fragmentShader:An.meshnormal_frag},sprite:{uniforms:$s([At.sprite,At.fog]),vertexShader:An.sprite_vert,fragmentShader:An.sprite_frag},background:{uniforms:{uvTransform:{value:new vn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:An.background_vert,fragmentShader:An.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new vn}},vertexShader:An.backgroundCube_vert,fragmentShader:An.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:An.cube_vert,fragmentShader:An.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:An.equirect_vert,fragmentShader:An.equirect_frag},distanceRGBA:{uniforms:$s([At.common,At.displacementmap,{referencePosition:{value:new te},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:An.distanceRGBA_vert,fragmentShader:An.distanceRGBA_frag},shadow:{uniforms:$s([At.lights,At.fog,{color:{value:new ut(0)},opacity:{value:1}}]),vertexShader:An.shadow_vert,fragmentShader:An.shadow_frag}};Yo.physical={uniforms:$s([Yo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new vn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new vn},clearcoatNormalScale:{value:new Ge(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new vn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new vn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new vn},sheen:{value:0},sheenColor:{value:new ut(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new vn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new vn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new vn},transmissionSamplerSize:{value:new Ge},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new vn},attenuationDistance:{value:0},attenuationColor:{value:new ut(0)},specularColor:{value:new ut(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new vn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new vn},anisotropyVector:{value:new Ge},anisotropyMap:{value:null},anisotropyMapTransform:{value:new vn}}]),vertexShader:An.meshphysical_vert,fragmentShader:An.meshphysical_frag};const kx={r:0,b:0,g:0},nh=new zr,E4=new Wt;function T4(i,e,t,n,a,r,l){const u=new ut(0);let d=r===!0?0:1,p,x,g=null,_=0,y=null;function b(D){let U=D.isScene===!0?D.background:null;return U&&U.isTexture&&(U=(D.backgroundBlurriness>0?t:e).get(U)),U}function C(D){let U=!1;const F=b(D);F===null?S(u,d):F&&F.isColor&&(S(F,1),U=!0);const N=i.xr.getEnvironmentBlendMode();N==="additive"?n.buffers.color.setClear(0,0,0,1,l):N==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,l),(i.autoClear||U)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function E(D,U){const F=b(U);F&&(F.isCubeTexture||F.mapping===zp)?(x===void 0&&(x=new Xi(new Uh(1,1,1),new hi({name:"BackgroundCubeMaterial",uniforms:Lp(Yo.backgroundCube.uniforms),vertexShader:Yo.backgroundCube.vertexShader,fragmentShader:Yo.backgroundCube.fragmentShader,side:oa,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),x.geometry.deleteAttribute("normal"),x.geometry.deleteAttribute("uv"),x.onBeforeRender=function(N,z,j){this.matrixWorld.copyPosition(j.matrixWorld)},Object.defineProperty(x.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(x)),nh.copy(U.backgroundRotation),nh.x*=-1,nh.y*=-1,nh.z*=-1,F.isCubeTexture&&F.isRenderTargetTexture===!1&&(nh.y*=-1,nh.z*=-1),x.material.uniforms.envMap.value=F,x.material.uniforms.flipEnvMap.value=F.isCubeTexture&&F.isRenderTargetTexture===!1?-1:1,x.material.uniforms.backgroundBlurriness.value=U.backgroundBlurriness,x.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,x.material.uniforms.backgroundRotation.value.setFromMatrix4(E4.makeRotationFromEuler(nh)),x.material.toneMapped=Wn.getTransfer(F.colorSpace)!==xi,(g!==F||_!==F.version||y!==i.toneMapping)&&(x.material.needsUpdate=!0,g=F,_=F.version,y=i.toneMapping),x.layers.enableAll(),D.unshift(x,x.geometry,x.material,0,0,null)):F&&F.isTexture&&(p===void 0&&(p=new Xi(new Ju(2,2),new hi({name:"BackgroundMaterial",uniforms:Lp(Yo.background.uniforms),vertexShader:Yo.background.vertexShader,fragmentShader:Yo.background.fragmentShader,side:Wo,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(p)),p.material.uniforms.t2D.value=F,p.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,p.material.toneMapped=Wn.getTransfer(F.colorSpace)!==xi,F.matrixAutoUpdate===!0&&F.updateMatrix(),p.material.uniforms.uvTransform.value.copy(F.matrix),(g!==F||_!==F.version||y!==i.toneMapping)&&(p.material.needsUpdate=!0,g=F,_=F.version,y=i.toneMapping),p.layers.enableAll(),D.unshift(p,p.geometry,p.material,0,0,null))}function S(D,U){D.getRGB(kx,YT(i)),n.buffers.color.setClear(kx.r,kx.g,kx.b,U,l)}function w(){x!==void 0&&(x.geometry.dispose(),x.material.dispose(),x=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return u},setClearColor:function(D,U=1){u.set(D),d=U,S(u,d)},getClearAlpha:function(){return d},setClearAlpha:function(D){d=D,S(u,d)},render:C,addToRenderList:E,dispose:w}}function C4(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},a=_(null);let r=a,l=!1;function u(P,q,ie,se,ae){let re=!1;const H=g(se,ie,q);r!==H&&(r=H,p(r.object)),re=y(P,se,ie,ae),re&&b(P,se,ie,ae),ae!==null&&e.update(ae,i.ELEMENT_ARRAY_BUFFER),(re||l)&&(l=!1,U(P,q,ie,se),ae!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(ae).buffer))}function d(){return i.createVertexArray()}function p(P){return i.bindVertexArray(P)}function x(P){return i.deleteVertexArray(P)}function g(P,q,ie){const se=ie.wireframe===!0;let ae=n[P.id];ae===void 0&&(ae={},n[P.id]=ae);let re=ae[q.id];re===void 0&&(re={},ae[q.id]=re);let H=re[se];return H===void 0&&(H=_(d()),re[se]=H),H}function _(P){const q=[],ie=[],se=[];for(let ae=0;ae<t;ae++)q[ae]=0,ie[ae]=0,se[ae]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:ie,attributeDivisors:se,object:P,attributes:{},index:null}}function y(P,q,ie,se){const ae=r.attributes,re=q.attributes;let H=0;const K=ie.getAttributes();for(const W in K)if(K[W].location>=0){const ve=ae[W];let Q=re[W];if(Q===void 0&&(W==="instanceMatrix"&&P.instanceMatrix&&(Q=P.instanceMatrix),W==="instanceColor"&&P.instanceColor&&(Q=P.instanceColor)),ve===void 0||ve.attribute!==Q||Q&&ve.data!==Q.data)return!0;H++}return r.attributesNum!==H||r.index!==se}function b(P,q,ie,se){const ae={},re=q.attributes;let H=0;const K=ie.getAttributes();for(const W in K)if(K[W].location>=0){let ve=re[W];ve===void 0&&(W==="instanceMatrix"&&P.instanceMatrix&&(ve=P.instanceMatrix),W==="instanceColor"&&P.instanceColor&&(ve=P.instanceColor));const Q={};Q.attribute=ve,ve&&ve.data&&(Q.data=ve.data),ae[W]=Q,H++}r.attributes=ae,r.attributesNum=H,r.index=se}function C(){const P=r.newAttributes;for(let q=0,ie=P.length;q<ie;q++)P[q]=0}function E(P){S(P,0)}function S(P,q){const ie=r.newAttributes,se=r.enabledAttributes,ae=r.attributeDivisors;ie[P]=1,se[P]===0&&(i.enableVertexAttribArray(P),se[P]=1),ae[P]!==q&&(i.vertexAttribDivisor(P,q),ae[P]=q)}function w(){const P=r.newAttributes,q=r.enabledAttributes;for(let ie=0,se=q.length;ie<se;ie++)q[ie]!==P[ie]&&(i.disableVertexAttribArray(ie),q[ie]=0)}function D(P,q,ie,se,ae,re,H){H===!0?i.vertexAttribIPointer(P,q,ie,ae,re):i.vertexAttribPointer(P,q,ie,se,ae,re)}function U(P,q,ie,se){C();const ae=se.attributes,re=ie.getAttributes(),H=q.defaultAttributeValues;for(const K in re){const W=re[K];if(W.location>=0){let me=ae[K];if(me===void 0&&(K==="instanceMatrix"&&P.instanceMatrix&&(me=P.instanceMatrix),K==="instanceColor"&&P.instanceColor&&(me=P.instanceColor)),me!==void 0){const ve=me.normalized,Q=me.itemSize,de=e.get(me);if(de===void 0)continue;const Te=de.buffer,Me=de.type,rt=de.bytesPerElement,xe=Me===i.INT||Me===i.UNSIGNED_INT||me.gpuType===gg;if(me.isInterleavedBufferAttribute){const fe=me.data,Fe=fe.stride,et=me.offset;if(fe.isInstancedInterleavedBuffer){for(let ht=0;ht<W.locationSize;ht++)S(W.location+ht,fe.meshPerAttribute);P.isInstancedMesh!==!0&&se._maxInstanceCount===void 0&&(se._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let ht=0;ht<W.locationSize;ht++)E(W.location+ht);i.bindBuffer(i.ARRAY_BUFFER,Te);for(let ht=0;ht<W.locationSize;ht++)D(W.location+ht,Q/W.locationSize,Me,ve,Fe*rt,(et+Q/W.locationSize*ht)*rt,xe)}else{if(me.isInstancedBufferAttribute){for(let fe=0;fe<W.locationSize;fe++)S(W.location+fe,me.meshPerAttribute);P.isInstancedMesh!==!0&&se._maxInstanceCount===void 0&&(se._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let fe=0;fe<W.locationSize;fe++)E(W.location+fe);i.bindBuffer(i.ARRAY_BUFFER,Te);for(let fe=0;fe<W.locationSize;fe++)D(W.location+fe,Q/W.locationSize,Me,ve,Q*rt,Q/W.locationSize*fe*rt,xe)}}else if(H!==void 0){const ve=H[K];if(ve!==void 0)switch(ve.length){case 2:i.vertexAttrib2fv(W.location,ve);break;case 3:i.vertexAttrib3fv(W.location,ve);break;case 4:i.vertexAttrib4fv(W.location,ve);break;default:i.vertexAttrib1fv(W.location,ve)}}}}w()}function F(){j();for(const P in n){const q=n[P];for(const ie in q){const se=q[ie];for(const ae in se)x(se[ae].object),delete se[ae];delete q[ie]}delete n[P]}}function N(P){if(n[P.id]===void 0)return;const q=n[P.id];for(const ie in q){const se=q[ie];for(const ae in se)x(se[ae].object),delete se[ae];delete q[ie]}delete n[P.id]}function z(P){for(const q in n){const ie=n[q];if(ie[P.id]===void 0)continue;const se=ie[P.id];for(const ae in se)x(se[ae].object),delete se[ae];delete ie[P.id]}}function j(){L(),l=!0,r!==a&&(r=a,p(r.object))}function L(){a.geometry=null,a.program=null,a.wireframe=!1}return{setup:u,reset:j,resetDefaultState:L,dispose:F,releaseStatesOfGeometry:N,releaseStatesOfProgram:z,initAttributes:C,enableAttribute:E,disableUnusedAttributes:w}}function R4(i,e,t){let n;function a(p){n=p}function r(p,x){i.drawArrays(n,p,x),t.update(x,n,1)}function l(p,x,g){g!==0&&(i.drawArraysInstanced(n,p,x,g),t.update(x,n,g))}function u(p,x,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,x,0,g);let y=0;for(let b=0;b<g;b++)y+=x[b];t.update(y,n,1)}function d(p,x,g,_){if(g===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let b=0;b<p.length;b++)l(p[b],x[b],_[b]);else{y.multiDrawArraysInstancedWEBGL(n,p,0,x,0,_,0,g);let b=0;for(let C=0;C<g;C++)b+=x[C]*_[C];t.update(b,n,1)}}this.setMode=a,this.render=r,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function w4(i,e,t,n){let a;function r(){if(a!==void 0)return a;if(e.has("EXT_texture_filter_anisotropic")===!0){const z=e.get("EXT_texture_filter_anisotropic");a=i.getParameter(z.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a}function l(z){return!(z!==_a&&n.convert(z)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function u(z){const j=z===wa&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(z!==ca&&n.convert(z)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&z!==ji&&!j)}function d(z){if(z==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";z="mediump"}return z==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const x=d(p);x!==p&&(Mt("WebGLRenderer:",p,"not supported, using",x,"instead."),p=x);const g=t.logarithmicDepthBuffer===!0,_=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),y=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),b=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),C=i.getParameter(i.MAX_TEXTURE_SIZE),E=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),S=i.getParameter(i.MAX_VERTEX_ATTRIBS),w=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),D=i.getParameter(i.MAX_VARYING_VECTORS),U=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),F=b>0,N=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:d,textureFormatReadable:l,textureTypeReadable:u,precision:p,logarithmicDepthBuffer:g,reversedDepthBuffer:_,maxTextures:y,maxVertexTextures:b,maxTextureSize:C,maxCubemapSize:E,maxAttributes:S,maxVertexUniforms:w,maxVaryings:D,maxFragmentUniforms:U,vertexTextures:F,maxSamples:N}}function B4(i){const e=this;let t=null,n=0,a=!1,r=!1;const l=new Ou,u=new vn,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(g,_){const y=g.length!==0||_||n!==0||a;return a=_,n=g.length,y},this.beginShadows=function(){r=!0,x(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(g,_){t=x(g,_,0)},this.setState=function(g,_,y){const b=g.clippingPlanes,C=g.clipIntersection,E=g.clipShadows,S=i.get(g);if(!a||b===null||b.length===0||r&&!E)r?x(null):p();else{const w=r?0:n,D=w*4;let U=S.clippingState||null;d.value=U,U=x(b,_,D,y);for(let F=0;F!==D;++F)U[F]=t[F];S.clippingState=U,this.numIntersection=C?this.numPlanes:0,this.numPlanes+=w}};function p(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function x(g,_,y,b){const C=g!==null?g.length:0;let E=null;if(C!==0){if(E=d.value,b!==!0||E===null){const S=y+C*4,w=_.matrixWorldInverse;u.getNormalMatrix(w),(E===null||E.length<S)&&(E=new Float32Array(S));for(let D=0,U=y;D!==C;++D,U+=4)l.copy(g[D]).applyMatrix4(w,u),l.normal.toArray(E,U),E[U+3]=l.constant}d.value=E,d.needsUpdate=!0}return e.numPlanes=C,e.numIntersection=0,E}}function D4(i){let e=new WeakMap;function t(l,u){return u===Ep?l.mapping=Fl:u===ig&&(l.mapping=Hu),l}function n(l){if(l&&l.isTexture){const u=l.mapping;if(u===Ep||u===ig)if(e.has(l)){const d=e.get(l).texture;return t(d,l.mapping)}else{const d=l.image;if(d&&d.height>0){const p=new oS(d.height);return p.fromEquirectangularTexture(i,l),e.set(l,p),l.addEventListener("dispose",a),t(p.texture,l.mapping)}else return null}}return l}function a(l){const u=l.target;u.removeEventListener("dispose",a);const d=e.get(u);d!==void 0&&(e.delete(u),d.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}const Iu=4,x3=[.125,.215,.35,.446,.526,.582],ch=20,U4=256,Bm=new Zu,_3=new ut;let E1=null,T1=0,C1=0,R1=!1;const O4=new te;class Bb{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,a=100,r={}){const{size:l=256,position:u=O4}=r;E1=this._renderer.getRenderTarget(),T1=this._renderer.getActiveCubeFace(),C1=this._renderer.getActiveMipmapLevel(),R1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(l);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,n,a,d,u),t>0&&this._blur(d,0,0,t),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=S3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=b3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(E1,T1,C1),this._renderer.xr.enabled=R1,e.scissorTest=!1,lp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Fl||e.mapping===Hu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),E1=this._renderer.getRenderTarget(),T1=this._renderer.getActiveCubeFace(),C1=this._renderer.getActiveMipmapLevel(),R1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:In,minFilter:In,generateMipmaps:!1,type:wa,format:_a,colorSpace:Fr,depthBuffer:!1},a=y3(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=y3(e,t,n);const{_lodMax:r}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=N4(r)),this._blurMaterial=I4(r,e,t),this._ggxMaterial=L4(r,e,t)}return a}_compileMaterial(e){const t=new Xi(new rn,e);this._renderer.compile(t,Bm)}_sceneToCubeUV(e,t,n,a,r){const d=new Ra(90,1,t,n),p=[1,-1,1,1,1,1],x=[1,1,1,-1,-1,-1],g=this._renderer,_=g.autoClear,y=g.toneMapping;g.getClearColor(_3),g.toneMapping=Jo,g.autoClear=!1,g.state.buffers.depth.getReversed()&&(g.setRenderTarget(a),g.clearDepth(),g.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Xi(new Uh,new $a({name:"PMREM.Background",side:oa,depthWrite:!1,depthTest:!1})));const C=this._backgroundBox,E=C.material;let S=!1;const w=e.background;w?w.isColor&&(E.color.copy(w),e.background=null,S=!0):(E.color.copy(_3),S=!0);for(let D=0;D<6;D++){const U=D%3;U===0?(d.up.set(0,p[D],0),d.position.set(r.x,r.y,r.z),d.lookAt(r.x+x[D],r.y,r.z)):U===1?(d.up.set(0,0,p[D]),d.position.set(r.x,r.y,r.z),d.lookAt(r.x,r.y+x[D],r.z)):(d.up.set(0,p[D],0),d.position.set(r.x,r.y,r.z),d.lookAt(r.x,r.y,r.z+x[D]));const F=this._cubeSize;lp(a,U*F,D>2?F:0,F,F),g.setRenderTarget(a),S&&g.render(C,d),g.render(e,d)}g.toneMapping=y,g.autoClear=_,e.background=w}_textureToCubeUV(e,t){const n=this._renderer,a=e.mapping===Fl||e.mapping===Hu;a?(this._cubemapMaterial===null&&(this._cubemapMaterial=S3()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=b3());const r=a?this._cubemapMaterial:this._equirectMaterial,l=this._lodMeshes[0];l.material=r;const u=r.uniforms;u.envMap.value=e;const d=this._cubeSize;lp(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(l,Bm)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const a=this._lodMeshes.length;for(let r=1;r<a;r++)this._applyGGXFilter(e,r-1,r);t.autoClear=n}_applyGGXFilter(e,t,n){const a=this._renderer,r=this._pingPongRenderTarget,l=this._ggxMaterial,u=this._lodMeshes[n];u.material=l;const d=l.uniforms,p=n/(this._lodMeshes.length-1),x=t/(this._lodMeshes.length-1),g=Math.sqrt(p*p-x*x),_=.05+p*.95,y=g*_,{_lodMax:b}=this,C=this._sizeLods[n],E=3*C*(n>b-Iu?n-b+Iu:0),S=4*(this._cubeSize-C);d.envMap.value=e.texture,d.roughness.value=y,d.mipInt.value=b-t,lp(r,E,S,3*C,2*C),a.setRenderTarget(r),a.render(u,Bm),d.envMap.value=r.texture,d.roughness.value=0,d.mipInt.value=b-n,lp(e,E,S,3*C,2*C),a.setRenderTarget(e),a.render(u,Bm)}_blur(e,t,n,a,r){const l=this._pingPongRenderTarget;this._halfBlur(e,l,t,n,a,"latitudinal",r),this._halfBlur(l,e,n,n,a,"longitudinal",r)}_halfBlur(e,t,n,a,r,l,u){const d=this._renderer,p=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&un("blur direction must be either latitudinal or longitudinal!");const x=3,g=this._lodMeshes[a];g.material=p;const _=p.uniforms,y=this._sizeLods[n]-1,b=isFinite(r)?Math.PI/(2*y):2*Math.PI/(2*ch-1),C=r/b,E=isFinite(r)?1+Math.floor(x*C):ch;E>ch&&Mt(`sigmaRadians, ${r}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${ch}`);const S=[];let w=0;for(let z=0;z<ch;++z){const j=z/C,L=Math.exp(-j*j/2);S.push(L),z===0?w+=L:z<E&&(w+=2*L)}for(let z=0;z<S.length;z++)S[z]=S[z]/w;_.envMap.value=e.texture,_.samples.value=E,_.weights.value=S,_.latitudinal.value=l==="latitudinal",u&&(_.poleAxis.value=u);const{_lodMax:D}=this;_.dTheta.value=b,_.mipInt.value=D-n;const U=this._sizeLods[a],F=3*U*(a>D-Iu?a-D+Iu:0),N=4*(this._cubeSize-U);lp(t,F,N,3*U,2*U),d.setRenderTarget(t),d.render(g,Bm)}}function N4(i){const e=[],t=[],n=[];let a=i;const r=i-Iu+1+x3.length;for(let l=0;l<r;l++){const u=Math.pow(2,a);e.push(u);let d=1/u;l>i-Iu?d=x3[l-i+Iu-1]:l===0&&(d=0),t.push(d);const p=1/(u-2),x=-p,g=1+p,_=[x,x,g,x,g,g,x,x,g,g,x,g],y=6,b=6,C=3,E=2,S=1,w=new Float32Array(C*b*y),D=new Float32Array(E*b*y),U=new Float32Array(S*b*y);for(let N=0;N<y;N++){const z=N%3*2/3-1,j=N>2?0:-1,L=[z,j,0,z+2/3,j,0,z+2/3,j+1,0,z,j,0,z+2/3,j+1,0,z,j+1,0];w.set(L,C*b*N),D.set(_,E*b*N);const P=[N,N,N,N,N,N];U.set(P,S*b*N)}const F=new rn;F.setAttribute("position",new Mn(w,C)),F.setAttribute("uv",new Mn(D,E)),F.setAttribute("faceIndex",new Mn(U,S)),n.push(new Xi(F,null)),a>Iu&&a--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function y3(i,e,t){const n=new ua(i,e,t);return n.texture.mapping=zp,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function lp(i,e,t,n,a){i.viewport.set(e,t,n,a),i.scissor.set(e,t,n,a)}function L4(i,e,t){return new hi({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:U4,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:Yy(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:es,depthTest:!1,depthWrite:!1})}function I4(i,e,t){const n=new Float32Array(ch),a=new te(0,1,0);return new hi({name:"SphericalGaussianBlur",defines:{n:ch,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:Yy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:es,depthTest:!1,depthWrite:!1})}function b3(){return new hi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Yy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:es,depthTest:!1,depthWrite:!1})}function S3(){return new hi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Yy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:es,depthTest:!1,depthWrite:!1})}function Yy(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function P4(i){let e=new WeakMap,t=null;function n(u){if(u&&u.isTexture){const d=u.mapping,p=d===Ep||d===ig,x=d===Fl||d===Hu;if(p||x){let g=e.get(u);const _=g!==void 0?g.texture.pmremVersion:0;if(u.isRenderTargetTexture&&u.pmremVersion!==_)return t===null&&(t=new Bb(i)),g=p?t.fromEquirectangular(u,g):t.fromCubemap(u,g),g.texture.pmremVersion=u.pmremVersion,e.set(u,g),g.texture;if(g!==void 0)return g.texture;{const y=u.image;return p&&y&&y.height>0||x&&y&&a(y)?(t===null&&(t=new Bb(i)),g=p?t.fromEquirectangular(u):t.fromCubemap(u),g.texture.pmremVersion=u.pmremVersion,e.set(u,g),u.addEventListener("dispose",r),g.texture):null}}}return u}function a(u){let d=0;const p=6;for(let x=0;x<p;x++)u[x]!==void 0&&d++;return d===p}function r(u){const d=u.target;d.removeEventListener("dispose",r);const p=e.get(d);p!==void 0&&(e.delete(d),p.dispose())}function l(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:l}}function F4(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const a=i.getExtension(n);return e[n]=a,a}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const a=t(n);return a===null&&Up("WebGLRenderer: "+n+" extension not supported."),a}}}function z4(i,e,t,n){const a={},r=new WeakMap;function l(g){const _=g.target;_.index!==null&&e.remove(_.index);for(const b in _.attributes)e.remove(_.attributes[b]);_.removeEventListener("dispose",l),delete a[_.id];const y=r.get(_);y&&(e.remove(y),r.delete(_)),n.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function u(g,_){return a[_.id]===!0||(_.addEventListener("dispose",l),a[_.id]=!0,t.memory.geometries++),_}function d(g){const _=g.attributes;for(const y in _)e.update(_[y],i.ARRAY_BUFFER)}function p(g){const _=[],y=g.index,b=g.attributes.position;let C=0;if(y!==null){const w=y.array;C=y.version;for(let D=0,U=w.length;D<U;D+=3){const F=w[D+0],N=w[D+1],z=w[D+2];_.push(F,N,N,z,z,F)}}else if(b!==void 0){const w=b.array;C=b.version;for(let D=0,U=w.length/3-1;D<U;D+=3){const F=D+0,N=D+1,z=D+2;_.push(F,N,N,z,z,F)}}else return;const E=new(VT(_)?rS:sS)(_,1);E.version=C;const S=r.get(g);S&&e.remove(S),r.set(g,E)}function x(g){const _=r.get(g);if(_){const y=g.index;y!==null&&_.version<y.version&&p(g)}else p(g);return r.get(g)}return{get:u,update:d,getWireframeAttribute:x}}function H4(i,e,t){let n;function a(_){n=_}let r,l;function u(_){r=_.type,l=_.bytesPerElement}function d(_,y){i.drawElements(n,y,r,_*l),t.update(y,n,1)}function p(_,y,b){b!==0&&(i.drawElementsInstanced(n,y,r,_*l,b),t.update(y,n,b))}function x(_,y,b){if(b===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,y,0,r,_,0,b);let E=0;for(let S=0;S<b;S++)E+=y[S];t.update(E,n,1)}function g(_,y,b,C){if(b===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let S=0;S<_.length;S++)p(_[S]/l,y[S],C[S]);else{E.multiDrawElementsInstancedWEBGL(n,y,0,r,_,0,C,0,b);let S=0;for(let w=0;w<b;w++)S+=y[w]*C[w];t.update(S,n,1)}}this.setMode=a,this.setIndex=u,this.render=d,this.renderInstances=p,this.renderMultiDraw=x,this.renderMultiDrawInstances=g}function G4(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,l,u){switch(t.calls++,l){case i.TRIANGLES:t.triangles+=u*(r/3);break;case i.LINES:t.lines+=u*(r/2);break;case i.LINE_STRIP:t.lines+=u*(r-1);break;case i.LINE_LOOP:t.lines+=u*r;break;case i.POINTS:t.points+=u*r;break;default:un("WebGLInfo: Unknown draw mode:",l);break}}function a(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:a,update:n}}function V4(i,e,t){const n=new WeakMap,a=new kn;function r(l,u,d){const p=l.morphTargetInfluences,x=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,g=x!==void 0?x.length:0;let _=n.get(u);if(_===void 0||_.count!==g){let P=function(){j.dispose(),n.delete(u),u.removeEventListener("dispose",P)};var y=P;_!==void 0&&_.texture.dispose();const b=u.morphAttributes.position!==void 0,C=u.morphAttributes.normal!==void 0,E=u.morphAttributes.color!==void 0,S=u.morphAttributes.position||[],w=u.morphAttributes.normal||[],D=u.morphAttributes.color||[];let U=0;b===!0&&(U=1),C===!0&&(U=2),E===!0&&(U=3);let F=u.attributes.position.count*U,N=1;F>e.maxTextureSize&&(N=Math.ceil(F/e.maxTextureSize),F=e.maxTextureSize);const z=new Float32Array(F*N*4*g),j=new Sy(z,F,N,g);j.type=ji,j.needsUpdate=!0;const L=U*4;for(let q=0;q<g;q++){const ie=S[q],se=w[q],ae=D[q],re=F*N*4*q;for(let H=0;H<ie.count;H++){const K=H*L;b===!0&&(a.fromBufferAttribute(ie,H),z[re+K+0]=a.x,z[re+K+1]=a.y,z[re+K+2]=a.z,z[re+K+3]=0),C===!0&&(a.fromBufferAttribute(se,H),z[re+K+4]=a.x,z[re+K+5]=a.y,z[re+K+6]=a.z,z[re+K+7]=0),E===!0&&(a.fromBufferAttribute(ae,H),z[re+K+8]=a.x,z[re+K+9]=a.y,z[re+K+10]=a.z,z[re+K+11]=ae.itemSize===4?a.w:1)}}_={count:g,texture:j,size:new Ge(F,N)},n.set(u,_),u.addEventListener("dispose",P)}if(l.isInstancedMesh===!0&&l.morphTexture!==null)d.getUniforms().setValue(i,"morphTexture",l.morphTexture,t);else{let b=0;for(let E=0;E<p.length;E++)b+=p[E];const C=u.morphTargetsRelative?1:1-b;d.getUniforms().setValue(i,"morphTargetBaseInfluence",C),d.getUniforms().setValue(i,"morphTargetInfluences",p)}d.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}return{update:r}}function k4(i,e,t,n){let a=new WeakMap;function r(d){const p=n.render.frame,x=d.geometry,g=e.get(d,x);if(a.get(g)!==p&&(e.update(g),a.set(g,p)),d.isInstancedMesh&&(d.hasEventListener("dispose",u)===!1&&d.addEventListener("dispose",u),a.get(d)!==p&&(t.update(d.instanceMatrix,i.ARRAY_BUFFER),d.instanceColor!==null&&t.update(d.instanceColor,i.ARRAY_BUFFER),a.set(d,p))),d.isSkinnedMesh){const _=d.skeleton;a.get(_)!==p&&(_.update(),a.set(_,p))}return g}function l(){a=new WeakMap}function u(d){const p=d.target;p.removeEventListener("dispose",u),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:r,dispose:l}}const VC=new ui,A3=new By(1,1),kC=new Sy,jC=new Ay,XC=new _g,M3=[],E3=[],T3=new Float32Array(16),C3=new Float32Array(9),R3=new Float32Array(4);function jp(i,e,t){const n=i[0];if(n<=0||n>0)return i;const a=e*t;let r=M3[a];if(r===void 0&&(r=new Float32Array(a),M3[a]=r),e!==0){n.toArray(r,0);for(let l=1,u=0;l!==e;++l)u+=t,i[l].toArray(r,u)}return r}function Ha(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Ga(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function qy(i,e){let t=E3[e];t===void 0&&(t=new Int32Array(e),E3[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function j4(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function X4(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ha(t,e))return;i.uniform2fv(this.addr,e),Ga(t,e)}}function Y4(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ha(t,e))return;i.uniform3fv(this.addr,e),Ga(t,e)}}function q4(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ha(t,e))return;i.uniform4fv(this.addr,e),Ga(t,e)}}function K4(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ha(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Ga(t,e)}else{if(Ha(t,n))return;R3.set(n),i.uniformMatrix2fv(this.addr,!1,R3),Ga(t,n)}}function J4(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ha(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Ga(t,e)}else{if(Ha(t,n))return;C3.set(n),i.uniformMatrix3fv(this.addr,!1,C3),Ga(t,n)}}function W4(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ha(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Ga(t,e)}else{if(Ha(t,n))return;T3.set(n),i.uniformMatrix4fv(this.addr,!1,T3),Ga(t,n)}}function Z4(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function Q4(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ha(t,e))return;i.uniform2iv(this.addr,e),Ga(t,e)}}function $4(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ha(t,e))return;i.uniform3iv(this.addr,e),Ga(t,e)}}function eI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ha(t,e))return;i.uniform4iv(this.addr,e),Ga(t,e)}}function tI(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function nI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ha(t,e))return;i.uniform2uiv(this.addr,e),Ga(t,e)}}function iI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ha(t,e))return;i.uniform3uiv(this.addr,e),Ga(t,e)}}function aI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ha(t,e))return;i.uniform4uiv(this.addr,e),Ga(t,e)}}function sI(i,e,t){const n=this.cache,a=t.allocateTextureUnit();n[0]!==a&&(i.uniform1i(this.addr,a),n[0]=a);let r;this.type===i.SAMPLER_2D_SHADOW?(A3.compareFunction=tS,r=A3):r=VC,t.setTexture2D(e||r,a)}function rI(i,e,t){const n=this.cache,a=t.allocateTextureUnit();n[0]!==a&&(i.uniform1i(this.addr,a),n[0]=a),t.setTexture3D(e||jC,a)}function oI(i,e,t){const n=this.cache,a=t.allocateTextureUnit();n[0]!==a&&(i.uniform1i(this.addr,a),n[0]=a),t.setTextureCube(e||XC,a)}function lI(i,e,t){const n=this.cache,a=t.allocateTextureUnit();n[0]!==a&&(i.uniform1i(this.addr,a),n[0]=a),t.setTexture2DArray(e||kC,a)}function cI(i){switch(i){case 5126:return j4;case 35664:return X4;case 35665:return Y4;case 35666:return q4;case 35674:return K4;case 35675:return J4;case 35676:return W4;case 5124:case 35670:return Z4;case 35667:case 35671:return Q4;case 35668:case 35672:return $4;case 35669:case 35673:return eI;case 5125:return tI;case 36294:return nI;case 36295:return iI;case 36296:return aI;case 35678:case 36198:case 36298:case 36306:case 35682:return sI;case 35679:case 36299:case 36307:return rI;case 35680:case 36300:case 36308:case 36293:return oI;case 36289:case 36303:case 36311:case 36292:return lI}}function uI(i,e){i.uniform1fv(this.addr,e)}function fI(i,e){const t=jp(e,this.size,2);i.uniform2fv(this.addr,t)}function hI(i,e){const t=jp(e,this.size,3);i.uniform3fv(this.addr,t)}function dI(i,e){const t=jp(e,this.size,4);i.uniform4fv(this.addr,t)}function pI(i,e){const t=jp(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function mI(i,e){const t=jp(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function gI(i,e){const t=jp(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function vI(i,e){i.uniform1iv(this.addr,e)}function xI(i,e){i.uniform2iv(this.addr,e)}function _I(i,e){i.uniform3iv(this.addr,e)}function yI(i,e){i.uniform4iv(this.addr,e)}function bI(i,e){i.uniform1uiv(this.addr,e)}function SI(i,e){i.uniform2uiv(this.addr,e)}function AI(i,e){i.uniform3uiv(this.addr,e)}function MI(i,e){i.uniform4uiv(this.addr,e)}function EI(i,e,t){const n=this.cache,a=e.length,r=qy(t,a);Ha(n,r)||(i.uniform1iv(this.addr,r),Ga(n,r));for(let l=0;l!==a;++l)t.setTexture2D(e[l]||VC,r[l])}function TI(i,e,t){const n=this.cache,a=e.length,r=qy(t,a);Ha(n,r)||(i.uniform1iv(this.addr,r),Ga(n,r));for(let l=0;l!==a;++l)t.setTexture3D(e[l]||jC,r[l])}function CI(i,e,t){const n=this.cache,a=e.length,r=qy(t,a);Ha(n,r)||(i.uniform1iv(this.addr,r),Ga(n,r));for(let l=0;l!==a;++l)t.setTextureCube(e[l]||XC,r[l])}function RI(i,e,t){const n=this.cache,a=e.length,r=qy(t,a);Ha(n,r)||(i.uniform1iv(this.addr,r),Ga(n,r));for(let l=0;l!==a;++l)t.setTexture2DArray(e[l]||kC,r[l])}function wI(i){switch(i){case 5126:return uI;case 35664:return fI;case 35665:return hI;case 35666:return dI;case 35674:return pI;case 35675:return mI;case 35676:return gI;case 5124:case 35670:return vI;case 35667:case 35671:return xI;case 35668:case 35672:return _I;case 35669:case 35673:return yI;case 5125:return bI;case 36294:return SI;case 36295:return AI;case 36296:return MI;case 35678:case 36198:case 36298:case 36306:case 35682:return EI;case 35679:case 36299:case 36307:return TI;case 35680:case 36300:case 36308:case 36293:return CI;case 36289:case 36303:case 36311:case 36292:return RI}}class BI{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=cI(t.type)}}class DI{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=wI(t.type)}}class UI{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const a=this.seq;for(let r=0,l=a.length;r!==l;++r){const u=a[r];u.setValue(e,t[u.id],n)}}}const w1=/(\w+)(\])?(\[|\.)?/g;function w3(i,e){i.seq.push(e),i.map[e.id]=e}function OI(i,e,t){const n=i.name,a=n.length;for(w1.lastIndex=0;;){const r=w1.exec(n),l=w1.lastIndex;let u=r[1];const d=r[2]==="]",p=r[3];if(d&&(u=u|0),p===void 0||p==="["&&l+2===a){w3(t,p===void 0?new BI(u,i,e):new DI(u,i,e));break}else{let g=t.map[u];g===void 0&&(g=new UI(u),w3(t,g)),t=g}}}class f_{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<n;++a){const r=e.getActiveUniform(t,a),l=e.getUniformLocation(t,r.name);OI(r,l,this)}}setValue(e,t,n,a){const r=this.map[t];r!==void 0&&r.setValue(e,n,a)}setOptional(e,t,n){const a=t[n];a!==void 0&&this.setValue(e,n,a)}static upload(e,t,n,a){for(let r=0,l=t.length;r!==l;++r){const u=t[r],d=n[u.id];d.needsUpdate!==!1&&u.setValue(e,d.value,a)}}static seqWithValue(e,t){const n=[];for(let a=0,r=e.length;a!==r;++a){const l=e[a];l.id in t&&n.push(l)}return n}}function B3(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const NI=37297;let LI=0;function II(i,e){const t=i.split(`
`),n=[],a=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let l=a;l<r;l++){const u=l+1;n.push(`${u===e?">":" "} ${u}: ${t[l]}`)}return n.join(`
`)}const D3=new vn;function PI(i){Wn._getMatrix(D3,Wn.workingColorSpace,i);const e=`mat3( ${D3.elements.map(t=>t.toFixed(4))} )`;switch(Wn.getTransfer(i)){case sg:return[e,"LinearTransferOETF"];case xi:return[e,"sRGBTransferOETF"];default:return Mt("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function U3(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),r=(i.getShaderInfoLog(e)||"").trim();if(n&&r==="")return"";const l=/ERROR: 0:(\d+)/.exec(r);if(l){const u=parseInt(l[1]);return t.toUpperCase()+`

`+r+`

`+II(i.getShaderSource(e),u)}else return r}function FI(i,e){const t=PI(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function zI(i,e){let t;switch(e){case MT:t="Linear";break;case ET:t="Reinhard";break;case TT:t="Cineon";break;case Yb:t="ACESFilmic";break;case RT:t="AgX";break;case wT:t="Neutral";break;case CT:t="Custom";break;default:Mt("WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const jx=new te;function HI(){Wn.getLuminanceCoefficients(jx);const i=jx.x.toFixed(4),e=jx.y.toFixed(4),t=jx.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function GI(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(km).join(`
`)}function VI(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function kI(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let a=0;a<n;a++){const r=i.getActiveAttrib(e,a),l=r.name;let u=1;r.type===i.FLOAT_MAT2&&(u=2),r.type===i.FLOAT_MAT3&&(u=3),r.type===i.FLOAT_MAT4&&(u=4),t[l]={type:r.type,location:i.getAttribLocation(e,l),locationSize:u}}return t}function km(i){return i!==""}function O3(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function N3(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const jI=/^[ \t]*#include +<([\w\d./]+)>/gm;function Db(i){return i.replace(jI,YI)}const XI=new Map;function YI(i,e){let t=An[e];if(t===void 0){const n=XI.get(e);if(n!==void 0)t=An[n],Mt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Db(t)}const qI=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function L3(i){return i.replace(qI,KI)}function KI(i,e,t,n){let a="";for(let r=parseInt(e);r<parseInt(t);r++)a+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return a}function I3(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function JI(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===hy?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===jm?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===jo&&(e="SHADOWMAP_TYPE_VSM"),e}function WI(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Fl:case Hu:e="ENVMAP_TYPE_CUBE";break;case zp:e="ENVMAP_TYPE_CUBE_UV";break}return e}function ZI(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case Hu:e="ENVMAP_MODE_REFRACTION";break}return e}function QI(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case mg:e="ENVMAP_BLENDING_MULTIPLY";break;case ST:e="ENVMAP_BLENDING_MIX";break;case AT:e="ENVMAP_BLENDING_ADD";break}return e}function $I(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function e5(i,e,t,n){const a=i.getContext(),r=t.defines;let l=t.vertexShader,u=t.fragmentShader;const d=JI(t),p=WI(t),x=ZI(t),g=QI(t),_=$I(t),y=GI(t),b=VI(r),C=a.createProgram();let E,S,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(km).join(`
`),E.length>0&&(E+=`
`),S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(km).join(`
`),S.length>0&&(S+=`
`)):(E=[I3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+x:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(km).join(`
`),S=[I3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+x:"",t.envMap?"#define "+g:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Jo?"#define TONE_MAPPING":"",t.toneMapping!==Jo?An.tonemapping_pars_fragment:"",t.toneMapping!==Jo?zI("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",An.colorspace_pars_fragment,FI("linearToOutputTexel",t.outputColorSpace),HI(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(km).join(`
`)),l=Db(l),l=O3(l,t),l=N3(l,t),u=Db(u),u=O3(u,t),u=N3(u,t),l=L3(l),u=L3(u),t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,E=[y,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,S=["#define varying in",t.glslVersion===Ab?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Ab?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const D=w+E+l,U=w+S+u,F=B3(a,a.VERTEX_SHADER,D),N=B3(a,a.FRAGMENT_SHADER,U);a.attachShader(C,F),a.attachShader(C,N),t.index0AttributeName!==void 0?a.bindAttribLocation(C,0,t.index0AttributeName):t.morphTargets===!0&&a.bindAttribLocation(C,0,"position"),a.linkProgram(C);function z(q){if(i.debug.checkShaderErrors){const ie=a.getProgramInfoLog(C)||"",se=a.getShaderInfoLog(F)||"",ae=a.getShaderInfoLog(N)||"",re=ie.trim(),H=se.trim(),K=ae.trim();let W=!0,me=!0;if(a.getProgramParameter(C,a.LINK_STATUS)===!1)if(W=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(a,C,F,N);else{const ve=U3(a,F,"vertex"),Q=U3(a,N,"fragment");un("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(C,a.VALIDATE_STATUS)+`

Material Name: `+q.name+`
Material Type: `+q.type+`

Program Info Log: `+re+`
`+ve+`
`+Q)}else re!==""?Mt("WebGLProgram: Program Info Log:",re):(H===""||K==="")&&(me=!1);me&&(q.diagnostics={runnable:W,programLog:re,vertexShader:{log:H,prefix:E},fragmentShader:{log:K,prefix:S}})}a.deleteShader(F),a.deleteShader(N),j=new f_(a,C),L=kI(a,C)}let j;this.getUniforms=function(){return j===void 0&&z(this),j};let L;this.getAttributes=function(){return L===void 0&&z(this),L};let P=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return P===!1&&(P=a.getProgramParameter(C,NI)),P},this.destroy=function(){n.releaseStatesOfProgram(this),a.deleteProgram(C),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=LI++,this.cacheKey=e,this.usedTimes=1,this.program=C,this.vertexShader=F,this.fragmentShader=N,this}let t5=0;class n5{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,a=this._getShaderStage(t),r=this._getShaderStage(n),l=this._getShaderCacheForMaterial(e);return l.has(a)===!1&&(l.add(a),a.usedTimes++),l.has(r)===!1&&(l.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new i5(e),t.set(e,n)),n}}class i5{constructor(e){this.id=t5++,this.code=e,this.usedTimes=0}}function a5(i,e,t,n,a,r,l){const u=new Np,d=new n5,p=new Set,x=[],g=a.logarithmicDepthBuffer,_=a.vertexTextures;let y=a.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function C(L){return p.add(L),L===0?"uv":`uv${L}`}function E(L,P,q,ie,se){const ae=ie.fog,re=se.geometry,H=L.isMeshStandardMaterial?ie.environment:null,K=(L.isMeshStandardMaterial?t:e).get(L.envMap||H),W=K&&K.mapping===zp?K.image.height:null,me=b[L.type];L.precision!==null&&(y=a.getMaxPrecision(L.precision),y!==L.precision&&Mt("WebGLProgram.getParameters:",L.precision,"not supported, using",y,"instead."));const ve=re.morphAttributes.position||re.morphAttributes.normal||re.morphAttributes.color,Q=ve!==void 0?ve.length:0;let de=0;re.morphAttributes.position!==void 0&&(de=1),re.morphAttributes.normal!==void 0&&(de=2),re.morphAttributes.color!==void 0&&(de=3);let Te,Me,rt,xe;if(me){const Cn=Yo[me];Te=Cn.vertexShader,Me=Cn.fragmentShader}else Te=L.vertexShader,Me=L.fragmentShader,d.update(L),rt=d.getVertexShaderID(L),xe=d.getFragmentShaderID(L);const fe=i.getRenderTarget(),Fe=i.state.buffers.depth.getReversed(),et=se.isInstancedMesh===!0,ht=se.isBatchedMesh===!0,yt=!!L.map,Xt=!!L.matcap,Ot=!!K,ke=!!L.aoMap,$=!!L.lightMap,Qe=!!L.bumpMap,st=!!L.normalMap,pt=!!L.displacementMap,it=!!L.emissiveMap,bt=!!L.metalnessMap,mt=!!L.roughnessMap,Ct=L.anisotropy>0,ee=L.clearcoat>0,X=L.dispersion>0,Ae=L.iridescence>0,He=L.sheen>0,Ze=L.transmission>0,Le=Ct&&!!L.anisotropyMap,Nt=ee&&!!L.clearcoatMap,xt=ee&&!!L.clearcoatNormalMap,Vt=ee&&!!L.clearcoatRoughnessMap,Lt=Ae&&!!L.iridescenceMap,Ye=Ae&&!!L.iridescenceThicknessMap,qe=He&&!!L.sheenColorMap,It=He&&!!L.sheenRoughnessMap,Et=!!L.specularMap,gt=!!L.specularColorMap,Dt=!!L.specularIntensityMap,pe=Ze&&!!L.transmissionMap,Ue=Ze&&!!L.thicknessMap,ft=!!L.gradientMap,vt=!!L.alphaMap,tt=L.alphaTest>0,Je=!!L.alphaHash,Bt=!!L.extensions;let Qt=Jo;L.toneMapped&&(fe===null||fe.isXRRenderTarget===!0)&&(Qt=i.toneMapping);const Fn={shaderID:me,shaderType:L.type,shaderName:L.name,vertexShader:Te,fragmentShader:Me,defines:L.defines,customVertexShaderID:rt,customFragmentShaderID:xe,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:y,batching:ht,batchingColor:ht&&se._colorsTexture!==null,instancing:et,instancingColor:et&&se.instanceColor!==null,instancingMorph:et&&se.morphTexture!==null,supportsVertexTextures:_,outputColorSpace:fe===null?i.outputColorSpace:fe.isXRRenderTarget===!0?fe.texture.colorSpace:Fr,alphaToCoverage:!!L.alphaToCoverage,map:yt,matcap:Xt,envMap:Ot,envMapMode:Ot&&K.mapping,envMapCubeUVHeight:W,aoMap:ke,lightMap:$,bumpMap:Qe,normalMap:st,displacementMap:_&&pt,emissiveMap:it,normalMapObjectSpace:st&&L.normalMapType===NT,normalMapTangentSpace:st&&L.normalMapType===qu,metalnessMap:bt,roughnessMap:mt,anisotropy:Ct,anisotropyMap:Le,clearcoat:ee,clearcoatMap:Nt,clearcoatNormalMap:xt,clearcoatRoughnessMap:Vt,dispersion:X,iridescence:Ae,iridescenceMap:Lt,iridescenceThicknessMap:Ye,sheen:He,sheenColorMap:qe,sheenRoughnessMap:It,specularMap:Et,specularColorMap:gt,specularIntensityMap:Dt,transmission:Ze,transmissionMap:pe,thicknessMap:Ue,gradientMap:ft,opaque:L.transparent===!1&&L.blending===vh&&L.alphaToCoverage===!1,alphaMap:vt,alphaTest:tt,alphaHash:Je,combine:L.combine,mapUv:yt&&C(L.map.channel),aoMapUv:ke&&C(L.aoMap.channel),lightMapUv:$&&C(L.lightMap.channel),bumpMapUv:Qe&&C(L.bumpMap.channel),normalMapUv:st&&C(L.normalMap.channel),displacementMapUv:pt&&C(L.displacementMap.channel),emissiveMapUv:it&&C(L.emissiveMap.channel),metalnessMapUv:bt&&C(L.metalnessMap.channel),roughnessMapUv:mt&&C(L.roughnessMap.channel),anisotropyMapUv:Le&&C(L.anisotropyMap.channel),clearcoatMapUv:Nt&&C(L.clearcoatMap.channel),clearcoatNormalMapUv:xt&&C(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Vt&&C(L.clearcoatRoughnessMap.channel),iridescenceMapUv:Lt&&C(L.iridescenceMap.channel),iridescenceThicknessMapUv:Ye&&C(L.iridescenceThicknessMap.channel),sheenColorMapUv:qe&&C(L.sheenColorMap.channel),sheenRoughnessMapUv:It&&C(L.sheenRoughnessMap.channel),specularMapUv:Et&&C(L.specularMap.channel),specularColorMapUv:gt&&C(L.specularColorMap.channel),specularIntensityMapUv:Dt&&C(L.specularIntensityMap.channel),transmissionMapUv:pe&&C(L.transmissionMap.channel),thicknessMapUv:Ue&&C(L.thicknessMap.channel),alphaMapUv:vt&&C(L.alphaMap.channel),vertexTangents:!!re.attributes.tangent&&(st||Ct),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!re.attributes.color&&re.attributes.color.itemSize===4,pointsUvs:se.isPoints===!0&&!!re.attributes.uv&&(yt||vt),fog:!!ae,useFog:L.fog===!0,fogExp2:!!ae&&ae.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:g,reversedDepthBuffer:Fe,skinning:se.isSkinnedMesh===!0,morphTargets:re.morphAttributes.position!==void 0,morphNormals:re.morphAttributes.normal!==void 0,morphColors:re.morphAttributes.color!==void 0,morphTargetsCount:Q,morphTextureStride:de,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:L.dithering,shadowMapEnabled:i.shadowMap.enabled&&q.length>0,shadowMapType:i.shadowMap.type,toneMapping:Qt,decodeVideoTexture:yt&&L.map.isVideoTexture===!0&&Wn.getTransfer(L.map.colorSpace)===xi,decodeVideoTextureEmissive:it&&L.emissiveMap.isVideoTexture===!0&&Wn.getTransfer(L.emissiveMap.colorSpace)===xi,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===Oi,flipSided:L.side===oa,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:Bt&&L.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Bt&&L.extensions.multiDraw===!0||ht)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return Fn.vertexUv1s=p.has(1),Fn.vertexUv2s=p.has(2),Fn.vertexUv3s=p.has(3),p.clear(),Fn}function S(L){const P=[];if(L.shaderID?P.push(L.shaderID):(P.push(L.customVertexShaderID),P.push(L.customFragmentShaderID)),L.defines!==void 0)for(const q in L.defines)P.push(q),P.push(L.defines[q]);return L.isRawShaderMaterial===!1&&(w(P,L),D(P,L),P.push(i.outputColorSpace)),P.push(L.customProgramCacheKey),P.join()}function w(L,P){L.push(P.precision),L.push(P.outputColorSpace),L.push(P.envMapMode),L.push(P.envMapCubeUVHeight),L.push(P.mapUv),L.push(P.alphaMapUv),L.push(P.lightMapUv),L.push(P.aoMapUv),L.push(P.bumpMapUv),L.push(P.normalMapUv),L.push(P.displacementMapUv),L.push(P.emissiveMapUv),L.push(P.metalnessMapUv),L.push(P.roughnessMapUv),L.push(P.anisotropyMapUv),L.push(P.clearcoatMapUv),L.push(P.clearcoatNormalMapUv),L.push(P.clearcoatRoughnessMapUv),L.push(P.iridescenceMapUv),L.push(P.iridescenceThicknessMapUv),L.push(P.sheenColorMapUv),L.push(P.sheenRoughnessMapUv),L.push(P.specularMapUv),L.push(P.specularColorMapUv),L.push(P.specularIntensityMapUv),L.push(P.transmissionMapUv),L.push(P.thicknessMapUv),L.push(P.combine),L.push(P.fogExp2),L.push(P.sizeAttenuation),L.push(P.morphTargetsCount),L.push(P.morphAttributeCount),L.push(P.numDirLights),L.push(P.numPointLights),L.push(P.numSpotLights),L.push(P.numSpotLightMaps),L.push(P.numHemiLights),L.push(P.numRectAreaLights),L.push(P.numDirLightShadows),L.push(P.numPointLightShadows),L.push(P.numSpotLightShadows),L.push(P.numSpotLightShadowsWithMaps),L.push(P.numLightProbes),L.push(P.shadowMapType),L.push(P.toneMapping),L.push(P.numClippingPlanes),L.push(P.numClipIntersection),L.push(P.depthPacking)}function D(L,P){u.disableAll(),P.supportsVertexTextures&&u.enable(0),P.instancing&&u.enable(1),P.instancingColor&&u.enable(2),P.instancingMorph&&u.enable(3),P.matcap&&u.enable(4),P.envMap&&u.enable(5),P.normalMapObjectSpace&&u.enable(6),P.normalMapTangentSpace&&u.enable(7),P.clearcoat&&u.enable(8),P.iridescence&&u.enable(9),P.alphaTest&&u.enable(10),P.vertexColors&&u.enable(11),P.vertexAlphas&&u.enable(12),P.vertexUv1s&&u.enable(13),P.vertexUv2s&&u.enable(14),P.vertexUv3s&&u.enable(15),P.vertexTangents&&u.enable(16),P.anisotropy&&u.enable(17),P.alphaHash&&u.enable(18),P.batching&&u.enable(19),P.dispersion&&u.enable(20),P.batchingColor&&u.enable(21),P.gradientMap&&u.enable(22),L.push(u.mask),u.disableAll(),P.fog&&u.enable(0),P.useFog&&u.enable(1),P.flatShading&&u.enable(2),P.logarithmicDepthBuffer&&u.enable(3),P.reversedDepthBuffer&&u.enable(4),P.skinning&&u.enable(5),P.morphTargets&&u.enable(6),P.morphNormals&&u.enable(7),P.morphColors&&u.enable(8),P.premultipliedAlpha&&u.enable(9),P.shadowMapEnabled&&u.enable(10),P.doubleSided&&u.enable(11),P.flipSided&&u.enable(12),P.useDepthPacking&&u.enable(13),P.dithering&&u.enable(14),P.transmission&&u.enable(15),P.sheen&&u.enable(16),P.opaque&&u.enable(17),P.pointsUvs&&u.enable(18),P.decodeVideoTexture&&u.enable(19),P.decodeVideoTextureEmissive&&u.enable(20),P.alphaToCoverage&&u.enable(21),L.push(u.mask)}function U(L){const P=b[L.type];let q;if(P){const ie=Yo[P];q=qT.clone(ie.uniforms)}else q=L.uniforms;return q}function F(L,P){let q;for(let ie=0,se=x.length;ie<se;ie++){const ae=x[ie];if(ae.cacheKey===P){q=ae,++q.usedTimes;break}}return q===void 0&&(q=new e5(i,P,L,r),x.push(q)),q}function N(L){if(--L.usedTimes===0){const P=x.indexOf(L);x[P]=x[x.length-1],x.pop(),L.destroy()}}function z(L){d.remove(L)}function j(){d.dispose()}return{getParameters:E,getProgramCacheKey:S,getUniforms:U,acquireProgram:F,releaseProgram:N,releaseShaderCache:z,programs:x,dispose:j}}function s5(){let i=new WeakMap;function e(l){return i.has(l)}function t(l){let u=i.get(l);return u===void 0&&(u={},i.set(l,u)),u}function n(l){i.delete(l)}function a(l,u,d){i.get(l)[u]=d}function r(){i=new WeakMap}return{has:e,get:t,remove:n,update:a,dispose:r}}function r5(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function P3(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function F3(){const i=[];let e=0;const t=[],n=[],a=[];function r(){e=0,t.length=0,n.length=0,a.length=0}function l(g,_,y,b,C,E){let S=i[e];return S===void 0?(S={id:g.id,object:g,geometry:_,material:y,groupOrder:b,renderOrder:g.renderOrder,z:C,group:E},i[e]=S):(S.id=g.id,S.object=g,S.geometry=_,S.material=y,S.groupOrder=b,S.renderOrder=g.renderOrder,S.z=C,S.group=E),e++,S}function u(g,_,y,b,C,E){const S=l(g,_,y,b,C,E);y.transmission>0?n.push(S):y.transparent===!0?a.push(S):t.push(S)}function d(g,_,y,b,C,E){const S=l(g,_,y,b,C,E);y.transmission>0?n.unshift(S):y.transparent===!0?a.unshift(S):t.unshift(S)}function p(g,_){t.length>1&&t.sort(g||r5),n.length>1&&n.sort(_||P3),a.length>1&&a.sort(_||P3)}function x(){for(let g=e,_=i.length;g<_;g++){const y=i[g];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}}return{opaque:t,transmissive:n,transparent:a,init:r,push:u,unshift:d,finish:x,sort:p}}function o5(){let i=new WeakMap;function e(n,a){const r=i.get(n);let l;return r===void 0?(l=new F3,i.set(n,[l])):a>=r.length?(l=new F3,r.push(l)):l=r[a],l}function t(){i=new WeakMap}return{get:e,dispose:t}}function l5(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new te,color:new ut};break;case"SpotLight":t={position:new te,direction:new te,color:new ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new te,color:new ut,distance:0,decay:0};break;case"HemisphereLight":t={direction:new te,skyColor:new ut,groundColor:new ut};break;case"RectAreaLight":t={color:new ut,position:new te,halfWidth:new te,halfHeight:new te};break}return i[e.id]=t,t}}}function c5(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ge};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ge};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ge,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let u5=0;function f5(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function h5(i){const e=new l5,t=c5(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new te);const a=new te,r=new Wt,l=new Wt;function u(p){let x=0,g=0,_=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let y=0,b=0,C=0,E=0,S=0,w=0,D=0,U=0,F=0,N=0,z=0;p.sort(f5);for(let L=0,P=p.length;L<P;L++){const q=p[L],ie=q.color,se=q.intensity,ae=q.distance,re=q.shadow&&q.shadow.map?q.shadow.map.texture:null;if(q.isAmbientLight)x+=ie.r*se,g+=ie.g*se,_+=ie.b*se;else if(q.isLightProbe){for(let H=0;H<9;H++)n.probe[H].addScaledVector(q.sh.coefficients[H],se);z++}else if(q.isDirectionalLight){const H=e.get(q);if(H.color.copy(q.color).multiplyScalar(q.intensity),q.castShadow){const K=q.shadow,W=t.get(q);W.shadowIntensity=K.intensity,W.shadowBias=K.bias,W.shadowNormalBias=K.normalBias,W.shadowRadius=K.radius,W.shadowMapSize=K.mapSize,n.directionalShadow[y]=W,n.directionalShadowMap[y]=re,n.directionalShadowMatrix[y]=q.shadow.matrix,w++}n.directional[y]=H,y++}else if(q.isSpotLight){const H=e.get(q);H.position.setFromMatrixPosition(q.matrixWorld),H.color.copy(ie).multiplyScalar(se),H.distance=ae,H.coneCos=Math.cos(q.angle),H.penumbraCos=Math.cos(q.angle*(1-q.penumbra)),H.decay=q.decay,n.spot[C]=H;const K=q.shadow;if(q.map&&(n.spotLightMap[F]=q.map,F++,K.updateMatrices(q),q.castShadow&&N++),n.spotLightMatrix[C]=K.matrix,q.castShadow){const W=t.get(q);W.shadowIntensity=K.intensity,W.shadowBias=K.bias,W.shadowNormalBias=K.normalBias,W.shadowRadius=K.radius,W.shadowMapSize=K.mapSize,n.spotShadow[C]=W,n.spotShadowMap[C]=re,U++}C++}else if(q.isRectAreaLight){const H=e.get(q);H.color.copy(ie).multiplyScalar(se),H.halfWidth.set(q.width*.5,0,0),H.halfHeight.set(0,q.height*.5,0),n.rectArea[E]=H,E++}else if(q.isPointLight){const H=e.get(q);if(H.color.copy(q.color).multiplyScalar(q.intensity),H.distance=q.distance,H.decay=q.decay,q.castShadow){const K=q.shadow,W=t.get(q);W.shadowIntensity=K.intensity,W.shadowBias=K.bias,W.shadowNormalBias=K.normalBias,W.shadowRadius=K.radius,W.shadowMapSize=K.mapSize,W.shadowCameraNear=K.camera.near,W.shadowCameraFar=K.camera.far,n.pointShadow[b]=W,n.pointShadowMap[b]=re,n.pointShadowMatrix[b]=q.shadow.matrix,D++}n.point[b]=H,b++}else if(q.isHemisphereLight){const H=e.get(q);H.skyColor.copy(q.color).multiplyScalar(se),H.groundColor.copy(q.groundColor).multiplyScalar(se),n.hemi[S]=H,S++}}E>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=At.LTC_FLOAT_1,n.rectAreaLTC2=At.LTC_FLOAT_2):(n.rectAreaLTC1=At.LTC_HALF_1,n.rectAreaLTC2=At.LTC_HALF_2)),n.ambient[0]=x,n.ambient[1]=g,n.ambient[2]=_;const j=n.hash;(j.directionalLength!==y||j.pointLength!==b||j.spotLength!==C||j.rectAreaLength!==E||j.hemiLength!==S||j.numDirectionalShadows!==w||j.numPointShadows!==D||j.numSpotShadows!==U||j.numSpotMaps!==F||j.numLightProbes!==z)&&(n.directional.length=y,n.spot.length=C,n.rectArea.length=E,n.point.length=b,n.hemi.length=S,n.directionalShadow.length=w,n.directionalShadowMap.length=w,n.pointShadow.length=D,n.pointShadowMap.length=D,n.spotShadow.length=U,n.spotShadowMap.length=U,n.directionalShadowMatrix.length=w,n.pointShadowMatrix.length=D,n.spotLightMatrix.length=U+F-N,n.spotLightMap.length=F,n.numSpotLightShadowsWithMaps=N,n.numLightProbes=z,j.directionalLength=y,j.pointLength=b,j.spotLength=C,j.rectAreaLength=E,j.hemiLength=S,j.numDirectionalShadows=w,j.numPointShadows=D,j.numSpotShadows=U,j.numSpotMaps=F,j.numLightProbes=z,n.version=u5++)}function d(p,x){let g=0,_=0,y=0,b=0,C=0;const E=x.matrixWorldInverse;for(let S=0,w=p.length;S<w;S++){const D=p[S];if(D.isDirectionalLight){const U=n.directional[g];U.direction.setFromMatrixPosition(D.matrixWorld),a.setFromMatrixPosition(D.target.matrixWorld),U.direction.sub(a),U.direction.transformDirection(E),g++}else if(D.isSpotLight){const U=n.spot[y];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(E),U.direction.setFromMatrixPosition(D.matrixWorld),a.setFromMatrixPosition(D.target.matrixWorld),U.direction.sub(a),U.direction.transformDirection(E),y++}else if(D.isRectAreaLight){const U=n.rectArea[b];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(E),l.identity(),r.copy(D.matrixWorld),r.premultiply(E),l.extractRotation(r),U.halfWidth.set(D.width*.5,0,0),U.halfHeight.set(0,D.height*.5,0),U.halfWidth.applyMatrix4(l),U.halfHeight.applyMatrix4(l),b++}else if(D.isPointLight){const U=n.point[_];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(E),_++}else if(D.isHemisphereLight){const U=n.hemi[C];U.direction.setFromMatrixPosition(D.matrixWorld),U.direction.transformDirection(E),C++}}}return{setup:u,setupView:d,state:n}}function z3(i){const e=new h5(i),t=[],n=[];function a(x){p.camera=x,t.length=0,n.length=0}function r(x){t.push(x)}function l(x){n.push(x)}function u(){e.setup(t)}function d(x){e.setupView(t,x)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:a,state:p,setupLights:u,setupLightsView:d,pushLight:r,pushShadow:l}}function d5(i){let e=new WeakMap;function t(a,r=0){const l=e.get(a);let u;return l===void 0?(u=new z3(i),e.set(a,[u])):r>=l.length?(u=new z3(i),l.push(u)):u=l[r],u}function n(){e=new WeakMap}return{get:t,dispose:n}}const p5=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,m5=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function g5(i,e,t){let n=new Gp;const a=new Ge,r=new Ge,l=new kn,u=new bS({depthPacking:OT}),d=new SS,p={},x=t.maxTextureSize,g={[Wo]:oa,[oa]:Wo,[Oi]:Oi},_=new hi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ge},radius:{value:4}},vertexShader:p5,fragmentShader:m5}),y=_.clone();y.defines.HORIZONTAL_PASS=1;const b=new rn;b.setAttribute("position",new Mn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const C=new Xi(b,_),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=hy;let S=this.type;this.render=function(N,z,j){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||N.length===0)return;const L=i.getRenderTarget(),P=i.getActiveCubeFace(),q=i.getActiveMipmapLevel(),ie=i.state;ie.setBlending(es),ie.buffers.depth.getReversed()===!0?ie.buffers.color.setClear(0,0,0,0):ie.buffers.color.setClear(1,1,1,1),ie.buffers.depth.setTest(!0),ie.setScissorTest(!1);const se=S!==jo&&this.type===jo,ae=S===jo&&this.type!==jo;for(let re=0,H=N.length;re<H;re++){const K=N[re],W=K.shadow;if(W===void 0){Mt("WebGLShadowMap:",K,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;a.copy(W.mapSize);const me=W.getFrameExtents();if(a.multiply(me),r.copy(W.mapSize),(a.x>x||a.y>x)&&(a.x>x&&(r.x=Math.floor(x/me.x),a.x=r.x*me.x,W.mapSize.x=r.x),a.y>x&&(r.y=Math.floor(x/me.y),a.y=r.y*me.y,W.mapSize.y=r.y)),W.map===null||se===!0||ae===!0){const Q=this.type!==jo?{minFilter:la,magFilter:la}:{};W.map!==null&&W.map.dispose(),W.map=new ua(a.x,a.y,Q),W.map.texture.name=K.name+".shadowMap",W.camera.updateProjectionMatrix()}i.setRenderTarget(W.map),i.clear();const ve=W.getViewportCount();for(let Q=0;Q<ve;Q++){const de=W.getViewport(Q);l.set(r.x*de.x,r.y*de.y,r.x*de.z,r.y*de.w),ie.viewport(l),W.updateMatrices(K,Q),n=W.getFrustum(),U(z,j,W.camera,K,this.type)}W.isPointLightShadow!==!0&&this.type===jo&&w(W,j),W.needsUpdate=!1}S=this.type,E.needsUpdate=!1,i.setRenderTarget(L,P,q)};function w(N,z){const j=e.update(C);_.defines.VSM_SAMPLES!==N.blurSamples&&(_.defines.VSM_SAMPLES=N.blurSamples,y.defines.VSM_SAMPLES=N.blurSamples,_.needsUpdate=!0,y.needsUpdate=!0),N.mapPass===null&&(N.mapPass=new ua(a.x,a.y)),_.uniforms.shadow_pass.value=N.map.texture,_.uniforms.resolution.value=N.mapSize,_.uniforms.radius.value=N.radius,i.setRenderTarget(N.mapPass),i.clear(),i.renderBufferDirect(z,null,j,_,C,null),y.uniforms.shadow_pass.value=N.mapPass.texture,y.uniforms.resolution.value=N.mapSize,y.uniforms.radius.value=N.radius,i.setRenderTarget(N.map),i.clear(),i.renderBufferDirect(z,null,j,y,C,null)}function D(N,z,j,L){let P=null;const q=j.isPointLight===!0?N.customDistanceMaterial:N.customDepthMaterial;if(q!==void 0)P=q;else if(P=j.isPointLight===!0?d:u,i.localClippingEnabled&&z.clipShadows===!0&&Array.isArray(z.clippingPlanes)&&z.clippingPlanes.length!==0||z.displacementMap&&z.displacementScale!==0||z.alphaMap&&z.alphaTest>0||z.map&&z.alphaTest>0||z.alphaToCoverage===!0){const ie=P.uuid,se=z.uuid;let ae=p[ie];ae===void 0&&(ae={},p[ie]=ae);let re=ae[se];re===void 0&&(re=P.clone(),ae[se]=re,z.addEventListener("dispose",F)),P=re}if(P.visible=z.visible,P.wireframe=z.wireframe,L===jo?P.side=z.shadowSide!==null?z.shadowSide:z.side:P.side=z.shadowSide!==null?z.shadowSide:g[z.side],P.alphaMap=z.alphaMap,P.alphaTest=z.alphaToCoverage===!0?.5:z.alphaTest,P.map=z.map,P.clipShadows=z.clipShadows,P.clippingPlanes=z.clippingPlanes,P.clipIntersection=z.clipIntersection,P.displacementMap=z.displacementMap,P.displacementScale=z.displacementScale,P.displacementBias=z.displacementBias,P.wireframeLinewidth=z.wireframeLinewidth,P.linewidth=z.linewidth,j.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const ie=i.properties.get(P);ie.light=j}return P}function U(N,z,j,L,P){if(N.visible===!1)return;if(N.layers.test(z.layers)&&(N.isMesh||N.isLine||N.isPoints)&&(N.castShadow||N.receiveShadow&&P===jo)&&(!N.frustumCulled||n.intersectsObject(N))){N.modelViewMatrix.multiplyMatrices(j.matrixWorldInverse,N.matrixWorld);const se=e.update(N),ae=N.material;if(Array.isArray(ae)){const re=se.groups;for(let H=0,K=re.length;H<K;H++){const W=re[H],me=ae[W.materialIndex];if(me&&me.visible){const ve=D(N,me,L,P);N.onBeforeShadow(i,N,z,j,se,ve,W),i.renderBufferDirect(j,null,se,ve,N,W),N.onAfterShadow(i,N,z,j,se,ve,W)}}}else if(ae.visible){const re=D(N,ae,L,P);N.onBeforeShadow(i,N,z,j,se,re,null),i.renderBufferDirect(j,null,se,re,N,null),N.onAfterShadow(i,N,z,j,se,re,null)}}const ie=N.children;for(let se=0,ae=ie.length;se<ae;se++)U(ie[se],z,j,L,P)}function F(N){N.target.removeEventListener("dispose",F);for(const j in p){const L=p[j],P=N.target.uuid;P in L&&(L[P].dispose(),delete L[P])}}}const v5={[m_]:ng,[g_]:__,[v_]:y_,[bh]:x_,[ng]:m_,[__]:g_,[y_]:v_,[x_]:bh};function x5(i,e){function t(){let pe=!1;const Ue=new kn;let ft=null;const vt=new kn(0,0,0,0);return{setMask:function(tt){ft!==tt&&!pe&&(i.colorMask(tt,tt,tt,tt),ft=tt)},setLocked:function(tt){pe=tt},setClear:function(tt,Je,Bt,Qt,Fn){Fn===!0&&(tt*=Qt,Je*=Qt,Bt*=Qt),Ue.set(tt,Je,Bt,Qt),vt.equals(Ue)===!1&&(i.clearColor(tt,Je,Bt,Qt),vt.copy(Ue))},reset:function(){pe=!1,ft=null,vt.set(-1,0,0,0)}}}function n(){let pe=!1,Ue=!1,ft=null,vt=null,tt=null;return{setReversed:function(Je){if(Ue!==Je){const Bt=e.get("EXT_clip_control");Je?Bt.clipControlEXT(Bt.LOWER_LEFT_EXT,Bt.ZERO_TO_ONE_EXT):Bt.clipControlEXT(Bt.LOWER_LEFT_EXT,Bt.NEGATIVE_ONE_TO_ONE_EXT),Ue=Je;const Qt=tt;tt=null,this.setClear(Qt)}},getReversed:function(){return Ue},setTest:function(Je){Je?fe(i.DEPTH_TEST):Fe(i.DEPTH_TEST)},setMask:function(Je){ft!==Je&&!pe&&(i.depthMask(Je),ft=Je)},setFunc:function(Je){if(Ue&&(Je=v5[Je]),vt!==Je){switch(Je){case m_:i.depthFunc(i.NEVER);break;case ng:i.depthFunc(i.ALWAYS);break;case g_:i.depthFunc(i.LESS);break;case bh:i.depthFunc(i.LEQUAL);break;case v_:i.depthFunc(i.EQUAL);break;case x_:i.depthFunc(i.GEQUAL);break;case __:i.depthFunc(i.GREATER);break;case y_:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}vt=Je}},setLocked:function(Je){pe=Je},setClear:function(Je){tt!==Je&&(Ue&&(Je=1-Je),i.clearDepth(Je),tt=Je)},reset:function(){pe=!1,ft=null,vt=null,tt=null,Ue=!1}}}function a(){let pe=!1,Ue=null,ft=null,vt=null,tt=null,Je=null,Bt=null,Qt=null,Fn=null;return{setTest:function(Cn){pe||(Cn?fe(i.STENCIL_TEST):Fe(i.STENCIL_TEST))},setMask:function(Cn){Ue!==Cn&&!pe&&(i.stencilMask(Cn),Ue=Cn)},setFunc:function(Cn,fa,Va){(ft!==Cn||vt!==fa||tt!==Va)&&(i.stencilFunc(Cn,fa,Va),ft=Cn,vt=fa,tt=Va)},setOp:function(Cn,fa,Va){(Je!==Cn||Bt!==fa||Qt!==Va)&&(i.stencilOp(Cn,fa,Va),Je=Cn,Bt=fa,Qt=Va)},setLocked:function(Cn){pe=Cn},setClear:function(Cn){Fn!==Cn&&(i.clearStencil(Cn),Fn=Cn)},reset:function(){pe=!1,Ue=null,ft=null,vt=null,tt=null,Je=null,Bt=null,Qt=null,Fn=null}}}const r=new t,l=new n,u=new a,d=new WeakMap,p=new WeakMap;let x={},g={},_=new WeakMap,y=[],b=null,C=!1,E=null,S=null,w=null,D=null,U=null,F=null,N=null,z=new ut(0,0,0),j=0,L=!1,P=null,q=null,ie=null,se=null,ae=null;const re=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let H=!1,K=0;const W=i.getParameter(i.VERSION);W.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(W)[1]),H=K>=1):W.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(W)[1]),H=K>=2);let me=null,ve={};const Q=i.getParameter(i.SCISSOR_BOX),de=i.getParameter(i.VIEWPORT),Te=new kn().fromArray(Q),Me=new kn().fromArray(de);function rt(pe,Ue,ft,vt){const tt=new Uint8Array(4),Je=i.createTexture();i.bindTexture(pe,Je),i.texParameteri(pe,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(pe,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Bt=0;Bt<ft;Bt++)pe===i.TEXTURE_3D||pe===i.TEXTURE_2D_ARRAY?i.texImage3D(Ue,0,i.RGBA,1,1,vt,0,i.RGBA,i.UNSIGNED_BYTE,tt):i.texImage2D(Ue+Bt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,tt);return Je}const xe={};xe[i.TEXTURE_2D]=rt(i.TEXTURE_2D,i.TEXTURE_2D,1),xe[i.TEXTURE_CUBE_MAP]=rt(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),xe[i.TEXTURE_2D_ARRAY]=rt(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),xe[i.TEXTURE_3D]=rt(i.TEXTURE_3D,i.TEXTURE_3D,1,1),r.setClear(0,0,0,1),l.setClear(1),u.setClear(0),fe(i.DEPTH_TEST),l.setFunc(bh),Qe(!1),st(vb),fe(i.CULL_FACE),ke(es);function fe(pe){x[pe]!==!0&&(i.enable(pe),x[pe]=!0)}function Fe(pe){x[pe]!==!1&&(i.disable(pe),x[pe]=!1)}function et(pe,Ue){return g[pe]!==Ue?(i.bindFramebuffer(pe,Ue),g[pe]=Ue,pe===i.DRAW_FRAMEBUFFER&&(g[i.FRAMEBUFFER]=Ue),pe===i.FRAMEBUFFER&&(g[i.DRAW_FRAMEBUFFER]=Ue),!0):!1}function ht(pe,Ue){let ft=y,vt=!1;if(pe){ft=_.get(Ue),ft===void 0&&(ft=[],_.set(Ue,ft));const tt=pe.textures;if(ft.length!==tt.length||ft[0]!==i.COLOR_ATTACHMENT0){for(let Je=0,Bt=tt.length;Je<Bt;Je++)ft[Je]=i.COLOR_ATTACHMENT0+Je;ft.length=tt.length,vt=!0}}else ft[0]!==i.BACK&&(ft[0]=i.BACK,vt=!0);vt&&i.drawBuffers(ft)}function yt(pe){return b!==pe?(i.useProgram(pe),b=pe,!0):!1}const Xt={[Nu]:i.FUNC_ADD,[sT]:i.FUNC_SUBTRACT,[rT]:i.FUNC_REVERSE_SUBTRACT};Xt[oT]=i.MIN,Xt[lT]=i.MAX;const Ot={[cT]:i.ZERO,[uT]:i.ONE,[fT]:i.SRC_COLOR,[d_]:i.SRC_ALPHA,[vT]:i.SRC_ALPHA_SATURATE,[mT]:i.DST_COLOR,[dT]:i.DST_ALPHA,[hT]:i.ONE_MINUS_SRC_COLOR,[p_]:i.ONE_MINUS_SRC_ALPHA,[gT]:i.ONE_MINUS_DST_COLOR,[pT]:i.ONE_MINUS_DST_ALPHA,[xT]:i.CONSTANT_COLOR,[_T]:i.ONE_MINUS_CONSTANT_COLOR,[yT]:i.CONSTANT_ALPHA,[bT]:i.ONE_MINUS_CONSTANT_ALPHA};function ke(pe,Ue,ft,vt,tt,Je,Bt,Qt,Fn,Cn){if(pe===es){C===!0&&(Fe(i.BLEND),C=!1);return}if(C===!1&&(fe(i.BLEND),C=!0),pe!==aT){if(pe!==E||Cn!==L){if((S!==Nu||U!==Nu)&&(i.blendEquation(i.FUNC_ADD),S=Nu,U=Nu),Cn)switch(pe){case vh:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case ir:i.blendFunc(i.ONE,i.ONE);break;case xb:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case _b:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:un("WebGLState: Invalid blending: ",pe);break}else switch(pe){case vh:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case ir:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case xb:un("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case _b:un("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:un("WebGLState: Invalid blending: ",pe);break}w=null,D=null,F=null,N=null,z.set(0,0,0),j=0,E=pe,L=Cn}return}tt=tt||Ue,Je=Je||ft,Bt=Bt||vt,(Ue!==S||tt!==U)&&(i.blendEquationSeparate(Xt[Ue],Xt[tt]),S=Ue,U=tt),(ft!==w||vt!==D||Je!==F||Bt!==N)&&(i.blendFuncSeparate(Ot[ft],Ot[vt],Ot[Je],Ot[Bt]),w=ft,D=vt,F=Je,N=Bt),(Qt.equals(z)===!1||Fn!==j)&&(i.blendColor(Qt.r,Qt.g,Qt.b,Fn),z.copy(Qt),j=Fn),E=pe,L=!1}function $(pe,Ue){pe.side===Oi?Fe(i.CULL_FACE):fe(i.CULL_FACE);let ft=pe.side===oa;Ue&&(ft=!ft),Qe(ft),pe.blending===vh&&pe.transparent===!1?ke(es):ke(pe.blending,pe.blendEquation,pe.blendSrc,pe.blendDst,pe.blendEquationAlpha,pe.blendSrcAlpha,pe.blendDstAlpha,pe.blendColor,pe.blendAlpha,pe.premultipliedAlpha),l.setFunc(pe.depthFunc),l.setTest(pe.depthTest),l.setMask(pe.depthWrite),r.setMask(pe.colorWrite);const vt=pe.stencilWrite;u.setTest(vt),vt&&(u.setMask(pe.stencilWriteMask),u.setFunc(pe.stencilFunc,pe.stencilRef,pe.stencilFuncMask),u.setOp(pe.stencilFail,pe.stencilZFail,pe.stencilZPass)),it(pe.polygonOffset,pe.polygonOffsetFactor,pe.polygonOffsetUnits),pe.alphaToCoverage===!0?fe(i.SAMPLE_ALPHA_TO_COVERAGE):Fe(i.SAMPLE_ALPHA_TO_COVERAGE)}function Qe(pe){P!==pe&&(pe?i.frontFace(i.CW):i.frontFace(i.CCW),P=pe)}function st(pe){pe!==tT?(fe(i.CULL_FACE),pe!==q&&(pe===vb?i.cullFace(i.BACK):pe===nT?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Fe(i.CULL_FACE),q=pe}function pt(pe){pe!==ie&&(H&&i.lineWidth(pe),ie=pe)}function it(pe,Ue,ft){pe?(fe(i.POLYGON_OFFSET_FILL),(se!==Ue||ae!==ft)&&(i.polygonOffset(Ue,ft),se=Ue,ae=ft)):Fe(i.POLYGON_OFFSET_FILL)}function bt(pe){pe?fe(i.SCISSOR_TEST):Fe(i.SCISSOR_TEST)}function mt(pe){pe===void 0&&(pe=i.TEXTURE0+re-1),me!==pe&&(i.activeTexture(pe),me=pe)}function Ct(pe,Ue,ft){ft===void 0&&(me===null?ft=i.TEXTURE0+re-1:ft=me);let vt=ve[ft];vt===void 0&&(vt={type:void 0,texture:void 0},ve[ft]=vt),(vt.type!==pe||vt.texture!==Ue)&&(me!==ft&&(i.activeTexture(ft),me=ft),i.bindTexture(pe,Ue||xe[pe]),vt.type=pe,vt.texture=Ue)}function ee(){const pe=ve[me];pe!==void 0&&pe.type!==void 0&&(i.bindTexture(pe.type,null),pe.type=void 0,pe.texture=void 0)}function X(){try{i.compressedTexImage2D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function Ae(){try{i.compressedTexImage3D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function He(){try{i.texSubImage2D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function Ze(){try{i.texSubImage3D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function Le(){try{i.compressedTexSubImage2D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function Nt(){try{i.compressedTexSubImage3D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function xt(){try{i.texStorage2D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function Vt(){try{i.texStorage3D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function Lt(){try{i.texImage2D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function Ye(){try{i.texImage3D(...arguments)}catch(pe){pe("WebGLState:",pe)}}function qe(pe){Te.equals(pe)===!1&&(i.scissor(pe.x,pe.y,pe.z,pe.w),Te.copy(pe))}function It(pe){Me.equals(pe)===!1&&(i.viewport(pe.x,pe.y,pe.z,pe.w),Me.copy(pe))}function Et(pe,Ue){let ft=p.get(Ue);ft===void 0&&(ft=new WeakMap,p.set(Ue,ft));let vt=ft.get(pe);vt===void 0&&(vt=i.getUniformBlockIndex(Ue,pe.name),ft.set(pe,vt))}function gt(pe,Ue){const vt=p.get(Ue).get(pe);d.get(Ue)!==vt&&(i.uniformBlockBinding(Ue,vt,pe.__bindingPointIndex),d.set(Ue,vt))}function Dt(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),l.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),x={},me=null,ve={},g={},_=new WeakMap,y=[],b=null,C=!1,E=null,S=null,w=null,D=null,U=null,F=null,N=null,z=new ut(0,0,0),j=0,L=!1,P=null,q=null,ie=null,se=null,ae=null,Te.set(0,0,i.canvas.width,i.canvas.height),Me.set(0,0,i.canvas.width,i.canvas.height),r.reset(),l.reset(),u.reset()}return{buffers:{color:r,depth:l,stencil:u},enable:fe,disable:Fe,bindFramebuffer:et,drawBuffers:ht,useProgram:yt,setBlending:ke,setMaterial:$,setFlipSided:Qe,setCullFace:st,setLineWidth:pt,setPolygonOffset:it,setScissorTest:bt,activeTexture:mt,bindTexture:Ct,unbindTexture:ee,compressedTexImage2D:X,compressedTexImage3D:Ae,texImage2D:Lt,texImage3D:Ye,updateUBOMapping:Et,uniformBlockBinding:gt,texStorage2D:xt,texStorage3D:Vt,texSubImage2D:He,texSubImage3D:Ze,compressedTexSubImage2D:Le,compressedTexSubImage3D:Nt,scissor:qe,viewport:It,reset:Dt}}function _5(i,e,t,n,a,r,l){const u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new Ge,x=new WeakMap;let g;const _=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(ee,X){return y?new OffscreenCanvas(ee,X):og("canvas")}function C(ee,X,Ae){let He=1;const Ze=Ct(ee);if((Ze.width>Ae||Ze.height>Ae)&&(He=Ae/Math.max(Ze.width,Ze.height)),He<1)if(typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ee instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ee instanceof ImageBitmap||typeof VideoFrame<"u"&&ee instanceof VideoFrame){const Le=Math.floor(He*Ze.width),Nt=Math.floor(He*Ze.height);g===void 0&&(g=b(Le,Nt));const xt=X?b(Le,Nt):g;return xt.width=Le,xt.height=Nt,xt.getContext("2d").drawImage(ee,0,0,Le,Nt),Mt("WebGLRenderer: Texture has been resized from ("+Ze.width+"x"+Ze.height+") to ("+Le+"x"+Nt+")."),xt}else return"data"in ee&&Mt("WebGLRenderer: Image in DataTexture is too big ("+Ze.width+"x"+Ze.height+")."),ee;return ee}function E(ee){return ee.generateMipmaps}function S(ee){i.generateMipmap(ee)}function w(ee){return ee.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:ee.isWebGL3DRenderTarget?i.TEXTURE_3D:ee.isWebGLArrayRenderTarget||ee.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function D(ee,X,Ae,He,Ze=!1){if(ee!==null){if(i[ee]!==void 0)return i[ee];Mt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ee+"'")}let Le=X;if(X===i.RED&&(Ae===i.FLOAT&&(Le=i.R32F),Ae===i.HALF_FLOAT&&(Le=i.R16F),Ae===i.UNSIGNED_BYTE&&(Le=i.R8)),X===i.RED_INTEGER&&(Ae===i.UNSIGNED_BYTE&&(Le=i.R8UI),Ae===i.UNSIGNED_SHORT&&(Le=i.R16UI),Ae===i.UNSIGNED_INT&&(Le=i.R32UI),Ae===i.BYTE&&(Le=i.R8I),Ae===i.SHORT&&(Le=i.R16I),Ae===i.INT&&(Le=i.R32I)),X===i.RG&&(Ae===i.FLOAT&&(Le=i.RG32F),Ae===i.HALF_FLOAT&&(Le=i.RG16F),Ae===i.UNSIGNED_BYTE&&(Le=i.RG8)),X===i.RG_INTEGER&&(Ae===i.UNSIGNED_BYTE&&(Le=i.RG8UI),Ae===i.UNSIGNED_SHORT&&(Le=i.RG16UI),Ae===i.UNSIGNED_INT&&(Le=i.RG32UI),Ae===i.BYTE&&(Le=i.RG8I),Ae===i.SHORT&&(Le=i.RG16I),Ae===i.INT&&(Le=i.RG32I)),X===i.RGB_INTEGER&&(Ae===i.UNSIGNED_BYTE&&(Le=i.RGB8UI),Ae===i.UNSIGNED_SHORT&&(Le=i.RGB16UI),Ae===i.UNSIGNED_INT&&(Le=i.RGB32UI),Ae===i.BYTE&&(Le=i.RGB8I),Ae===i.SHORT&&(Le=i.RGB16I),Ae===i.INT&&(Le=i.RGB32I)),X===i.RGBA_INTEGER&&(Ae===i.UNSIGNED_BYTE&&(Le=i.RGBA8UI),Ae===i.UNSIGNED_SHORT&&(Le=i.RGBA16UI),Ae===i.UNSIGNED_INT&&(Le=i.RGBA32UI),Ae===i.BYTE&&(Le=i.RGBA8I),Ae===i.SHORT&&(Le=i.RGBA16I),Ae===i.INT&&(Le=i.RGBA32I)),X===i.RGB&&(Ae===i.UNSIGNED_INT_5_9_9_9_REV&&(Le=i.RGB9_E5),Ae===i.UNSIGNED_INT_10F_11F_11F_REV&&(Le=i.R11F_G11F_B10F)),X===i.RGBA){const Nt=Ze?sg:Wn.getTransfer(He);Ae===i.FLOAT&&(Le=i.RGBA32F),Ae===i.HALF_FLOAT&&(Le=i.RGBA16F),Ae===i.UNSIGNED_BYTE&&(Le=Nt===xi?i.SRGB8_ALPHA8:i.RGBA8),Ae===i.UNSIGNED_SHORT_4_4_4_4&&(Le=i.RGBA4),Ae===i.UNSIGNED_SHORT_5_5_5_1&&(Le=i.RGB5_A1)}return(Le===i.R16F||Le===i.R32F||Le===i.RG16F||Le===i.RG32F||Le===i.RGBA16F||Le===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Le}function U(ee,X){let Ae;return ee?X===null||X===Zo||X===Sh?Ae=i.DEPTH24_STENCIL8:X===ji?Ae=i.DEPTH32F_STENCIL8:X===Cp&&(Ae=i.DEPTH24_STENCIL8,Mt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):X===null||X===Zo||X===Sh?Ae=i.DEPTH_COMPONENT24:X===ji?Ae=i.DEPTH_COMPONENT32F:X===Cp&&(Ae=i.DEPTH_COMPONENT16),Ae}function F(ee,X){return E(ee)===!0||ee.isFramebufferTexture&&ee.minFilter!==la&&ee.minFilter!==In?Math.log2(Math.max(X.width,X.height))+1:ee.mipmaps!==void 0&&ee.mipmaps.length>0?ee.mipmaps.length:ee.isCompressedTexture&&Array.isArray(ee.image)?X.mipmaps.length:1}function N(ee){const X=ee.target;X.removeEventListener("dispose",N),j(X),X.isVideoTexture&&x.delete(X)}function z(ee){const X=ee.target;X.removeEventListener("dispose",z),P(X)}function j(ee){const X=n.get(ee);if(X.__webglInit===void 0)return;const Ae=ee.source,He=_.get(Ae);if(He){const Ze=He[X.__cacheKey];Ze.usedTimes--,Ze.usedTimes===0&&L(ee),Object.keys(He).length===0&&_.delete(Ae)}n.remove(ee)}function L(ee){const X=n.get(ee);i.deleteTexture(X.__webglTexture);const Ae=ee.source,He=_.get(Ae);delete He[X.__cacheKey],l.memory.textures--}function P(ee){const X=n.get(ee);if(ee.depthTexture&&(ee.depthTexture.dispose(),n.remove(ee.depthTexture)),ee.isWebGLCubeRenderTarget)for(let He=0;He<6;He++){if(Array.isArray(X.__webglFramebuffer[He]))for(let Ze=0;Ze<X.__webglFramebuffer[He].length;Ze++)i.deleteFramebuffer(X.__webglFramebuffer[He][Ze]);else i.deleteFramebuffer(X.__webglFramebuffer[He]);X.__webglDepthbuffer&&i.deleteRenderbuffer(X.__webglDepthbuffer[He])}else{if(Array.isArray(X.__webglFramebuffer))for(let He=0;He<X.__webglFramebuffer.length;He++)i.deleteFramebuffer(X.__webglFramebuffer[He]);else i.deleteFramebuffer(X.__webglFramebuffer);if(X.__webglDepthbuffer&&i.deleteRenderbuffer(X.__webglDepthbuffer),X.__webglMultisampledFramebuffer&&i.deleteFramebuffer(X.__webglMultisampledFramebuffer),X.__webglColorRenderbuffer)for(let He=0;He<X.__webglColorRenderbuffer.length;He++)X.__webglColorRenderbuffer[He]&&i.deleteRenderbuffer(X.__webglColorRenderbuffer[He]);X.__webglDepthRenderbuffer&&i.deleteRenderbuffer(X.__webglDepthRenderbuffer)}const Ae=ee.textures;for(let He=0,Ze=Ae.length;He<Ze;He++){const Le=n.get(Ae[He]);Le.__webglTexture&&(i.deleteTexture(Le.__webglTexture),l.memory.textures--),n.remove(Ae[He])}n.remove(ee)}let q=0;function ie(){q=0}function se(){const ee=q;return ee>=a.maxTextures&&Mt("WebGLTextures: Trying to use "+ee+" texture units while this GPU supports only "+a.maxTextures),q+=1,ee}function ae(ee){const X=[];return X.push(ee.wrapS),X.push(ee.wrapT),X.push(ee.wrapR||0),X.push(ee.magFilter),X.push(ee.minFilter),X.push(ee.anisotropy),X.push(ee.internalFormat),X.push(ee.format),X.push(ee.type),X.push(ee.generateMipmaps),X.push(ee.premultiplyAlpha),X.push(ee.flipY),X.push(ee.unpackAlignment),X.push(ee.colorSpace),X.join()}function re(ee,X){const Ae=n.get(ee);if(ee.isVideoTexture&&bt(ee),ee.isRenderTargetTexture===!1&&ee.isExternalTexture!==!0&&ee.version>0&&Ae.__version!==ee.version){const He=ee.image;if(He===null)Mt("WebGLRenderer: Texture marked for update but no image data found.");else if(He.complete===!1)Mt("WebGLRenderer: Texture marked for update but image is incomplete");else{xe(Ae,ee,X);return}}else ee.isExternalTexture&&(Ae.__webglTexture=ee.sourceTexture?ee.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,Ae.__webglTexture,i.TEXTURE0+X)}function H(ee,X){const Ae=n.get(ee);if(ee.isRenderTargetTexture===!1&&ee.version>0&&Ae.__version!==ee.version){xe(Ae,ee,X);return}else ee.isExternalTexture&&(Ae.__webglTexture=ee.sourceTexture?ee.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,Ae.__webglTexture,i.TEXTURE0+X)}function K(ee,X){const Ae=n.get(ee);if(ee.isRenderTargetTexture===!1&&ee.version>0&&Ae.__version!==ee.version){xe(Ae,ee,X);return}t.bindTexture(i.TEXTURE_3D,Ae.__webglTexture,i.TEXTURE0+X)}function W(ee,X){const Ae=n.get(ee);if(ee.version>0&&Ae.__version!==ee.version){fe(Ae,ee,X);return}t.bindTexture(i.TEXTURE_CUBE_MAP,Ae.__webglTexture,i.TEXTURE0+X)}const me={[Gu]:i.REPEAT,[ea]:i.CLAMP_TO_EDGE,[Tp]:i.MIRRORED_REPEAT},ve={[la]:i.NEAREST,[dy]:i.NEAREST_MIPMAP_NEAREST,[uh]:i.NEAREST_MIPMAP_LINEAR,[In]:i.LINEAR,[bp]:i.LINEAR_MIPMAP_NEAREST,[fo]:i.LINEAR_MIPMAP_LINEAR},Q={[LT]:i.NEVER,[GT]:i.ALWAYS,[IT]:i.LESS,[tS]:i.LEQUAL,[PT]:i.EQUAL,[HT]:i.GEQUAL,[FT]:i.GREATER,[zT]:i.NOTEQUAL};function de(ee,X){if(X.type===ji&&e.has("OES_texture_float_linear")===!1&&(X.magFilter===In||X.magFilter===bp||X.magFilter===uh||X.magFilter===fo||X.minFilter===In||X.minFilter===bp||X.minFilter===uh||X.minFilter===fo)&&Mt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(ee,i.TEXTURE_WRAP_S,me[X.wrapS]),i.texParameteri(ee,i.TEXTURE_WRAP_T,me[X.wrapT]),(ee===i.TEXTURE_3D||ee===i.TEXTURE_2D_ARRAY)&&i.texParameteri(ee,i.TEXTURE_WRAP_R,me[X.wrapR]),i.texParameteri(ee,i.TEXTURE_MAG_FILTER,ve[X.magFilter]),i.texParameteri(ee,i.TEXTURE_MIN_FILTER,ve[X.minFilter]),X.compareFunction&&(i.texParameteri(ee,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(ee,i.TEXTURE_COMPARE_FUNC,Q[X.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(X.magFilter===la||X.minFilter!==uh&&X.minFilter!==fo||X.type===ji&&e.has("OES_texture_float_linear")===!1)return;if(X.anisotropy>1||n.get(X).__currentAnisotropy){const Ae=e.get("EXT_texture_filter_anisotropic");i.texParameterf(ee,Ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(X.anisotropy,a.getMaxAnisotropy())),n.get(X).__currentAnisotropy=X.anisotropy}}}function Te(ee,X){let Ae=!1;ee.__webglInit===void 0&&(ee.__webglInit=!0,X.addEventListener("dispose",N));const He=X.source;let Ze=_.get(He);Ze===void 0&&(Ze={},_.set(He,Ze));const Le=ae(X);if(Le!==ee.__cacheKey){Ze[Le]===void 0&&(Ze[Le]={texture:i.createTexture(),usedTimes:0},l.memory.textures++,Ae=!0),Ze[Le].usedTimes++;const Nt=Ze[ee.__cacheKey];Nt!==void 0&&(Ze[ee.__cacheKey].usedTimes--,Nt.usedTimes===0&&L(X)),ee.__cacheKey=Le,ee.__webglTexture=Ze[Le].texture}return Ae}function Me(ee,X,Ae){return Math.floor(Math.floor(ee/Ae)/X)}function rt(ee,X,Ae,He){const Le=ee.updateRanges;if(Le.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,X.width,X.height,Ae,He,X.data);else{Le.sort((Ye,qe)=>Ye.start-qe.start);let Nt=0;for(let Ye=1;Ye<Le.length;Ye++){const qe=Le[Nt],It=Le[Ye],Et=qe.start+qe.count,gt=Me(It.start,X.width,4),Dt=Me(qe.start,X.width,4);It.start<=Et+1&&gt===Dt&&Me(It.start+It.count-1,X.width,4)===gt?qe.count=Math.max(qe.count,It.start+It.count-qe.start):(++Nt,Le[Nt]=It)}Le.length=Nt+1;const xt=i.getParameter(i.UNPACK_ROW_LENGTH),Vt=i.getParameter(i.UNPACK_SKIP_PIXELS),Lt=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,X.width);for(let Ye=0,qe=Le.length;Ye<qe;Ye++){const It=Le[Ye],Et=Math.floor(It.start/4),gt=Math.ceil(It.count/4),Dt=Et%X.width,pe=Math.floor(Et/X.width),Ue=gt,ft=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,Dt),i.pixelStorei(i.UNPACK_SKIP_ROWS,pe),t.texSubImage2D(i.TEXTURE_2D,0,Dt,pe,Ue,ft,Ae,He,X.data)}ee.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,xt),i.pixelStorei(i.UNPACK_SKIP_PIXELS,Vt),i.pixelStorei(i.UNPACK_SKIP_ROWS,Lt)}}function xe(ee,X,Ae){let He=i.TEXTURE_2D;(X.isDataArrayTexture||X.isCompressedArrayTexture)&&(He=i.TEXTURE_2D_ARRAY),X.isData3DTexture&&(He=i.TEXTURE_3D);const Ze=Te(ee,X),Le=X.source;t.bindTexture(He,ee.__webglTexture,i.TEXTURE0+Ae);const Nt=n.get(Le);if(Le.version!==Nt.__version||Ze===!0){t.activeTexture(i.TEXTURE0+Ae);const xt=Wn.getPrimaries(Wn.workingColorSpace),Vt=X.colorSpace===qo?null:Wn.getPrimaries(X.colorSpace),Lt=X.colorSpace===qo||xt===Vt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,X.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,X.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Lt);let Ye=C(X.image,!1,a.maxTextureSize);Ye=mt(X,Ye);const qe=r.convert(X.format,X.colorSpace),It=r.convert(X.type);let Et=D(X.internalFormat,qe,It,X.colorSpace,X.isVideoTexture);de(He,X);let gt;const Dt=X.mipmaps,pe=X.isVideoTexture!==!0,Ue=Nt.__version===void 0||Ze===!0,ft=Le.dataReady,vt=F(X,Ye);if(X.isDepthTexture)Et=U(X.format===Ah,X.type),Ue&&(pe?t.texStorage2D(i.TEXTURE_2D,1,Et,Ye.width,Ye.height):t.texImage2D(i.TEXTURE_2D,0,Et,Ye.width,Ye.height,0,qe,It,null));else if(X.isDataTexture)if(Dt.length>0){pe&&Ue&&t.texStorage2D(i.TEXTURE_2D,vt,Et,Dt[0].width,Dt[0].height);for(let tt=0,Je=Dt.length;tt<Je;tt++)gt=Dt[tt],pe?ft&&t.texSubImage2D(i.TEXTURE_2D,tt,0,0,gt.width,gt.height,qe,It,gt.data):t.texImage2D(i.TEXTURE_2D,tt,Et,gt.width,gt.height,0,qe,It,gt.data);X.generateMipmaps=!1}else pe?(Ue&&t.texStorage2D(i.TEXTURE_2D,vt,Et,Ye.width,Ye.height),ft&&rt(X,Ye,qe,It)):t.texImage2D(i.TEXTURE_2D,0,Et,Ye.width,Ye.height,0,qe,It,Ye.data);else if(X.isCompressedTexture)if(X.isCompressedArrayTexture){pe&&Ue&&t.texStorage3D(i.TEXTURE_2D_ARRAY,vt,Et,Dt[0].width,Dt[0].height,Ye.depth);for(let tt=0,Je=Dt.length;tt<Je;tt++)if(gt=Dt[tt],X.format!==_a)if(qe!==null)if(pe){if(ft)if(X.layerUpdates.size>0){const Bt=wb(gt.width,gt.height,X.format,X.type);for(const Qt of X.layerUpdates){const Fn=gt.data.subarray(Qt*Bt/gt.data.BYTES_PER_ELEMENT,(Qt+1)*Bt/gt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,tt,0,0,Qt,gt.width,gt.height,1,qe,Fn)}X.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,tt,0,0,0,gt.width,gt.height,Ye.depth,qe,gt.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,tt,Et,gt.width,gt.height,Ye.depth,0,gt.data,0,0);else Mt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else pe?ft&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,tt,0,0,0,gt.width,gt.height,Ye.depth,qe,It,gt.data):t.texImage3D(i.TEXTURE_2D_ARRAY,tt,Et,gt.width,gt.height,Ye.depth,0,qe,It,gt.data)}else{pe&&Ue&&t.texStorage2D(i.TEXTURE_2D,vt,Et,Dt[0].width,Dt[0].height);for(let tt=0,Je=Dt.length;tt<Je;tt++)gt=Dt[tt],X.format!==_a?qe!==null?pe?ft&&t.compressedTexSubImage2D(i.TEXTURE_2D,tt,0,0,gt.width,gt.height,qe,gt.data):t.compressedTexImage2D(i.TEXTURE_2D,tt,Et,gt.width,gt.height,0,gt.data):Mt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pe?ft&&t.texSubImage2D(i.TEXTURE_2D,tt,0,0,gt.width,gt.height,qe,It,gt.data):t.texImage2D(i.TEXTURE_2D,tt,Et,gt.width,gt.height,0,qe,It,gt.data)}else if(X.isDataArrayTexture)if(pe){if(Ue&&t.texStorage3D(i.TEXTURE_2D_ARRAY,vt,Et,Ye.width,Ye.height,Ye.depth),ft)if(X.layerUpdates.size>0){const tt=wb(Ye.width,Ye.height,X.format,X.type);for(const Je of X.layerUpdates){const Bt=Ye.data.subarray(Je*tt/Ye.data.BYTES_PER_ELEMENT,(Je+1)*tt/Ye.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Je,Ye.width,Ye.height,1,qe,It,Bt)}X.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Ye.width,Ye.height,Ye.depth,qe,It,Ye.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,Et,Ye.width,Ye.height,Ye.depth,0,qe,It,Ye.data);else if(X.isData3DTexture)pe?(Ue&&t.texStorage3D(i.TEXTURE_3D,vt,Et,Ye.width,Ye.height,Ye.depth),ft&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Ye.width,Ye.height,Ye.depth,qe,It,Ye.data)):t.texImage3D(i.TEXTURE_3D,0,Et,Ye.width,Ye.height,Ye.depth,0,qe,It,Ye.data);else if(X.isFramebufferTexture){if(Ue)if(pe)t.texStorage2D(i.TEXTURE_2D,vt,Et,Ye.width,Ye.height);else{let tt=Ye.width,Je=Ye.height;for(let Bt=0;Bt<vt;Bt++)t.texImage2D(i.TEXTURE_2D,Bt,Et,tt,Je,0,qe,It,null),tt>>=1,Je>>=1}}else if(Dt.length>0){if(pe&&Ue){const tt=Ct(Dt[0]);t.texStorage2D(i.TEXTURE_2D,vt,Et,tt.width,tt.height)}for(let tt=0,Je=Dt.length;tt<Je;tt++)gt=Dt[tt],pe?ft&&t.texSubImage2D(i.TEXTURE_2D,tt,0,0,qe,It,gt):t.texImage2D(i.TEXTURE_2D,tt,Et,qe,It,gt);X.generateMipmaps=!1}else if(pe){if(Ue){const tt=Ct(Ye);t.texStorage2D(i.TEXTURE_2D,vt,Et,tt.width,tt.height)}ft&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,qe,It,Ye)}else t.texImage2D(i.TEXTURE_2D,0,Et,qe,It,Ye);E(X)&&S(He),Nt.__version=Le.version,X.onUpdate&&X.onUpdate(X)}ee.__version=X.version}function fe(ee,X,Ae){if(X.image.length!==6)return;const He=Te(ee,X),Ze=X.source;t.bindTexture(i.TEXTURE_CUBE_MAP,ee.__webglTexture,i.TEXTURE0+Ae);const Le=n.get(Ze);if(Ze.version!==Le.__version||He===!0){t.activeTexture(i.TEXTURE0+Ae);const Nt=Wn.getPrimaries(Wn.workingColorSpace),xt=X.colorSpace===qo?null:Wn.getPrimaries(X.colorSpace),Vt=X.colorSpace===qo||Nt===xt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,X.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,X.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Vt);const Lt=X.isCompressedTexture||X.image[0].isCompressedTexture,Ye=X.image[0]&&X.image[0].isDataTexture,qe=[];for(let Je=0;Je<6;Je++)!Lt&&!Ye?qe[Je]=C(X.image[Je],!0,a.maxCubemapSize):qe[Je]=Ye?X.image[Je].image:X.image[Je],qe[Je]=mt(X,qe[Je]);const It=qe[0],Et=r.convert(X.format,X.colorSpace),gt=r.convert(X.type),Dt=D(X.internalFormat,Et,gt,X.colorSpace),pe=X.isVideoTexture!==!0,Ue=Le.__version===void 0||He===!0,ft=Ze.dataReady;let vt=F(X,It);de(i.TEXTURE_CUBE_MAP,X);let tt;if(Lt){pe&&Ue&&t.texStorage2D(i.TEXTURE_CUBE_MAP,vt,Dt,It.width,It.height);for(let Je=0;Je<6;Je++){tt=qe[Je].mipmaps;for(let Bt=0;Bt<tt.length;Bt++){const Qt=tt[Bt];X.format!==_a?Et!==null?pe?ft&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Bt,0,0,Qt.width,Qt.height,Et,Qt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Bt,Dt,Qt.width,Qt.height,0,Qt.data):Mt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pe?ft&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Bt,0,0,Qt.width,Qt.height,Et,gt,Qt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Bt,Dt,Qt.width,Qt.height,0,Et,gt,Qt.data)}}}else{if(tt=X.mipmaps,pe&&Ue){tt.length>0&&vt++;const Je=Ct(qe[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,vt,Dt,Je.width,Je.height)}for(let Je=0;Je<6;Je++)if(Ye){pe?ft&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,0,0,qe[Je].width,qe[Je].height,Et,gt,qe[Je].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,Dt,qe[Je].width,qe[Je].height,0,Et,gt,qe[Je].data);for(let Bt=0;Bt<tt.length;Bt++){const Fn=tt[Bt].image[Je].image;pe?ft&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Bt+1,0,0,Fn.width,Fn.height,Et,gt,Fn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Bt+1,Dt,Fn.width,Fn.height,0,Et,gt,Fn.data)}}else{pe?ft&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,0,0,Et,gt,qe[Je]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,Dt,Et,gt,qe[Je]);for(let Bt=0;Bt<tt.length;Bt++){const Qt=tt[Bt];pe?ft&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Bt+1,0,0,Et,gt,Qt.image[Je]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Bt+1,Dt,Et,gt,Qt.image[Je])}}}E(X)&&S(i.TEXTURE_CUBE_MAP),Le.__version=Ze.version,X.onUpdate&&X.onUpdate(X)}ee.__version=X.version}function Fe(ee,X,Ae,He,Ze,Le){const Nt=r.convert(Ae.format,Ae.colorSpace),xt=r.convert(Ae.type),Vt=D(Ae.internalFormat,Nt,xt,Ae.colorSpace),Lt=n.get(X),Ye=n.get(Ae);if(Ye.__renderTarget=X,!Lt.__hasExternalTextures){const qe=Math.max(1,X.width>>Le),It=Math.max(1,X.height>>Le);Ze===i.TEXTURE_3D||Ze===i.TEXTURE_2D_ARRAY?t.texImage3D(Ze,Le,Vt,qe,It,X.depth,0,Nt,xt,null):t.texImage2D(Ze,Le,Vt,qe,It,0,Nt,xt,null)}t.bindFramebuffer(i.FRAMEBUFFER,ee),it(X)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,He,Ze,Ye.__webglTexture,0,pt(X)):(Ze===i.TEXTURE_2D||Ze>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Ze<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,He,Ze,Ye.__webglTexture,Le),t.bindFramebuffer(i.FRAMEBUFFER,null)}function et(ee,X,Ae){if(i.bindRenderbuffer(i.RENDERBUFFER,ee),X.depthBuffer){const He=X.depthTexture,Ze=He&&He.isDepthTexture?He.type:null,Le=U(X.stencilBuffer,Ze),Nt=X.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,xt=pt(X);it(X)?u.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,xt,Le,X.width,X.height):Ae?i.renderbufferStorageMultisample(i.RENDERBUFFER,xt,Le,X.width,X.height):i.renderbufferStorage(i.RENDERBUFFER,Le,X.width,X.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Nt,i.RENDERBUFFER,ee)}else{const He=X.textures;for(let Ze=0;Ze<He.length;Ze++){const Le=He[Ze],Nt=r.convert(Le.format,Le.colorSpace),xt=r.convert(Le.type),Vt=D(Le.internalFormat,Nt,xt,Le.colorSpace),Lt=pt(X);Ae&&it(X)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,Lt,Vt,X.width,X.height):it(X)?u.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Lt,Vt,X.width,X.height):i.renderbufferStorage(i.RENDERBUFFER,Vt,X.width,X.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function ht(ee,X){if(X&&X.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,ee),!(X.depthTexture&&X.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const He=n.get(X.depthTexture);He.__renderTarget=X,(!He.__webglTexture||X.depthTexture.image.width!==X.width||X.depthTexture.image.height!==X.height)&&(X.depthTexture.image.width=X.width,X.depthTexture.image.height=X.height,X.depthTexture.needsUpdate=!0),re(X.depthTexture,0);const Ze=He.__webglTexture,Le=pt(X);if(X.depthTexture.format===Rp)it(X)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Ze,0,Le):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Ze,0);else if(X.depthTexture.format===Ah)it(X)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Ze,0,Le):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Ze,0);else throw new Error("Unknown depthTexture format")}function yt(ee){const X=n.get(ee),Ae=ee.isWebGLCubeRenderTarget===!0;if(X.__boundDepthTexture!==ee.depthTexture){const He=ee.depthTexture;if(X.__depthDisposeCallback&&X.__depthDisposeCallback(),He){const Ze=()=>{delete X.__boundDepthTexture,delete X.__depthDisposeCallback,He.removeEventListener("dispose",Ze)};He.addEventListener("dispose",Ze),X.__depthDisposeCallback=Ze}X.__boundDepthTexture=He}if(ee.depthTexture&&!X.__autoAllocateDepthBuffer){if(Ae)throw new Error("target.depthTexture not supported in Cube render targets");const He=ee.texture.mipmaps;He&&He.length>0?ht(X.__webglFramebuffer[0],ee):ht(X.__webglFramebuffer,ee)}else if(Ae){X.__webglDepthbuffer=[];for(let He=0;He<6;He++)if(t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer[He]),X.__webglDepthbuffer[He]===void 0)X.__webglDepthbuffer[He]=i.createRenderbuffer(),et(X.__webglDepthbuffer[He],ee,!1);else{const Ze=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Le=X.__webglDepthbuffer[He];i.bindRenderbuffer(i.RENDERBUFFER,Le),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ze,i.RENDERBUFFER,Le)}}else{const He=ee.texture.mipmaps;if(He&&He.length>0?t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer),X.__webglDepthbuffer===void 0)X.__webglDepthbuffer=i.createRenderbuffer(),et(X.__webglDepthbuffer,ee,!1);else{const Ze=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Le=X.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Le),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ze,i.RENDERBUFFER,Le)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function Xt(ee,X,Ae){const He=n.get(ee);X!==void 0&&Fe(He.__webglFramebuffer,ee,ee.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),Ae!==void 0&&yt(ee)}function Ot(ee){const X=ee.texture,Ae=n.get(ee),He=n.get(X);ee.addEventListener("dispose",z);const Ze=ee.textures,Le=ee.isWebGLCubeRenderTarget===!0,Nt=Ze.length>1;if(Nt||(He.__webglTexture===void 0&&(He.__webglTexture=i.createTexture()),He.__version=X.version,l.memory.textures++),Le){Ae.__webglFramebuffer=[];for(let xt=0;xt<6;xt++)if(X.mipmaps&&X.mipmaps.length>0){Ae.__webglFramebuffer[xt]=[];for(let Vt=0;Vt<X.mipmaps.length;Vt++)Ae.__webglFramebuffer[xt][Vt]=i.createFramebuffer()}else Ae.__webglFramebuffer[xt]=i.createFramebuffer()}else{if(X.mipmaps&&X.mipmaps.length>0){Ae.__webglFramebuffer=[];for(let xt=0;xt<X.mipmaps.length;xt++)Ae.__webglFramebuffer[xt]=i.createFramebuffer()}else Ae.__webglFramebuffer=i.createFramebuffer();if(Nt)for(let xt=0,Vt=Ze.length;xt<Vt;xt++){const Lt=n.get(Ze[xt]);Lt.__webglTexture===void 0&&(Lt.__webglTexture=i.createTexture(),l.memory.textures++)}if(ee.samples>0&&it(ee)===!1){Ae.__webglMultisampledFramebuffer=i.createFramebuffer(),Ae.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer);for(let xt=0;xt<Ze.length;xt++){const Vt=Ze[xt];Ae.__webglColorRenderbuffer[xt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,Ae.__webglColorRenderbuffer[xt]);const Lt=r.convert(Vt.format,Vt.colorSpace),Ye=r.convert(Vt.type),qe=D(Vt.internalFormat,Lt,Ye,Vt.colorSpace,ee.isXRRenderTarget===!0),It=pt(ee);i.renderbufferStorageMultisample(i.RENDERBUFFER,It,qe,ee.width,ee.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+xt,i.RENDERBUFFER,Ae.__webglColorRenderbuffer[xt])}i.bindRenderbuffer(i.RENDERBUFFER,null),ee.depthBuffer&&(Ae.__webglDepthRenderbuffer=i.createRenderbuffer(),et(Ae.__webglDepthRenderbuffer,ee,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Le){t.bindTexture(i.TEXTURE_CUBE_MAP,He.__webglTexture),de(i.TEXTURE_CUBE_MAP,X);for(let xt=0;xt<6;xt++)if(X.mipmaps&&X.mipmaps.length>0)for(let Vt=0;Vt<X.mipmaps.length;Vt++)Fe(Ae.__webglFramebuffer[xt][Vt],ee,X,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+xt,Vt);else Fe(Ae.__webglFramebuffer[xt],ee,X,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+xt,0);E(X)&&S(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Nt){for(let xt=0,Vt=Ze.length;xt<Vt;xt++){const Lt=Ze[xt],Ye=n.get(Lt);let qe=i.TEXTURE_2D;(ee.isWebGL3DRenderTarget||ee.isWebGLArrayRenderTarget)&&(qe=ee.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(qe,Ye.__webglTexture),de(qe,Lt),Fe(Ae.__webglFramebuffer,ee,Lt,i.COLOR_ATTACHMENT0+xt,qe,0),E(Lt)&&S(qe)}t.unbindTexture()}else{let xt=i.TEXTURE_2D;if((ee.isWebGL3DRenderTarget||ee.isWebGLArrayRenderTarget)&&(xt=ee.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(xt,He.__webglTexture),de(xt,X),X.mipmaps&&X.mipmaps.length>0)for(let Vt=0;Vt<X.mipmaps.length;Vt++)Fe(Ae.__webglFramebuffer[Vt],ee,X,i.COLOR_ATTACHMENT0,xt,Vt);else Fe(Ae.__webglFramebuffer,ee,X,i.COLOR_ATTACHMENT0,xt,0);E(X)&&S(xt),t.unbindTexture()}ee.depthBuffer&&yt(ee)}function ke(ee){const X=ee.textures;for(let Ae=0,He=X.length;Ae<He;Ae++){const Ze=X[Ae];if(E(Ze)){const Le=w(ee),Nt=n.get(Ze).__webglTexture;t.bindTexture(Le,Nt),S(Le),t.unbindTexture()}}}const $=[],Qe=[];function st(ee){if(ee.samples>0){if(it(ee)===!1){const X=ee.textures,Ae=ee.width,He=ee.height;let Ze=i.COLOR_BUFFER_BIT;const Le=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Nt=n.get(ee),xt=X.length>1;if(xt)for(let Lt=0;Lt<X.length;Lt++)t.bindFramebuffer(i.FRAMEBUFFER,Nt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Lt,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Nt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Lt,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Nt.__webglMultisampledFramebuffer);const Vt=ee.texture.mipmaps;Vt&&Vt.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Nt.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Nt.__webglFramebuffer);for(let Lt=0;Lt<X.length;Lt++){if(ee.resolveDepthBuffer&&(ee.depthBuffer&&(Ze|=i.DEPTH_BUFFER_BIT),ee.stencilBuffer&&ee.resolveStencilBuffer&&(Ze|=i.STENCIL_BUFFER_BIT)),xt){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Nt.__webglColorRenderbuffer[Lt]);const Ye=n.get(X[Lt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Ye,0)}i.blitFramebuffer(0,0,Ae,He,0,0,Ae,He,Ze,i.NEAREST),d===!0&&($.length=0,Qe.length=0,$.push(i.COLOR_ATTACHMENT0+Lt),ee.depthBuffer&&ee.resolveDepthBuffer===!1&&($.push(Le),Qe.push(Le),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,Qe)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,$))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),xt)for(let Lt=0;Lt<X.length;Lt++){t.bindFramebuffer(i.FRAMEBUFFER,Nt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Lt,i.RENDERBUFFER,Nt.__webglColorRenderbuffer[Lt]);const Ye=n.get(X[Lt]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Nt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Lt,i.TEXTURE_2D,Ye,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Nt.__webglMultisampledFramebuffer)}else if(ee.depthBuffer&&ee.resolveDepthBuffer===!1&&d){const X=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[X])}}}function pt(ee){return Math.min(a.maxSamples,ee.samples)}function it(ee){const X=n.get(ee);return ee.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&X.__useRenderToTexture!==!1}function bt(ee){const X=l.render.frame;x.get(ee)!==X&&(x.set(ee,X),ee.update())}function mt(ee,X){const Ae=ee.colorSpace,He=ee.format,Ze=ee.type;return ee.isCompressedTexture===!0||ee.isVideoTexture===!0||Ae!==Fr&&Ae!==qo&&(Wn.getTransfer(Ae)===xi?(He!==_a||Ze!==ca)&&Mt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):un("WebGLTextures: Unsupported texture color space:",Ae)),X}function Ct(ee){return typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement?(p.width=ee.naturalWidth||ee.width,p.height=ee.naturalHeight||ee.height):typeof VideoFrame<"u"&&ee instanceof VideoFrame?(p.width=ee.displayWidth,p.height=ee.displayHeight):(p.width=ee.width,p.height=ee.height),p}this.allocateTextureUnit=se,this.resetTextureUnits=ie,this.setTexture2D=re,this.setTexture2DArray=H,this.setTexture3D=K,this.setTextureCube=W,this.rebindTextures=Xt,this.setupRenderTarget=Ot,this.updateRenderTargetMipmap=ke,this.updateMultisampleRenderTarget=st,this.setupDepthRenderbuffer=yt,this.setupFrameBufferTexture=Fe,this.useMultisampledRTT=it}function YC(i,e){function t(n,a=qo){let r;const l=Wn.getTransfer(a);if(n===ca)return i.UNSIGNED_BYTE;if(n===gy)return i.UNSIGNED_SHORT_4_4_4_4;if(n===vy)return i.UNSIGNED_SHORT_5_5_5_1;if(n===qb)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===Kb)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===py)return i.BYTE;if(n===my)return i.SHORT;if(n===Cp)return i.UNSIGNED_SHORT;if(n===gg)return i.INT;if(n===Zo)return i.UNSIGNED_INT;if(n===ji)return i.FLOAT;if(n===wa)return i.HALF_FLOAT;if(n===Jb)return i.ALPHA;if(n===Wb)return i.RGB;if(n===_a)return i.RGBA;if(n===Rp)return i.DEPTH_COMPONENT;if(n===Ah)return i.DEPTH_STENCIL;if(n===vg)return i.RED;if(n===xg)return i.RED_INTEGER;if(n===xy)return i.RG;if(n===_y)return i.RG_INTEGER;if(n===yy)return i.RGBA_INTEGER;if(n===Xm||n===Ym||n===qm||n===Km)if(l===xi)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===Xm)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Ym)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===qm)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Km)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===Xm)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Ym)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===qm)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Km)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===b_||n===S_||n===A_||n===M_)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===b_)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===S_)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===A_)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===M_)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===E_||n===T_||n===C_)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===E_||n===T_)return l===xi?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===C_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===R_||n===w_||n===B_||n===D_||n===U_||n===O_||n===N_||n===L_||n===I_||n===P_||n===F_||n===z_||n===H_||n===G_)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===R_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===w_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===B_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===D_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===U_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===O_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===N_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===L_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===I_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===P_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===F_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===z_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===H_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===G_)return l===xi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===V_||n===k_||n===j_)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===V_)return l===xi?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===k_)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===j_)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===X_||n===Y_||n===q_||n===K_)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===X_)return r.COMPRESSED_RED_RGTC1_EXT;if(n===Y_)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===q_)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===K_)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Sh?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const y5=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,b5=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class S5{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new dS(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new hi({vertexShader:y5,fragmentShader:b5,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Xi(new Ju(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class A5 extends Hr{constructor(e,t){super();const n=this;let a=null,r=1,l=null,u="local-floor",d=1,p=null,x=null,g=null,_=null,y=null,b=null;const C=typeof XRWebGLBinding<"u",E=new S5,S={},w=t.getContextAttributes();let D=null,U=null;const F=[],N=[],z=new Ge;let j=null;const L=new Ra;L.viewport=new kn;const P=new Ra;P.viewport=new kn;const q=[L,P],ie=new NC;let se=null,ae=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(xe){let fe=F[xe];return fe===void 0&&(fe=new u_,F[xe]=fe),fe.getTargetRaySpace()},this.getControllerGrip=function(xe){let fe=F[xe];return fe===void 0&&(fe=new u_,F[xe]=fe),fe.getGripSpace()},this.getHand=function(xe){let fe=F[xe];return fe===void 0&&(fe=new u_,F[xe]=fe),fe.getHandSpace()};function re(xe){const fe=N.indexOf(xe.inputSource);if(fe===-1)return;const Fe=F[fe];Fe!==void 0&&(Fe.update(xe.inputSource,xe.frame,p||l),Fe.dispatchEvent({type:xe.type,data:xe.inputSource}))}function H(){a.removeEventListener("select",re),a.removeEventListener("selectstart",re),a.removeEventListener("selectend",re),a.removeEventListener("squeeze",re),a.removeEventListener("squeezestart",re),a.removeEventListener("squeezeend",re),a.removeEventListener("end",H),a.removeEventListener("inputsourceschange",K);for(let xe=0;xe<F.length;xe++){const fe=N[xe];fe!==null&&(N[xe]=null,F[xe].disconnect(fe))}se=null,ae=null,E.reset();for(const xe in S)delete S[xe];e.setRenderTarget(D),y=null,_=null,g=null,a=null,U=null,rt.stop(),n.isPresenting=!1,e.setPixelRatio(j),e.setSize(z.width,z.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(xe){r=xe,n.isPresenting===!0&&Mt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(xe){u=xe,n.isPresenting===!0&&Mt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||l},this.setReferenceSpace=function(xe){p=xe},this.getBaseLayer=function(){return _!==null?_:y},this.getBinding=function(){return g===null&&C&&(g=new XRWebGLBinding(a,t)),g},this.getFrame=function(){return b},this.getSession=function(){return a},this.setSession=async function(xe){if(a=xe,a!==null){if(D=e.getRenderTarget(),a.addEventListener("select",re),a.addEventListener("selectstart",re),a.addEventListener("selectend",re),a.addEventListener("squeeze",re),a.addEventListener("squeezestart",re),a.addEventListener("squeezeend",re),a.addEventListener("end",H),a.addEventListener("inputsourceschange",K),w.xrCompatible!==!0&&await t.makeXRCompatible(),j=e.getPixelRatio(),e.getSize(z),C&&"createProjectionLayer"in XRWebGLBinding.prototype){let Fe=null,et=null,ht=null;w.depth&&(ht=w.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Fe=w.stencil?Ah:Rp,et=w.stencil?Sh:Zo);const yt={colorFormat:t.RGBA8,depthFormat:ht,scaleFactor:r};g=this.getBinding(),_=g.createProjectionLayer(yt),a.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),U=new ua(_.textureWidth,_.textureHeight,{format:_a,type:ca,depthTexture:new By(_.textureWidth,_.textureHeight,et,void 0,void 0,void 0,void 0,void 0,void 0,Fe),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}else{const Fe={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:r};y=new XRWebGLLayer(a,t,Fe),a.updateRenderState({baseLayer:y}),e.setPixelRatio(1),e.setSize(y.framebufferWidth,y.framebufferHeight,!1),U=new ua(y.framebufferWidth,y.framebufferHeight,{format:_a,type:ca,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1})}U.isXRRenderTarget=!0,this.setFoveation(d),p=null,l=await a.requestReferenceSpace(u),rt.setContext(a),rt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(a!==null)return a.environmentBlendMode},this.getDepthTexture=function(){return E.getDepthTexture()};function K(xe){for(let fe=0;fe<xe.removed.length;fe++){const Fe=xe.removed[fe],et=N.indexOf(Fe);et>=0&&(N[et]=null,F[et].disconnect(Fe))}for(let fe=0;fe<xe.added.length;fe++){const Fe=xe.added[fe];let et=N.indexOf(Fe);if(et===-1){for(let yt=0;yt<F.length;yt++)if(yt>=N.length){N.push(Fe),et=yt;break}else if(N[yt]===null){N[yt]=Fe,et=yt;break}if(et===-1)break}const ht=F[et];ht&&ht.connect(Fe)}}const W=new te,me=new te;function ve(xe,fe,Fe){W.setFromMatrixPosition(fe.matrixWorld),me.setFromMatrixPosition(Fe.matrixWorld);const et=W.distanceTo(me),ht=fe.projectionMatrix.elements,yt=Fe.projectionMatrix.elements,Xt=ht[14]/(ht[10]-1),Ot=ht[14]/(ht[10]+1),ke=(ht[9]+1)/ht[5],$=(ht[9]-1)/ht[5],Qe=(ht[8]-1)/ht[0],st=(yt[8]+1)/yt[0],pt=Xt*Qe,it=Xt*st,bt=et/(-Qe+st),mt=bt*-Qe;if(fe.matrixWorld.decompose(xe.position,xe.quaternion,xe.scale),xe.translateX(mt),xe.translateZ(bt),xe.matrixWorld.compose(xe.position,xe.quaternion,xe.scale),xe.matrixWorldInverse.copy(xe.matrixWorld).invert(),ht[10]===-1)xe.projectionMatrix.copy(fe.projectionMatrix),xe.projectionMatrixInverse.copy(fe.projectionMatrixInverse);else{const Ct=Xt+bt,ee=Ot+bt,X=pt-mt,Ae=it+(et-mt),He=ke*Ot/ee*Ct,Ze=$*Ot/ee*Ct;xe.projectionMatrix.makePerspective(X,Ae,He,Ze,Ct,ee),xe.projectionMatrixInverse.copy(xe.projectionMatrix).invert()}}function Q(xe,fe){fe===null?xe.matrixWorld.copy(xe.matrix):xe.matrixWorld.multiplyMatrices(fe.matrixWorld,xe.matrix),xe.matrixWorldInverse.copy(xe.matrixWorld).invert()}this.updateCamera=function(xe){if(a===null)return;let fe=xe.near,Fe=xe.far;E.texture!==null&&(E.depthNear>0&&(fe=E.depthNear),E.depthFar>0&&(Fe=E.depthFar)),ie.near=P.near=L.near=fe,ie.far=P.far=L.far=Fe,(se!==ie.near||ae!==ie.far)&&(a.updateRenderState({depthNear:ie.near,depthFar:ie.far}),se=ie.near,ae=ie.far),ie.layers.mask=xe.layers.mask|6,L.layers.mask=ie.layers.mask&3,P.layers.mask=ie.layers.mask&5;const et=xe.parent,ht=ie.cameras;Q(ie,et);for(let yt=0;yt<ht.length;yt++)Q(ht[yt],et);ht.length===2?ve(ie,L,P):ie.projectionMatrix.copy(L.projectionMatrix),de(xe,ie,et)};function de(xe,fe,Fe){Fe===null?xe.matrix.copy(fe.matrixWorld):(xe.matrix.copy(Fe.matrixWorld),xe.matrix.invert(),xe.matrix.multiply(fe.matrixWorld)),xe.matrix.decompose(xe.position,xe.quaternion,xe.scale),xe.updateMatrixWorld(!0),xe.projectionMatrix.copy(fe.projectionMatrix),xe.projectionMatrixInverse.copy(fe.projectionMatrixInverse),xe.isPerspectiveCamera&&(xe.fov=Op*2*Math.atan(1/xe.projectionMatrix.elements[5]),xe.zoom=1)}this.getCamera=function(){return ie},this.getFoveation=function(){if(!(_===null&&y===null))return d},this.setFoveation=function(xe){d=xe,_!==null&&(_.fixedFoveation=xe),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=xe)},this.hasDepthSensing=function(){return E.texture!==null},this.getDepthSensingMesh=function(){return E.getMesh(ie)},this.getCameraTexture=function(xe){return S[xe]};let Te=null;function Me(xe,fe){if(x=fe.getViewerPose(p||l),b=fe,x!==null){const Fe=x.views;y!==null&&(e.setRenderTargetFramebuffer(U,y.framebuffer),e.setRenderTarget(U));let et=!1;Fe.length!==ie.cameras.length&&(ie.cameras.length=0,et=!0);for(let Ot=0;Ot<Fe.length;Ot++){const ke=Fe[Ot];let $=null;if(y!==null)$=y.getViewport(ke);else{const st=g.getViewSubImage(_,ke);$=st.viewport,Ot===0&&(e.setRenderTargetTextures(U,st.colorTexture,st.depthStencilTexture),e.setRenderTarget(U))}let Qe=q[Ot];Qe===void 0&&(Qe=new Ra,Qe.layers.enable(Ot),Qe.viewport=new kn,q[Ot]=Qe),Qe.matrix.fromArray(ke.transform.matrix),Qe.matrix.decompose(Qe.position,Qe.quaternion,Qe.scale),Qe.projectionMatrix.fromArray(ke.projectionMatrix),Qe.projectionMatrixInverse.copy(Qe.projectionMatrix).invert(),Qe.viewport.set($.x,$.y,$.width,$.height),Ot===0&&(ie.matrix.copy(Qe.matrix),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale)),et===!0&&ie.cameras.push(Qe)}const ht=a.enabledFeatures;if(ht&&ht.includes("depth-sensing")&&a.depthUsage=="gpu-optimized"&&C){g=n.getBinding();const Ot=g.getDepthInformation(Fe[0]);Ot&&Ot.isValid&&Ot.texture&&E.init(Ot,a.renderState)}if(ht&&ht.includes("camera-access")&&C){e.state.unbindTexture(),g=n.getBinding();for(let Ot=0;Ot<Fe.length;Ot++){const ke=Fe[Ot].camera;if(ke){let $=S[ke];$||($=new dS,S[ke]=$);const Qe=g.getCameraImage(ke);$.sourceTexture=Qe}}}}for(let Fe=0;Fe<F.length;Fe++){const et=N[Fe],ht=F[Fe];et!==null&&ht!==void 0&&ht.update(et,fe,p||l)}Te&&Te(xe,fe),fe.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:fe}),b=null}const rt=new GC;rt.setAnimationLoop(Me),this.setAnimationLoop=function(xe){Te=xe},this.dispose=function(){}}}const ih=new zr,M5=new Wt;function E5(i,e){function t(E,S){E.matrixAutoUpdate===!0&&E.updateMatrix(),S.value.copy(E.matrix)}function n(E,S){S.color.getRGB(E.fogColor.value,YT(i)),S.isFog?(E.fogNear.value=S.near,E.fogFar.value=S.far):S.isFogExp2&&(E.fogDensity.value=S.density)}function a(E,S,w,D,U){S.isMeshBasicMaterial||S.isMeshLambertMaterial?r(E,S):S.isMeshToonMaterial?(r(E,S),g(E,S)):S.isMeshPhongMaterial?(r(E,S),x(E,S)):S.isMeshStandardMaterial?(r(E,S),_(E,S),S.isMeshPhysicalMaterial&&y(E,S,U)):S.isMeshMatcapMaterial?(r(E,S),b(E,S)):S.isMeshDepthMaterial?r(E,S):S.isMeshDistanceMaterial?(r(E,S),C(E,S)):S.isMeshNormalMaterial?r(E,S):S.isLineBasicMaterial?(l(E,S),S.isLineDashedMaterial&&u(E,S)):S.isPointsMaterial?d(E,S,w,D):S.isSpriteMaterial?p(E,S):S.isShadowMaterial?(E.color.value.copy(S.color),E.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function r(E,S){E.opacity.value=S.opacity,S.color&&E.diffuse.value.copy(S.color),S.emissive&&E.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(E.map.value=S.map,t(S.map,E.mapTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.bumpMap&&(E.bumpMap.value=S.bumpMap,t(S.bumpMap,E.bumpMapTransform),E.bumpScale.value=S.bumpScale,S.side===oa&&(E.bumpScale.value*=-1)),S.normalMap&&(E.normalMap.value=S.normalMap,t(S.normalMap,E.normalMapTransform),E.normalScale.value.copy(S.normalScale),S.side===oa&&E.normalScale.value.negate()),S.displacementMap&&(E.displacementMap.value=S.displacementMap,t(S.displacementMap,E.displacementMapTransform),E.displacementScale.value=S.displacementScale,E.displacementBias.value=S.displacementBias),S.emissiveMap&&(E.emissiveMap.value=S.emissiveMap,t(S.emissiveMap,E.emissiveMapTransform)),S.specularMap&&(E.specularMap.value=S.specularMap,t(S.specularMap,E.specularMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest);const w=e.get(S),D=w.envMap,U=w.envMapRotation;D&&(E.envMap.value=D,ih.copy(U),ih.x*=-1,ih.y*=-1,ih.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(ih.y*=-1,ih.z*=-1),E.envMapRotation.value.setFromMatrix4(M5.makeRotationFromEuler(ih)),E.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=S.reflectivity,E.ior.value=S.ior,E.refractionRatio.value=S.refractionRatio),S.lightMap&&(E.lightMap.value=S.lightMap,E.lightMapIntensity.value=S.lightMapIntensity,t(S.lightMap,E.lightMapTransform)),S.aoMap&&(E.aoMap.value=S.aoMap,E.aoMapIntensity.value=S.aoMapIntensity,t(S.aoMap,E.aoMapTransform))}function l(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,S.map&&(E.map.value=S.map,t(S.map,E.mapTransform))}function u(E,S){E.dashSize.value=S.dashSize,E.totalSize.value=S.dashSize+S.gapSize,E.scale.value=S.scale}function d(E,S,w,D){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.size.value=S.size*w,E.scale.value=D*.5,S.map&&(E.map.value=S.map,t(S.map,E.uvTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest)}function p(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.rotation.value=S.rotation,S.map&&(E.map.value=S.map,t(S.map,E.mapTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest)}function x(E,S){E.specular.value.copy(S.specular),E.shininess.value=Math.max(S.shininess,1e-4)}function g(E,S){S.gradientMap&&(E.gradientMap.value=S.gradientMap)}function _(E,S){E.metalness.value=S.metalness,S.metalnessMap&&(E.metalnessMap.value=S.metalnessMap,t(S.metalnessMap,E.metalnessMapTransform)),E.roughness.value=S.roughness,S.roughnessMap&&(E.roughnessMap.value=S.roughnessMap,t(S.roughnessMap,E.roughnessMapTransform)),S.envMap&&(E.envMapIntensity.value=S.envMapIntensity)}function y(E,S,w){E.ior.value=S.ior,S.sheen>0&&(E.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),E.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(E.sheenColorMap.value=S.sheenColorMap,t(S.sheenColorMap,E.sheenColorMapTransform)),S.sheenRoughnessMap&&(E.sheenRoughnessMap.value=S.sheenRoughnessMap,t(S.sheenRoughnessMap,E.sheenRoughnessMapTransform))),S.clearcoat>0&&(E.clearcoat.value=S.clearcoat,E.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(E.clearcoatMap.value=S.clearcoatMap,t(S.clearcoatMap,E.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,t(S.clearcoatRoughnessMap,E.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(E.clearcoatNormalMap.value=S.clearcoatNormalMap,t(S.clearcoatNormalMap,E.clearcoatNormalMapTransform),E.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===oa&&E.clearcoatNormalScale.value.negate())),S.dispersion>0&&(E.dispersion.value=S.dispersion),S.iridescence>0&&(E.iridescence.value=S.iridescence,E.iridescenceIOR.value=S.iridescenceIOR,E.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(E.iridescenceMap.value=S.iridescenceMap,t(S.iridescenceMap,E.iridescenceMapTransform)),S.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=S.iridescenceThicknessMap,t(S.iridescenceThicknessMap,E.iridescenceThicknessMapTransform))),S.transmission>0&&(E.transmission.value=S.transmission,E.transmissionSamplerMap.value=w.texture,E.transmissionSamplerSize.value.set(w.width,w.height),S.transmissionMap&&(E.transmissionMap.value=S.transmissionMap,t(S.transmissionMap,E.transmissionMapTransform)),E.thickness.value=S.thickness,S.thicknessMap&&(E.thicknessMap.value=S.thicknessMap,t(S.thicknessMap,E.thicknessMapTransform)),E.attenuationDistance.value=S.attenuationDistance,E.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(E.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(E.anisotropyMap.value=S.anisotropyMap,t(S.anisotropyMap,E.anisotropyMapTransform))),E.specularIntensity.value=S.specularIntensity,E.specularColor.value.copy(S.specularColor),S.specularColorMap&&(E.specularColorMap.value=S.specularColorMap,t(S.specularColorMap,E.specularColorMapTransform)),S.specularIntensityMap&&(E.specularIntensityMap.value=S.specularIntensityMap,t(S.specularIntensityMap,E.specularIntensityMapTransform))}function b(E,S){S.matcap&&(E.matcap.value=S.matcap)}function C(E,S){const w=e.get(S).light;E.referencePosition.value.setFromMatrixPosition(w.matrixWorld),E.nearDistance.value=w.shadow.camera.near,E.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:a}}function T5(i,e,t,n){let a={},r={},l=[];const u=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function d(w,D){const U=D.program;n.uniformBlockBinding(w,U)}function p(w,D){let U=a[w.id];U===void 0&&(b(w),U=x(w),a[w.id]=U,w.addEventListener("dispose",E));const F=D.program;n.updateUBOMapping(w,F);const N=e.render.frame;r[w.id]!==N&&(_(w),r[w.id]=N)}function x(w){const D=g();w.__bindingPointIndex=D;const U=i.createBuffer(),F=w.__size,N=w.usage;return i.bindBuffer(i.UNIFORM_BUFFER,U),i.bufferData(i.UNIFORM_BUFFER,F,N),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,D,U),U}function g(){for(let w=0;w<u;w++)if(l.indexOf(w)===-1)return l.push(w),w;return un("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(w){const D=a[w.id],U=w.uniforms,F=w.__cache;i.bindBuffer(i.UNIFORM_BUFFER,D);for(let N=0,z=U.length;N<z;N++){const j=Array.isArray(U[N])?U[N]:[U[N]];for(let L=0,P=j.length;L<P;L++){const q=j[L];if(y(q,N,L,F)===!0){const ie=q.__offset,se=Array.isArray(q.value)?q.value:[q.value];let ae=0;for(let re=0;re<se.length;re++){const H=se[re],K=C(H);typeof H=="number"||typeof H=="boolean"?(q.__data[0]=H,i.bufferSubData(i.UNIFORM_BUFFER,ie+ae,q.__data)):H.isMatrix3?(q.__data[0]=H.elements[0],q.__data[1]=H.elements[1],q.__data[2]=H.elements[2],q.__data[3]=0,q.__data[4]=H.elements[3],q.__data[5]=H.elements[4],q.__data[6]=H.elements[5],q.__data[7]=0,q.__data[8]=H.elements[6],q.__data[9]=H.elements[7],q.__data[10]=H.elements[8],q.__data[11]=0):(H.toArray(q.__data,ae),ae+=K.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,ie,q.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function y(w,D,U,F){const N=w.value,z=D+"_"+U;if(F[z]===void 0)return typeof N=="number"||typeof N=="boolean"?F[z]=N:F[z]=N.clone(),!0;{const j=F[z];if(typeof N=="number"||typeof N=="boolean"){if(j!==N)return F[z]=N,!0}else if(j.equals(N)===!1)return j.copy(N),!0}return!1}function b(w){const D=w.uniforms;let U=0;const F=16;for(let z=0,j=D.length;z<j;z++){const L=Array.isArray(D[z])?D[z]:[D[z]];for(let P=0,q=L.length;P<q;P++){const ie=L[P],se=Array.isArray(ie.value)?ie.value:[ie.value];for(let ae=0,re=se.length;ae<re;ae++){const H=se[ae],K=C(H),W=U%F,me=W%K.boundary,ve=W+me;U+=me,ve!==0&&F-ve<K.storage&&(U+=F-ve),ie.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),ie.__offset=U,U+=K.storage}}}const N=U%F;return N>0&&(U+=F-N),w.__size=U,w.__cache={},this}function C(w){const D={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(D.boundary=4,D.storage=4):w.isVector2?(D.boundary=8,D.storage=8):w.isVector3||w.isColor?(D.boundary=16,D.storage=12):w.isVector4?(D.boundary=16,D.storage=16):w.isMatrix3?(D.boundary=48,D.storage=48):w.isMatrix4?(D.boundary=64,D.storage=64):w.isTexture?Mt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Mt("WebGLRenderer: Unsupported uniform value type.",w),D}function E(w){const D=w.target;D.removeEventListener("dispose",E);const U=l.indexOf(D.__bindingPointIndex);l.splice(U,1),i.deleteBuffer(a[D.id]),delete a[D.id],delete r[D.id]}function S(){for(const w in a)i.deleteBuffer(a[w]);l=[],a={},r={}}return{bind:d,update:p,dispose:S}}const C5=new Uint16Array([11481,15204,11534,15171,11808,15015,12385,14843,12894,14716,13396,14600,13693,14483,13976,14366,14237,14171,14405,13961,14511,13770,14605,13598,14687,13444,14760,13305,14822,13066,14876,12857,14923,12675,14963,12517,14997,12379,15025,12230,15049,12023,15070,11843,15086,11687,15100,11551,15111,11433,15120,11330,15127,11217,15132,11060,15135,10922,15138,10801,15139,10695,15139,10600,13012,14923,13020,14917,13064,14886,13176,14800,13349,14666,13513,14526,13724,14398,13960,14230,14200,14020,14383,13827,14488,13651,14583,13491,14667,13348,14740,13132,14803,12908,14856,12713,14901,12542,14938,12394,14968,12241,14992,12017,15010,11822,15024,11654,15034,11507,15041,11380,15044,11269,15044,11081,15042,10913,15037,10764,15031,10635,15023,10520,15014,10419,15003,10330,13657,14676,13658,14673,13670,14660,13698,14622,13750,14547,13834,14442,13956,14317,14112,14093,14291,13889,14407,13704,14499,13538,14586,13389,14664,13201,14733,12966,14792,12758,14842,12577,14882,12418,14915,12272,14940,12033,14959,11826,14972,11646,14980,11490,14983,11355,14983,11212,14979,11008,14971,10830,14961,10675,14950,10540,14936,10420,14923,10315,14909,10204,14894,10041,14089,14460,14090,14459,14096,14452,14112,14431,14141,14388,14186,14305,14252,14130,14341,13941,14399,13756,14467,13585,14539,13430,14610,13272,14677,13026,14737,12808,14790,12617,14833,12449,14869,12303,14896,12065,14916,11845,14929,11655,14937,11490,14939,11347,14936,11184,14930,10970,14921,10783,14912,10621,14900,10480,14885,10356,14867,10247,14848,10062,14827,9894,14805,9745,14400,14208,14400,14206,14402,14198,14406,14174,14415,14122,14427,14035,14444,13913,14469,13767,14504,13613,14548,13463,14598,13324,14651,13082,14704,12858,14752,12658,14795,12483,14831,12330,14860,12106,14881,11875,14895,11675,14903,11501,14905,11351,14903,11178,14900,10953,14892,10757,14880,10589,14865,10442,14847,10313,14827,10162,14805,9965,14782,9792,14757,9642,14731,9507,14562,13883,14562,13883,14563,13877,14566,13862,14570,13830,14576,13773,14584,13689,14595,13582,14613,13461,14637,13336,14668,13120,14704,12897,14741,12695,14776,12516,14808,12358,14835,12150,14856,11910,14870,11701,14878,11519,14882,11361,14884,11187,14880,10951,14871,10748,14858,10572,14842,10418,14823,10286,14801,10099,14777,9897,14751,9722,14725,9567,14696,9430,14666,9309,14702,13604,14702,13604,14702,13600,14703,13591,14705,13570,14707,13533,14709,13477,14712,13400,14718,13305,14727,13106,14743,12907,14762,12716,14784,12539,14807,12380,14827,12190,14844,11943,14855,11727,14863,11539,14870,11376,14871,11204,14868,10960,14858,10748,14845,10565,14829,10406,14809,10269,14786,10058,14761,9852,14734,9671,14705,9512,14674,9374,14641,9253,14608,9076,14821,13366,14821,13365,14821,13364,14821,13358,14821,13344,14821,13320,14819,13252,14817,13145,14815,13011,14814,12858,14817,12698,14823,12539,14832,12389,14841,12214,14850,11968,14856,11750,14861,11558,14866,11390,14867,11226,14862,10972,14853,10754,14840,10565,14823,10401,14803,10259,14780,10032,14754,9820,14725,9635,14694,9473,14661,9333,14627,9203,14593,8988,14557,8798,14923,13014,14922,13014,14922,13012,14922,13004,14920,12987,14919,12957,14915,12907,14909,12834,14902,12738,14894,12623,14888,12498,14883,12370,14880,12203,14878,11970,14875,11759,14873,11569,14874,11401,14872,11243,14865,10986,14855,10762,14842,10568,14825,10401,14804,10255,14781,10017,14754,9799,14725,9611,14692,9445,14658,9301,14623,9139,14587,8920,14548,8729,14509,8562,15008,12672,15008,12672,15008,12671,15007,12667,15005,12656,15001,12637,14997,12605,14989,12556,14978,12490,14966,12407,14953,12313,14940,12136,14927,11934,14914,11742,14903,11563,14896,11401,14889,11247,14879,10992,14866,10767,14851,10570,14833,10400,14812,10252,14789,10007,14761,9784,14731,9592,14698,9424,14663,9279,14627,9088,14588,8868,14548,8676,14508,8508,14467,8360,15080,12386,15080,12386,15079,12385,15078,12383,15076,12378,15072,12367,15066,12347,15057,12315,15045,12253,15030,12138,15012,11998,14993,11845,14972,11685,14951,11530,14935,11383,14920,11228,14904,10981,14887,10762,14870,10567,14850,10397,14827,10248,14803,9997,14774,9771,14743,9578,14710,9407,14674,9259,14637,9048,14596,8826,14555,8632,14514,8464,14471,8317,14427,8182,15139,12008,15139,12008,15138,12008,15137,12007,15135,12003,15130,11990,15124,11969,15115,11929,15102,11872,15086,11794,15064,11693,15041,11581,15013,11459,14987,11336,14966,11170,14944,10944,14921,10738,14898,10552,14875,10387,14850,10239,14824,9983,14794,9758,14762,9563,14728,9392,14692,9244,14653,9014,14611,8791,14569,8597,14526,8427,14481,8281,14436,8110,14391,7885,15188,11617,15188,11617,15187,11617,15186,11618,15183,11617,15179,11612,15173,11601,15163,11581,15150,11546,15133,11495,15110,11427,15083,11346,15051,11246,15024,11057,14996,10868,14967,10687,14938,10517,14911,10362,14882,10206,14853,9956,14821,9737,14787,9543,14752,9375,14715,9228,14675,8980,14632,8760,14589,8565,14544,8395,14498,8248,14451,8049,14404,7824,14357,7630,15228,11298,15228,11298,15227,11299,15226,11301,15223,11303,15219,11302,15213,11299,15204,11290,15191,11271,15174,11217,15150,11129,15119,11015,15087,10886,15057,10744,15024,10599,14990,10455,14957,10318,14924,10143,14891,9911,14856,9701,14820,9516,14782,9352,14744,9200,14703,8946,14659,8725,14615,8533,14568,8366,14521,8220,14472,7992,14423,7770,14374,7578,14315,7408,15260,10819,15260,10819,15259,10822,15258,10826,15256,10832,15251,10836,15246,10841,15237,10838,15225,10821,15207,10788,15183,10734,15151,10660,15120,10571,15087,10469,15049,10359,15012,10249,14974,10041,14937,9837,14900,9647,14860,9475,14820,9320,14779,9147,14736,8902,14691,8688,14646,8499,14598,8335,14549,8189,14499,7940,14448,7720,14397,7529,14347,7363,14256,7218,15285,10410,15285,10411,15285,10413,15284,10418,15282,10425,15278,10434,15272,10442,15264,10449,15252,10445,15235,10433,15210,10403,15179,10358,15149,10301,15113,10218,15073,10059,15033,9894,14991,9726,14951,9565,14909,9413,14865,9273,14822,9073,14777,8845,14730,8641,14682,8459,14633,8300,14583,8129,14531,7883,14479,7670,14426,7482,14373,7321,14305,7176,14201,6939,15305,9939,15305,9940,15305,9945,15304,9955,15302,9967,15298,9989,15293,10010,15286,10033,15274,10044,15258,10045,15233,10022,15205,9975,15174,9903,15136,9808,15095,9697,15053,9578,15009,9451,14965,9327,14918,9198,14871,8973,14825,8766,14775,8579,14725,8408,14675,8259,14622,8058,14569,7821,14515,7615,14460,7435,14405,7276,14350,7108,14256,6866,14149,6653,15321,9444,15321,9445,15321,9448,15320,9458,15317,9470,15314,9490,15310,9515,15302,9540,15292,9562,15276,9579,15251,9577,15226,9559,15195,9519,15156,9463,15116,9389,15071,9304,15025,9208,14978,9023,14927,8838,14878,8661,14827,8496,14774,8344,14722,8206,14667,7973,14612,7749,14556,7555,14499,7382,14443,7229,14385,7025,14322,6791,14210,6588,14100,6409,15333,8920,15333,8921,15332,8927,15332,8943,15329,8965,15326,9002,15322,9048,15316,9106,15307,9162,15291,9204,15267,9221,15244,9221,15212,9196,15175,9134,15133,9043,15088,8930,15040,8801,14990,8665,14938,8526,14886,8391,14830,8261,14775,8087,14719,7866,14661,7664,14603,7482,14544,7322,14485,7178,14426,6936,14367,6713,14281,6517,14166,6348,14054,6198,15341,8360,15341,8361,15341,8366,15341,8379,15339,8399,15336,8431,15332,8473,15326,8527,15318,8585,15302,8632,15281,8670,15258,8690,15227,8690,15191,8664,15149,8612,15104,8543,15055,8456,15001,8360,14948,8259,14892,8122,14834,7923,14776,7734,14716,7558,14656,7397,14595,7250,14534,7070,14472,6835,14410,6628,14350,6443,14243,6283,14125,6135,14010,5889,15348,7715,15348,7717,15348,7725,15347,7745,15345,7780,15343,7836,15339,7905,15334,8e3,15326,8103,15310,8193,15293,8239,15270,8270,15240,8287,15204,8283,15163,8260,15118,8223,15067,8143,15014,8014,14958,7873,14899,7723,14839,7573,14778,7430,14715,7293,14652,7164,14588,6931,14524,6720,14460,6531,14396,6362,14330,6210,14207,6015,14086,5781,13969,5576,15352,7114,15352,7116,15352,7128,15352,7159,15350,7195,15348,7237,15345,7299,15340,7374,15332,7457,15317,7544,15301,7633,15280,7703,15251,7754,15216,7775,15176,7767,15131,7733,15079,7670,15026,7588,14967,7492,14906,7387,14844,7278,14779,7171,14714,6965,14648,6770,14581,6587,14515,6420,14448,6269,14382,6123,14299,5881,14172,5665,14049,5477,13929,5310,15355,6329,15355,6330,15355,6339,15355,6362,15353,6410,15351,6472,15349,6572,15344,6688,15337,6835,15323,6985,15309,7142,15287,7220,15260,7277,15226,7310,15188,7326,15142,7318,15090,7285,15036,7239,14976,7177,14914,7045,14849,6892,14782,6736,14714,6581,14645,6433,14576,6293,14506,6164,14438,5946,14369,5733,14270,5540,14140,5369,14014,5216,13892,5043,15357,5483,15357,5484,15357,5496,15357,5528,15356,5597,15354,5692,15351,5835,15347,6011,15339,6195,15328,6317,15314,6446,15293,6566,15268,6668,15235,6746,15197,6796,15152,6811,15101,6790,15046,6748,14985,6673,14921,6583,14854,6479,14785,6371,14714,6259,14643,6149,14571,5946,14499,5750,14428,5567,14358,5401,14242,5250,14109,5111,13980,4870,13856,4657,15359,4555,15359,4557,15358,4573,15358,4633,15357,4715,15355,4841,15353,5061,15349,5216,15342,5391,15331,5577,15318,5770,15299,5967,15274,6150,15243,6223,15206,6280,15161,6310,15111,6317,15055,6300,14994,6262,14928,6208,14860,6141,14788,5994,14715,5838,14641,5684,14566,5529,14492,5384,14418,5247,14346,5121,14216,4892,14079,4682,13948,4496,13822,4330,15359,3498,15359,3501,15359,3520,15359,3598,15358,3719,15356,3860,15355,4137,15351,4305,15344,4563,15334,4809,15321,5116,15303,5273,15280,5418,15250,5547,15214,5653,15170,5722,15120,5761,15064,5763,15002,5733,14935,5673,14865,5597,14792,5504,14716,5400,14640,5294,14563,5185,14486,5041,14410,4841,14335,4655,14191,4482,14051,4325,13918,4183,13790,4012,15360,2282,15360,2285,15360,2306,15360,2401,15359,2547,15357,2748,15355,3103,15352,3349,15345,3675,15336,4020,15324,4272,15307,4496,15285,4716,15255,4908,15220,5086,15178,5170,15128,5214,15072,5234,15010,5231,14943,5206,14871,5166,14796,5102,14718,4971,14639,4833,14559,4687,14480,4541,14402,4401,14315,4268,14167,4142,14025,3958,13888,3747,13759,3556,15360,923,15360,925,15360,946,15360,1052,15359,1214,15357,1494,15356,1892,15352,2274,15346,2663,15338,3099,15326,3393,15309,3679,15288,3980,15260,4183,15226,4325,15185,4437,15136,4517,15080,4570,15018,4591,14950,4581,14877,4545,14800,4485,14720,4411,14638,4325,14556,4231,14475,4136,14395,3988,14297,3803,14145,3628,13999,3465,13861,3314,13729,3177,15360,263,15360,264,15360,272,15360,325,15359,407,15358,548,15356,780,15352,1144,15347,1580,15339,2099,15328,2425,15312,2795,15292,3133,15264,3329,15232,3517,15191,3689,15143,3819,15088,3923,15025,3978,14956,3999,14882,3979,14804,3931,14722,3855,14639,3756,14554,3645,14470,3529,14388,3409,14279,3289,14124,3173,13975,3055,13834,2848,13701,2658,15360,49,15360,49,15360,52,15360,75,15359,111,15358,201,15356,283,15353,519,15348,726,15340,1045,15329,1415,15314,1795,15295,2173,15269,2410,15237,2649,15197,2866,15150,3054,15095,3140,15032,3196,14963,3228,14888,3236,14808,3224,14725,3191,14639,3146,14553,3088,14466,2976,14382,2836,14262,2692,14103,2549,13952,2409,13808,2278,13674,2154,15360,4,15360,4,15360,4,15360,13,15359,33,15358,59,15357,112,15353,199,15348,302,15341,456,15331,628,15316,827,15297,1082,15272,1332,15241,1601,15202,1851,15156,2069,15101,2172,15039,2256,14970,2314,14894,2348,14813,2358,14728,2344,14640,2311,14551,2263,14463,2203,14376,2133,14247,2059,14084,1915,13930,1761,13784,1609,13648,1464,15360,0,15360,0,15360,0,15360,3,15359,18,15358,26,15357,53,15354,80,15348,97,15341,165,15332,238,15318,326,15299,427,15275,529,15245,654,15207,771,15161,885,15108,994,15046,1089,14976,1170,14900,1229,14817,1266,14731,1284,14641,1282,14550,1260,14460,1223,14370,1174,14232,1116,14066,1050,13909,981,13761,910,13623,839]);let bc=null;function R5(){return bc===null&&(bc=new ho(C5,32,32,xy,wa),bc.minFilter=In,bc.magFilter=In,bc.wrapS=ea,bc.wrapT=ea,bc.generateMipmaps=!1,bc.needsUpdate=!0),bc}class PS{constructor(e={}){const{canvas:t=kT(),context:n=null,depth:a=!0,stencil:r=!1,alpha:l=!1,antialias:u=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:p=!1,powerPreference:x="default",failIfMajorPerformanceCaveat:g=!1,reversedDepthBuffer:_=!1}=e;this.isWebGLRenderer=!0;let y;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");y=n.getContextAttributes().alpha}else y=l;const b=new Set([yy,_y,xg]),C=new Set([ca,Zo,Cp,Sh,gy,vy]),E=new Uint32Array(4),S=new Int32Array(4);let w=null,D=null;const U=[],F=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Jo,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const N=this;let z=!1;this._outputColorSpace=ti;let j=0,L=0,P=null,q=-1,ie=null;const se=new kn,ae=new kn;let re=null;const H=new ut(0);let K=0,W=t.width,me=t.height,ve=1,Q=null,de=null;const Te=new kn(0,0,W,me),Me=new kn(0,0,W,me);let rt=!1;const xe=new Gp;let fe=!1,Fe=!1;const et=new Wt,ht=new te,yt=new kn,Xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Ot=!1;function ke(){return P===null?ve:1}let $=n;function Qe(V,ne){return t.getContext(V,ne)}try{const V={alpha:!0,depth:a,stencil:r,antialias:u,premultipliedAlpha:d,preserveDrawingBuffer:p,powerPreference:x,failIfMajorPerformanceCaveat:g};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Dh}`),t.addEventListener("webglcontextlost",tt,!1),t.addEventListener("webglcontextrestored",Je,!1),t.addEventListener("webglcontextcreationerror",Bt,!1),$===null){const ne="webgl2";if($=Qe(ne,V),$===null)throw Qe(ne)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(V){throw V("WebGLRenderer: "+V.message),V}let st,pt,it,bt,mt,Ct,ee,X,Ae,He,Ze,Le,Nt,xt,Vt,Lt,Ye,qe,It,Et,gt,Dt,pe,Ue;function ft(){st=new F4($),st.init(),Dt=new YC($,st),pt=new w4($,st,e,Dt),it=new x5($,st),pt.reversedDepthBuffer&&_&&it.buffers.depth.setReversed(!0),bt=new G4($),mt=new s5,Ct=new _5($,st,it,mt,pt,Dt,bt),ee=new D4(N),X=new P4(N),Ae=new XO($),pe=new C4($,Ae),He=new z4($,Ae,bt,pe),Ze=new k4($,He,Ae,bt),It=new V4($,pt,Ct),Lt=new B4(mt),Le=new a5(N,ee,X,st,pt,pe,Lt),Nt=new E5(N,mt),xt=new o5,Vt=new d5(st),qe=new T4(N,ee,X,it,Ze,y,d),Ye=new g5(N,Ze,pt),Ue=new T5($,bt,pt,it),Et=new R4($,st,bt),gt=new H4($,st,bt),bt.programs=Le.programs,N.capabilities=pt,N.extensions=st,N.properties=mt,N.renderLists=xt,N.shadowMap=Ye,N.state=it,N.info=bt}ft();const vt=new A5(N,$);this.xr=vt,this.getContext=function(){return $},this.getContextAttributes=function(){return $.getContextAttributes()},this.forceContextLoss=function(){const V=st.get("WEBGL_lose_context");V&&V.loseContext()},this.forceContextRestore=function(){const V=st.get("WEBGL_lose_context");V&&V.restoreContext()},this.getPixelRatio=function(){return ve},this.setPixelRatio=function(V){V!==void 0&&(ve=V,this.setSize(W,me,!1))},this.getSize=function(V){return V.set(W,me)},this.setSize=function(V,ne,le=!0){if(vt.isPresenting){Mt("WebGLRenderer: Can't change size while VR device is presenting.");return}W=V,me=ne,t.width=Math.floor(V*ve),t.height=Math.floor(ne*ve),le===!0&&(t.style.width=V+"px",t.style.height=ne+"px"),this.setViewport(0,0,V,ne)},this.getDrawingBufferSize=function(V){return V.set(W*ve,me*ve).floor()},this.setDrawingBufferSize=function(V,ne,le){W=V,me=ne,ve=le,t.width=Math.floor(V*le),t.height=Math.floor(ne*le),this.setViewport(0,0,V,ne)},this.getCurrentViewport=function(V){return V.copy(se)},this.getViewport=function(V){return V.copy(Te)},this.setViewport=function(V,ne,le,_e){V.isVector4?Te.set(V.x,V.y,V.z,V.w):Te.set(V,ne,le,_e),it.viewport(se.copy(Te).multiplyScalar(ve).round())},this.getScissor=function(V){return V.copy(Me)},this.setScissor=function(V,ne,le,_e){V.isVector4?Me.set(V.x,V.y,V.z,V.w):Me.set(V,ne,le,_e),it.scissor(ae.copy(Me).multiplyScalar(ve).round())},this.getScissorTest=function(){return rt},this.setScissorTest=function(V){it.setScissorTest(rt=V)},this.setOpaqueSort=function(V){Q=V},this.setTransparentSort=function(V){de=V},this.getClearColor=function(V){return V.copy(qe.getClearColor())},this.setClearColor=function(){qe.setClearColor(...arguments)},this.getClearAlpha=function(){return qe.getClearAlpha()},this.setClearAlpha=function(){qe.setClearAlpha(...arguments)},this.clear=function(V=!0,ne=!0,le=!0){let _e=0;if(V){let oe=!1;if(P!==null){const Ne=P.texture.format;oe=b.has(Ne)}if(oe){const Ne=P.texture.type,je=C.has(Ne),$e=qe.getClearColor(),ct=qe.getClearAlpha(),_t=$e.r,Rt=$e.g,Tt=$e.b;je?(E[0]=_t,E[1]=Rt,E[2]=Tt,E[3]=ct,$.clearBufferuiv($.COLOR,0,E)):(S[0]=_t,S[1]=Rt,S[2]=Tt,S[3]=ct,$.clearBufferiv($.COLOR,0,S))}else _e|=$.COLOR_BUFFER_BIT}ne&&(_e|=$.DEPTH_BUFFER_BIT),le&&(_e|=$.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),$.clear(_e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",tt,!1),t.removeEventListener("webglcontextrestored",Je,!1),t.removeEventListener("webglcontextcreationerror",Bt,!1),qe.dispose(),xt.dispose(),Vt.dispose(),mt.dispose(),ee.dispose(),X.dispose(),Ze.dispose(),pe.dispose(),Ue.dispose(),Le.dispose(),vt.dispose(),vt.removeEventListener("sessionstart",go),vt.removeEventListener("sessionend",sr),ta.stop()};function tt(V){V.preventDefault(),lg("WebGLRenderer: Context Lost."),z=!0}function Je(){lg("WebGLRenderer: Context Restored."),z=!1;const V=bt.autoReset,ne=Ye.enabled,le=Ye.autoUpdate,_e=Ye.needsUpdate,oe=Ye.type;ft(),bt.autoReset=V,Ye.enabled=ne,Ye.autoUpdate=le,Ye.needsUpdate=_e,Ye.type=oe}function Bt(V){un("WebGLRenderer: A WebGL context could not be created. Reason: ",V.statusMessage)}function Qt(V){const ne=V.target;ne.removeEventListener("dispose",Qt),Fn(ne)}function Fn(V){Cn(V),mt.remove(V)}function Cn(V){const ne=mt.get(V).programs;ne!==void 0&&(ne.forEach(function(le){Le.releaseProgram(le)}),V.isShaderMaterial&&Le.releaseShaderCache(V))}this.renderBufferDirect=function(V,ne,le,_e,oe,Ne){ne===null&&(ne=Xt);const je=oe.isMesh&&oe.matrixWorld.determinant()<0,$e=we(V,ne,le,_e,oe);it.setMaterial(_e,je);let ct=le.index,_t=1;if(_e.wireframe===!0){if(ct=He.getWireframeAttribute(le),ct===void 0)return;_t=2}const Rt=le.drawRange,Tt=le.attributes.position;let Ut=Rt.start*_t,on=(Rt.start+Rt.count)*_t;Ne!==null&&(Ut=Math.max(Ut,Ne.start*_t),on=Math.min(on,(Ne.start+Ne.count)*_t)),ct!==null?(Ut=Math.max(Ut,0),on=Math.min(on,ct.count)):Tt!=null&&(Ut=Math.max(Ut,0),on=Math.min(on,Tt.count));const Ht=on-Ut;if(Ht<0||Ht===1/0)return;pe.setup(oe,_e,$e,le,ct);let Jt,xn=Et;if(ct!==null&&(Jt=Ae.get(ct),xn=gt,xn.setIndex(Jt)),oe.isMesh)_e.wireframe===!0?(it.setLineWidth(_e.wireframeLinewidth*ke()),xn.setMode($.LINES)):xn.setMode($.TRIANGLES);else if(oe.isLine){let Gt=_e.linewidth;Gt===void 0&&(Gt=1),it.setLineWidth(Gt*ke()),oe.isLineSegments?xn.setMode($.LINES):oe.isLineLoop?xn.setMode($.LINE_LOOP):xn.setMode($.LINE_STRIP)}else oe.isPoints?xn.setMode($.POINTS):oe.isSprite&&xn.setMode($.TRIANGLES);if(oe.isBatchedMesh)if(oe._multiDrawInstances!==null)Up("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),xn.renderMultiDrawInstances(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount,oe._multiDrawInstances);else if(st.get("WEBGL_multi_draw"))xn.renderMultiDraw(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount);else{const Gt=oe._multiDrawStarts,pn=oe._multiDrawCounts,Pt=oe._multiDrawCount,Rn=ct?Ae.get(ct).bytesPerElement:1,zn=mt.get(_e).currentProgram.getUniforms();for(let Yt=0;Yt<Pt;Yt++)zn.setValue($,"_gl_DrawID",Yt),xn.render(Gt[Yt]/Rn,pn[Yt])}else if(oe.isInstancedMesh)xn.renderInstances(Ut,Ht,oe.count);else if(le.isInstancedBufferGeometry){const Gt=le._maxInstanceCount!==void 0?le._maxInstanceCount:1/0,pn=Math.min(le.instanceCount,Gt);xn.renderInstances(Ut,Ht,pn)}else xn.render(Ut,Ht)};function fa(V,ne,le){V.transparent===!0&&V.side===Oi&&V.forceSinglePass===!1?(V.side=oa,V.needsUpdate=!0,G(V,ne,le),V.side=Wo,V.needsUpdate=!0,G(V,ne,le),V.side=Oi):G(V,ne,le)}this.compile=function(V,ne,le=null){le===null&&(le=V),D=Vt.get(le),D.init(ne),F.push(D),le.traverseVisible(function(oe){oe.isLight&&oe.layers.test(ne.layers)&&(D.pushLight(oe),oe.castShadow&&D.pushShadow(oe))}),V!==le&&V.traverseVisible(function(oe){oe.isLight&&oe.layers.test(ne.layers)&&(D.pushLight(oe),oe.castShadow&&D.pushShadow(oe))}),D.setupLights();const _e=new Set;return V.traverse(function(oe){if(!(oe.isMesh||oe.isPoints||oe.isLine||oe.isSprite))return;const Ne=oe.material;if(Ne)if(Array.isArray(Ne))for(let je=0;je<Ne.length;je++){const $e=Ne[je];fa($e,le,oe),_e.add($e)}else fa(Ne,le,oe),_e.add(Ne)}),D=F.pop(),_e},this.compileAsync=function(V,ne,le=null){const _e=this.compile(V,ne,le);return new Promise(oe=>{function Ne(){if(_e.forEach(function(je){mt.get(je).currentProgram.isReady()&&_e.delete(je)}),_e.size===0){oe(V);return}setTimeout(Ne,10)}st.get("KHR_parallel_shader_compile")!==null?Ne():setTimeout(Ne,10)})};let Va=null;function zl(V){Va&&Va(V)}function go(){ta.stop()}function sr(){ta.start()}const ta=new GC;ta.setAnimationLoop(zl),typeof self<"u"&&ta.setContext(self),this.setAnimationLoop=function(V){Va=V,vt.setAnimationLoop(V),V===null?ta.stop():ta.start()},vt.addEventListener("sessionstart",go),vt.addEventListener("sessionend",sr),this.render=function(V,ne){if(ne!==void 0&&ne.isCamera!==!0){un("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(z===!0)return;if(V.matrixWorldAutoUpdate===!0&&V.updateMatrixWorld(),ne.parent===null&&ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),vt.enabled===!0&&vt.isPresenting===!0&&(vt.cameraAutoUpdate===!0&&vt.updateCamera(ne),ne=vt.getCamera()),V.isScene===!0&&V.onBeforeRender(N,V,ne,P),D=Vt.get(V,F.length),D.init(ne),F.push(D),et.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),xe.setFromProjectionMatrix(et,Ir,ne.reversedDepth),Fe=this.localClippingEnabled,fe=Lt.init(this.clippingPlanes,Fe),w=xt.get(V,U.length),w.init(),U.push(w),vt.enabled===!0&&vt.isPresenting===!0){const Ne=N.xr.getDepthSensingMesh();Ne!==null&&ms(Ne,ne,-1/0,N.sortObjects)}ms(V,ne,0,N.sortObjects),w.finish(),N.sortObjects===!0&&w.sort(Q,de),Ot=vt.enabled===!1||vt.isPresenting===!1||vt.hasDepthSensing()===!1,Ot&&qe.addToRenderList(w,V),this.info.render.frame++,fe===!0&&Lt.beginShadows();const le=D.state.shadowsArray;Ye.render(le,V,ne),fe===!0&&Lt.endShadows(),this.info.autoReset===!0&&this.info.reset();const _e=w.opaque,oe=w.transmissive;if(D.setupLights(),ne.isArrayCamera){const Ne=ne.cameras;if(oe.length>0)for(let je=0,$e=Ne.length;je<$e;je++){const ct=Ne[je];en(_e,oe,V,ct)}Ot&&qe.render(V);for(let je=0,$e=Ne.length;je<$e;je++){const ct=Ne[je];ba(w,V,ct,ct.viewport)}}else oe.length>0&&en(_e,oe,V,ne),Ot&&qe.render(V),ba(w,V,ne);P!==null&&L===0&&(Ct.updateMultisampleRenderTarget(P),Ct.updateRenderTargetMipmap(P)),V.isScene===!0&&V.onAfterRender(N,V,ne),pe.resetDefaultState(),q=-1,ie=null,F.pop(),F.length>0?(D=F[F.length-1],fe===!0&&Lt.setGlobalState(N.clippingPlanes,D.state.camera)):D=null,U.pop(),U.length>0?w=U[U.length-1]:w=null};function ms(V,ne,le,_e){if(V.visible===!1)return;if(V.layers.test(ne.layers)){if(V.isGroup)le=V.renderOrder;else if(V.isLOD)V.autoUpdate===!0&&V.update(ne);else if(V.isLight)D.pushLight(V),V.castShadow&&D.pushShadow(V);else if(V.isSprite){if(!V.frustumCulled||xe.intersectsSprite(V)){_e&&yt.setFromMatrixPosition(V.matrixWorld).applyMatrix4(et);const je=Ze.update(V),$e=V.material;$e.visible&&w.push(V,je,$e,le,yt.z,null)}}else if((V.isMesh||V.isLine||V.isPoints)&&(!V.frustumCulled||xe.intersectsObject(V))){const je=Ze.update(V),$e=V.material;if(_e&&(V.boundingSphere!==void 0?(V.boundingSphere===null&&V.computeBoundingSphere(),yt.copy(V.boundingSphere.center)):(je.boundingSphere===null&&je.computeBoundingSphere(),yt.copy(je.boundingSphere.center)),yt.applyMatrix4(V.matrixWorld).applyMatrix4(et)),Array.isArray($e)){const ct=je.groups;for(let _t=0,Rt=ct.length;_t<Rt;_t++){const Tt=ct[_t],Ut=$e[Tt.materialIndex];Ut&&Ut.visible&&w.push(V,je,Ut,le,yt.z,Tt)}}else $e.visible&&w.push(V,je,$e,le,yt.z,null)}}const Ne=V.children;for(let je=0,$e=Ne.length;je<$e;je++)ms(Ne[je],ne,le,_e)}function ba(V,ne,le,_e){const{opaque:oe,transmissive:Ne,transparent:je}=V;D.setupLightsView(le),fe===!0&&Lt.setGlobalState(N.clippingPlanes,le),_e&&it.viewport(se.copy(_e)),oe.length>0&&ha(oe,ne,le),Ne.length>0&&ha(Ne,ne,le),je.length>0&&ha(je,ne,le),it.buffers.depth.setTest(!0),it.buffers.depth.setMask(!0),it.buffers.color.setMask(!0),it.setPolygonOffset(!1)}function en(V,ne,le,_e){if((le.isScene===!0?le.overrideMaterial:null)!==null)return;D.state.transmissionRenderTarget[_e.id]===void 0&&(D.state.transmissionRenderTarget[_e.id]=new ua(1,1,{generateMipmaps:!0,type:st.has("EXT_color_buffer_half_float")||st.has("EXT_color_buffer_float")?wa:ca,minFilter:fo,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Wn.workingColorSpace}));const Ne=D.state.transmissionRenderTarget[_e.id],je=_e.viewport||se;Ne.setSize(je.z*N.transmissionResolutionScale,je.w*N.transmissionResolutionScale);const $e=N.getRenderTarget(),ct=N.getActiveCubeFace(),_t=N.getActiveMipmapLevel();N.setRenderTarget(Ne),N.getClearColor(H),K=N.getClearAlpha(),K<1&&N.setClearColor(16777215,.5),N.clear(),Ot&&qe.render(le);const Rt=N.toneMapping;N.toneMapping=Jo;const Tt=_e.viewport;if(_e.viewport!==void 0&&(_e.viewport=void 0),D.setupLightsView(_e),fe===!0&&Lt.setGlobalState(N.clippingPlanes,_e),ha(V,le,_e),Ct.updateMultisampleRenderTarget(Ne),Ct.updateRenderTargetMipmap(Ne),st.has("WEBGL_multisampled_render_to_texture")===!1){let Ut=!1;for(let on=0,Ht=ne.length;on<Ht;on++){const Jt=ne[on],{object:xn,geometry:Gt,material:pn,group:Pt}=Jt;if(pn.side===Oi&&xn.layers.test(_e.layers)){const Rn=pn.side;pn.side=oa,pn.needsUpdate=!0,hn(xn,le,_e,Gt,pn,Pt),pn.side=Rn,pn.needsUpdate=!0,Ut=!0}}Ut===!0&&(Ct.updateMultisampleRenderTarget(Ne),Ct.updateRenderTargetMipmap(Ne))}N.setRenderTarget($e,ct,_t),N.setClearColor(H,K),Tt!==void 0&&(_e.viewport=Tt),N.toneMapping=Rt}function ha(V,ne,le){const _e=ne.isScene===!0?ne.overrideMaterial:null;for(let oe=0,Ne=V.length;oe<Ne;oe++){const je=V[oe],{object:$e,geometry:ct,group:_t}=je;let Rt=je.material;Rt.allowOverride===!0&&_e!==null&&(Rt=_e),$e.layers.test(le.layers)&&hn($e,ne,le,ct,Rt,_t)}}function hn(V,ne,le,_e,oe,Ne){V.onBeforeRender(N,ne,le,_e,oe,Ne),V.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,V.matrixWorld),V.normalMatrix.getNormalMatrix(V.modelViewMatrix),oe.onBeforeRender(N,ne,le,_e,V,Ne),oe.transparent===!0&&oe.side===Oi&&oe.forceSinglePass===!1?(oe.side=oa,oe.needsUpdate=!0,N.renderBufferDirect(le,ne,_e,oe,V,Ne),oe.side=Wo,oe.needsUpdate=!0,N.renderBufferDirect(le,ne,_e,oe,V,Ne),oe.side=Oi):N.renderBufferDirect(le,ne,_e,oe,V,Ne),V.onAfterRender(N,ne,le,_e,oe,Ne)}function G(V,ne,le){ne.isScene!==!0&&(ne=Xt);const _e=mt.get(V),oe=D.state.lights,Ne=D.state.shadowsArray,je=oe.state.version,$e=Le.getParameters(V,oe.state,Ne,ne,le),ct=Le.getProgramCacheKey($e);let _t=_e.programs;_e.environment=V.isMeshStandardMaterial?ne.environment:null,_e.fog=ne.fog,_e.envMap=(V.isMeshStandardMaterial?X:ee).get(V.envMap||_e.environment),_e.envMapRotation=_e.environment!==null&&V.envMap===null?ne.environmentRotation:V.envMapRotation,_t===void 0&&(V.addEventListener("dispose",Qt),_t=new Map,_e.programs=_t);let Rt=_t.get(ct);if(Rt!==void 0){if(_e.currentProgram===Rt&&_e.lightsStateVersion===je)return he(V,$e),Rt}else $e.uniforms=Le.getUniforms(V),V.onBeforeCompile($e,N),Rt=Le.acquireProgram($e,ct),_t.set(ct,Rt),_e.uniforms=$e.uniforms;const Tt=_e.uniforms;return(!V.isShaderMaterial&&!V.isRawShaderMaterial||V.clipping===!0)&&(Tt.clippingPlanes=Lt.uniform),he(V,$e),_e.needsLights=Pe(V),_e.lightsStateVersion=je,_e.needsLights&&(Tt.ambientLightColor.value=oe.state.ambient,Tt.lightProbe.value=oe.state.probe,Tt.directionalLights.value=oe.state.directional,Tt.directionalLightShadows.value=oe.state.directionalShadow,Tt.spotLights.value=oe.state.spot,Tt.spotLightShadows.value=oe.state.spotShadow,Tt.rectAreaLights.value=oe.state.rectArea,Tt.ltc_1.value=oe.state.rectAreaLTC1,Tt.ltc_2.value=oe.state.rectAreaLTC2,Tt.pointLights.value=oe.state.point,Tt.pointLightShadows.value=oe.state.pointShadow,Tt.hemisphereLights.value=oe.state.hemi,Tt.directionalShadowMap.value=oe.state.directionalShadowMap,Tt.directionalShadowMatrix.value=oe.state.directionalShadowMatrix,Tt.spotShadowMap.value=oe.state.spotShadowMap,Tt.spotLightMatrix.value=oe.state.spotLightMatrix,Tt.spotLightMap.value=oe.state.spotLightMap,Tt.pointShadowMap.value=oe.state.pointShadowMap,Tt.pointShadowMatrix.value=oe.state.pointShadowMatrix),_e.currentProgram=Rt,_e.uniformsList=null,Rt}function Z(V){if(V.uniformsList===null){const ne=V.currentProgram.getUniforms();V.uniformsList=f_.seqWithValue(ne.seq,V.uniforms)}return V.uniformsList}function he(V,ne){const le=mt.get(V);le.outputColorSpace=ne.outputColorSpace,le.batching=ne.batching,le.batchingColor=ne.batchingColor,le.instancing=ne.instancing,le.instancingColor=ne.instancingColor,le.instancingMorph=ne.instancingMorph,le.skinning=ne.skinning,le.morphTargets=ne.morphTargets,le.morphNormals=ne.morphNormals,le.morphColors=ne.morphColors,le.morphTargetsCount=ne.morphTargetsCount,le.numClippingPlanes=ne.numClippingPlanes,le.numIntersection=ne.numClipIntersection,le.vertexAlphas=ne.vertexAlphas,le.vertexTangents=ne.vertexTangents,le.toneMapping=ne.toneMapping}function we(V,ne,le,_e,oe){ne.isScene!==!0&&(ne=Xt),Ct.resetTextureUnits();const Ne=ne.fog,je=_e.isMeshStandardMaterial?ne.environment:null,$e=P===null?N.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:Fr,ct=(_e.isMeshStandardMaterial?X:ee).get(_e.envMap||je),_t=_e.vertexColors===!0&&!!le.attributes.color&&le.attributes.color.itemSize===4,Rt=!!le.attributes.tangent&&(!!_e.normalMap||_e.anisotropy>0),Tt=!!le.morphAttributes.position,Ut=!!le.morphAttributes.normal,on=!!le.morphAttributes.color;let Ht=Jo;_e.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(Ht=N.toneMapping);const Jt=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,xn=Jt!==void 0?Jt.length:0,Gt=mt.get(_e),pn=D.state.lights;if(fe===!0&&(Fe===!0||V!==ie)){const da=V===ie&&_e.id===q;Lt.setState(_e,V,da)}let Pt=!1;_e.version===Gt.__version?(Gt.needsLights&&Gt.lightsStateVersion!==pn.state.version||Gt.outputColorSpace!==$e||oe.isBatchedMesh&&Gt.batching===!1||!oe.isBatchedMesh&&Gt.batching===!0||oe.isBatchedMesh&&Gt.batchingColor===!0&&oe.colorTexture===null||oe.isBatchedMesh&&Gt.batchingColor===!1&&oe.colorTexture!==null||oe.isInstancedMesh&&Gt.instancing===!1||!oe.isInstancedMesh&&Gt.instancing===!0||oe.isSkinnedMesh&&Gt.skinning===!1||!oe.isSkinnedMesh&&Gt.skinning===!0||oe.isInstancedMesh&&Gt.instancingColor===!0&&oe.instanceColor===null||oe.isInstancedMesh&&Gt.instancingColor===!1&&oe.instanceColor!==null||oe.isInstancedMesh&&Gt.instancingMorph===!0&&oe.morphTexture===null||oe.isInstancedMesh&&Gt.instancingMorph===!1&&oe.morphTexture!==null||Gt.envMap!==ct||_e.fog===!0&&Gt.fog!==Ne||Gt.numClippingPlanes!==void 0&&(Gt.numClippingPlanes!==Lt.numPlanes||Gt.numIntersection!==Lt.numIntersection)||Gt.vertexAlphas!==_t||Gt.vertexTangents!==Rt||Gt.morphTargets!==Tt||Gt.morphNormals!==Ut||Gt.morphColors!==on||Gt.toneMapping!==Ht||Gt.morphTargetsCount!==xn)&&(Pt=!0):(Pt=!0,Gt.__version=_e.version);let Rn=Gt.currentProgram;Pt===!0&&(Rn=G(_e,ne,oe));let zn=!1,Yt=!1,Bi=!1;const Un=Rn.getUniforms(),jn=Gt.uniforms;if(it.useProgram(Rn.program)&&(zn=!0,Yt=!0,Bi=!0),_e.id!==q&&(q=_e.id,Yt=!0),zn||ie!==V){it.buffers.depth.getReversed()&&V.reversedDepth!==!0&&(V._reversedDepth=!0,V.updateProjectionMatrix()),Un.setValue($,"projectionMatrix",V.projectionMatrix),Un.setValue($,"viewMatrix",V.matrixWorldInverse);const Li=Un.map.cameraPosition;Li!==void 0&&Li.setValue($,ht.setFromMatrixPosition(V.matrixWorld)),pt.logarithmicDepthBuffer&&Un.setValue($,"logDepthBufFC",2/(Math.log(V.far+1)/Math.LN2)),(_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshLambertMaterial||_e.isMeshBasicMaterial||_e.isMeshStandardMaterial||_e.isShaderMaterial)&&Un.setValue($,"isOrthographic",V.isOrthographicCamera===!0),ie!==V&&(ie=V,Yt=!0,Bi=!0)}if(oe.isSkinnedMesh){Un.setOptional($,oe,"bindMatrix"),Un.setOptional($,oe,"bindMatrixInverse");const da=oe.skeleton;da&&(da.boneTexture===null&&da.computeBoneTexture(),Un.setValue($,"boneTexture",da.boneTexture,Ct))}oe.isBatchedMesh&&(Un.setOptional($,oe,"batchingTexture"),Un.setValue($,"batchingTexture",oe._matricesTexture,Ct),Un.setOptional($,oe,"batchingIdTexture"),Un.setValue($,"batchingIdTexture",oe._indirectTexture,Ct),Un.setOptional($,oe,"batchingColorTexture"),oe._colorsTexture!==null&&Un.setValue($,"batchingColorTexture",oe._colorsTexture,Ct));const di=le.morphAttributes;if((di.position!==void 0||di.normal!==void 0||di.color!==void 0)&&It.update(oe,le,Rn),(Yt||Gt.receiveShadow!==oe.receiveShadow)&&(Gt.receiveShadow=oe.receiveShadow,Un.setValue($,"receiveShadow",oe.receiveShadow)),_e.isMeshGouraudMaterial&&_e.envMap!==null&&(jn.envMap.value=ct,jn.flipEnvMap.value=ct.isCubeTexture&&ct.isRenderTargetTexture===!1?-1:1),_e.isMeshStandardMaterial&&_e.envMap===null&&ne.environment!==null&&(jn.envMapIntensity.value=ne.environmentIntensity),jn.dfgLUT!==void 0&&(jn.dfgLUT.value=R5()),Yt&&(Un.setValue($,"toneMappingExposure",N.toneMappingExposure),Gt.needsLights&&ze(jn,Bi),Ne&&_e.fog===!0&&Nt.refreshFogUniforms(jn,Ne),Nt.refreshMaterialUniforms(jn,_e,ve,me,D.state.transmissionRenderTarget[V.id]),f_.upload($,Z(Gt),jn,Ct)),_e.isShaderMaterial&&_e.uniformsNeedUpdate===!0&&(f_.upload($,Z(Gt),jn,Ct),_e.uniformsNeedUpdate=!1),_e.isSpriteMaterial&&Un.setValue($,"center",oe.center),Un.setValue($,"modelViewMatrix",oe.modelViewMatrix),Un.setValue($,"normalMatrix",oe.normalMatrix),Un.setValue($,"modelMatrix",oe.matrixWorld),_e.isShaderMaterial||_e.isRawShaderMaterial){const da=_e.uniformsGroups;for(let Li=0,yr=da.length;Li<yr;Li++){const rr=da[Li];Ue.update(rr,Rn),Ue.bind(rr,Rn)}}return Rn}function ze(V,ne){V.ambientLightColor.needsUpdate=ne,V.lightProbe.needsUpdate=ne,V.directionalLights.needsUpdate=ne,V.directionalLightShadows.needsUpdate=ne,V.pointLights.needsUpdate=ne,V.pointLightShadows.needsUpdate=ne,V.spotLights.needsUpdate=ne,V.spotLightShadows.needsUpdate=ne,V.rectAreaLights.needsUpdate=ne,V.hemisphereLights.needsUpdate=ne}function Pe(V){return V.isMeshLambertMaterial||V.isMeshToonMaterial||V.isMeshPhongMaterial||V.isMeshStandardMaterial||V.isShadowMaterial||V.isShaderMaterial&&V.lights===!0}this.getActiveCubeFace=function(){return j},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(V,ne,le){const _e=mt.get(V);_e.__autoAllocateDepthBuffer=V.resolveDepthBuffer===!1,_e.__autoAllocateDepthBuffer===!1&&(_e.__useRenderToTexture=!1),mt.get(V.texture).__webglTexture=ne,mt.get(V.depthTexture).__webglTexture=_e.__autoAllocateDepthBuffer?void 0:le,_e.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(V,ne){const le=mt.get(V);le.__webglFramebuffer=ne,le.__useDefaultFramebuffer=ne===void 0};const ot=$.createFramebuffer();this.setRenderTarget=function(V,ne=0,le=0){P=V,j=ne,L=le;let _e=!0,oe=null,Ne=!1,je=!1;if(V){const ct=mt.get(V);if(ct.__useDefaultFramebuffer!==void 0)it.bindFramebuffer($.FRAMEBUFFER,null),_e=!1;else if(ct.__webglFramebuffer===void 0)Ct.setupRenderTarget(V);else if(ct.__hasExternalTextures)Ct.rebindTextures(V,mt.get(V.texture).__webglTexture,mt.get(V.depthTexture).__webglTexture);else if(V.depthBuffer){const Tt=V.depthTexture;if(ct.__boundDepthTexture!==Tt){if(Tt!==null&&mt.has(Tt)&&(V.width!==Tt.image.width||V.height!==Tt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Ct.setupDepthRenderbuffer(V)}}const _t=V.texture;(_t.isData3DTexture||_t.isDataArrayTexture||_t.isCompressedArrayTexture)&&(je=!0);const Rt=mt.get(V).__webglFramebuffer;V.isWebGLCubeRenderTarget?(Array.isArray(Rt[ne])?oe=Rt[ne][le]:oe=Rt[ne],Ne=!0):V.samples>0&&Ct.useMultisampledRTT(V)===!1?oe=mt.get(V).__webglMultisampledFramebuffer:Array.isArray(Rt)?oe=Rt[le]:oe=Rt,se.copy(V.viewport),ae.copy(V.scissor),re=V.scissorTest}else se.copy(Te).multiplyScalar(ve).floor(),ae.copy(Me).multiplyScalar(ve).floor(),re=rt;if(le!==0&&(oe=ot),it.bindFramebuffer($.FRAMEBUFFER,oe)&&_e&&it.drawBuffers(V,oe),it.viewport(se),it.scissor(ae),it.setScissorTest(re),Ne){const ct=mt.get(V.texture);$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_CUBE_MAP_POSITIVE_X+ne,ct.__webglTexture,le)}else if(je){const ct=ne;for(let _t=0;_t<V.textures.length;_t++){const Rt=mt.get(V.textures[_t]);$.framebufferTextureLayer($.FRAMEBUFFER,$.COLOR_ATTACHMENT0+_t,Rt.__webglTexture,le,ct)}}else if(V!==null&&le!==0){const ct=mt.get(V.texture);$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,ct.__webglTexture,le)}q=-1},this.readRenderTargetPixels=function(V,ne,le,_e,oe,Ne,je,$e=0){if(!(V&&V.isWebGLRenderTarget)){un("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ct=mt.get(V).__webglFramebuffer;if(V.isWebGLCubeRenderTarget&&je!==void 0&&(ct=ct[je]),ct){it.bindFramebuffer($.FRAMEBUFFER,ct);try{const _t=V.textures[$e],Rt=_t.format,Tt=_t.type;if(!pt.textureFormatReadable(Rt)){un("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!pt.textureTypeReadable(Tt)){un("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ne>=0&&ne<=V.width-_e&&le>=0&&le<=V.height-oe&&(V.textures.length>1&&$.readBuffer($.COLOR_ATTACHMENT0+$e),$.readPixels(ne,le,_e,oe,Dt.convert(Rt),Dt.convert(Tt),Ne))}finally{const _t=P!==null?mt.get(P).__webglFramebuffer:null;it.bindFramebuffer($.FRAMEBUFFER,_t)}}},this.readRenderTargetPixelsAsync=async function(V,ne,le,_e,oe,Ne,je,$e=0){if(!(V&&V.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ct=mt.get(V).__webglFramebuffer;if(V.isWebGLCubeRenderTarget&&je!==void 0&&(ct=ct[je]),ct)if(ne>=0&&ne<=V.width-_e&&le>=0&&le<=V.height-oe){it.bindFramebuffer($.FRAMEBUFFER,ct);const _t=V.textures[$e],Rt=_t.format,Tt=_t.type;if(!pt.textureFormatReadable(Rt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!pt.textureTypeReadable(Tt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Ut=$.createBuffer();$.bindBuffer($.PIXEL_PACK_BUFFER,Ut),$.bufferData($.PIXEL_PACK_BUFFER,Ne.byteLength,$.STREAM_READ),V.textures.length>1&&$.readBuffer($.COLOR_ATTACHMENT0+$e),$.readPixels(ne,le,_e,oe,Dt.convert(Rt),Dt.convert(Tt),0);const on=P!==null?mt.get(P).__webglFramebuffer:null;it.bindFramebuffer($.FRAMEBUFFER,on);const Ht=$.fenceSync($.SYNC_GPU_COMMANDS_COMPLETE,0);return $.flush(),await tD($,Ht,4),$.bindBuffer($.PIXEL_PACK_BUFFER,Ut),$.getBufferSubData($.PIXEL_PACK_BUFFER,0,Ne),$.deleteBuffer(Ut),$.deleteSync(Ht),Ne}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(V,ne=null,le=0){const _e=Math.pow(2,-le),oe=Math.floor(V.image.width*_e),Ne=Math.floor(V.image.height*_e),je=ne!==null?ne.x:0,$e=ne!==null?ne.y:0;Ct.setTexture2D(V,0),$.copyTexSubImage2D($.TEXTURE_2D,le,0,0,je,$e,oe,Ne),it.unbindTexture()};const nt=$.createFramebuffer(),at=$.createFramebuffer();this.copyTextureToTexture=function(V,ne,le=null,_e=null,oe=0,Ne=null){Ne===null&&(oe!==0?(Up("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ne=oe,oe=0):Ne=0);let je,$e,ct,_t,Rt,Tt,Ut,on,Ht;const Jt=V.isCompressedTexture?V.mipmaps[Ne]:V.image;if(le!==null)je=le.max.x-le.min.x,$e=le.max.y-le.min.y,ct=le.isBox3?le.max.z-le.min.z:1,_t=le.min.x,Rt=le.min.y,Tt=le.isBox3?le.min.z:0;else{const di=Math.pow(2,-oe);je=Math.floor(Jt.width*di),$e=Math.floor(Jt.height*di),V.isDataArrayTexture?ct=Jt.depth:V.isData3DTexture?ct=Math.floor(Jt.depth*di):ct=1,_t=0,Rt=0,Tt=0}_e!==null?(Ut=_e.x,on=_e.y,Ht=_e.z):(Ut=0,on=0,Ht=0);const xn=Dt.convert(ne.format),Gt=Dt.convert(ne.type);let pn;ne.isData3DTexture?(Ct.setTexture3D(ne,0),pn=$.TEXTURE_3D):ne.isDataArrayTexture||ne.isCompressedArrayTexture?(Ct.setTexture2DArray(ne,0),pn=$.TEXTURE_2D_ARRAY):(Ct.setTexture2D(ne,0),pn=$.TEXTURE_2D),$.pixelStorei($.UNPACK_FLIP_Y_WEBGL,ne.flipY),$.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),$.pixelStorei($.UNPACK_ALIGNMENT,ne.unpackAlignment);const Pt=$.getParameter($.UNPACK_ROW_LENGTH),Rn=$.getParameter($.UNPACK_IMAGE_HEIGHT),zn=$.getParameter($.UNPACK_SKIP_PIXELS),Yt=$.getParameter($.UNPACK_SKIP_ROWS),Bi=$.getParameter($.UNPACK_SKIP_IMAGES);$.pixelStorei($.UNPACK_ROW_LENGTH,Jt.width),$.pixelStorei($.UNPACK_IMAGE_HEIGHT,Jt.height),$.pixelStorei($.UNPACK_SKIP_PIXELS,_t),$.pixelStorei($.UNPACK_SKIP_ROWS,Rt),$.pixelStorei($.UNPACK_SKIP_IMAGES,Tt);const Un=V.isDataArrayTexture||V.isData3DTexture,jn=ne.isDataArrayTexture||ne.isData3DTexture;if(V.isDepthTexture){const di=mt.get(V),da=mt.get(ne),Li=mt.get(di.__renderTarget),yr=mt.get(da.__renderTarget);it.bindFramebuffer($.READ_FRAMEBUFFER,Li.__webglFramebuffer),it.bindFramebuffer($.DRAW_FRAMEBUFFER,yr.__webglFramebuffer);for(let rr=0;rr<ct;rr++)Un&&($.framebufferTextureLayer($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,mt.get(V).__webglTexture,oe,Tt+rr),$.framebufferTextureLayer($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,mt.get(ne).__webglTexture,Ne,Ht+rr)),$.blitFramebuffer(_t,Rt,je,$e,Ut,on,je,$e,$.DEPTH_BUFFER_BIT,$.NEAREST);it.bindFramebuffer($.READ_FRAMEBUFFER,null),it.bindFramebuffer($.DRAW_FRAMEBUFFER,null)}else if(oe!==0||V.isRenderTargetTexture||mt.has(V)){const di=mt.get(V),da=mt.get(ne);it.bindFramebuffer($.READ_FRAMEBUFFER,nt),it.bindFramebuffer($.DRAW_FRAMEBUFFER,at);for(let Li=0;Li<ct;Li++)Un?$.framebufferTextureLayer($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,di.__webglTexture,oe,Tt+Li):$.framebufferTexture2D($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,di.__webglTexture,oe),jn?$.framebufferTextureLayer($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,da.__webglTexture,Ne,Ht+Li):$.framebufferTexture2D($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,da.__webglTexture,Ne),oe!==0?$.blitFramebuffer(_t,Rt,je,$e,Ut,on,je,$e,$.COLOR_BUFFER_BIT,$.NEAREST):jn?$.copyTexSubImage3D(pn,Ne,Ut,on,Ht+Li,_t,Rt,je,$e):$.copyTexSubImage2D(pn,Ne,Ut,on,_t,Rt,je,$e);it.bindFramebuffer($.READ_FRAMEBUFFER,null),it.bindFramebuffer($.DRAW_FRAMEBUFFER,null)}else jn?V.isDataTexture||V.isData3DTexture?$.texSubImage3D(pn,Ne,Ut,on,Ht,je,$e,ct,xn,Gt,Jt.data):ne.isCompressedArrayTexture?$.compressedTexSubImage3D(pn,Ne,Ut,on,Ht,je,$e,ct,xn,Jt.data):$.texSubImage3D(pn,Ne,Ut,on,Ht,je,$e,ct,xn,Gt,Jt):V.isDataTexture?$.texSubImage2D($.TEXTURE_2D,Ne,Ut,on,je,$e,xn,Gt,Jt.data):V.isCompressedTexture?$.compressedTexSubImage2D($.TEXTURE_2D,Ne,Ut,on,Jt.width,Jt.height,xn,Jt.data):$.texSubImage2D($.TEXTURE_2D,Ne,Ut,on,je,$e,xn,Gt,Jt);$.pixelStorei($.UNPACK_ROW_LENGTH,Pt),$.pixelStorei($.UNPACK_IMAGE_HEIGHT,Rn),$.pixelStorei($.UNPACK_SKIP_PIXELS,zn),$.pixelStorei($.UNPACK_SKIP_ROWS,Yt),$.pixelStorei($.UNPACK_SKIP_IMAGES,Bi),Ne===0&&ne.generateMipmaps&&$.generateMipmap(pn),it.unbindTexture()},this.initRenderTarget=function(V){mt.get(V).__webglFramebuffer===void 0&&Ct.setupRenderTarget(V)},this.initTexture=function(V){V.isCubeTexture?Ct.setTextureCube(V,0):V.isData3DTexture?Ct.setTexture3D(V,0):V.isDataArrayTexture||V.isCompressedArrayTexture?Ct.setTexture2DArray(V,0):Ct.setTexture2D(V,0),it.unbindTexture()},this.resetState=function(){j=0,L=0,P=null,it.reset(),pe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ir}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Wn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Wn._getUnpackColorSpace()}}const w5=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Yb,AddEquation:Nu,AddOperation:AT,AdditiveAnimationBlendMode:$b,AdditiveBlending:ir,AgXToneMapping:RT,AlphaFormat:Jb,AlwaysCompare:GT,AlwaysDepth:ng,AlwaysStencilFunc:Sb,AmbientLight:CC,AnimationAction:PC,AnimationClip:Rh,AnimationLoader:VU,AnimationMixer:LS,AnimationObjectGroup:fO,AnimationUtils:FU,ArcCurve:nC,ArrayCamera:NC,ArrowHelper:IO,AttachedBindMode:yb,Audio:LC,AudioAnalyser:tO,AudioContext:DS,AudioListener:QU,AudioLoader:JU,AxesHelper:PO,BackSide:oa,BasicDepthPacking:Yu,BasicShadowMap:iT,BatchedMesh:QT,Bone:Cy,BooleanKeyframeTrack:Nh,Box2:bO,Box3:ns,Box3Helper:NO,BoxGeometry:Uh,BoxHelper:OO,BufferAttribute:Mn,BufferGeometry:rn,BufferGeometryLoader:UC,ByteType:py,Cache:Pl,Camera:My,CameraHelper:UO,CanvasTexture:eC,CapsuleGeometry:Dy,CatmullRomCurve3:iC,CineonToneMapping:TT,CircleGeometry:Uy,ClampToEdgeWrapping:ea,Clock:US,Color:ut,ColorKeyframeTrack:ES,ColorManagement:Wn,CompressedArrayTexture:rU,CompressedCubeTexture:oU,CompressedTexture:wy,CompressedTextureLoader:kU,ConeGeometry:Ag,ConstantAlphaFactor:yT,ConstantColorFactor:xT,Controls:zO,CubeCamera:KT,CubeReflectionMapping:Fl,CubeRefractionMapping:Hu,CubeTexture:_g,CubeTextureLoader:MC,CubeUVReflectionMapping:zp,CubicBezierCurve:mS,CubicBezierCurve3:aC,CubicInterpolant:bC,CullFaceBack:vb,CullFaceFront:nT,CullFaceFrontBack:_B,CullFaceNone:tT,Curve:$o,CurvePath:rC,CustomBlending:aT,CustomToneMapping:CT,CylinderGeometry:Sg,Cylindrical:yO,Data3DTexture:Ay,DataArrayTexture:Sy,DataTexture:ho,DataTextureLoader:TS,DataUtils:dh,DecrementStencilOp:wB,DecrementWrapStencilOp:DB,DefaultLoadingManager:_p,DepthFormat:Rp,DepthStencilFormat:Ah,DepthTexture:By,DetachedBindMode:BT,DirectionalLight:BS,DirectionalLightHelper:DO,DiscreteInterpolant:SC,DodecahedronGeometry:Oy,DoubleSide:Oi,DstAlphaFactor:dT,DstColorFactor:mT,DynamicCopyUsage:YB,DynamicDrawUsage:HB,DynamicReadUsage:kB,EdgesGeometry:tC,EllipseCurve:Ny,EqualCompare:PT,EqualDepth:v_,EqualStencilFunc:LB,EquirectangularReflectionMapping:Ep,EquirectangularRefractionMapping:ig,Euler:zr,EventDispatcher:Hr,ExternalTexture:dS,ExtrudeGeometry:Ly,FileLoader:hs,Float16BufferAttribute:FD,Float32BufferAttribute:zt,FloatType:ji,Fog:Ty,FogExp2:Ey,FramebufferTexture:sU,FrontSide:Wo,Frustum:Gp,FrustumArray:Ry,GLBufferAttribute:vO,GLSL1:KB,GLSL3:Ab,GreaterCompare:FT,GreaterDepth:__,GreaterEqualCompare:HT,GreaterEqualDepth:x_,GreaterEqualStencilFunc:zB,GreaterStencilFunc:PB,GridHelper:wO,Group:wc,HalfFloatType:wa,HemisphereLight:TC,HemisphereLightHelper:RO,IcosahedronGeometry:Mg,ImageBitmapLoader:OC,ImageLoader:hg,ImageUtils:jT,IncrementStencilOp:RB,IncrementWrapStencilOp:BB,InstancedBufferAttribute:Eh,InstancedBufferGeometry:DC,InstancedInterleavedBuffer:gO,InstancedMesh:uS,Int16BufferAttribute:ID,Int32BufferAttribute:PD,Int8BufferAttribute:OD,IntType:gg,InterleavedBuffer:yg,InterleavedBufferAttribute:ku,Interpolant:kp,InterpolateDiscrete:wp,InterpolateLinear:Bp,InterpolateSmooth:c_,InterpolationSamplingMode:ZB,InterpolationSamplingType:WB,InvertStencilOp:UB,KeepStencilOp:lh,KeyframeTrack:mo,LOD:ZT,LatheGeometry:Iy,Layers:Np,LessCompare:IT,LessDepth:g_,LessEqualCompare:tS,LessEqualDepth:bh,LessEqualStencilFunc:IB,LessStencilFunc:NB,Light:Wu,LightProbe:BC,Line:Uc,Line3:MO,LineBasicMaterial:Os,LineCurve:gS,LineCurve3:sC,LineDashedMaterial:xC,LineLoop:fS,LineSegments:Qo,LinearFilter:In,LinearInterpolant:MS,LinearMipMapLinearFilter:bb,LinearMipMapNearestFilter:SB,LinearMipmapLinearFilter:fo,LinearMipmapNearestFilter:bp,LinearSRGBColorSpace:Fr,LinearToneMapping:MT,LinearTransfer:sg,Loader:ds,LoaderUtils:Fu,LoadingManager:ky,LoopOnce:Zb,LoopPingPong:DT,LoopRepeat:Qb,MOUSE:vB,Material:ya,MaterialLoader:jy,MathUtils:iS,Matrix2:IS,Matrix3:vn,Matrix4:Wt,MaxEquation:lT,Mesh:Xi,MeshBasicMaterial:$a,MeshDepthMaterial:bS,MeshDistanceMaterial:SS,MeshLambertMaterial:gC,MeshMatcapMaterial:vC,MeshNormalMaterial:yS,MeshPhongMaterial:pC,MeshPhysicalMaterial:po,MeshStandardMaterial:ra,MeshToonMaterial:mC,MinEquation:oT,MirroredRepeatWrapping:Tp,MixOperation:ST,MultiplyBlending:_b,MultiplyOperation:mg,NearestFilter:la,NearestMipMapLinearFilter:bB,NearestMipMapNearestFilter:yB,NearestMipmapLinearFilter:uh,NearestMipmapNearestFilter:dy,NeutralToneMapping:wT,NeverCompare:LT,NeverDepth:m_,NeverStencilFunc:OB,NoBlending:es,NoColorSpace:qo,NoToneMapping:Jo,NormalAnimationBlendMode:by,NormalBlending:vh,NotEqualCompare:zT,NotEqualDepth:y_,NotEqualStencilFunc:FB,NumberKeyframeTrack:Ch,Object3D:Pn,ObjectLoader:qU,ObjectSpaceNormalMap:NT,OctahedronGeometry:Eg,OneFactor:uT,OneMinusConstantAlphaFactor:bT,OneMinusConstantColorFactor:_T,OneMinusDstAlphaFactor:pT,OneMinusDstColorFactor:gT,OneMinusSrcAlphaFactor:p_,OneMinusSrcColorFactor:hT,OrthographicCamera:Zu,PCFShadowMap:hy,PCFSoftShadowMap:jm,PMREMGenerator:Bb,Path:$_,PerspectiveCamera:Ra,Plane:Ou,PlaneGeometry:Ju,PlaneHelper:LO,PointLight:wS,PointLightHelper:TO,Points:hS,PointsMaterial:Vp,PolarGridHelper:BO,PolyhedronGeometry:Ku,PositionalAudio:eO,PropertyBinding:Qn,PropertyMixer:IC,QuadraticBezierCurve:vS,QuadraticBezierCurve3:xS,Quaternion:ts,QuaternionKeyframeTrack:ju,QuaternionLinearInterpolant:AC,RED_GREEN_RGTC2_Format:q_,RED_RGTC1_Format:X_,REVISION:Dh,RGBADepthPacking:OT,RGBAFormat:_a,RGBAIntegerFormat:yy,RGBA_ASTC_10x10_Format:z_,RGBA_ASTC_10x5_Format:I_,RGBA_ASTC_10x6_Format:P_,RGBA_ASTC_10x8_Format:F_,RGBA_ASTC_12x10_Format:H_,RGBA_ASTC_12x12_Format:G_,RGBA_ASTC_4x4_Format:R_,RGBA_ASTC_5x4_Format:w_,RGBA_ASTC_5x5_Format:B_,RGBA_ASTC_6x5_Format:D_,RGBA_ASTC_6x6_Format:U_,RGBA_ASTC_8x5_Format:O_,RGBA_ASTC_8x6_Format:N_,RGBA_ASTC_8x8_Format:L_,RGBA_BPTC_Format:V_,RGBA_ETC2_EAC_Format:C_,RGBA_PVRTC_2BPPV1_Format:M_,RGBA_PVRTC_4BPPV1_Format:A_,RGBA_S3TC_DXT1_Format:Ym,RGBA_S3TC_DXT3_Format:qm,RGBA_S3TC_DXT5_Format:Km,RGBDepthPacking:MB,RGBFormat:Wb,RGBIntegerFormat:AB,RGB_BPTC_SIGNED_Format:k_,RGB_BPTC_UNSIGNED_Format:j_,RGB_ETC1_Format:E_,RGB_ETC2_Format:T_,RGB_PVRTC_2BPPV1_Format:S_,RGB_PVRTC_4BPPV1_Format:b_,RGB_S3TC_DXT1_Format:Xm,RGDepthPacking:EB,RGFormat:xy,RGIntegerFormat:_y,RawShaderMaterial:dC,Ray:Hp,Raycaster:Xy,RectAreaLight:RC,RedFormat:vg,RedIntegerFormat:xg,ReinhardToneMapping:ET,RenderTarget:aS,RenderTarget3D:dO,RepeatWrapping:Gu,ReplaceStencilOp:CB,ReverseSubtractEquation:rT,RingGeometry:Py,SIGNED_RED_GREEN_RGTC2_Format:K_,SIGNED_RED_RGTC1_Format:Y_,SRGBColorSpace:ti,SRGBTransfer:xi,Scene:Mh,ShaderChunk:An,ShaderLib:Yo,ShaderMaterial:hi,ShadowMaterial:hC,Shape:_h,ShapeGeometry:Fy,ShapePath:FO,ShapeUtils:Ko,ShortType:my,Skeleton:bg,SkeletonHelper:zC,SkinnedMesh:cS,Source:Lu,Sphere:za,SphereGeometry:Oh,Spherical:FC,SphericalHarmonics3:wC,SplineCurve:_S,SpotLight:RS,SpotLightHelper:EO,Sprite:WT,SpriteMaterial:lS,SrcAlphaFactor:d_,SrcAlphaSaturateFactor:vT,SrcColorFactor:fT,StaticCopyUsage:XB,StaticDrawUsage:rg,StaticReadUsage:VB,StereoCamera:WU,StreamCopyUsage:qB,StreamDrawUsage:GB,StreamReadUsage:jB,StringKeyframeTrack:Lh,SubtractEquation:sT,SubtractiveBlending:xb,TOUCH:xB,TangentSpaceNormalMap:qu,TetrahedronGeometry:zy,Texture:ui,TextureLoader:EC,TextureUtils:jO,Timer:xO,TimestampQuery:JB,TorusGeometry:Hy,TorusKnotGeometry:Gy,Triangle:xr,TriangleFanDrawMode:J_,TriangleStripDrawMode:eS,TrianglesDrawMode:UT,TubeGeometry:Vy,UVMapping:zu,Uint16BufferAttribute:sS,Uint32BufferAttribute:rS,Uint8BufferAttribute:ND,Uint8ClampedBufferAttribute:LD,Uniform:Zn,UniformsGroup:mO,UniformsLib:At,UniformsUtils:qT,UnsignedByteType:ca,UnsignedInt101111Type:Kb,UnsignedInt248Type:Sh,UnsignedInt5999Type:qb,UnsignedIntType:Zo,UnsignedShort4444Type:gy,UnsignedShort5551Type:vy,UnsignedShortType:Cp,VSMShadowMap:jo,Vector2:Ge,Vector3:te,Vector4:kn,VectorKeyframeTrack:Xu,VideoFrameTexture:aU,VideoTexture:$T,WebGL3DRenderTarget:SD,WebGLArrayRenderTarget:bD,WebGLCoordinateSystem:Ir,WebGLCubeRenderTarget:oS,WebGLRenderTarget:ua,WebGLRenderer:PS,WebGLUtils:YC,WebGPUCoordinateSystem:Dp,WebXRController:u_,WireframeGeometry:fC,WrapAroundEnding:ag,ZeroCurvatureEnding:fh,ZeroFactor:cT,ZeroSlopeEnding:hh,ZeroStencilOp:TB,createCanvasElement:kT,error:un,getConsoleFunction:eD,log:lg,setConsoleFunction:$B,warn:Mt,warnOnce:Up},Symbol.toStringTag,{value:"Module"}));var B1={exports:{}},D1={},U1={exports:{}},O1={};var H3;function B5(){if(H3)return O1;H3=1;var i=Fp();function e(g,_){return g===_&&(g!==0||1/g===1/_)||g!==g&&_!==_}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,a=i.useEffect,r=i.useLayoutEffect,l=i.useDebugValue;function u(g,_){var y=_(),b=n({inst:{value:y,getSnapshot:_}}),C=b[0].inst,E=b[1];return r(function(){C.value=y,C.getSnapshot=_,d(C)&&E({inst:C})},[g,y,_]),a(function(){return d(C)&&E({inst:C}),g(function(){d(C)&&E({inst:C})})},[g]),l(y),y}function d(g){var _=g.getSnapshot;g=g.value;try{var y=_();return!t(g,y)}catch{return!0}}function p(g,_){return _()}var x=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:u;return O1.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:x,O1}var G3;function D5(){return G3||(G3=1,U1.exports=B5()),U1.exports}var V3;function U5(){if(V3)return D1;V3=1;var i=Fp(),e=D5();function t(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var n=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,r=i.useRef,l=i.useEffect,u=i.useMemo,d=i.useDebugValue;return D1.useSyncExternalStoreWithSelector=function(p,x,g,_,y){var b=r(null);if(b.current===null){var C={hasValue:!1,value:null};b.current=C}else C=b.current;b=u(function(){function S(N){if(!w){if(w=!0,D=N,N=_(N),y!==void 0&&C.hasValue){var z=C.value;if(y(z,N))return U=z}return U=N}if(z=U,n(D,N))return z;var j=_(N);return y!==void 0&&y(z,j)?(D=N,z):(D=N,U=j)}var w=!1,D,U,F=g===void 0?null:g;return[function(){return S(x())},F===null?void 0:function(){return S(F())}]},[x,g,_,y]);var E=a(p,b[0],b[1]);return l(function(){C.hasValue=!0,C.value=E},[E]),d(E),E},D1}var k3;function O5(){return k3||(k3=1,B1.exports=U5()),B1.exports}var N5=O5();const L5=Xb(N5),j3=i=>{let e;const t=new Set,n=(p,x)=>{const g=typeof p=="function"?p(e):p;if(!Object.is(g,e)){const _=e;e=x??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(y=>y(e,_))}},a=()=>e,u={setState:n,getState:a,getInitialState:()=>d,subscribe:p=>(t.add(p),()=>t.delete(p))},d=e=i(n,a,u);return u},qC=(i=>i?j3(i):j3),{useSyncExternalStoreWithSelector:I5}=L5,P5=i=>i;function F5(i,e=P5,t){const n=I5(i.subscribe,i.getState,i.getInitialState,e,t);return Rc.useDebugValue(n),n}const X3=(i,e)=>{const t=qC(i),n=(a,r=e)=>F5(t,a,r);return Object.assign(n,t),n},KC=((i,e)=>i?X3(i,e):X3),z5=i=>typeof i=="object"&&typeof i.then=="function",mh=[];function JC(i,e,t=(n,a)=>n===a){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let a=0;a<n;a++)if(!t(i[a],e[a]))return!1;return!0}function WC(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const r of mh)if(JC(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return n.lifespan&&n.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,n.lifespan)),r.response;if(!t)throw r.promise}const a={keys:e,equal:n.equal,remove:()=>{const r=mh.indexOf(a);r!==-1&&mh.splice(r,1)},promise:(z5(i)?i:i(...e)).then(r=>{a.response=r,n.lifespan&&n.lifespan>0&&(a.timeout=setTimeout(a.remove,n.lifespan))}).catch(r=>a.error=r)};if(mh.push(a),!t)throw a.promise}const H5=(i,e,t)=>WC(i,e,!1,t),G5=(i,e,t)=>void WC(i,e,!0,t),V5=i=>{if(i===void 0||i.length===0)mh.splice(0,mh.length);else{const e=mh.find(t=>JC(i,t.keys,t.equal));e&&e.remove()}};var N1={exports:{}},L1={exports:{}},I1={exports:{}},P1={};var Y3;function k5(){return Y3||(Y3=1,(function(i){function e(H,K){var W=H.length;H.push(K);e:for(;0<W;){var me=W-1>>>1,ve=H[me];if(0<a(ve,K))H[me]=K,H[W]=ve,W=me;else break e}}function t(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var K=H[0],W=H.pop();if(W!==K){H[0]=W;e:for(var me=0,ve=H.length,Q=ve>>>1;me<Q;){var de=2*(me+1)-1,Te=H[de],Me=de+1,rt=H[Me];if(0>a(Te,W))Me<ve&&0>a(rt,Te)?(H[me]=rt,H[Me]=W,me=Me):(H[me]=Te,H[de]=W,me=de);else if(Me<ve&&0>a(rt,W))H[me]=rt,H[Me]=W,me=Me;else break e}}return K}function a(H,K){var W=H.sortIndex-K.sortIndex;return W!==0?W:H.id-K.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var d=[],p=[],x=1,g=null,_=3,y=!1,b=!1,C=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function D(H){for(var K=t(p);K!==null;){if(K.callback===null)n(p);else if(K.startTime<=H)n(p),K.sortIndex=K.expirationTime,e(d,K);else break;K=t(p)}}function U(H){if(C=!1,D(H),!b)if(t(d)!==null)b=!0,ae();else{var K=t(p);K!==null&&re(U,K.startTime-H)}}var F=!1,N=-1,z=5,j=-1;function L(){return!(i.unstable_now()-j<z)}function P(){if(F){var H=i.unstable_now();j=H;var K=!0;try{e:{b=!1,C&&(C=!1,S(N),N=-1),y=!0;var W=_;try{t:{for(D(H),g=t(d);g!==null&&!(g.expirationTime>H&&L());){var me=g.callback;if(typeof me=="function"){g.callback=null,_=g.priorityLevel;var ve=me(g.expirationTime<=H);if(H=i.unstable_now(),typeof ve=="function"){g.callback=ve,D(H),K=!0;break t}g===t(d)&&n(d),D(H)}else n(d);g=t(d)}if(g!==null)K=!0;else{var Q=t(p);Q!==null&&re(U,Q.startTime-H),K=!1}}break e}finally{g=null,_=W,y=!1}K=void 0}}finally{K?q():F=!1}}}var q;if(typeof w=="function")q=function(){w(P)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,se=ie.port2;ie.port1.onmessage=P,q=function(){se.postMessage(null)}}else q=function(){E(P,0)};function ae(){F||(F=!0,q())}function re(H,K){N=E(function(){H(i.unstable_now())},K)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(H){H.callback=null},i.unstable_continueExecution=function(){b||y||(b=!0,ae())},i.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<H?Math.floor(1e3/H):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_getFirstCallbackNode=function(){return t(d)},i.unstable_next=function(H){switch(_){case 1:case 2:case 3:var K=3;break;default:K=_}var W=_;_=K;try{return H()}finally{_=W}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(H,K){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var W=_;_=H;try{return K()}finally{_=W}},i.unstable_scheduleCallback=function(H,K,W){var me=i.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?me+W:me):W=me,H){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=W+ve,H={id:x++,callback:K,priorityLevel:H,startTime:W,expirationTime:ve,sortIndex:-1},W>me?(H.sortIndex=W,e(p,H),t(d)===null&&H===t(p)&&(C?(S(N),N=-1):C=!0,re(U,W-me))):(H.sortIndex=ve,e(d,H),b||y||(b=!0,ae())),H},i.unstable_shouldYield=L,i.unstable_wrapCallback=function(H){var K=_;return function(){var W=_;_=K;try{return H.apply(this,arguments)}finally{_=W}}}})(P1)),P1}var q3;function j5(){return q3||(q3=1,I1.exports=k5()),I1.exports}var K3;function X5(){return K3||(K3=1,(function(i){i.exports=function(e){function t(c,f,v,M){return new v0(c,f,v,M)}function n(){}function a(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)f+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(c){return c===null||typeof c!="object"?null:(c=M0&&c[M0]||c["@@iterator"],typeof c=="function"?c:null)}function l(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===$l?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case Jc:return"Fragment";case Mr:return"Portal";case A0:return"Profiler";case S0:return"StrictMode";case ld:return"Suspense";case xl:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case Kr:return(c.displayName||"Context")+".Provider";case vl:return(c._context.displayName||"Context")+".Consumer";case Wc:var f=c.render;return c=c.displayName,c||(c=f.displayName||f.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case yf:return f=c.displayName||null,f!==null?f:l(c.type)||"Memo";case Er:f=c._payload,c=c._init;try{return l(c(f))}catch{}}return null}function u(c){if(cd===void 0)try{throw Error()}catch(v){var f=v.stack.trim().match(/\n( *(at )?)/);cd=f&&f[1]||"",E0=-1<v.stack.indexOf(`
    at`)?" (<anonymous>)":-1<v.stack.indexOf("@")?"@unknown:0:0":""}return`
`+cd+c+E0}function d(c,f){if(!c||_l)return"";_l=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var M={DetermineComponentFrameRoot:function(){try{if(f){var St=function(){throw Error()};if(Object.defineProperty(St.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(St,[])}catch(ln){var wt=ln}Reflect.construct(c,[],St)}else{try{St.call()}catch(ln){wt=ln}c.call(St.prototype)}}else{try{throw Error()}catch(ln){wt=ln}(St=c())&&typeof St.catch=="function"&&St.catch(function(){})}}catch(ln){if(ln&&wt&&typeof ln.stack=="string")return[ln.stack,wt.stack]}return[null,null]}};M.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var R=Object.getOwnPropertyDescriptor(M.DetermineComponentFrameRoot,"name");R&&R.configurable&&Object.defineProperty(M.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var O=M.DetermineComponentFrameRoot(),J=O[0],ce=O[1];if(J&&ce){var Se=J.split(`
`),Xe=ce.split(`
`);for(R=M=0;M<Se.length&&!Se[M].includes("DetermineComponentFrameRoot");)M++;for(;R<Xe.length&&!Xe[R].includes("DetermineComponentFrameRoot");)R++;if(M===Se.length||R===Xe.length)for(M=Se.length-1,R=Xe.length-1;1<=M&&0<=R&&Se[M]!==Xe[R];)R--;for(;1<=M&&0<=R;M--,R--)if(Se[M]!==Xe[R]){if(M!==1||R!==1)do if(M--,R--,0>R||Se[M]!==Xe[R]){var dt=`
`+Se[M].replace(" at new "," at ");return c.displayName&&dt.includes("<anonymous>")&&(dt=dt.replace("<anonymous>",c.displayName)),dt}while(1<=M&&0<=R);break}}}finally{_l=!1,Error.prepareStackTrace=v}return(v=c?c.displayName||c.name:"")?u(v):""}function p(c){switch(c.tag){case 26:case 27:case 5:return u(c.type);case 16:return u("Lazy");case 13:return u("Suspense");case 19:return u("SuspenseList");case 0:case 15:return c=d(c.type,!1),c;case 11:return c=d(c.type.render,!1),c;case 1:return c=d(c.type,!0),c;default:return""}}function x(c){try{var f="";do f+=p(c),c=c.return;while(c);return f}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}function g(c){var f=c,v=c;if(c.alternate)for(;f.return;)f=f.return;else{c=f;do f=c,(f.flags&4098)!==0&&(v=f.return),c=f.return;while(c)}return f.tag===3?v:null}function _(c){if(g(c)!==c)throw Error(a(188))}function y(c){var f=c.alternate;if(!f){if(f=g(c),f===null)throw Error(a(188));return f!==c?null:c}for(var v=c,M=f;;){var R=v.return;if(R===null)break;var O=R.alternate;if(O===null){if(M=R.return,M!==null){v=M;continue}break}if(R.child===O.child){for(O=R.child;O;){if(O===v)return _(R),c;if(O===M)return _(R),f;O=O.sibling}throw Error(a(188))}if(v.return!==M.return)v=R,M=O;else{for(var J=!1,ce=R.child;ce;){if(ce===v){J=!0,v=R,M=O;break}if(ce===M){J=!0,M=R,v=O;break}ce=ce.sibling}if(!J){for(ce=O.child;ce;){if(ce===v){J=!0,v=O,M=R;break}if(ce===M){J=!0,M=O,v=R;break}ce=ce.sibling}if(!J)throw Error(a(189))}}if(v.alternate!==M)throw Error(a(190))}if(v.tag!==3)throw Error(a(188));return v.stateNode.current===v?c:f}function b(c){var f=c.tag;if(f===5||f===26||f===27||f===6)return c;for(c=c.child;c!==null;){if(f=b(c),f!==null)return f;c=c.sibling}return null}function C(c){var f=c.tag;if(f===5||f===26||f===27||f===6)return c;for(c=c.child;c!==null;){if(c.tag!==4&&(f=C(c),f!==null))return f;c=c.sibling}return null}function E(c){return{current:c}}function S(c){0>Bo||(c.current=wf[Bo],wf[Bo]=null,Bo--)}function w(c,f){Bo++,wf[Bo]=c.current,c.current=f}function D(c){return c>>>=0,c===0?32:31-(Bf(c)/wv|0)|0}function U(c){var f=c&42;if(f!==0)return f;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function F(c,f){var v=c.pendingLanes;if(v===0)return 0;var M=0,R=c.suspendedLanes,O=c.pingedLanes,J=c.warmLanes;c=c.finishedLanes!==0;var ce=v&134217727;return ce!==0?(v=ce&~R,v!==0?M=U(v):(O&=ce,O!==0?M=U(O):c||(J=ce&~J,J!==0&&(M=U(J))))):(ce=v&~R,ce!==0?M=U(ce):O!==0?M=U(O):c||(J=v&~J,J!==0&&(M=U(J)))),M===0?0:f!==0&&f!==M&&(f&R)===0&&(R=M&-M,J=f&-f,R>=J||R===32&&(J&4194176)!==0)?f:M}function N(c,f){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&f)===0}function z(c,f){switch(c){case 1:case 2:case 4:case 8:return f+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function j(){var c=eu;return eu<<=1,(eu&4194176)===0&&(eu=128),c}function L(){var c=Df;return Df<<=1,(Df&62914560)===0&&(Df=4194304),c}function P(c){for(var f=[],v=0;31>v;v++)f.push(c);return f}function q(c,f){c.pendingLanes|=f,f!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function ie(c,f,v,M,R,O){var J=c.pendingLanes;c.pendingLanes=v,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=v,c.entangledLanes&=v,c.errorRecoveryDisabledLanes&=v,c.shellSuspendCounter=0;var ce=c.entanglements,Se=c.expirationTimes,Xe=c.hiddenUpdates;for(v=J&~v;0<v;){var dt=31-ys(v),St=1<<dt;ce[dt]=0,Se[dt]=-1;var wt=Xe[dt];if(wt!==null)for(Xe[dt]=null,dt=0;dt<wt.length;dt++){var ln=wt[dt];ln!==null&&(ln.lane&=-536870913)}v&=~St}M!==0&&se(c,M,0),O!==0&&R===0&&c.tag!==0&&(c.suspendedLanes|=O&~(J&~f))}function se(c,f,v){c.pendingLanes|=f,c.suspendedLanes&=~f;var M=31-ys(f);c.entangledLanes|=f,c.entanglements[M]=c.entanglements[M]|1073741824|v&4194218}function ae(c,f){var v=c.entangledLanes|=f;for(c=c.entanglements;v;){var M=31-ys(v),R=1<<M;R&f|c[M]&f&&(c[M]|=f),v&=~R}}function re(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function H(c){if(bs&&typeof bs.onCommitFiberRoot=="function")try{bs.onCommitFiberRoot(nu,c,void 0,(c.current.flags&128)===128)}catch{}}function K(c){if(typeof Ov=="function"&&nm(c),bs&&typeof bs.setStrictMode=="function")try{bs.setStrictMode(nu,c)}catch{}}function W(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}function me(c,f){if(typeof c=="object"&&c!==null){var v=Td.get(c);return v!==void 0?v:(f={value:c,source:f,stack:x(f)},Td.set(c,f),f)}return{value:c,source:f,stack:x(f)}}function ve(c,f){Ci[Fi++]=Nf,Ci[Fi++]=Of,Of=c,Nf=f}function Q(c,f,v){Vs[ks++]=$r,Vs[ks++]=cr,Vs[ks++]=Tr,Tr=c;var M=$r;c=cr;var R=32-ys(M)-1;M&=~(1<<R),v+=1;var O=32-ys(f)+R;if(30<O){var J=R-R%5;O=(M&(1<<J)-1).toString(32),M>>=J,R-=J,$r=1<<32-ys(f)+R|v<<R|M,cr=O+c}else $r=1<<O|v<<R|M,cr=c}function de(c){c.return!==null&&(ve(c,1),Q(c,1,0))}function Te(c){for(;c===Of;)Of=Ci[--Fi],Ci[Fi]=null,Nf=Ci[--Fi],Ci[Fi]=null;for(;c===Tr;)Tr=Vs[--ks],Vs[ks]=null,cr=Vs[--ks],Vs[ks]=null,$r=Vs[--ks],Vs[ks]=null}function Me(c,f){w(Cr,f),w(Lf,c),w(Ta,null),c=ec(f),S(Ta),w(Ta,c)}function rt(){S(Ta),S(Lf),S(Cr)}function xe(c){c.memoizedState!==null&&w(iu,c);var f=Ta.current,v=lv(f,c.type);f!==v&&(w(Lf,c),w(Ta,v))}function fe(c){Lf.current===c&&(S(Ta),S(Lf)),iu.current===c&&(S(iu),Wr?nn._currentValue=_s:nn._currentValue2=_s)}function Fe(c){var f=Error(a(418,""));throw Ot(me(f,c)),If}function et(c,f){if(!rs)throw Error(a(175));i2(c.stateNode,c.type,c.memoizedProps,f,c)||Fe(c)}function ht(c){for(Ka=c.return;Ka;)switch(Ka.tag){case 3:case 27:ur=!0;return;case 5:case 13:ur=!1;return;default:Ka=Ka.return}}function yt(c){if(!rs||c!==Ka)return!1;if(!Xn)return ht(c),Xn=!0,!1;var f=!1;if(Na?c.tag!==3&&c.tag!==27&&(c.tag!==5||Mv(c.type)&&!Sl(c.type,c.memoizedProps))&&(f=!0):c.tag!==3&&(c.tag!==5||Mv(c.type)&&!Sl(c.type,c.memoizedProps))&&(f=!0),f&&Ia&&Fe(c),ht(c),c.tag===13){if(!rs)throw Error(a(316));if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(a(317));Ia=Sv(c)}else Ia=Ka?k0(c.stateNode):null;return!0}function Xt(){rs&&(Ia=Ka=null,Xn=!1)}function Ot(c){js===null?js=[c]:js.push(c)}function ke(){for(var c=Ml,f=au=Ml=0;f<c;){var v=Xs[f];Xs[f++]=null;var M=Xs[f];Xs[f++]=null;var R=Xs[f];Xs[f++]=null;var O=Xs[f];if(Xs[f++]=null,M!==null&&R!==null){var J=M.pending;J===null?R.next=R:(R.next=J.next,J.next=R),M.pending=R}O!==0&&pt(v,R,O)}}function $(c,f,v,M){Xs[Ml++]=c,Xs[Ml++]=f,Xs[Ml++]=v,Xs[Ml++]=M,au|=M,c.lanes|=M,c=c.alternate,c!==null&&(c.lanes|=M)}function Qe(c,f,v,M){return $(c,f,v,M),it(c)}function st(c,f){return $(c,null,null,f),it(c)}function pt(c,f,v){c.lanes|=v;var M=c.alternate;M!==null&&(M.lanes|=v);for(var R=!1,O=c.return;O!==null;)O.childLanes|=v,M=O.alternate,M!==null&&(M.childLanes|=v),O.tag===22&&(c=O.stateNode,c===null||c._visibility&1||(R=!0)),c=O,O=O.return;R&&f!==null&&c.tag===3&&(O=c.stateNode,R=31-ys(v),O=O.hiddenUpdates,c=O[R],c===null?O[R]=[f]:c.push(f),f.lane=v|536870912)}function it(c){if(50<fc)throw fc=0,cs=null,Error(a(185));for(var f=c.return;f!==null;)c=f,f=c.return;return c.tag===3?c.stateNode:null}function bt(c){c!==ac&&c.next===null&&(ac===null?su=ac=c:ac=ac.next=c),Ff=!0,Pf||(Pf=!0,He(Ct))}function mt(c,f){if(!Rr&&Ff){Rr=!0;do for(var v=!1,M=su;M!==null;){if(c!==0){var R=M.pendingLanes;if(R===0)var O=0;else{var J=M.suspendedLanes,ce=M.pingedLanes;O=(1<<31-ys(42|c)+1)-1,O&=R&~(J&~ce),O=O&201326677?O&201326677|1:O?O|2:0}O!==0&&(v=!0,Ae(M,O))}else O=yn,O=F(M,M===En?O:0),(O&3)===0||N(M,O)||(v=!0,Ae(M,O));M=M.next}while(v);Rr=!1}}function Ct(){Ff=Pf=!1;var c=0;El!==0&&(Al()&&(c=El),El=0);for(var f=La(),v=null,M=su;M!==null;){var R=M.next,O=ee(M,f);O===0?(M.next=null,v===null?su=R:v.next=R,R===null&&(ac=v)):(v=M,(c!==0||(O&3)!==0)&&(Ff=!0)),M=R}mt(c)}function ee(c,f){for(var v=c.suspendedLanes,M=c.pingedLanes,R=c.expirationTimes,O=c.pendingLanes&-62914561;0<O;){var J=31-ys(O),ce=1<<J,Se=R[J];Se===-1?((ce&v)===0||(ce&M)!==0)&&(R[J]=z(ce,f)):Se<=f&&(c.expiredLanes|=ce),O&=~ce}if(f=En,v=yn,v=F(c,c===f?v:0),M=c.callbackNode,v===0||c===f&&mi===2||c.cancelPendingCommit!==null)return M!==null&&M!==null&&Uf(M),c.callbackNode=null,c.callbackPriority=0;if((v&3)===0||N(c,v)){if(f=v&-v,f===c.callbackPriority)return f;switch(M!==null&&Uf(M),re(v)){case 2:case 8:v=Uv;break;case 32:v=Md;break;case 268435456:v=Ed;break;default:v=Md}return M=X.bind(null,c),v=tu(v,M),c.callbackPriority=f,c.callbackNode=v,f}return M!==null&&M!==null&&Uf(M),c.callbackPriority=2,c.callbackNode=null,2}function X(c,f){var v=c.callbackNode;if(Ma()&&c.callbackNode!==v)return null;var M=yn;return M=F(c,c===En?M:0),M===0?null:(mf(c,M,f),ee(c,La()),c.callbackNode!=null&&c.callbackNode===v?X.bind(null,c):null)}function Ae(c,f){if(Ma())return null;mf(c,f,!0)}function He(c){na?dd(function(){(Kt&6)!==0?tu(tm,c):c()}):tu(tm,c)}function Ze(){return El===0&&(El=j()),El}function Le(c,f){if(zf===null){var v=zf=[];Cd=0,Ss=Ze(),Tl={status:"pending",value:void 0,then:function(M){v.push(M)}}}return Cd++,f.then(Nt,Nt),f}function Nt(){if(--Cd===0&&zf!==null){Tl!==null&&(Tl.status="fulfilled");var c=zf;zf=null,Ss=0,Tl=null;for(var f=0;f<c.length;f++)(0,c[f])()}}function xt(c,f){var v=[],M={status:"pending",value:null,reason:null,then:function(R){v.push(R)}};return c.then(function(){M.status="fulfilled",M.value=f;for(var R=0;R<v.length;R++)(0,v[R])(f)},function(R){for(M.status="rejected",M.reason=R,R=0;R<v.length;R++)(0,v[R])(void 0)}),M}function Vt(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Lt(c,f){c=c.updateQueue,f.updateQueue===c&&(f.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function Ye(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function qe(c,f,v){var M=c.updateQueue;if(M===null)return null;if(M=M.shared,(Kt&2)!==0){var R=M.pending;return R===null?f.next=f:(f.next=R.next,R.next=f),M.pending=f,f=it(c),pt(c,null,v),f}return $(c,M,f,v),it(c)}function It(c,f,v){if(f=f.updateQueue,f!==null&&(f=f.shared,(v&4194176)!==0)){var M=f.lanes;M&=c.pendingLanes,v|=M,f.lanes=v,ae(c,v)}}function Et(c,f){var v=c.updateQueue,M=c.alternate;if(M!==null&&(M=M.updateQueue,v===M)){var R=null,O=null;if(v=v.firstBaseUpdate,v!==null){do{var J={lane:v.lane,tag:v.tag,payload:v.payload,callback:null,next:null};O===null?R=O=J:O=O.next=J,v=v.next}while(v!==null);O===null?R=O=f:O=O.next=f}else R=O=f;v={baseState:M.baseState,firstBaseUpdate:R,lastBaseUpdate:O,shared:M.shared,callbacks:M.callbacks},c.updateQueue=v;return}c=v.lastBaseUpdate,c===null?v.firstBaseUpdate=f:c.next=f,v.lastBaseUpdate=f}function gt(){if(ru){var c=Tl;if(c!==null)throw c}}function Dt(c,f,v,M){ru=!1;var R=c.updateQueue;Do=!1;var O=R.firstBaseUpdate,J=R.lastBaseUpdate,ce=R.shared.pending;if(ce!==null){R.shared.pending=null;var Se=ce,Xe=Se.next;Se.next=null,J===null?O=Xe:J.next=Xe,J=Se;var dt=c.alternate;dt!==null&&(dt=dt.updateQueue,ce=dt.lastBaseUpdate,ce!==J&&(ce===null?dt.firstBaseUpdate=Xe:ce.next=Xe,dt.lastBaseUpdate=Se))}if(O!==null){var St=R.baseState;J=0,dt=Xe=Se=null,ce=O;do{var wt=ce.lane&-536870913,ln=wt!==ce.lane;if(ln?(yn&wt)===wt:(M&wt)===wt){wt!==0&&wt===Ss&&(ru=!0),dt!==null&&(dt=dt.next={lane:0,tag:ce.tag,payload:ce.payload,callback:null,next:null});e:{var Ts=c,kf=ce;wt=f;var hc=v;switch(kf.tag){case 1:if(Ts=kf.payload,typeof Ts=="function"){St=Ts.call(hc,St,wt);break e}St=Ts;break e;case 3:Ts.flags=Ts.flags&-65537|128;case 0:if(Ts=kf.payload,wt=typeof Ts=="function"?Ts.call(hc,St,wt):Ts,wt==null)break e;St=Ql({},St,wt);break e;case 2:Do=!0}}wt=ce.callback,wt!==null&&(c.flags|=64,ln&&(c.flags|=8192),ln=R.callbacks,ln===null?R.callbacks=[wt]:ln.push(wt))}else ln={lane:wt,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},dt===null?(Xe=dt=ln,Se=St):dt=dt.next=ln,J|=wt;if(ce=ce.next,ce===null){if(ce=R.shared.pending,ce===null)break;ln=ce,ce=ln.next,ln.next=null,R.lastBaseUpdate=ln,R.shared.pending=null}}while(!0);dt===null&&(Se=St),R.baseState=Se,R.firstBaseUpdate=Xe,R.lastBaseUpdate=dt,O===null&&(R.shared.lanes=0),Js|=J,c.lanes=J,c.memoizedState=St}}function pe(c,f){if(typeof c!="function")throw Error(a(191,c));c.call(f)}function Ue(c,f){var v=c.callbacks;if(v!==null)for(c.callbacks=null,c=0;c<v.length;c++)pe(v[c],f)}function ft(c,f){if(Gs(c,f))return!0;if(typeof c!="object"||c===null||typeof f!="object"||f===null)return!1;var v=Object.keys(c),M=Object.keys(f);if(v.length!==M.length)return!1;for(M=0;M<v.length;M++){var R=v[M];if(!Hf.call(f,R)||!Gs(c[R],f[R]))return!1}return!0}function vt(c){return c=c.status,c==="fulfilled"||c==="rejected"}function tt(){}function Je(c,f,v){switch(v=c[v],v===void 0?c.push(f):v!==f&&(f.then(tt,tt),f=v),f.status){case"fulfilled":return f.value;case"rejected":throw c=f.reason,c===fi?Error(a(483)):c;default:if(typeof f.status=="string")f.then(tt,tt);else{if(c=En,c!==null&&100<c.shellSuspendCounter)throw Error(a(482));c=f,c.status="pending",c.then(function(M){if(f.status==="pending"){var R=f;R.status="fulfilled",R.value=M}},function(M){if(f.status==="pending"){var R=f;R.status="rejected",R.reason=M}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw c=f.reason,c===fi?Error(a(483)):c}throw sc=f,fi}}function Bt(){if(sc===null)throw Error(a(459));var c=sc;return sc=null,c}function Qt(c){var f=fr;return fr+=1,eo===null&&(eo=[]),Je(eo,c,f)}function Fn(c,f){f=f.props.ref,c.ref=f!==void 0?f:null}function Cn(c,f){throw f.$$typeof===b0?Error(a(525)):(c=Object.prototype.toString.call(f),Error(a(31,c==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":c)))}function fa(c){var f=c._init;return f(c._payload)}function Va(c){function f(Re,ye){if(c){var Oe=Re.deletions;Oe===null?(Re.deletions=[ye],Re.flags|=16):Oe.push(ye)}}function v(Re,ye){if(!c)return null;for(;ye!==null;)f(Re,ye),ye=ye.sibling;return null}function M(Re){for(var ye=new Map;Re!==null;)Re.key!==null?ye.set(Re.key,Re):ye.set(Re.index,Re),Re=Re.sibling;return ye}function R(Re,ye){return Re=Ya(Re,ye),Re.index=0,Re.sibling=null,Re}function O(Re,ye,Oe){return Re.index=Oe,c?(Oe=Re.alternate,Oe!==null?(Oe=Oe.index,Oe<ye?(Re.flags|=33554434,ye):Oe):(Re.flags|=33554434,ye)):(Re.flags|=1048576,ye)}function J(Re){return c&&Re.alternate===null&&(Re.flags|=33554434),Re}function ce(Re,ye,Oe,lt){return ye===null||ye.tag!==6?(ye=gl(Oe,Re.mode,lt),ye.return=Re,ye):(ye=R(ye,Oe),ye.return=Re,ye)}function Se(Re,ye,Oe,lt){var jt=Oe.type;return jt===Jc?dt(Re,ye,Oe.props.children,lt,Oe.key):ye!==null&&(ye.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Er&&fa(jt)===ye.type)?(ye=R(ye,Oe.props),Fn(ye,Oe),ye.return=Re,ye):(ye=or(Oe.type,Oe.key,Oe.props,null,Re.mode,lt),Fn(ye,Oe),ye.return=Re,ye)}function Xe(Re,ye,Oe,lt){return ye===null||ye.tag!==4||ye.stateNode.containerInfo!==Oe.containerInfo||ye.stateNode.implementation!==Oe.implementation?(ye=Kc(Oe,Re.mode,lt),ye.return=Re,ye):(ye=R(ye,Oe.children||[]),ye.return=Re,ye)}function dt(Re,ye,Oe,lt,jt){return ye===null||ye.tag!==7?(ye=Eo(Oe,Re.mode,lt,jt),ye.return=Re,ye):(ye=R(ye,Oe),ye.return=Re,ye)}function St(Re,ye,Oe){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ye=gl(""+ye,Re.mode,Oe),ye.return=Re,ye;if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case To:return Oe=or(ye.type,ye.key,ye.props,null,Re.mode,Oe),Fn(Oe,ye),Oe.return=Re,Oe;case Mr:return ye=Kc(ye,Re.mode,Oe),ye.return=Re,ye;case Er:var lt=ye._init;return ye=lt(ye._payload),St(Re,ye,Oe)}if(yl(ye)||r(ye))return ye=Eo(ye,Re.mode,Oe,null),ye.return=Re,ye;if(typeof ye.then=="function")return St(Re,Qt(ye),Oe);if(ye.$$typeof===Kr)return St(Re,uf(Re,ye),Oe);Cn(Re,ye)}return null}function wt(Re,ye,Oe,lt){var jt=ye!==null?ye.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return jt!==null?null:ce(Re,ye,""+Oe,lt);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case To:return Oe.key===jt?Se(Re,ye,Oe,lt):null;case Mr:return Oe.key===jt?Xe(Re,ye,Oe,lt):null;case Er:return jt=Oe._init,Oe=jt(Oe._payload),wt(Re,ye,Oe,lt)}if(yl(Oe)||r(Oe))return jt!==null?null:dt(Re,ye,Oe,lt,null);if(typeof Oe.then=="function")return wt(Re,ye,Qt(Oe),lt);if(Oe.$$typeof===Kr)return wt(Re,ye,uf(Re,Oe),lt);Cn(Re,Oe)}return null}function ln(Re,ye,Oe,lt,jt){if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return Re=Re.get(Oe)||null,ce(ye,Re,""+lt,jt);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case To:return Re=Re.get(lt.key===null?Oe:lt.key)||null,Se(ye,Re,lt,jt);case Mr:return Re=Re.get(lt.key===null?Oe:lt.key)||null,Xe(ye,Re,lt,jt);case Er:var yi=lt._init;return lt=yi(lt._payload),ln(Re,ye,Oe,lt,jt)}if(yl(lt)||r(lt))return Re=Re.get(Oe)||null,dt(ye,Re,lt,jt,null);if(typeof lt.then=="function")return ln(Re,ye,Oe,Qt(lt),jt);if(lt.$$typeof===Kr)return ln(Re,ye,Oe,uf(ye,lt),jt);Cn(ye,lt)}return null}function Ts(Re,ye,Oe,lt){for(var jt=null,yi=null,an=ye,qn=ye=0,ga=null;an!==null&&qn<Oe.length;qn++){an.index>qn?(ga=an,an=null):ga=an.sibling;var Kn=wt(Re,an,Oe[qn],lt);if(Kn===null){an===null&&(an=ga);break}c&&an&&Kn.alternate===null&&f(Re,an),ye=O(Kn,ye,qn),yi===null?jt=Kn:yi.sibling=Kn,yi=Kn,an=ga}if(qn===Oe.length)return v(Re,an),Xn&&ve(Re,qn),jt;if(an===null){for(;qn<Oe.length;qn++)an=St(Re,Oe[qn],lt),an!==null&&(ye=O(an,ye,qn),yi===null?jt=an:yi.sibling=an,yi=an);return Xn&&ve(Re,qn),jt}for(an=M(an);qn<Oe.length;qn++)ga=ln(an,Re,qn,Oe[qn],lt),ga!==null&&(c&&ga.alternate!==null&&an.delete(ga.key===null?qn:ga.key),ye=O(ga,ye,qn),yi===null?jt=ga:yi.sibling=ga,yi=ga);return c&&an.forEach(function(Fo){return f(Re,Fo)}),Xn&&ve(Re,qn),jt}function kf(Re,ye,Oe,lt){if(Oe==null)throw Error(a(151));for(var jt=null,yi=null,an=ye,qn=ye=0,ga=null,Kn=Oe.next();an!==null&&!Kn.done;qn++,Kn=Oe.next()){an.index>qn?(ga=an,an=null):ga=an.sibling;var Fo=wt(Re,an,Kn.value,lt);if(Fo===null){an===null&&(an=ga);break}c&&an&&Fo.alternate===null&&f(Re,an),ye=O(Fo,ye,qn),yi===null?jt=Fo:yi.sibling=Fo,yi=Fo,an=ga}if(Kn.done)return v(Re,an),Xn&&ve(Re,qn),jt;if(an===null){for(;!Kn.done;qn++,Kn=Oe.next())Kn=St(Re,Kn.value,lt),Kn!==null&&(ye=O(Kn,ye,qn),yi===null?jt=Kn:yi.sibling=Kn,yi=Kn);return Xn&&ve(Re,qn),jt}for(an=M(an);!Kn.done;qn++,Kn=Oe.next())Kn=ln(an,Re,qn,Kn.value,lt),Kn!==null&&(c&&Kn.alternate!==null&&an.delete(Kn.key===null?qn:Kn.key),ye=O(Kn,ye,qn),yi===null?jt=Kn:yi.sibling=Kn,yi=Kn);return c&&an.forEach(function(Id){return f(Re,Id)}),Xn&&ve(Re,qn),jt}function hc(Re,ye,Oe,lt){if(typeof Oe=="object"&&Oe!==null&&Oe.type===Jc&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case To:e:{for(var jt=Oe.key;ye!==null;){if(ye.key===jt){if(jt=Oe.type,jt===Jc){if(ye.tag===7){v(Re,ye.sibling),lt=R(ye,Oe.props.children),lt.return=Re,Re=lt;break e}}else if(ye.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Er&&fa(jt)===ye.type){v(Re,ye.sibling),lt=R(ye,Oe.props),Fn(lt,Oe),lt.return=Re,Re=lt;break e}v(Re,ye);break}else f(Re,ye);ye=ye.sibling}Oe.type===Jc?(lt=Eo(Oe.props.children,Re.mode,lt,Oe.key),lt.return=Re,Re=lt):(lt=or(Oe.type,Oe.key,Oe.props,null,Re.mode,lt),Fn(lt,Oe),lt.return=Re,Re=lt)}return J(Re);case Mr:e:{for(jt=Oe.key;ye!==null;){if(ye.key===jt)if(ye.tag===4&&ye.stateNode.containerInfo===Oe.containerInfo&&ye.stateNode.implementation===Oe.implementation){v(Re,ye.sibling),lt=R(ye,Oe.children||[]),lt.return=Re,Re=lt;break e}else{v(Re,ye);break}else f(Re,ye);ye=ye.sibling}lt=Kc(Oe,Re.mode,lt),lt.return=Re,Re=lt}return J(Re);case Er:return jt=Oe._init,Oe=jt(Oe._payload),hc(Re,ye,Oe,lt)}if(yl(Oe))return Ts(Re,ye,Oe,lt);if(r(Oe)){if(jt=r(Oe),typeof jt!="function")throw Error(a(150));return Oe=jt.call(Oe),kf(Re,ye,Oe,lt)}if(typeof Oe.then=="function")return hc(Re,ye,Qt(Oe),lt);if(Oe.$$typeof===Kr)return hc(Re,ye,uf(Re,Oe),lt);Cn(Re,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint"?(Oe=""+Oe,ye!==null&&ye.tag===6?(v(Re,ye.sibling),lt=R(ye,Oe),lt.return=Re,Re=lt):(v(Re,ye),lt=gl(Oe,Re.mode,lt),lt.return=Re,Re=lt),J(Re)):v(Re,ye)}return function(Re,ye,Oe,lt){try{fr=0;var jt=hc(Re,ye,Oe,lt);return eo=null,jt}catch(an){if(an===fi)throw an;var yi=t(29,an,null,Re.mode);return yi.lanes=lt,yi.return=Re,yi}finally{}}}function zl(c,f){c=wr,w(Ys,c),w(to,f),wr=c|f.baseLanes}function go(){w(Ys,wr),w(to,to.current)}function sr(){wr=Ys.current,S(to),S(Ys)}function ta(c){var f=c.alternate;w(ia,ia.current&1),w(qs,c),hr===null&&(f===null||to.current!==null||f.memoizedState!==null)&&(hr=c)}function ms(c){if(c.tag===22){if(w(ia,ia.current),w(qs,c),hr===null){var f=c.alternate;f!==null&&f.memoizedState!==null&&(hr=c)}}else ba()}function ba(){w(ia,ia.current),w(qs,qs.current)}function en(c){S(qs),hr===c&&(hr=null),S(ia)}function ha(c){for(var f=c;f!==null;){if(f.tag===13){var v=f.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||xd(v)||Rf(v)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function hn(){throw Error(a(321))}function G(c,f){if(f===null)return!1;for(var v=0;v<f.length&&v<c.length;v++)if(!Gs(c[v],f[v]))return!1;return!0}function Z(c,f,v,M,R,O){return no=O,mn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,$t.H=c===null||c.memoizedState===null?aa:Ja,Uo=!1,O=v(M,R),Uo=!1,Ri&&(O=we(f,v,M,R)),he(c),O}function he(c){$t.H=Yn;var f=ei!==null&&ei.next!==null;if(no=0,qi=ei=mn=null,dr=!1,zi=0,ou=null,f)throw Error(a(300));c===null||Ki||(c=c.dependencies,c!==null&&sl(c)&&(Ki=!0))}function we(c,f,v,M){mn=c;var R=0;do{if(Ri&&(ou=null),zi=0,Ri=!1,25<=R)throw Error(a(301));if(R+=1,qi=ei=null,c.updateQueue!=null){var O=c.updateQueue;O.lastEffect=null,O.events=null,O.stores=null,O.memoCache!=null&&(O.memoCache.index=0)}$t.H=Rl,O=f(v,M)}while(Ri);return O}function ze(){var c=$t.H,f=c.useState()[0];return f=typeof f.then=="function"?ne(f):f,c=c.useState()[0],(ei!==null?ei.memoizedState:null)!==c&&(mn.flags|=1024),f}function Pe(){var c=Gf!==0;return Gf=0,c}function ot(c,f,v){f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~v}function nt(c){if(dr){for(c=c.memoizedState;c!==null;){var f=c.queue;f!==null&&(f.pending=null),c=c.next}dr=!1}no=0,qi=ei=mn=null,Ri=!1,zi=Gf=0,ou=null}function at(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qi===null?mn.memoizedState=qi=c:qi=qi.next=c,qi}function V(){if(ei===null){var c=mn.alternate;c=c!==null?c.memoizedState:null}else c=ei.next;var f=qi===null?mn.memoizedState:qi.next;if(f!==null)qi=f,ei=c;else{if(c===null)throw mn.alternate===null?Error(a(467)):Error(a(310));ei=c,c={memoizedState:ei.memoizedState,baseState:ei.baseState,baseQueue:ei.baseQueue,queue:ei.queue,next:null},qi===null?mn.memoizedState=qi=c:qi=qi.next=c}return qi}function ne(c){var f=zi;return zi+=1,ou===null&&(ou=[]),c=Je(ou,c,f),f=mn,(qi===null?f.memoizedState:qi.next)===null&&(f=f.alternate,$t.H=f===null||f.memoizedState===null?aa:Ja),c}function le(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return ne(c);if(c.$$typeof===Kr)return Da(c)}throw Error(a(438,String(c)))}function _e(c){var f=null,v=mn.updateQueue;if(v!==null&&(f=v.memoCache),f==null){var M=mn.alternate;M!==null&&(M=M.updateQueue,M!==null&&(M=M.memoCache,M!=null&&(f={data:M.data.map(function(R){return R.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),v===null&&(v=wd(),mn.updateQueue=v),v.memoCache=f,v=f.data[f.index],v===void 0)for(v=f.data[f.index]=Array(c),M=0;M<c;M++)v[M]=ov;return f.index++,v}function oe(c,f){return typeof f=="function"?f(c):f}function Ne(c){var f=V();return je(f,ei,c)}function je(c,f,v){var M=c.queue;if(M===null)throw Error(a(311));M.lastRenderedReducer=v;var R=c.baseQueue,O=M.pending;if(O!==null){if(R!==null){var J=R.next;R.next=O.next,O.next=J}f.baseQueue=R=O,M.pending=null}if(O=c.baseState,R===null)c.memoizedState=O;else{f=R.next;var ce=J=null,Se=null,Xe=f,dt=!1;do{var St=Xe.lane&-536870913;if(St!==Xe.lane?(yn&St)===St:(no&St)===St){var wt=Xe.revertLane;if(wt===0)Se!==null&&(Se=Se.next={lane:0,revertLane:0,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null}),St===Ss&&(dt=!0);else if((no&wt)===wt){Xe=Xe.next,wt===Ss&&(dt=!0);continue}else St={lane:0,revertLane:Xe.revertLane,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},Se===null?(ce=Se=St,J=O):Se=Se.next=St,mn.lanes|=wt,Js|=wt;St=Xe.action,Uo&&v(O,St),O=Xe.hasEagerState?Xe.eagerState:v(O,St)}else wt={lane:St,revertLane:Xe.revertLane,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},Se===null?(ce=Se=wt,J=O):Se=Se.next=wt,mn.lanes|=St,Js|=St;Xe=Xe.next}while(Xe!==null&&Xe!==f);if(Se===null?J=O:Se.next=ce,!Gs(O,c.memoizedState)&&(Ki=!0,dt&&(v=Tl,v!==null)))throw v;c.memoizedState=O,c.baseState=J,c.baseQueue=Se,M.lastRenderedState=O}return R===null&&(M.lanes=0),[c.memoizedState,M.dispatch]}function $e(c){var f=V(),v=f.queue;if(v===null)throw Error(a(311));v.lastRenderedReducer=c;var M=v.dispatch,R=v.pending,O=f.memoizedState;if(R!==null){v.pending=null;var J=R=R.next;do O=c(O,J.action),J=J.next;while(J!==R);Gs(O,f.memoizedState)||(Ki=!0),f.memoizedState=O,f.baseQueue===null&&(f.baseState=O),v.lastRenderedState=O}return[O,M]}function ct(c,f,v){var M=mn,R=V(),O=Xn;if(O){if(v===void 0)throw Error(a(407));v=v()}else v=f();var J=!Gs((ei||R).memoizedState,v);if(J&&(R.memoizedState=v,Ki=!0),R=R.queue,$u(Tt.bind(null,M,R,c),[c]),R.getSnapshot!==f||J||qi!==null&&qi.memoizedState.tag&1){if(M.flags|=2048,Li(9,Rt.bind(null,M,R,v,f),{destroy:void 0},null),En===null)throw Error(a(349));O||(no&60)!==0||_t(M,f,v)}return v}function _t(c,f,v){c.flags|=16384,c={getSnapshot:f,value:v},f=mn.updateQueue,f===null?(f=wd(),mn.updateQueue=f,f.stores=[c]):(v=f.stores,v===null?f.stores=[c]:v.push(c))}function Rt(c,f,v,M){f.value=v,f.getSnapshot=M,Ut(f)&&on(c)}function Tt(c,f,v){return v(function(){Ut(f)&&on(c)})}function Ut(c){var f=c.getSnapshot;c=c.value;try{var v=f();return!Gs(c,v)}catch{return!0}}function on(c){var f=st(c,2);f!==null&&Xa(f,c,2)}function Ht(c){var f=at();if(typeof c=="function"){var v=c;if(c=v(),Uo){K(!0);try{v()}finally{K(!1)}}}return f.memoizedState=f.baseState=c,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oe,lastRenderedState:c},f}function Jt(c,f,v,M){return c.baseState=v,je(c,ei,typeof M=="function"?M:oe)}function xn(c,f,v,M,R){if(Vl(c))throw Error(a(485));if(c=f.action,c!==null){var O={payload:R,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(J){O.listeners.push(J)}};$t.T!==null?v(!0):O.isTransition=!1,M(O),v=f.pending,v===null?(O.next=f.pending=O,Gt(f,O)):(O.next=v.next,f.pending=v.next=O)}}function Gt(c,f){var v=f.action,M=f.payload,R=c.state;if(f.isTransition){var O=$t.T,J={};$t.T=J;try{var ce=v(R,M),Se=$t.S;Se!==null&&Se(J,ce),pn(c,f,ce)}catch(Xe){Rn(c,f,Xe)}finally{$t.T=O}}else try{O=v(R,M),pn(c,f,O)}catch(Xe){Rn(c,f,Xe)}}function pn(c,f,v){v!==null&&typeof v=="object"&&typeof v.then=="function"?v.then(function(M){Pt(c,f,M)},function(M){return Rn(c,f,M)}):Pt(c,f,v)}function Pt(c,f,v){f.status="fulfilled",f.value=v,zn(f),c.state=v,f=c.pending,f!==null&&(v=f.next,v===f?c.pending=null:(v=v.next,f.next=v,Gt(c,v)))}function Rn(c,f,v){var M=c.pending;if(c.pending=null,M!==null){M=M.next;do f.status="rejected",f.reason=v,zn(f),f=f.next;while(f!==M)}c.action=null}function zn(c){c=c.listeners;for(var f=0;f<c.length;f++)(0,c[f])()}function Yt(c,f){return f}function Bi(c,f){if(Xn){var v=En.formState;if(v!==null){e:{var M=mn;if(Xn){if(Ia){var R=pv(Ia,ur);if(R){Ia=k0(R),M=mv(R);break e}}Fe(M)}M=!1}M&&(f=v[0])}}v=at(),v.memoizedState=v.baseState=f,M={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yt,lastRenderedState:f},v.queue=M,v=Hh.bind(null,mn,M),M.dispatch=v,M=Ht(!1);var O=Gh.bind(null,mn,!1,M.queue);return M=at(),R={state:f,dispatch:null,action:c,pending:null},M.queue=R,v=xn.bind(null,mn,R,O,v),R.dispatch=v,M.memoizedState=c,[f,v,!1]}function Un(c){var f=V();return jn(f,ei,c)}function jn(c,f,v){f=je(c,f,Yt)[0],c=Ne(oe)[0],f=typeof f=="object"&&f!==null&&typeof f.then=="function"?ne(f):f;var M=V(),R=M.queue,O=R.dispatch;return v!==M.memoizedState&&(mn.flags|=2048,Li(9,di.bind(null,R,v),{destroy:void 0},null)),[f,O,c]}function di(c,f){c.action=f}function da(c){var f=V(),v=ei;if(v!==null)return jn(f,v,c);V(),f=f.memoizedState,v=V();var M=v.queue.dispatch;return v.memoizedState=c,[f,M,!1]}function Li(c,f,v,M){return c={tag:c,create:f,inst:v,deps:M,next:null},f=mn.updateQueue,f===null&&(f=wd(),mn.updateQueue=f),v=f.lastEffect,v===null?f.lastEffect=c.next=c:(M=v.next,v.next=c,c.next=M,f.lastEffect=c),c}function yr(){return V().memoizedState}function rr(c,f,v,M){var R=at();mn.flags|=c,R.memoizedState=Li(1|f,v,{destroy:void 0},M===void 0?null:M)}function Qu(c,f,v,M){var R=V();M=M===void 0?null:M;var O=R.memoizedState.inst;ei!==null&&M!==null&&G(M,ei.memoizedState.deps)?R.memoizedState=Li(f,v,O,M):(mn.flags|=c,R.memoizedState=Li(1|f,v,O,M))}function Yp(c,f){rr(8390656,8,c,f)}function $u(c,f){Qu(2048,8,c,f)}function Ig(c,f){return Qu(4,2,c,f)}function Pg(c,f){return Qu(4,4,c,f)}function ef(c,f){if(typeof f=="function"){c=c();var v=f(c);return function(){typeof v=="function"?v():f(null)}}if(f!=null)return c=c(),f.current=c,function(){f.current=null}}function Gr(c,f,v){v=v!=null?v.concat([c]):null,Qu(4,4,ef.bind(null,f,c),v)}function tf(){}function Ph(c,f){var v=V();f=f===void 0?null:f;var M=v.memoizedState;return f!==null&&G(f,M[1])?M[0]:(v.memoizedState=[c,f],c)}function Hl(c,f){var v=V();f=f===void 0?null:f;var M=v.memoizedState;if(f!==null&&G(f,M[1]))return M[0];if(M=c(),Uo){K(!0);try{c()}finally{K(!1)}}return v.memoizedState=[M,f],M}function el(c,f,v){return v===void 0||(no&1073741824)!==0?c.memoizedState=f:(c.memoizedState=v,c=jr(),mn.lanes|=c,Js|=c,v)}function qp(c,f,v,M){return Gs(v,f)?v:to.current!==null?(c=el(c,v,M),Gs(c,f)||(Ki=!0),c):(no&42)===0?(Ki=!0,c.memoizedState=v):(c=jr(),mn.lanes|=c,Js|=c,f)}function Fh(c,f,v,M,R){var O=pa();qa(O!==0&&8>O?O:8);var J=$t.T,ce={};$t.T=ce,Gh(c,!1,f,v);try{var Se=R(),Xe=$t.S;if(Xe!==null&&Xe(ce,Se),Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var dt=xt(Se,M);nl(c,f,dt,ss(c))}else nl(c,f,M,ss(c))}catch(St){nl(c,f,{then:function(){},status:"rejected",reason:St},ss())}finally{qa(O),$t.T=J}}function Kp(c){var f=c.memoizedState;if(f!==null)return f;f={memoizedState:_s,baseState:_s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oe,lastRenderedState:_s},next:null};var v={};return f.next={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oe,lastRenderedState:v},next:null},c.memoizedState=f,c=c.alternate,c!==null&&(c.memoizedState=f),f}function Gl(){return Da(nn)}function Vr(){return V().memoizedState}function zh(){return V().memoizedState}function nf(c){for(var f=c.return;f!==null;){switch(f.tag){case 24:case 3:var v=ss();c=Ye(v);var M=qe(f,c,v);M!==null&&(Xa(M,f,v),It(M,f,v)),f={cache:Yh()},c.payload=f;return}f=f.return}}function tl(c,f,v){var M=ss();v={lane:M,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null},Vl(c)?af(f,v):(v=Qe(c,f,v,M),v!==null&&(Xa(v,c,M),Jp(v,f,M)))}function Hh(c,f,v){var M=ss();nl(c,f,v,M)}function nl(c,f,v,M){var R={lane:M,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null};if(Vl(c))af(f,R);else{var O=c.alternate;if(c.lanes===0&&(O===null||O.lanes===0)&&(O=f.lastRenderedReducer,O!==null))try{var J=f.lastRenderedState,ce=O(J,v);if(R.hasEagerState=!0,R.eagerState=ce,Gs(ce,J))return $(c,f,R,0),En===null&&ke(),!1}catch{}finally{}if(v=Qe(c,f,R,M),v!==null)return Xa(v,c,M),Jp(v,f,M),!0}return!1}function Gh(c,f,v,M){if(M={lane:2,revertLane:Ze(),action:M,hasEagerState:!1,eagerState:null,next:null},Vl(c)){if(f)throw Error(a(479))}else f=Qe(c,v,M,2),f!==null&&Xa(f,c,2)}function Vl(c){var f=c.alternate;return c===mn||f!==null&&f===mn}function af(c,f){Ri=dr=!0;var v=c.pending;v===null?f.next=f:(f.next=v.next,v.next=f),c.pending=f}function Jp(c,f,v){if((v&4194176)!==0){var M=f.lanes;M&=c.pendingLanes,v|=M,f.lanes=v,ae(c,v)}}function ka(c,f,v,M){f=c.memoizedState,v=v(M,f),v=v==null?f:Ql({},f,v),c.memoizedState=v,c.lanes===0&&(c.updateQueue.baseState=v)}function il(c,f,v,M,R,O,J){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(M,O,J):f.prototype&&f.prototype.isPureReactComponent?!ft(v,M)||!ft(R,O):!0}function sf(c,f,v,M){c=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(v,M),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(v,M),f.state!==c&&Bd.enqueueReplaceState(f,f.state,null)}function br(c,f){var v=f;if("ref"in f){v={};for(var M in f)M!=="ref"&&(v[M]=f[M])}if(c=c.defaultProps){v===f&&(v=Ql({},v));for(var R in c)v[R]===void 0&&(v[R]=c[R])}return v}function Vh(c,f){try{var v=c.onUncaughtError;v(f.value,{componentStack:f.stack})}catch(M){setTimeout(function(){throw M})}}function kh(c,f,v){try{var M=c.onCaughtError;M(v.value,{componentStack:v.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(R){setTimeout(function(){throw R})}}function rf(c,f,v){return v=Ye(v),v.tag=3,v.payload={element:null},v.callback=function(){Vh(c,f)},v}function Nc(c){return c=Ye(c),c.tag=3,c}function of(c,f,v,M){var R=v.type.getDerivedStateFromError;if(typeof R=="function"){var O=M.value;c.payload=function(){return R(O)},c.callback=function(){kh(f,v,M)}}var J=v.stateNode;J!==null&&typeof J.componentDidCatch=="function"&&(c.callback=function(){kh(f,v,M),typeof R!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var ce=M.stack;this.componentDidCatch(M.value,{componentStack:ce!==null?ce:""})})}function Fg(c,f,v,M,R){if(v.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){if(f=v.alternate,f!==null&&kl(f,v,R,!0),v=qs.current,v!==null){switch(v.tag){case 13:return hr===null?xs():v.alternate===null&&Gn===0&&(Gn=3),v.flags&=-257,v.flags|=65536,v.lanes=R,M===Rd?v.flags|=16384:(f=v.updateQueue,f===null?v.updateQueue=new Set([M]):f.add(M),rd(c,M,R)),!1;case 22:return v.flags|=65536,M===Rd?v.flags|=16384:(f=v.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([M])},v.updateQueue=f):(v=f.retryQueue,v===null?f.retryQueue=new Set([M]):v.add(M)),rd(c,M,R)),!1}throw Error(a(435,v.tag))}return rd(c,M,R),xs(),!1}if(Xn)return f=qs.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=R,M!==If&&(c=Error(a(422),{cause:M}),Ot(me(c,v)))):(M!==If&&(f=Error(a(423),{cause:M}),Ot(me(f,v))),c=c.current.alternate,c.flags|=65536,R&=-R,c.lanes|=R,M=me(M,v),R=rf(c.stateNode,M,R),Et(c,R),Gn!==4&&(Gn=2)),!1;var O=Error(a(520),{cause:M});if(O=me(O,v),cu===null?cu=[O]:cu.push(O),Gn!==4&&(Gn=2),f===null)return!0;M=me(M,v),v=f;do{switch(v.tag){case 3:return v.flags|=65536,c=R&-R,v.lanes|=c,c=rf(v.stateNode,M,c),Et(v,c),!1;case 1:if(f=v.type,O=v.stateNode,(v.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(Zs===null||!Zs.has(O))))return v.flags|=65536,R&=-R,v.lanes|=R,R=Nc(R),of(R,c,v,M),Et(v,R),!1}v=v.return}while(v!==null);return!1}function Ba(c,f,v,M){f.child=c===null?am(f,null,v,M):Cl(f,c.child,v,M)}function zg(c,f,v,M,R){v=v.render;var O=f.ref;if("ref"in M){var J={};for(var ce in M)ce!=="ref"&&(J[ce]=M[ce])}else J=M;return jl(f),M=Z(c,f,v,J,O,R),ce=Pe(),c!==null&&!Ki?(ot(c,f,R),vo(c,f,R)):(Xn&&ce&&de(f),f.flags|=1,Ba(c,f,M,R),f.child)}function Hg(c,f,v,M,R){if(c===null){var O=v.type;return typeof O=="function"&&!Ao(O)&&O.defaultProps===void 0&&v.compare===null?(f.tag=15,f.type=O,jh(c,f,O,M,R)):(c=or(v.type,null,M,f,f.mode,R),c.ref=f.ref,c.return=f,f.child=c)}if(O=c.child,!n0(c,R)){var J=O.memoizedProps;if(v=v.compare,v=v!==null?v:ft,v(J,M)&&c.ref===f.ref)return vo(c,f,R)}return f.flags|=1,c=Ya(O,M),c.ref=f.ref,c.return=f,f.child=c}function jh(c,f,v,M,R){if(c!==null){var O=c.memoizedProps;if(ft(O,M)&&c.ref===f.ref)if(Ki=!1,f.pendingProps=M=O,n0(c,R))(c.flags&131072)!==0&&(Ki=!0);else return f.lanes=c.lanes,vo(c,f,R)}return Wp(c,f,v,M,R)}function Gg(c,f,v){var M=f.pendingProps,R=M.children,O=(f.stateNode._pendingVisibility&2)!==0,J=c!==null?c.memoizedState:null;if(lf(c,f),M.mode==="hidden"||O){if((f.flags&128)!==0){if(M=J!==null?J.baseLanes|v:v,c!==null){for(R=f.child=c.child,O=0;R!==null;)O=O|R.lanes|R.childLanes,R=R.sibling;f.childLanes=O&~M}else f.childLanes=0,f.child=null;return Vg(c,f,M,v)}if((v&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},c!==null&&qh(f,J!==null?J.cachePool:null),J!==null?zl(f,J):go(),ms(f);else return f.lanes=f.childLanes=536870912,Vg(c,f,J!==null?J.baseLanes|v:v,v)}else J!==null?(qh(f,J.cachePool),zl(f,J),ba(),f.memoizedState=null):(c!==null&&qh(f,null),go(),ba());return Ba(c,f,R,v),f.child}function Vg(c,f,v,M){var R=rl();return R=R===null?null:{parent:Wr?ni._currentValue:ni._currentValue2,pool:R},f.memoizedState={baseLanes:v,cachePool:R},c!==null&&qh(f,null),go(),ms(f),c!==null&&kl(c,f,M,!0),null}function lf(c,f){var v=f.ref;if(v===null)c!==null&&c.ref!==null&&(f.flags|=2097664);else{if(typeof v!="function"&&typeof v!="object")throw Error(a(284));(c===null||c.ref!==v)&&(f.flags|=2097664)}}function Wp(c,f,v,M,R){return jl(f),v=Z(c,f,v,M,void 0,R),M=Pe(),c!==null&&!Ki?(ot(c,f,R),vo(c,f,R)):(Xn&&M&&de(f),f.flags|=1,Ba(c,f,v,R),f.child)}function kg(c,f,v,M,R,O){return jl(f),f.updateQueue=null,v=we(f,M,v,R),he(c),M=Pe(),c!==null&&!Ki?(ot(c,f,O),vo(c,f,O)):(Xn&&M&&de(f),f.flags|=1,Ba(c,f,v,O),f.child)}function Zp(c,f,v,M,R){if(jl(f),f.stateNode===null){var O=ic,J=v.contextType;typeof J=="object"&&J!==null&&(O=Da(J)),O=new v(M,O),f.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,O.updater=Bd,f.stateNode=O,O._reactInternals=f,O=f.stateNode,O.props=M,O.state=f.memoizedState,O.refs={},Vt(f),J=v.contextType,O.context=typeof J=="object"&&J!==null?Da(J):ic,O.state=f.memoizedState,J=v.getDerivedStateFromProps,typeof J=="function"&&(ka(f,v,J,M),O.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof O.getSnapshotBeforeUpdate=="function"||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(J=O.state,typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount(),J!==O.state&&Bd.enqueueReplaceState(O,O.state,null),Dt(f,M,O,R),gt(),O.state=f.memoizedState),typeof O.componentDidMount=="function"&&(f.flags|=4194308),M=!0}else if(c===null){O=f.stateNode;var ce=f.memoizedProps,Se=br(v,ce);O.props=Se;var Xe=O.context,dt=v.contextType;J=ic,typeof dt=="object"&&dt!==null&&(J=Da(dt));var St=v.getDerivedStateFromProps;dt=typeof St=="function"||typeof O.getSnapshotBeforeUpdate=="function",ce=f.pendingProps!==ce,dt||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(ce||Xe!==J)&&sf(f,O,M,J),Do=!1;var wt=f.memoizedState;O.state=wt,Dt(f,M,O,R),gt(),Xe=f.memoizedState,ce||wt!==Xe||Do?(typeof St=="function"&&(ka(f,v,St,M),Xe=f.memoizedState),(Se=Do||il(f,v,Se,M,wt,Xe,J))?(dt||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(f.flags|=4194308)):(typeof O.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=M,f.memoizedState=Xe),O.props=M,O.state=Xe,O.context=J,M=Se):(typeof O.componentDidMount=="function"&&(f.flags|=4194308),M=!1)}else{O=f.stateNode,Lt(c,f),J=f.memoizedProps,dt=br(v,J),O.props=dt,St=f.pendingProps,wt=O.context,Xe=v.contextType,Se=ic,typeof Xe=="object"&&Xe!==null&&(Se=Da(Xe)),ce=v.getDerivedStateFromProps,(Xe=typeof ce=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(J!==St||wt!==Se)&&sf(f,O,M,Se),Do=!1,wt=f.memoizedState,O.state=wt,Dt(f,M,O,R),gt();var ln=f.memoizedState;J!==St||wt!==ln||Do||c!==null&&c.dependencies!==null&&sl(c.dependencies)?(typeof ce=="function"&&(ka(f,v,ce,M),ln=f.memoizedState),(dt=Do||il(f,v,dt,M,wt,ln,Se)||c!==null&&c.dependencies!==null&&sl(c.dependencies))?(Xe||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(M,ln,Se),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(M,ln,Se)),typeof O.componentDidUpdate=="function"&&(f.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof O.componentDidUpdate!="function"||J===c.memoizedProps&&wt===c.memoizedState||(f.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||J===c.memoizedProps&&wt===c.memoizedState||(f.flags|=1024),f.memoizedProps=M,f.memoizedState=ln),O.props=M,O.state=ln,O.context=Se,M=dt):(typeof O.componentDidUpdate!="function"||J===c.memoizedProps&&wt===c.memoizedState||(f.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||J===c.memoizedProps&&wt===c.memoizedState||(f.flags|=1024),M=!1)}return O=M,lf(c,f),M=(f.flags&128)!==0,O||M?(O=f.stateNode,v=M&&typeof v.getDerivedStateFromError!="function"?null:O.render(),f.flags|=1,c!==null&&M?(f.child=Cl(f,c.child,null,R),f.child=Cl(f,null,v,R)):Ba(c,f,v,R),f.memoizedState=O.state,c=f.child):c=vo(c,f,R),c}function jg(c,f,v,M){return Xt(),f.flags|=256,Ba(c,f,v,M),f.child}function Qp(c){return{baseLanes:c,cachePool:Jg()}}function $p(c,f,v){return c=c!==null?c.childLanes&~v:0,f&&(c|=Es),c}function Xg(c,f,v){var M=f.pendingProps,R=!1,O=(f.flags&128)!==0,J;if((J=O)||(J=c!==null&&c.memoizedState===null?!1:(ia.current&2)!==0),J&&(R=!0,f.flags&=-129),J=(f.flags&32)!==0,f.flags&=-33,c===null){if(Xn){if(R?ta(f):ba(),Xn){var ce=Ia,Se;(Se=ce)&&(ce=yv(ce,ur),ce!==null?(f.memoizedState={dehydrated:ce,treeContext:Tr!==null?{id:$r,overflow:cr}:null,retryLane:536870912},Se=t(18,null,null,0),Se.stateNode=ce,Se.return=f,f.child=Se,Ka=f,Ia=null,Se=!0):Se=!1),Se||Fe(f)}if(ce=f.memoizedState,ce!==null&&(ce=ce.dehydrated,ce!==null))return Rf(ce)?f.lanes=16:f.lanes=536870912,null;en(f)}return ce=M.children,M=M.fallback,R?(ba(),R=f.mode,ce=e0({mode:"hidden",children:ce},R),M=Eo(M,R,v,null),ce.return=f,M.return=f,ce.sibling=M,f.child=ce,R=f.child,R.memoizedState=Qp(v),R.childLanes=$p(c,J,v),f.memoizedState=Wa,M):(ta(f),cf(f,ce))}if(Se=c.memoizedState,Se!==null&&(ce=Se.dehydrated,ce!==null)){if(O)f.flags&256?(ta(f),f.flags&=-257,f=t0(c,f,v)):f.memoizedState!==null?(ba(),f.child=c.child,f.flags|=128,f=null):(ba(),R=M.fallback,ce=f.mode,M=e0({mode:"visible",children:M.children},ce),R=Eo(R,ce,v,null),R.flags|=2,M.return=f,R.return=f,M.sibling=R,f.child=M,Cl(f,c.child,null,v),M=f.child,M.memoizedState=Qp(v),M.childLanes=$p(c,J,v),f.memoizedState=Wa,f=R);else if(ta(f),Rf(ce))J=dv(ce).digest,M=Error(a(419)),M.stack="",M.digest=J,Ot({value:M,source:null,stack:null}),f=t0(c,f,v);else if(Ki||kl(c,f,v,!1),J=(v&c.childLanes)!==0,Ki||J){if(J=En,J!==null){if(M=v&-v,(M&42)!==0)M=1;else switch(M){case 2:M=1;break;case 8:M=4;break;case 32:M=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:M=64;break;case 268435456:M=134217728;break;default:M=0}if(M=(M&(J.suspendedLanes|v))!==0?0:M,M!==0&&M!==Se.retryLane)throw Se.retryLane=M,st(c,M),Xa(J,c,M),Lv}xd(ce)||xs(),f=t0(c,f,v)}else xd(ce)?(f.flags|=128,f.child=c.child,f=Wl.bind(null,c),n2(ce,f),f=null):(c=Se.treeContext,rs&&(Ia=vv(ce),Ka=f,Xn=!0,js=null,ur=!1,c!==null&&(Vs[ks++]=$r,Vs[ks++]=cr,Vs[ks++]=Tr,$r=c.id,cr=c.overflow,Tr=f)),f=cf(f,M.children),f.flags|=4096);return f}return R?(ba(),R=M.fallback,ce=f.mode,Se=c.child,O=Se.sibling,M=Ya(Se,{mode:"hidden",children:M.children}),M.subtreeFlags=Se.subtreeFlags&31457280,O!==null?R=Ya(O,R):(R=Eo(R,ce,v,null),R.flags|=2),R.return=f,M.return=f,M.sibling=R,f.child=M,M=R,R=f.child,ce=c.child.memoizedState,ce===null?ce=Qp(v):(Se=ce.cachePool,Se!==null?(O=Wr?ni._currentValue:ni._currentValue2,Se=Se.parent!==O?{parent:O,pool:O}:Se):Se=Jg(),ce={baseLanes:ce.baseLanes|v,cachePool:Se}),R.memoizedState=ce,R.childLanes=$p(c,J,v),f.memoizedState=Wa,M):(ta(f),v=c.child,c=v.sibling,v=Ya(v,{mode:"visible",children:M.children}),v.return=f,v.sibling=null,c!==null&&(J=f.deletions,J===null?(f.deletions=[c],f.flags|=16):J.push(c)),f.child=v,f.memoizedState=null,v)}function cf(c,f){return f=e0({mode:"visible",children:f},c.mode),f.return=c,c.child=f}function e0(c,f){return od(c,f,0,null)}function t0(c,f,v){return Cl(f,c.child,null,v),c=cf(f,f.pendingProps.children),c.flags|=2,f.memoizedState=null,c}function Yg(c,f,v){c.lanes|=f;var M=c.alternate;M!==null&&(M.lanes|=f),i0(c.return,f,v)}function Xh(c,f,v,M,R){var O=c.memoizedState;O===null?c.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:M,tail:v,tailMode:R}:(O.isBackwards=f,O.rendering=null,O.renderingStartTime=0,O.last=M,O.tail=v,O.tailMode=R)}function qg(c,f,v){var M=f.pendingProps,R=M.revealOrder,O=M.tail;if(Ba(c,f,M.children,v),M=ia.current,(M&2)!==0)M=M&1|2,f.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=f.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Yg(c,v,f);else if(c.tag===19)Yg(c,v,f);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===f)break e;for(;c.sibling===null;){if(c.return===null||c.return===f)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}M&=1}switch(w(ia,M),R){case"forwards":for(v=f.child,R=null;v!==null;)c=v.alternate,c!==null&&ha(c)===null&&(R=v),v=v.sibling;v=R,v===null?(R=f.child,f.child=null):(R=v.sibling,v.sibling=null),Xh(f,!1,R,v,O);break;case"backwards":for(v=null,R=f.child,f.child=null;R!==null;){if(c=R.alternate,c!==null&&ha(c)===null){f.child=R;break}c=R.sibling,R.sibling=v,v=R,R=c}Xh(f,!0,v,null,O);break;case"together":Xh(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function vo(c,f,v){if(c!==null&&(f.dependencies=c.dependencies),Js|=f.lanes,(v&f.childLanes)===0)if(c!==null){if(kl(c,f,v,!1),(v&f.childLanes)===0)return null}else return null;if(c!==null&&f.child!==c.child)throw Error(a(153));if(f.child!==null){for(c=f.child,v=Ya(c,c.pendingProps),f.child=v,v.return=f;c.sibling!==null;)c=c.sibling,v=v.sibling=Ya(c,c.pendingProps),v.return=f;v.sibling=null}return f.child}function n0(c,f){return(c.lanes&f)!==0?!0:(c=c.dependencies,!!(c!==null&&sl(c)))}function $y(c,f,v){switch(f.tag){case 3:Me(f,f.stateNode.containerInfo),al(f,ni,c.memoizedState.cache),Xt();break;case 27:case 5:xe(f);break;case 4:Me(f,f.stateNode.containerInfo);break;case 10:al(f,f.type,f.memoizedProps.value);break;case 13:var M=f.memoizedState;if(M!==null)return M.dehydrated!==null?(ta(f),f.flags|=128,null):(v&f.child.childLanes)!==0?Xg(c,f,v):(ta(f),c=vo(c,f,v),c!==null?c.sibling:null);ta(f);break;case 19:var R=(c.flags&128)!==0;if(M=(v&f.childLanes)!==0,M||(kl(c,f,v,!1),M=(v&f.childLanes)!==0),R){if(M)return qg(c,f,v);f.flags|=128}if(R=f.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),w(ia,ia.current),M)break;return null;case 22:case 23:return f.lanes=0,Gg(c,f,v);case 24:al(f,ni,c.memoizedState.cache)}return vo(c,f,v)}function Kg(c,f,v){if(c!==null)if(c.memoizedProps!==f.pendingProps)Ki=!0;else{if(!n0(c,v)&&(f.flags&128)===0)return Ki=!1,$y(c,f,v);Ki=(c.flags&131072)!==0}else Ki=!1,Xn&&(f.flags&1048576)!==0&&Q(f,Nf,f.index);switch(f.lanes=0,f.tag){case 16:e:{c=f.pendingProps;var M=f.elementType,R=M._init;if(M=R(M._payload),f.type=M,typeof M=="function")Ao(M)?(c=br(M,c),f.tag=1,f=Zp(null,f,M,c,v)):(f.tag=0,f=Wp(null,f,M,c,v));else{if(M!=null){if(R=M.$$typeof,R===Wc){f.tag=11,f=zg(null,f,M,c,v);break e}else if(R===yf){f.tag=14,f=Hg(null,f,M,c,v);break e}}throw f=l(M)||M,Error(a(306,f,""))}}return f;case 0:return Wp(c,f,f.type,f.pendingProps,v);case 1:return M=f.type,R=br(M,f.pendingProps),Zp(c,f,M,R,v);case 3:e:{if(Me(f,f.stateNode.containerInfo),c===null)throw Error(a(387));var O=f.pendingProps;R=f.memoizedState,M=R.element,Lt(c,f),Dt(f,O,null,v);var J=f.memoizedState;if(O=J.cache,al(f,ni,O),O!==R.cache&&a0(f,[ni],v,!0),gt(),O=J.element,rs&&R.isDehydrated)if(R={element:O,isDehydrated:!1,cache:J.cache},f.updateQueue.baseState=R,f.memoizedState=R,f.flags&256){f=jg(c,f,O,v);break e}else if(O!==M){M=me(Error(a(424)),f),Ot(M),f=jg(c,f,O,v);break e}else for(rs&&(Ia=gv(f.stateNode.containerInfo),Ka=f,Xn=!0,js=null,ur=!0),v=am(f,null,O,v),f.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(Xt(),O===M){f=vo(c,f,v);break e}Ba(c,f,O,v)}f=f.child}return f;case 26:if(Hs)return lf(c,f),c===null?(v=Ad(f.type,null,f.pendingProps,null))?f.memoizedState=v:Xn||(f.stateNode=a2(f.type,f.pendingProps,Cr.current,f)):f.memoizedState=Ad(f.type,c.memoizedProps,f.pendingProps,c.memoizedState),null;case 27:if(Na)return xe(f),c===null&&Na&&Xn&&(M=f.stateNode=em(f.type,f.pendingProps,Cr.current,Ta.current,!1),Ka=f,ur=!0,Ia=_d(M)),M=f.pendingProps.children,c!==null||Xn?Ba(c,f,M,v):f.child=Cl(f,null,M,v),lf(c,f),f.child;case 5:return c===null&&Xn&&(Ev(f.type,f.pendingProps,Ta.current),(R=M=Ia)&&(M=xv(M,f.type,f.pendingProps,ur),M!==null?(f.stateNode=M,Ka=f,Ia=_d(M),ur=!1,R=!0):R=!1),R||Fe(f)),xe(f),R=f.type,O=f.pendingProps,J=c!==null?c.memoizedProps:null,M=O.children,Sl(R,O)?M=null:J!==null&&Sl(R,J)&&(f.flags|=32),f.memoizedState!==null&&(R=Z(c,f,ze,null,null,v),Wr?nn._currentValue=R:nn._currentValue2=R),lf(c,f),Ba(c,f,M,v),f.child;case 6:return c===null&&Xn&&(Tv(f.pendingProps,Ta.current),(c=v=Ia)&&(v=_v(v,f.pendingProps,ur),v!==null?(f.stateNode=v,Ka=f,Ia=null,c=!0):c=!1),c||Fe(f)),null;case 13:return Xg(c,f,v);case 4:return Me(f,f.stateNode.containerInfo),M=f.pendingProps,c===null?f.child=Cl(f,null,M,v):Ba(c,f,M,v),f.child;case 11:return zg(c,f,f.type,f.pendingProps,v);case 7:return Ba(c,f,f.pendingProps,v),f.child;case 8:return Ba(c,f,f.pendingProps.children,v),f.child;case 12:return Ba(c,f,f.pendingProps.children,v),f.child;case 10:return M=f.pendingProps,al(f,f.type,M.value),Ba(c,f,M.children,v),f.child;case 9:return R=f.type._context,M=f.pendingProps.children,jl(f),R=Da(R),M=M(R),f.flags|=1,Ba(c,f,M,v),f.child;case 14:return Hg(c,f,f.type,f.pendingProps,v);case 15:return jh(c,f,f.type,f.pendingProps,v);case 19:return qg(c,f,v);case 22:return Gg(c,f,v);case 24:return jl(f),M=Da(ni),c===null?(R=rl(),R===null&&(R=En,O=Yh(),R.pooledCache=O,O.refCount++,O!==null&&(R.pooledCacheLanes|=v),R=O),f.memoizedState={parent:M,cache:R},Vt(f),al(f,ni,R)):((c.lanes&v)!==0&&(Lt(c,f),Dt(f,null,null,v),gt()),R=c.memoizedState,O=f.memoizedState,R.parent!==M?(R={parent:M,cache:M},f.memoizedState=R,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=R),al(f,ni,M)):(M=O.cache,al(f,ni,M),M!==R.cache&&a0(f,[ni],v,!0))),Ba(c,f,f.pendingProps.children,v),f.child;case 29:throw f.pendingProps}throw Error(a(156,f.tag))}function al(c,f,v){Wr?(w(As,f._currentValue),f._currentValue=v):(w(As,f._currentValue2),f._currentValue2=v)}function xo(c){var f=As.current;Wr?c._currentValue=f:c._currentValue2=f,S(As)}function i0(c,f,v){for(;c!==null;){var M=c.alternate;if((c.childLanes&f)!==f?(c.childLanes|=f,M!==null&&(M.childLanes|=f)):M!==null&&(M.childLanes&f)!==f&&(M.childLanes|=f),c===v)break;c=c.return}}function a0(c,f,v,M){var R=c.child;for(R!==null&&(R.return=c);R!==null;){var O=R.dependencies;if(O!==null){var J=R.child;O=O.firstContext;e:for(;O!==null;){var ce=O;O=R;for(var Se=0;Se<f.length;Se++)if(ce.context===f[Se]){O.lanes|=v,ce=O.alternate,ce!==null&&(ce.lanes|=v),i0(O.return,v,c),M||(J=null);break e}O=ce.next}}else if(R.tag===18){if(J=R.return,J===null)throw Error(a(341));J.lanes|=v,O=J.alternate,O!==null&&(O.lanes|=v),i0(J,v,c),J=null}else J=R.child;if(J!==null)J.return=R;else for(J=R;J!==null;){if(J===c){J=null;break}if(R=J.sibling,R!==null){R.return=J.return,J=R;break}J=J.return}R=J}}function kl(c,f,v,M){c=null;for(var R=f,O=!1;R!==null;){if(!O){if((R.flags&524288)!==0)O=!0;else if((R.flags&262144)!==0)break}if(R.tag===10){var J=R.alternate;if(J===null)throw Error(a(387));if(J=J.memoizedProps,J!==null){var ce=R.type;Gs(R.pendingProps.value,J.value)||(c!==null?c.push(ce):c=[ce])}}else if(R===iu.current){if(J=R.alternate,J===null)throw Error(a(387));J.memoizedState.memoizedState!==R.memoizedState.memoizedState&&(c!==null?c.push(nn):c=[nn])}R=R.return}c!==null&&a0(f,c,v,M),f.flags|=262144}function sl(c){for(c=c.firstContext;c!==null;){var f=c.context;if(!Gs(Wr?f._currentValue:f._currentValue2,c.memoizedValue))return!0;c=c.next}return!1}function jl(c){wl=c,Hi=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function Da(c){return s0(wl,c)}function uf(c,f){return wl===null&&jl(c),s0(c,f)}function s0(c,f){var v=Wr?f._currentValue:f._currentValue2;if(f={context:f,memoizedValue:v,next:null},Hi===null){if(c===null)throw Error(a(308));Hi=f,c.dependencies={lanes:0,firstContext:f},c.flags|=524288}else Hi=Hi.next=f;return v}function Yh(){return{controller:new Iv,data:new Map,refCount:0}}function Lc(c){c.refCount--,c.refCount===0&&Oo(rc,function(){c.controller.abort()})}function rl(){var c=No.current;return c!==null?c:En.pooledCache}function qh(c,f){f===null?w(No,No.current):w(No,f.pool)}function Jg(){var c=rl();return c===null?null:{parent:Wr?ni._currentValue:ni._currentValue2,pool:c}}function Ls(c){c.flags|=4}function r0(c,f){if(c!==null&&c.child===f.child)return!1;if((f.flags&16)!==0)return!0;for(c=f.child;c!==null;){if((c.flags&13878)!==0||(c.subtreeFlags&13878)!==0)return!0;c=c.sibling}return!1}function Kh(c,f,v,M){if(Oa)for(v=f.child;v!==null;){if(v.tag===5||v.tag===6)Jr(c,v.stateNode);else if(!(v.tag===4||Na&&v.tag===27)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return;v=v.return}v.sibling.return=v.return,v=v.sibling}else if(Fs)for(var R=f.child;R!==null;){if(R.tag===5){var O=R.stateNode;v&&M&&(O=G0(O,R.type,R.memoizedProps)),Jr(c,O)}else if(R.tag===6)O=R.stateNode,v&&M&&(O=V0(O,R.memoizedProps)),Jr(c,O);else if(R.tag!==4){if(R.tag===22&&R.memoizedState!==null)O=R.child,O!==null&&(O.return=R),Kh(c,R,!0,!0);else if(R.child!==null){R.child.return=R,R=R.child;continue}}if(R===f)break;for(;R.sibling===null;){if(R.return===null||R.return===f)return;R=R.return}R.sibling.return=R.return,R=R.sibling}}function Ic(c,f,v,M){if(Fs)for(var R=f.child;R!==null;){if(R.tag===5){var O=R.stateNode;v&&M&&(O=G0(O,R.type,R.memoizedProps)),z0(c,O)}else if(R.tag===6)O=R.stateNode,v&&M&&(O=V0(O,R.memoizedProps)),z0(c,O);else if(R.tag!==4){if(R.tag===22&&R.memoizedState!==null)O=R.child,O!==null&&(O.return=R),Ic(c,R,!(R.memoizedProps!==null&&R.memoizedProps.mode==="manual"),!0);else if(R.child!==null){R.child.return=R,R=R.child;continue}}if(R===f)break;for(;R.sibling===null;){if(R.return===null||R.return===f)return;R=R.return}R.sibling.return=R.return,R=R.sibling}}function Pc(c,f){if(Fs&&r0(c,f)){c=f.stateNode;var v=c.containerInfo,M=vd();Ic(M,f,!1,!1),c.pendingChildren=M,Ls(f),hv(v,M)}}function o0(c,f,v,M){if(Oa)c.memoizedProps!==M&&Ls(f);else if(Fs){var R=c.stateNode,O=c.memoizedProps;if((c=r0(c,f))||O!==M){var J=Ta.current;O=F0(R,v,O,M,!c,null),O===R?f.stateNode=R:(Co(O,v,M,J)&&Ls(f),f.stateNode=O,c?Kh(O,f,!1,!1):Ls(f))}else f.stateNode=R}}function Fc(c,f,v){if(cv(f,v)){if(c.flags|=16777216,!Ro(f,v))if(gf())c.flags|=8192;else throw sc=Rd,im}else c.flags&=-16777217}function l0(c,f){if(Cv(f)){if(c.flags|=16777216,!Q0(f))if(gf())c.flags|=8192;else throw sc=Rd,im}else c.flags&=-16777217}function ff(c,f){f!==null&&(c.flags|=4),c.flags&16384&&(f=c.tag!==22?L():536870912,c.lanes|=f,Io|=f)}function Xl(c,f){if(!Xn)switch(c.tailMode){case"hidden":f=c.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?c.tail=null:v.sibling=null;break;case"collapsed":v=c.tail;for(var M=null;v!==null;)v.alternate!==null&&(M=v),v=v.sibling;M===null?f||c.tail===null?c.tail=null:c.tail.sibling=null:M.sibling=null}}function Ei(c){var f=c.alternate!==null&&c.alternate.child===c.child,v=0,M=0;if(f)for(var R=c.child;R!==null;)v|=R.lanes|R.childLanes,M|=R.subtreeFlags&31457280,M|=R.flags&31457280,R.return=c,R=R.sibling;else for(R=c.child;R!==null;)v|=R.lanes|R.childLanes,M|=R.subtreeFlags,M|=R.flags,R.return=c,R=R.sibling;return c.subtreeFlags|=M,c.childLanes=v,f}function Wg(c,f,v){var M=f.pendingProps;switch(Te(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ei(f),null;case 1:return Ei(f),null;case 3:return v=f.stateNode,M=null,c!==null&&(M=c.memoizedState.cache),f.memoizedState.cache!==M&&(f.flags|=2048),xo(ni),rt(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(c===null||c.child===null)&&(yt(f)?Ls(f):c===null||c.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,js!==null&&(yo(js),js=null))),Pc(c,f),Ei(f),null;case 26:if(Hs){v=f.type;var R=f.memoizedState;return c===null?(Ls(f),R!==null?(Ei(f),l0(f,R)):(Ei(f),Fc(f,v,M))):R?R!==c.memoizedState?(Ls(f),Ei(f),l0(f,R)):(Ei(f),f.flags&=-16777217):(Oa?c.memoizedProps!==M&&Ls(f):o0(c,f,v,M),Ei(f),Fc(f,v,M)),null}case 27:if(Na){if(fe(f),v=Cr.current,R=f.type,c!==null&&f.stateNode!=null)Oa?c.memoizedProps!==M&&Ls(f):o0(c,f,R,M);else{if(!M){if(f.stateNode===null)throw Error(a(166));return Ei(f),null}c=Ta.current,yt(f)?et(f,c):(c=em(R,M,v,c,!0),f.stateNode=c,Ls(f))}return Ei(f),null}case 5:if(fe(f),v=f.type,c!==null&&f.stateNode!=null)o0(c,f,v,M);else{if(!M){if(f.stateNode===null)throw Error(a(166));return Ei(f),null}c=Ta.current,yt(f)?et(f,c):(R=C0(v,M,Cr.current,c,f),Kh(R,f,!1,!1),f.stateNode=R,Co(R,v,M,c)&&Ls(f))}return Ei(f),Fc(f,f.type,f.pendingProps),null;case 6:if(c&&f.stateNode!=null)v=c.memoizedProps,Oa?v!==M&&Ls(f):Fs&&(v!==M?(f.stateNode=fd(M,Cr.current,Ta.current,f),Ls(f)):f.stateNode=c.stateNode);else{if(typeof M!="string"&&f.stateNode===null)throw Error(a(166));if(c=Cr.current,v=Ta.current,yt(f)){if(!rs)throw Error(a(176));if(c=f.stateNode,v=f.memoizedProps,M=null,R=Ka,R!==null)switch(R.tag){case 27:case 5:M=R.memoizedProps}bv(c,v,f,M)||Fe(f)}else f.stateNode=fd(M,c,v,f)}return Ei(f),null;case 13:if(M=f.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(R=yt(f),M!==null&&M.dehydrated!==null){if(c===null){if(!R)throw Error(a(318));if(!rs)throw Error(a(344));if(R=f.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(a(317));Qc(R,f)}else Xt(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Ei(f),R=!1}else js!==null&&(yo(js),js=null),R=!0;if(!R)return f.flags&256?(en(f),f):(en(f),null)}if(en(f),(f.flags&128)!==0)return f.lanes=v,f;if(v=M!==null,c=c!==null&&c.memoizedState!==null,v){M=f.child,R=null,M.alternate!==null&&M.alternate.memoizedState!==null&&M.alternate.memoizedState.cachePool!==null&&(R=M.alternate.memoizedState.cachePool.pool);var O=null;M.memoizedState!==null&&M.memoizedState.cachePool!==null&&(O=M.memoizedState.cachePool.pool),O!==R&&(M.flags|=2048)}return v!==c&&v&&(f.child.flags|=8192),ff(f,f.updateQueue),Ei(f),null;case 4:return rt(),Pc(c,f),c===null&&B0(f.stateNode.containerInfo),Ei(f),null;case 10:return xo(f.type),Ei(f),null;case 19:if(S(ia),R=f.memoizedState,R===null)return Ei(f),null;if(M=(f.flags&128)!==0,O=R.rendering,O===null)if(M)Xl(R,!1);else{if(Gn!==0||c!==null&&(c.flags&128)!==0)for(c=f.child;c!==null;){if(O=ha(c),O!==null){for(f.flags|=128,Xl(R,!1),c=O.updateQueue,f.updateQueue=c,ff(f,c),f.subtreeFlags=0,c=v,v=f.child;v!==null;)Mo(v,c),v=v.sibling;return w(ia,ia.current&1|2),f.child}c=c.sibling}R.tail!==null&&La()>Ui&&(f.flags|=128,M=!0,Xl(R,!1),f.lanes=4194304)}else{if(!M)if(c=ha(O),c!==null){if(f.flags|=128,M=!0,c=c.updateQueue,f.updateQueue=c,ff(f,c),Xl(R,!0),R.tail===null&&R.tailMode==="hidden"&&!O.alternate&&!Xn)return Ei(f),null}else 2*La()-R.renderingStartTime>Ui&&v!==536870912&&(f.flags|=128,M=!0,Xl(R,!1),f.lanes=4194304);R.isBackwards?(O.sibling=f.child,f.child=O):(c=R.last,c!==null?c.sibling=O:f.child=O,R.last=O)}return R.tail!==null?(f=R.tail,R.rendering=f,R.tail=f.sibling,R.renderingStartTime=La(),f.sibling=null,c=ia.current,w(ia,M?c&1|2:c&1),f):(Ei(f),null);case 22:case 23:return en(f),sr(),M=f.memoizedState!==null,c!==null?c.memoizedState!==null!==M&&(f.flags|=8192):M&&(f.flags|=8192),M?(v&536870912)!==0&&(f.flags&128)===0&&(Ei(f),f.subtreeFlags&6&&(f.flags|=8192)):Ei(f),v=f.updateQueue,v!==null&&ff(f,v.retryQueue),v=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),M=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(M=f.memoizedState.cachePool.pool),M!==v&&(f.flags|=2048),c!==null&&S(No),null;case 24:return v=null,c!==null&&(v=c.memoizedState.cache),f.memoizedState.cache!==v&&(f.flags|=2048),xo(ni),Ei(f),null;case 25:return null}throw Error(a(156,f.tag))}function Zg(c,f){switch(Te(f),f.tag){case 1:return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 3:return xo(ni),rt(),c=f.flags,(c&65536)!==0&&(c&128)===0?(f.flags=c&-65537|128,f):null;case 26:case 27:case 5:return fe(f),null;case 13:if(en(f),c=f.memoizedState,c!==null&&c.dehydrated!==null){if(f.alternate===null)throw Error(a(340));Xt()}return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 19:return S(ia),null;case 4:return rt(),null;case 10:return xo(f.type),null;case 22:case 23:return en(f),sr(),c!==null&&S(No),c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 24:return xo(ni),null;case 25:return null;default:return null}}function c0(c,f){switch(Te(f),f.tag){case 3:xo(ni),rt();break;case 26:case 27:case 5:fe(f);break;case 4:rt();break;case 13:en(f);break;case 19:S(ia);break;case 10:xo(f.type);break;case 22:case 23:en(f),sr(),c!==null&&S(No);break;case 24:xo(ni)}}function hf(c,f){try{var v=f.updateQueue,M=v!==null?v.lastEffect:null;if(M!==null){var R=M.next;v=R;do{if((v.tag&c)===c){M=void 0;var O=v.create,J=v.inst;M=O(),J.destroy=M}v=v.next}while(v!==R)}}catch(ce){Bn(f,f.return,ce)}}function ol(c,f,v){try{var M=f.updateQueue,R=M!==null?M.lastEffect:null;if(R!==null){var O=R.next;M=O;do{if((M.tag&c)===c){var J=M.inst,ce=J.destroy;if(ce!==void 0){J.destroy=void 0,R=f;var Se=v;try{ce()}catch(Xe){Bn(R,Se,Xe)}}}M=M.next}while(M!==O)}}catch(Xe){Bn(f,f.return,Xe)}}function Qg(c){var f=c.updateQueue;if(f!==null){var v=c.stateNode;try{Ue(f,v)}catch(M){Bn(c,c.return,M)}}}function $g(c,f,v){v.props=br(c.type,c.memoizedProps),v.state=c.memoizedState;try{v.componentWillUnmount()}catch(M){Bn(c,f,M)}}function Yl(c,f){try{var v=c.ref;if(v!==null){var M=c.stateNode;switch(c.tag){case 26:case 27:case 5:var R=Zc(M);break;default:R=M}typeof v=="function"?c.refCleanup=v(R):v.current=R}}catch(O){Bn(c,f,O)}}function Ti(c,f){var v=c.ref,M=c.refCleanup;if(v!==null)if(typeof M=="function")try{M()}catch(R){Bn(c,f,R)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof v=="function")try{v(null)}catch(R){Bn(c,f,R)}else v.current=null}function zc(c){var f=c.type,v=c.memoizedProps,M=c.stateNode;try{t2(M,f,v,c)}catch(R){Bn(c,c.return,R)}}function u0(c,f,v){try{N0(c.stateNode,c.type,v,f,c)}catch(M){Bn(c,c.return,M)}}function f0(c){return c.tag===5||c.tag===3||(Hs?c.tag===26:!1)||(Na?c.tag===27:!1)||c.tag===4}function Jh(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||f0(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&(!Na||c.tag!==27)&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function Wh(c,f,v){var M=c.tag;if(M===5||M===6)c=c.stateNode,f?I0(v,c,f):uv(v,c);else if(!(M===4||Na&&M===27)&&(c=c.child,c!==null))for(Wh(c,f,v),c=c.sibling;c!==null;)Wh(c,f,v),c=c.sibling}function Hc(c,f,v){var M=c.tag;if(M===5||M===6)c=c.stateNode,f?L0(v,c,f):O0(v,c);else if(!(M===4||Na&&M===27)&&(c=c.child,c!==null))for(Hc(c,f,v),c=c.sibling;c!==null;)Hc(c,f,v),c=c.sibling}function ev(c,f,v){c=c.containerInfo;try{H0(c,v)}catch(M){Bn(f,f.return,M)}}function Gc(c,f){for(bl(c.containerInfo),Gi=f;Gi!==null;)if(c=Gi,f=c.child,(c.subtreeFlags&1028)!==0&&f!==null)f.return=c,Gi=f;else for(;Gi!==null;){c=Gi;var v=c.alternate;switch(f=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&v!==null){f=void 0;var M=c,R=v.memoizedProps;v=v.memoizedState;var O=M.stateNode;try{var J=br(M.type,R,M.elementType===M.type);f=O.getSnapshotBeforeUpdate(J,v),O.__reactInternalSnapshotBeforeUpdate=f}catch(ce){Bn(M,M.return,ce)}}break;case 3:(f&1024)!==0&&Oa&&gd(c.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(a(163))}if(f=c.sibling,f!==null){f.return=c.return,Gi=f;break}Gi=c.return}return J=oc,oc=!1,J}function Zh(c,f,v){var M=v.flags;switch(v.tag){case 0:case 11:case 15:kr(c,v),M&4&&hf(5,v);break;case 1:if(kr(c,v),M&4)if(c=v.stateNode,f===null)try{c.componentDidMount()}catch(ce){Bn(v,v.return,ce)}else{var R=br(v.type,f.memoizedProps);f=f.memoizedState;try{c.componentDidUpdate(R,f,c.__reactInternalSnapshotBeforeUpdate)}catch(ce){Bn(v,v.return,ce)}}M&64&&Qg(v),M&512&&Yl(v,v.return);break;case 3:if(kr(c,v),M&64&&(M=v.updateQueue,M!==null)){if(c=null,v.child!==null)switch(v.child.tag){case 27:case 5:c=Zc(v.child.stateNode);break;case 1:c=v.child.stateNode}try{Ue(M,c)}catch(ce){Bn(v,v.return,ce)}}break;case 26:if(Hs){kr(c,v),M&512&&Yl(v,v.return);break}case 27:case 5:kr(c,v),f===null&&M&4&&zc(v),M&512&&Yl(v,v.return);break;case 12:kr(c,v);break;case 13:kr(c,v),M&4&&ll(c,v);break;case 22:if(R=v.memoizedState!==null||ma,!R){f=f!==null&&f.memoizedState!==null||Di;var O=ma,J=Di;ma=R,(Di=f)&&!J?ul(c,v,(v.subtreeFlags&8772)!==0):kr(c,v),ma=O,Di=J}M&512&&(v.memoizedProps.mode==="manual"?Yl(v,v.return):Ti(v,v.return));break;default:kr(c,v)}}function Vc(c){var f=c.alternate;f!==null&&(c.alternate=null,Vc(f)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(f=c.stateNode,f!==null&&D0(f)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function Is(c,f,v){for(v=v.child;v!==null;)Qh(c,f,v),v=v.sibling}function Qh(c,f,v){if(bs&&typeof bs.onCommitFiberUnmount=="function")try{bs.onCommitFiberUnmount(nu,v)}catch{}switch(v.tag){case 26:if(Hs){Di||Ti(v,f),Is(c,f,v),v.memoizedState?q0(v.memoizedState):v.stateNode&&W0(v.stateNode);break}case 27:if(Na){Di||Ti(v,f);var M=Ji,R=Ms;Ji=v.stateNode,Is(c,f,v),Rv(v.stateNode),Ji=M,Ms=R;break}case 5:Di||Ti(v,f);case 6:if(Oa){if(M=Ji,R=Ms,Ji=null,Is(c,f,v),Ji=M,Ms=R,Ji!==null)if(Ms)try{Yi(Ji,v.stateNode)}catch(O){Bn(v,f,O)}else try{os(Ji,v.stateNode)}catch(O){Bn(v,f,O)}}else Is(c,f,v);break;case 18:Oa&&Ji!==null&&(Ms?j0(Ji,v.stateNode):Av(Ji,v.stateNode));break;case 4:Oa?(M=Ji,R=Ms,Ji=v.stateNode.containerInfo,Ms=!0,Is(c,f,v),Ji=M,Ms=R):(Fs&&ev(v.stateNode,v,vd()),Is(c,f,v));break;case 0:case 11:case 14:case 15:Di||ol(2,v,f),Di||ol(4,v,f),Is(c,f,v);break;case 1:Di||(Ti(v,f),M=v.stateNode,typeof M.componentWillUnmount=="function"&&$g(v,f,M)),Is(c,f,v);break;case 21:Is(c,f,v);break;case 22:Di||Ti(v,f),Di=(M=Di)||v.memoizedState!==null,Is(c,f,v),Di=M;break;default:Is(c,f,v)}}function ll(c,f){if(rs&&f.memoizedState===null&&(c=f.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{bd(c)}catch(v){Bn(f,f.return,v)}}function kc(c){switch(c.tag){case 13:case 19:var f=c.stateNode;return f===null&&(f=c.stateNode=new lu),f;case 22:return c=c.stateNode,f=c._retryCache,f===null&&(f=c._retryCache=new lu),f;default:throw Error(a(435,c.tag))}}function df(c,f){var v=kc(c);f.forEach(function(M){var R=g0.bind(null,c,M);v.has(M)||(v.add(M),M.then(R,R))})}function is(c,f){var v=f.deletions;if(v!==null)for(var M=0;M<v.length;M++){var R=v[M],O=c,J=f;if(Oa){var ce=J;e:for(;ce!==null;){switch(ce.tag){case 27:case 5:Ji=ce.stateNode,Ms=!1;break e;case 3:Ji=ce.stateNode.containerInfo,Ms=!0;break e;case 4:Ji=ce.stateNode.containerInfo,Ms=!0;break e}ce=ce.return}if(Ji===null)throw Error(a(160));Qh(O,J,R),Ji=null,Ms=!1}else Qh(O,J,R);O=R.alternate,O!==null&&(O.return=null),R.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)cl(f,c),f=f.sibling}function cl(c,f){var v=c.alternate,M=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:is(f,c),gs(c),M&4&&(ol(3,c,c.return),hf(3,c),ol(5,c,c.return));break;case 1:is(f,c),gs(c),M&512&&(Di||v===null||Ti(v,v.return)),M&64&&ma&&(c=c.updateQueue,c!==null&&(M=c.callbacks,M!==null&&(v=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=v===null?M:v.concat(M))));break;case 26:if(Hs){var R=ls;is(f,c),gs(c),M&512&&(Di||v===null||Ti(v,v.return)),M&4&&(M=v!==null?v.memoizedState:null,f=c.memoizedState,v===null?f===null?c.stateNode===null?c.stateNode=K0(R,c.type,c.memoizedProps,c):J0(R,c.type,c.stateNode):c.stateNode=Y0(R,f,c.memoizedProps):M!==f?(M===null?v.stateNode!==null&&W0(v.stateNode):q0(M),f===null?J0(R,c.type,c.stateNode):Y0(R,f,c.memoizedProps)):f===null&&c.stateNode!==null&&u0(c,c.memoizedProps,v.memoizedProps));break}case 27:if(Na&&M&4&&c.alternate===null){R=c.stateNode;var O=c.memoizedProps;try{s2(R),r2(c.type,O,R,c)}catch(dt){Bn(c,c.return,dt)}}case 5:if(is(f,c),gs(c),M&512&&(Di||v===null||Ti(v,v.return)),Oa){if(c.flags&32){f=c.stateNode;try{Tf(f)}catch(dt){Bn(c,c.return,dt)}}M&4&&c.stateNode!=null&&(f=c.memoizedProps,u0(c,f,v!==null?v.memoizedProps:f)),M&1024&&(Bl=!0)}break;case 6:if(is(f,c),gs(c),M&4&&Oa){if(c.stateNode===null)throw Error(a(162));M=c.memoizedProps,v=v!==null?v.memoizedProps:M,f=c.stateNode;try{fv(f,v,M)}catch(dt){Bn(c,c.return,dt)}}break;case 3:if(Hs?(Z0(),R=ls,ls=Sd(f.containerInfo),is(f,c),ls=R):is(f,c),gs(c),M&4){if(Oa&&rs&&v!==null&&v.memoizedState.isDehydrated)try{yd(f.containerInfo)}catch(dt){Bn(c,c.return,dt)}if(Fs){M=f.containerInfo,v=f.pendingChildren;try{H0(M,v)}catch(dt){Bn(c,c.return,dt)}}}Bl&&(Bl=!1,h0(c));break;case 4:Hs?(v=ls,ls=Sd(c.stateNode.containerInfo),is(f,c),gs(c),ls=v):(is(f,c),gs(c)),M&4&&Fs&&ev(c.stateNode,c,c.stateNode.pendingChildren);break;case 12:is(f,c),gs(c);break;case 13:is(f,c),gs(c),c.child.flags&8192&&c.memoizedState!==null!=(v!==null&&v.memoizedState!==null)&&(io=La()),M&4&&(M=c.updateQueue,M!==null&&(c.updateQueue=null,df(c,M)));break;case 22:M&512&&(Di||v===null||Ti(v,v.return)),R=c.memoizedState!==null;var J=v!==null&&v.memoizedState!==null,ce=ma,Se=Di;if(ma=ce||R,Di=Se||J,is(f,c),Di=Se,ma=ce,gs(c),f=c.stateNode,f._current=c,f._visibility&=-3,f._visibility|=f._pendingVisibility&2,M&8192&&(f._visibility=R?f._visibility&-2:f._visibility|1,R&&(f=ma||Di,v===null||J||f||jc(c)),Oa&&(c.memoizedProps===null||c.memoizedProps.mode!=="manual"))){e:if(v=null,Oa)for(f=c;;){if(f.tag===5||Hs&&f.tag===26||Na&&f.tag===27){if(v===null){J=v=f;try{O=J.stateNode,R?Cf(O):P0(J.stateNode,J.memoizedProps)}catch(dt){Bn(J,J.return,dt)}}}else if(f.tag===6){if(v===null){J=f;try{var Xe=J.stateNode;R?md(Xe):wo(Xe,J.memoizedProps)}catch(dt){Bn(J,J.return,dt)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===c)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break e;for(;f.sibling===null;){if(f.return===null||f.return===c)break e;v===f&&(v=null),f=f.return}v===f&&(v=null),f.sibling.return=f.return,f=f.sibling}}M&4&&(M=c.updateQueue,M!==null&&(v=M.retryQueue,v!==null&&(M.retryQueue=null,df(c,v))));break;case 19:is(f,c),gs(c),M&4&&(M=c.updateQueue,M!==null&&(c.updateQueue=null,df(c,M)));break;case 21:break;default:is(f,c),gs(c)}}function gs(c){var f=c.flags;if(f&2){try{if(Oa&&(!Na||c.tag!==27)){e:{for(var v=c.return;v!==null;){if(f0(v)){var M=v;break e}v=v.return}throw Error(a(160))}switch(M.tag){case 27:if(Na){var R=M.stateNode,O=Jh(c);Hc(c,O,R);break}case 5:var J=M.stateNode;M.flags&32&&(Tf(J),M.flags&=-33);var ce=Jh(c);Hc(c,ce,J);break;case 3:case 4:var Se=M.stateNode.containerInfo,Xe=Jh(c);Wh(c,Xe,Se);break;default:throw Error(a(161))}}}catch(dt){Bn(c,c.return,dt)}c.flags&=-3}f&4096&&(c.flags&=-4097)}function h0(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var f=c;h0(f),f.tag===5&&f.flags&1024&&pi(f.stateNode),c=c.sibling}}function kr(c,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)Zh(c,f.alternate,f),f=f.sibling}function jc(c){for(c=c.child;c!==null;){var f=c;switch(f.tag){case 0:case 11:case 14:case 15:ol(4,f,f.return),jc(f);break;case 1:Ti(f,f.return);var v=f.stateNode;typeof v.componentWillUnmount=="function"&&$g(f,f.return,v),jc(f);break;case 26:case 27:case 5:Ti(f,f.return),jc(f);break;case 22:Ti(f,f.return),f.memoizedState===null&&jc(f);break;default:jc(f)}c=c.sibling}}function ul(c,f,v){for(v=v&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var M=f.alternate,R=c,O=f,J=O.flags;switch(O.tag){case 0:case 11:case 15:ul(R,O,v),hf(4,O);break;case 1:if(ul(R,O,v),M=O,R=M.stateNode,typeof R.componentDidMount=="function")try{R.componentDidMount()}catch(Xe){Bn(M,M.return,Xe)}if(M=O,R=M.updateQueue,R!==null){var ce=M.stateNode;try{var Se=R.shared.hiddenCallbacks;if(Se!==null)for(R.shared.hiddenCallbacks=null,R=0;R<Se.length;R++)pe(Se[R],ce)}catch(Xe){Bn(M,M.return,Xe)}}v&&J&64&&Qg(O),Yl(O,O.return);break;case 26:case 27:case 5:ul(R,O,v),v&&M===null&&J&4&&zc(O),Yl(O,O.return);break;case 12:ul(R,O,v);break;case 13:ul(R,O,v),v&&J&4&&ll(R,O);break;case 22:O.memoizedState===null&&ul(R,O,v),Yl(O,O.return);break;default:ul(R,O,v)}f=f.sibling}}function d0(c,f){var v=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),c=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(c=f.memoizedState.cachePool.pool),c!==v&&(c!=null&&c.refCount++,v!=null&&Lc(v))}function $h(c,f){c=null,f.alternate!==null&&(c=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==c&&(f.refCount++,c!=null&&Lc(c))}function _o(c,f,v,M){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)ed(c,f,v,M),f=f.sibling}function ed(c,f,v,M){var R=f.flags;switch(f.tag){case 0:case 11:case 15:_o(c,f,v,M),R&2048&&hf(9,f);break;case 3:_o(c,f,v,M),R&2048&&(c=null,f.alternate!==null&&(c=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==c&&(f.refCount++,c!=null&&Lc(c)));break;case 12:if(R&2048){_o(c,f,v,M),c=f.stateNode;try{var O=f.memoizedProps,J=O.id,ce=O.onPostCommit;typeof ce=="function"&&ce(J,f.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(Se){Bn(f,f.return,Se)}}else _o(c,f,v,M);break;case 23:break;case 22:O=f.stateNode,f.memoizedState!==null?O._visibility&4?_o(c,f,v,M):fl(c,f):O._visibility&4?_o(c,f,v,M):(O._visibility|=4,ja(c,f,v,M,(f.subtreeFlags&10256)!==0)),R&2048&&d0(f.alternate,f);break;case 24:_o(c,f,v,M),R&2048&&$h(f.alternate,f);break;default:_o(c,f,v,M)}}function ja(c,f,v,M,R){for(R=R&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var O=c,J=f,ce=v,Se=M,Xe=J.flags;switch(J.tag){case 0:case 11:case 15:ja(O,J,ce,Se,R),hf(8,J);break;case 23:break;case 22:var dt=J.stateNode;J.memoizedState!==null?dt._visibility&4?ja(O,J,ce,Se,R):fl(O,J):(dt._visibility|=4,ja(O,J,ce,Se,R)),R&&Xe&2048&&d0(J.alternate,J);break;case 24:ja(O,J,ce,Se,R),R&&Xe&2048&&$h(J.alternate,J);break;default:ja(O,J,ce,Se,R)}f=f.sibling}}function fl(c,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var v=c,M=f,R=M.flags;switch(M.tag){case 22:fl(v,M),R&2048&&d0(M.alternate,M);break;case 24:fl(v,M),R&2048&&$h(M.alternate,M);break;default:fl(v,M)}f=f.sibling}}function Sa(c){if(c.subtreeFlags&lc)for(c=c.child;c!==null;)ql(c),c=c.sibling}function ql(c){switch(c.tag){case 26:Sa(c),c.flags&lc&&(c.memoizedState!==null?$0(ls,c.memoizedState,c.memoizedProps):Ii(c.type,c.memoizedProps));break;case 5:Sa(c),c.flags&lc&&Ii(c.type,c.memoizedProps);break;case 3:case 4:if(Hs){var f=ls;ls=Sd(c.stateNode.containerInfo),Sa(c),ls=f}else Sa(c);break;case 22:c.memoizedState===null&&(f=c.alternate,f!==null&&f.memoizedState!==null?(f=lc,lc=16777216,Sa(c),lc=f):Sa(c));break;default:Sa(c)}}function td(c){var f=c.alternate;if(f!==null&&(c=f.child,c!==null)){f.child=null;do f=c.sibling,c.sibling=null,c=f;while(c!==null)}}function hl(c){var f=c.deletions;if((c.flags&16)!==0){if(f!==null)for(var v=0;v<f.length;v++){var M=f[v];Gi=M,dl(M,c)}td(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)pf(c),c=c.sibling}function pf(c){switch(c.tag){case 0:case 11:case 15:hl(c),c.flags&2048&&ol(9,c,c.return);break;case 3:hl(c);break;case 12:hl(c);break;case 22:var f=c.stateNode;c.memoizedState!==null&&f._visibility&4&&(c.return===null||c.return.tag!==13)?(f._visibility&=-5,Xc(c)):hl(c);break;default:hl(c)}}function Xc(c){var f=c.deletions;if((c.flags&16)!==0){if(f!==null)for(var v=0;v<f.length;v++){var M=f[v];Gi=M,dl(M,c)}td(c)}for(c=c.child;c!==null;){switch(f=c,f.tag){case 0:case 11:case 15:ol(8,f,f.return),Xc(f);break;case 22:v=f.stateNode,v._visibility&4&&(v._visibility&=-5,Xc(f));break;default:Xc(f)}c=c.sibling}}function dl(c,f){for(;Gi!==null;){var v=Gi;switch(v.tag){case 0:case 11:case 15:ol(8,v,f);break;case 23:case 22:if(v.memoizedState!==null&&v.memoizedState.cachePool!==null){var M=v.memoizedState.cachePool.pool;M!=null&&M.refCount++}break;case 24:Lc(v.memoizedState.cache)}if(M=v.child,M!==null)M.return=v,Gi=M;else e:for(v=c;Gi!==null;){M=Gi;var R=M.sibling,O=M.return;if(Vc(M),M===v){Gi=null;break e}if(R!==null){R.return=O,Gi=R;break e}Gi=O}}}function nd(c){var f=w0(c);if(f!=null){if(typeof f.memoizedProps["data-testname"]!="string")throw Error(a(364));return f}if(c=nc(c),c===null)throw Error(a(362));return c.stateNode.current}function Yc(c,f){var v=c.tag;switch(f.$$typeof){case Vf:if(c.type===f.value)return!0;break;case Od:e:{for(f=f.value,c=[c,0],v=0;v<c.length;){var M=c[v++],R=M.tag,O=c[v++],J=f[O];if(R!==5&&R!==26&&R!==27||!Qr(M)){for(;J!=null&&Yc(M,J);)O++,J=f[O];if(O===f.length){f=!0;break e}else for(M=M.child;M!==null;)c.push(M,O),M=M.sibling}}f=!1}return f;case Nd:if((v===5||v===26||v===27)&&e2(c.stateNode,f.value))return!0;break;case ii:if((v===5||v===6||v===26||v===27)&&(c=Ef(c),c!==null&&0<=c.indexOf(f.value)))return!0;break;case Hn:if((v===5||v===26||v===27)&&(c=c.memoizedProps["data-testname"],typeof c=="string"&&c.toLowerCase()===f.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function pl(c){switch(c.$$typeof){case Vf:return"<"+(l(c.value)||"Unknown")+">";case Od:return":has("+(pl(c)||"")+")";case Nd:return'[role="'+c.value+'"]';case ii:return'"'+c.value+'"';case Hn:return'[data-testname="'+c.value+'"]';default:throw Error(a(365))}}function tv(c,f){var v=[];c=[c,0];for(var M=0;M<c.length;){var R=c[M++],O=R.tag,J=c[M++],ce=f[J];if(O!==5&&O!==26&&O!==27||!Qr(R)){for(;ce!=null&&Yc(R,ce);)J++,ce=f[J];if(J===f.length)v.push(R);else for(R=R.child;R!==null;)c.push(R,J),R=R.sibling}}return v}function as(c,f){if(!Zr)throw Error(a(363));c=nd(c),c=tv(c,f),f=[],c=Array.from(c);for(var v=0;v<c.length;){var M=c[v++],R=M.tag;if(R===5||R===26||R===27)Qr(M)||f.push(M.stateNode);else for(M=M.child;M!==null;)c.push(M),M=M.sibling}return f}function ss(){if((Kt&2)!==0&&yn!==0)return yn&-yn;if($t.T!==null){var c=Ss;return c!==0?c:Ze()}return lr()}function jr(){Es===0&&(Es=(yn&536870912)===0||Xn?j():536870912);var c=qs.current;return c!==null&&(c.flags|=32),Es}function Xa(c,f,v){(c===En&&mi===2||c.cancelPendingCommit!==null)&&(Ar(c,0),Sr(c,yn,Es,!1)),q(c,v),((Kt&2)===0||c!==En)&&(c===En&&((Kt&2)===0&&(Br|=v),Gn===4&&Sr(c,yn,Es,!1)),bt(c))}function mf(c,f,v){if((Kt&6)!==0)throw Error(a(327));var M=!v&&(f&60)===0&&(f&c.expiredLanes)===0||N(c,f),R=M?qr(c,f):Xr(c,f,!0),O=M;do{if(R===0){Ks&&!M&&Sr(c,f,0,!1);break}else if(R===6)Sr(c,f,0,!ai);else{if(v=c.current.alternate,O&&!nv(v)){R=Xr(c,f,!1),O=!1;continue}if(R===2){if(O=f,c.errorRecoveryDisabledLanes&O)var J=0;else J=c.pendingLanes&-536870913,J=J!==0?J:J&536870912?536870912:0;if(J!==0){f=J;e:{var ce=c;R=cu;var Se=rs&&ce.current.memoizedState.isDehydrated;if(Se&&(Ar(ce,J).flags|=256),J=Xr(ce,J,!1),J!==2){if(Lo&&!Se){ce.errorRecoveryDisabledLanes|=O,Br|=O,R=4;break e}O=Ws,Ws=R,O!==null&&yo(O)}R=J}if(O=!1,R!==2)continue}}if(R===1){Ar(c,0),Sr(c,f,0,!0);break}e:{switch(M=c,R){case 0:case 1:throw Error(a(345));case 4:if((f&4194176)===f){Sr(M,f,Es,!ai);break e}break;case 2:Ws=null;break;case 3:case 5:break;default:throw Error(a(329))}if(M.finishedWork=v,M.finishedLanes=f,(f&62914560)===f&&(O=io+300-La(),10<O)){if(Sr(M,f,Es,!ai),F(M,0)!==0)break e;M.timeoutHandle=R0(id.bind(null,M,v,Ws,Dr,uu,f,Es,Br,Io,ai,2,-0,0),O);break e}id(M,v,Ws,Dr,uu,f,Es,Br,Io,ai,0,-0,0)}}break}while(!0);bt(c)}function yo(c){Ws===null?Ws=c:Ws.push.apply(Ws,c)}function id(c,f,v,M,R,O,J,ce,Se,Xe,dt,St,wt){var ln=f.subtreeFlags;if((ln&8192||(ln&16785408)===16785408)&&(zs(),ql(f),f=hd(),f!==null)){c.cancelPendingCommit=f(_i.bind(null,c,v,M,R,J,ce,Se,1,St,wt)),Sr(c,O,J,!Xe);return}_i(c,v,M,R,J,ce,Se,dt,St,wt)}function nv(c){for(var f=c;;){var v=f.tag;if((v===0||v===11||v===15)&&f.flags&16384&&(v=f.updateQueue,v!==null&&(v=v.stores,v!==null)))for(var M=0;M<v.length;M++){var R=v[M],O=R.getSnapshot;R=R.value;try{if(!Gs(O(),R))return!1}catch{return!1}}if(v=f.child,f.subtreeFlags&16384&&v!==null)v.return=f,f=v;else{if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Sr(c,f,v,M){f&=~Za,f&=~Br,c.suspendedLanes|=f,c.pingedLanes&=~f,M&&(c.warmLanes|=f),M=c.expirationTimes;for(var R=f;0<R;){var O=31-ys(R),J=1<<O;M[O]=-1,R&=~J}v!==0&&se(c,v,f)}function p0(){return(Kt&6)===0?(mt(0),!1):!0}function vs(){if(fn!==null){if(mi===0)var c=fn.return;else c=fn,Hi=wl=null,nt(c),eo=null,fr=0,c=fn;for(;c!==null;)c0(c.alternate,c),c=c.return;fn=null}}function Ar(c,f){c.finishedWork=null,c.finishedLanes=0;var v=c.timeoutHandle;v!==tc&&(c.timeoutHandle=tc,Mf(v)),v=c.cancelPendingCommit,v!==null&&(c.cancelPendingCommit=null,v()),vs(),En=c,fn=v=Ya(c.current,null),yn=f,mi=0,Wi=null,ai=!1,Ks=N(c,f),Lo=!1,Io=Es=Za=Br=Js=Gn=0,Ws=cu=null,uu=!1,(f&8)!==0&&(f|=f&32);var M=c.entangledLanes;if(M!==0)for(c=c.entanglements,M&=f;0<M;){var R=31-ys(M),O=1<<R;f|=c[R],M&=~O}return wr=f,ke(),v}function Kl(c,f){mn=null,$t.H=Yn,f===fi?(f=Bt(),mi=3):f===im?(f=Bt(),mi=4):mi=f===Lv?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Wi=f,fn===null&&(Gn=1,Vh(c,me(f,c.current)))}function gf(){var c=qs.current;return c===null?!0:(yn&4194176)===yn?hr===null:(yn&62914560)===yn||(yn&536870912)!==0?c===hr:!1}function qc(){var c=$t.H;return $t.H=Yn,c===null?Yn:c}function Ps(){var c=$t.A;return $t.A=Ud,c}function xs(){Gn=4,ai||(yn&4194176)!==yn&&qs.current!==null||(Ks=!0),(Js&134217727)===0&&(Br&134217727)===0||En===null||Sr(En,yn,Es,!1)}function Xr(c,f,v){var M=Kt;Kt|=2;var R=qc(),O=Ps();(En!==c||yn!==f)&&(Dr=null,Ar(c,f)),f=!1;var J=Gn;e:do try{if(mi!==0&&fn!==null){var ce=fn,Se=Wi;switch(mi){case 8:vs(),J=6;break e;case 3:case 2:case 6:qs.current===null&&(f=!0);var Xe=mi;if(mi=0,Wi=null,ml(c,ce,Se,Xe),v&&Ks){J=0;break e}break;default:Xe=mi,mi=0,Wi=null,ml(c,ce,Se,Xe)}}Yr(),J=Gn;break}catch(dt){Kl(c,dt)}while(!0);return f&&c.shellSuspendCounter++,Hi=wl=null,Kt=M,$t.H=R,$t.A=O,fn===null&&(En=null,yn=0,ke()),J}function Yr(){for(;fn!==null;)m0(fn)}function qr(c,f){var v=Kt;Kt|=2;var M=qc(),R=Ps();En!==c||yn!==f?(Dr=null,Ui=La()+500,Ar(c,f)):Ks=N(c,f);e:do try{if(mi!==0&&fn!==null){f=fn;var O=Wi;t:switch(mi){case 1:mi=0,Wi=null,ml(c,f,O,1);break;case 2:if(vt(O)){mi=0,Wi=null,ad(f);break}f=function(){mi===2&&En===c&&(mi=7),bt(c)},O.then(f,f);break e;case 3:mi=7;break e;case 4:mi=5;break e;case 7:vt(O)?(mi=0,Wi=null,ad(f)):(mi=0,Wi=null,ml(c,f,O,7));break;case 5:var J=null;switch(fn.tag){case 26:J=fn.memoizedState;case 5:case 27:var ce=fn,Se=ce.type,Xe=ce.pendingProps;if(J?Q0(J):Ro(Se,Xe)){mi=0,Wi=null;var dt=ce.sibling;if(dt!==null)fn=dt;else{var St=ce.return;St!==null?(fn=St,vf(St)):fn=null}break t}}mi=0,Wi=null,ml(c,f,O,5);break;case 6:mi=0,Wi=null,ml(c,f,O,6);break;case 8:vs(),Gn=6;break e;default:throw Error(a(462))}}bo();break}catch(wt){Kl(c,wt)}while(!0);return Hi=wl=null,$t.H=M,$t.A=R,Kt=v,fn!==null?0:(En=null,yn=0,ke(),Gn)}function bo(){for(;fn!==null&&!Bv();)m0(fn)}function m0(c){var f=Kg(c.alternate,c,wr);c.memoizedProps=c.pendingProps,f===null?vf(c):fn=f}function ad(c){var f=c,v=f.alternate;switch(f.tag){case 15:case 0:f=kg(v,f,f.pendingProps,f.type,void 0,yn);break;case 11:f=kg(v,f,f.pendingProps,f.type.render,f.ref,yn);break;case 5:nt(f);default:c0(v,f),f=fn=Mo(f,wr),f=Kg(v,f,wr)}c.memoizedProps=c.pendingProps,f===null?vf(c):fn=f}function ml(c,f,v,M){Hi=wl=null,nt(f),eo=null,fr=0;var R=f.return;try{if(Fg(c,R,f,v,yn)){Gn=1,Vh(c,me(v,c.current)),fn=null;return}}catch(O){if(R!==null)throw fn=R,O;Gn=1,Vh(c,me(v,c.current)),fn=null;return}f.flags&32768?(Xn||M===1?c=!0:Ks||(yn&536870912)!==0?c=!1:(ai=c=!0,(M===2||M===3||M===6)&&(M=qs.current,M!==null&&M.tag===13&&(M.flags|=16384))),Aa(f,c)):vf(f)}function vf(c){var f=c;do{if((f.flags&32768)!==0){Aa(f,ai);return}c=f.return;var v=Wg(f.alternate,f,wr);if(v!==null){fn=v;return}if(f=f.sibling,f!==null){fn=f;return}fn=f=c}while(f!==null);Gn===0&&(Gn=5)}function Aa(c,f){do{var v=Zg(c.alternate,c);if(v!==null){v.flags&=32767,fn=v;return}if(v=c.return,v!==null&&(v.flags|=32768,v.subtreeFlags=0,v.deletions=null),!f&&(c=c.sibling,c!==null)){fn=c;return}fn=c=v}while(c!==null);Gn=6,fn=null}function _i(c,f,v,M,R,O,J,ce,Se,Xe){var dt=$t.T,St=pa();try{qa(2),$t.T=null,On(c,f,v,M,St,R,O,J,ce,Se,Xe)}finally{$t.T=dt,qa(St)}}function On(c,f,v,M,R,O,J,ce){do Ma();while(Po!==null);if((Kt&6)!==0)throw Error(a(327));var Se=c.finishedWork;if(M=c.finishedLanes,Se===null)return null;if(c.finishedWork=null,c.finishedLanes=0,Se===c.current)throw Error(a(177));c.callbackNode=null,c.callbackPriority=0,c.cancelPendingCommit=null;var Xe=Se.lanes|Se.childLanes;if(Xe|=au,ie(c,M,Xe,O,J,ce),c===En&&(fn=En=null,yn=0),(Se.subtreeFlags&10256)===0&&(Se.flags&10256)===0||pr||(pr=!0,Ld=Xe,uc=v,xf(Md,function(){return Ma(),null})),v=(Se.flags&15990)!==0,(Se.subtreeFlags&15990)!==0||v?(v=$t.T,$t.T=null,O=pa(),qa(2),J=Kt,Kt|=4,Gc(c,Se),cl(Se,c),T0(c.containerInfo),c.current=Se,Zh(c,Se.alternate,Se),Dv(),Kt=J,qa(O),$t.T=v):c.current=Se,pr?(pr=!1,Po=c,cc=M):So(c,Xe),Xe=c.pendingLanes,Xe===0&&(Zs=null),H(Se.stateNode),bt(c),f!==null)for(R=c.onRecoverableError,Se=0;Se<f.length;Se++)Xe=f[Se],R(Xe.value,{componentStack:Xe.stack});return(cc&3)!==0&&Ma(),Xe=c.pendingLanes,(M&4194218)!==0&&(Xe&42)!==0?c===cs?fc++:(fc=0,cs=c):fc=0,mt(0),null}function So(c,f){(c.pooledCacheLanes&=f)===0&&(f=c.pooledCache,f!=null&&(c.pooledCache=null,Lc(f)))}function Ma(){if(Po!==null){var c=Po,f=Ld;Ld=0;var v=re(cc),M=32>v?32:v;v=$t.T;var R=pa();try{if(qa(M),$t.T=null,Po===null)var O=!1;else{M=uc,uc=null;var J=Po,ce=cc;if(Po=null,cc=0,(Kt&6)!==0)throw Error(a(331));var Se=Kt;if(Kt|=4,pf(J.current),ed(J,J.current,ce,M),Kt=Se,mt(0,!1),bs&&typeof bs.onPostCommitFiberRoot=="function")try{bs.onPostCommitFiberRoot(nu,J)}catch{}O=!0}return O}finally{qa(R),$t.T=v,So(c,f)}}return!1}function sd(c,f,v){f=me(v,f),f=rf(c.stateNode,f,2),c=qe(c,f,2),c!==null&&(q(c,2),bt(c))}function Bn(c,f,v){if(c.tag===3)sd(c,c,v);else for(;f!==null;){if(f.tag===3){sd(f,c,v);break}else if(f.tag===1){var M=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(Zs===null||!Zs.has(M))){c=me(v,c),v=Nc(2),M=qe(f,v,2),M!==null&&(of(v,M,f,c),q(M,2),bt(M));break}}f=f.return}}function rd(c,f,v){var M=c.pingCache;if(M===null){M=c.pingCache=new Dn;var R=new Set;M.set(f,R)}else R=M.get(f),R===void 0&&(R=new Set,M.set(f,R));R.has(v)||(Lo=!0,R.add(v),c=iv.bind(null,c,f,v),f.then(c,c))}function iv(c,f,v){var M=c.pingCache;M!==null&&M.delete(f),c.pingedLanes|=c.suspendedLanes&v,c.warmLanes&=~v,En===c&&(yn&v)===v&&(Gn===4||Gn===3&&(yn&62914560)===yn&&300>La()-io?(Kt&2)===0&&Ar(c,0):Za|=v,Io===yn&&(Io=0)),bt(c)}function Jl(c,f){f===0&&(f=L()),c=st(c,f),c!==null&&(q(c,f),bt(c))}function Wl(c){var f=c.memoizedState,v=0;f!==null&&(v=f.retryLane),Jl(c,v)}function g0(c,f){var v=0;switch(c.tag){case 13:var M=c.stateNode,R=c.memoizedState;R!==null&&(v=R.retryLane);break;case 19:M=c.stateNode;break;case 22:M=c.stateNode._retryCache;break;default:throw Error(a(314))}M!==null&&M.delete(f),Jl(c,v)}function xf(c,f){return tu(c,f)}function v0(c,f,v,M){this.tag=c,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ao(c){return c=c.prototype,!(!c||!c.isReactComponent)}function Ya(c,f){var v=c.alternate;return v===null?(v=t(c.tag,f,c.key,c.mode),v.elementType=c.elementType,v.type=c.type,v.stateNode=c.stateNode,v.alternate=c,c.alternate=v):(v.pendingProps=f,v.type=c.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=c.flags&31457280,v.childLanes=c.childLanes,v.lanes=c.lanes,v.child=c.child,v.memoizedProps=c.memoizedProps,v.memoizedState=c.memoizedState,v.updateQueue=c.updateQueue,f=c.dependencies,v.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},v.sibling=c.sibling,v.index=c.index,v.ref=c.ref,v.refCleanup=c.refCleanup,v}function Mo(c,f){c.flags&=31457282;var v=c.alternate;return v===null?(c.childLanes=0,c.lanes=f,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=v.childLanes,c.lanes=v.lanes,c.child=v.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=v.memoizedProps,c.memoizedState=v.memoizedState,c.updateQueue=v.updateQueue,c.type=v.type,f=v.dependencies,c.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),c}function or(c,f,v,M,R,O){var J=0;if(M=c,typeof c=="function")Ao(c)&&(J=1);else if(typeof c=="string")J=Hs&&Na?X0(c,v,Ta.current)?26:$c(c)?27:5:Hs?X0(c,v,Ta.current)?26:5:Na&&$c(c)?27:5;else e:switch(c){case Jc:return Eo(v.children,R,O,f);case S0:J=8,R|=24;break;case A0:return c=t(12,v,f,R|2),c.elementType=A0,c.lanes=O,c;case ld:return c=t(13,v,f,R),c.elementType=ld,c.lanes=O,c;case xl:return c=t(19,v,f,R),c.elementType=xl,c.lanes=O,c;case bf:return od(v,R,O,f);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case rv:case Kr:J=10;break e;case vl:J=9;break e;case Wc:J=11;break e;case yf:J=14;break e;case Er:J=16,M=null;break e}J=29,v=Error(a(130,c===null?"null":typeof c,"")),M=null}return f=t(J,v,f,R),f.elementType=c,f.type=M,f.lanes=O,f}function Eo(c,f,v,M){return c=t(7,c,M,f),c.lanes=v,c}function od(c,f,v,M){c=t(22,c,M,f),c.elementType=bf,c.lanes=v;var R={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var O=R._current;if(O===null)throw Error(a(456));if((R._pendingVisibility&2)===0){var J=st(O,2);J!==null&&(R._pendingVisibility|=2,Xa(J,O,2))}},attach:function(){var O=R._current;if(O===null)throw Error(a(456));if((R._pendingVisibility&2)!==0){var J=st(O,2);J!==null&&(R._pendingVisibility&=-3,Xa(J,O,2))}}};return c.stateNode=R,c}function gl(c,f,v){return c=t(6,c,null,f),c.lanes=v,c}function Kc(c,f,v){return f=t(4,c.children!==null?c.children:[],c.key,f),f.lanes=v,f.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},f}function Zl(c,f,v,M,R,O,J,ce){this.tag=1,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=tc,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=P(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=P(0),this.hiddenUpdates=P(null),this.identifierPrefix=M,this.onUncaughtError=R,this.onCaughtError=O,this.onRecoverableError=J,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ce,this.incompleteTransitions=new Map}function Ea(c,f,v,M,R,O,J,ce,Se,Xe,dt,St){return c=new Zl(c,f,v,J,ce,Se,Xe,St),f=1,O===!0&&(f|=24),O=t(3,null,null,f),c.current=O,O.stateNode=c,f=Yh(),f.refCount++,c.pooledCache=f,f.refCount++,O.memoizedState={element:M,isDehydrated:v,cache:f},Vt(O),c}function _f(c){return c?(c=ic,c):ic}function x0(c){var f=c._reactInternals;if(f===void 0)throw typeof c.render=="function"?Error(a(188)):(c=Object.keys(c).join(","),Error(a(268,c)));return c=y(f),c=c!==null?b(c):null,c===null?null:Zc(c.stateNode)}function av(c,f,v,M,R,O){R=_f(R),M.context===null?M.context=R:M.pendingContext=R,M=Ye(f),M.payload={element:v},O=O===void 0?null:O,O!==null&&(M.callback=O),v=qe(c,M,f),v!==null&&(Xa(v,c,f),It(v,c,f))}function sv(c,f){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var v=c.retryLane;c.retryLane=v!==0&&v<f?v:f}}function _0(c,f){sv(c,f),(c=c.alternate)&&sv(c,f)}var qt={},y0=Fp(),Ua=j5(),Ql=Object.assign,b0=Symbol.for("react.element"),To=Symbol.for("react.transitional.element"),Mr=Symbol.for("react.portal"),Jc=Symbol.for("react.fragment"),S0=Symbol.for("react.strict_mode"),A0=Symbol.for("react.profiler"),rv=Symbol.for("react.provider"),vl=Symbol.for("react.consumer"),Kr=Symbol.for("react.context"),Wc=Symbol.for("react.forward_ref"),ld=Symbol.for("react.suspense"),xl=Symbol.for("react.suspense_list"),yf=Symbol.for("react.memo"),Er=Symbol.for("react.lazy"),bf=Symbol.for("react.offscreen"),ov=Symbol.for("react.memo_cache_sentinel"),M0=Symbol.iterator,$l=Symbol.for("react.client.reference"),$t=y0.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,cd,E0,_l=!1,yl=Array.isArray,ud=e.rendererVersion,Sf=e.rendererPackageName,Af=e.extraDevToolsConfig,Zc=e.getPublicInstance,ec=e.getRootHostContext,lv=e.getChildHostContext,bl=e.prepareForCommit,T0=e.resetAfterCommit,C0=e.createInstance,Jr=e.appendInitialChild,Co=e.finalizeInitialChildren,Sl=e.shouldSetTextContent,fd=e.createTextInstance,R0=e.scheduleTimeout,Mf=e.cancelTimeout,tc=e.noTimeout,Wr=e.isPrimaryRenderer;e.warnsIfNotActing;var Oa=e.supportsMutation,Fs=e.supportsPersistence,rs=e.supportsHydration,w0=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var B0=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var qa=e.setCurrentUpdatePriority,pa=e.getCurrentUpdatePriority,lr=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Al=e.shouldAttemptEagerTransition,D0=e.detachDeletedInstance;e.requestPostPaintCallback;var cv=e.maySuspendCommit,Ro=e.preloadInstance,zs=e.startSuspendingCommit,Ii=e.suspendInstance,hd=e.waitForCommitToBeReady,_s=e.NotPendingTransition,nn=e.HostTransitionContext,pi=e.resetFormInstance;e.bindToConsole;var na=e.supportsMicrotasks,dd=e.scheduleMicrotask,Zr=e.supportsTestSelectors,nc=e.findFiberRoot,pd=e.getBoundingRect,Ef=e.getTextContent,Qr=e.isHiddenSubtree,e2=e.matchAccessibilityRole,Pi=e.setFocusIfFocusable,U0=e.setupIntersectionObserver,O0=e.appendChild,uv=e.appendChildToContainer,fv=e.commitTextUpdate,t2=e.commitMount,N0=e.commitUpdate,L0=e.insertBefore,I0=e.insertInContainerBefore,os=e.removeChild,Yi=e.removeChildFromContainer,Tf=e.resetTextContent,Cf=e.hideInstance,md=e.hideTextInstance,P0=e.unhideInstance,wo=e.unhideTextInstance,gd=e.clearContainer,F0=e.cloneInstance,vd=e.createContainerChildSet,z0=e.appendChildToContainerChildSet,hv=e.finalizeContainerChildren,H0=e.replaceContainerChildren,G0=e.cloneHiddenInstance,V0=e.cloneHiddenTextInstance,xd=e.isSuspenseInstancePending,Rf=e.isSuspenseInstanceFallback,dv=e.getSuspenseInstanceFallbackErrorDetails,n2=e.registerSuspenseInstanceRetry,pv=e.canHydrateFormStateMarker,mv=e.isFormStateMarkerMatching,k0=e.getNextHydratableSibling,_d=e.getFirstHydratableChild,gv=e.getFirstHydratableChildWithinContainer,vv=e.getFirstHydratableChildWithinSuspenseInstance,xv=e.canHydrateInstance,_v=e.canHydrateTextInstance,yv=e.canHydrateSuspenseInstance,i2=e.hydrateInstance,bv=e.hydrateTextInstance,Qc=e.hydrateSuspenseInstance,Sv=e.getNextHydratableInstanceAfterSuspenseInstance,yd=e.commitHydratedContainer,bd=e.commitHydratedSuspenseInstance,Av=e.clearSuspenseBoundary,j0=e.clearSuspenseBoundaryFromContainer,Mv=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Ev=e.validateHydratableInstance,Tv=e.validateHydratableTextInstance,Hs=e.supportsResources,X0=e.isHostHoistableType,Sd=e.getHoistableRoot,Ad=e.getResource,Y0=e.acquireResource,q0=e.releaseResource,K0=e.hydrateHoistable,J0=e.mountHoistable,W0=e.unmountHoistable,a2=e.createHoistableInstance,Z0=e.prepareToCommitHoistables,Cv=e.mayResourceSuspendCommit,Q0=e.preloadResource,$0=e.suspendResource,Na=e.supportsSingletons,em=e.resolveSingletonInstance,s2=e.clearSingleton,r2=e.acquireSingletonInstance,Rv=e.releaseSingletonInstance,$c=e.isHostSingletonType,wf=[],Bo=-1,ic={},ys=Math.clz32?Math.clz32:D,Bf=Math.log,wv=Math.LN2,eu=128,Df=4194304,tu=Ua.unstable_scheduleCallback,Uf=Ua.unstable_cancelCallback,Bv=Ua.unstable_shouldYield,Dv=Ua.unstable_requestPaint,La=Ua.unstable_now,tm=Ua.unstable_ImmediatePriority,Uv=Ua.unstable_UserBlockingPriority,Md=Ua.unstable_NormalPriority,Ed=Ua.unstable_IdlePriority,Ov=Ua.log,nm=Ua.unstable_setDisableYieldValue,nu=null,bs=null,Gs=typeof Object.is=="function"?Object.is:W,Td=new WeakMap,Ci=[],Fi=0,Of=null,Nf=0,Vs=[],ks=0,Tr=null,$r=1,cr="",Ta=E(null),Lf=E(null),Cr=E(null),iu=E(null),Ka=null,Ia=null,Xn=!1,js=null,ur=!1,If=Error(a(519)),Xs=[],Ml=0,au=0,su=null,ac=null,Pf=!1,Ff=!1,Rr=!1,El=0,zf=null,Cd=0,Ss=0,Tl=null,Do=!1,ru=!1,Hf=Object.prototype.hasOwnProperty,fi=Error(a(460)),im=Error(a(474)),Rd={then:function(){}},sc=null,eo=null,fr=0,Cl=Va(!0),am=Va(!1),to=E(null),Ys=E(0),qs=E(null),hr=null,ia=E(0),no=0,mn=null,ei=null,qi=null,dr=!1,Ri=!1,Uo=!1,Gf=0,zi=0,ou=null,Nv=0,wd=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Yn={readContext:Da,use:le,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useLayoutEffect:hn,useInsertionEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useSyncExternalStore:hn,useId:hn};Yn.useCacheRefresh=hn,Yn.useMemoCache=hn,Yn.useHostTransitionStatus=hn,Yn.useFormState=hn,Yn.useActionState=hn,Yn.useOptimistic=hn;var aa={readContext:Da,use:le,useCallback:function(c,f){return at().memoizedState=[c,f===void 0?null:f],c},useContext:Da,useEffect:Yp,useImperativeHandle:function(c,f,v){v=v!=null?v.concat([c]):null,rr(4194308,4,ef.bind(null,f,c),v)},useLayoutEffect:function(c,f){return rr(4194308,4,c,f)},useInsertionEffect:function(c,f){rr(4,2,c,f)},useMemo:function(c,f){var v=at();f=f===void 0?null:f;var M=c();if(Uo){K(!0);try{c()}finally{K(!1)}}return v.memoizedState=[M,f],M},useReducer:function(c,f,v){var M=at();if(v!==void 0){var R=v(f);if(Uo){K(!0);try{v(f)}finally{K(!1)}}}else R=f;return M.memoizedState=M.baseState=R,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:R},M.queue=c,c=c.dispatch=tl.bind(null,mn,c),[M.memoizedState,c]},useRef:function(c){var f=at();return c={current:c},f.memoizedState=c},useState:function(c){c=Ht(c);var f=c.queue,v=Hh.bind(null,mn,f);return f.dispatch=v,[c.memoizedState,v]},useDebugValue:tf,useDeferredValue:function(c,f){var v=at();return el(v,c,f)},useTransition:function(){var c=Ht(!1);return c=Fh.bind(null,mn,c.queue,!0,!1),at().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,f,v){var M=mn,R=at();if(Xn){if(v===void 0)throw Error(a(407));v=v()}else{if(v=f(),En===null)throw Error(a(349));(yn&60)!==0||_t(M,f,v)}R.memoizedState=v;var O={value:v,getSnapshot:f};return R.queue=O,Yp(Tt.bind(null,M,O,c),[c]),M.flags|=2048,Li(9,Rt.bind(null,M,O,v,f),{destroy:void 0},null),v},useId:function(){var c=at(),f=En.identifierPrefix;if(Xn){var v=cr,M=$r;v=(M&~(1<<32-ys(M)-1)).toString(32)+v,f=":"+f+"R"+v,v=Gf++,0<v&&(f+="H"+v.toString(32)),f+=":"}else v=Nv++,f=":"+f+"r"+v.toString(32)+":";return c.memoizedState=f},useCacheRefresh:function(){return at().memoizedState=nf.bind(null,mn)}};aa.useMemoCache=_e,aa.useHostTransitionStatus=Gl,aa.useFormState=Bi,aa.useActionState=Bi,aa.useOptimistic=function(c){var f=at();f.memoizedState=f.baseState=c;var v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=v,f=Gh.bind(null,mn,!0,v),v.dispatch=f,[c,f]};var Ja={readContext:Da,use:le,useCallback:Ph,useContext:Da,useEffect:$u,useImperativeHandle:Gr,useInsertionEffect:Ig,useLayoutEffect:Pg,useMemo:Hl,useReducer:Ne,useRef:yr,useState:function(){return Ne(oe)},useDebugValue:tf,useDeferredValue:function(c,f){var v=V();return qp(v,ei.memoizedState,c,f)},useTransition:function(){var c=Ne(oe)[0],f=V().memoizedState;return[typeof c=="boolean"?c:ne(c),f]},useSyncExternalStore:ct,useId:Vr};Ja.useCacheRefresh=zh,Ja.useMemoCache=_e,Ja.useHostTransitionStatus=Gl,Ja.useFormState=Un,Ja.useActionState=Un,Ja.useOptimistic=function(c,f){var v=V();return Jt(v,ei,c,f)};var Rl={readContext:Da,use:le,useCallback:Ph,useContext:Da,useEffect:$u,useImperativeHandle:Gr,useInsertionEffect:Ig,useLayoutEffect:Pg,useMemo:Hl,useReducer:$e,useRef:yr,useState:function(){return $e(oe)},useDebugValue:tf,useDeferredValue:function(c,f){var v=V();return ei===null?el(v,c,f):qp(v,ei.memoizedState,c,f)},useTransition:function(){var c=$e(oe)[0],f=V().memoizedState;return[typeof c=="boolean"?c:ne(c),f]},useSyncExternalStore:ct,useId:Vr};Rl.useCacheRefresh=zh,Rl.useMemoCache=_e,Rl.useHostTransitionStatus=Gl,Rl.useFormState=da,Rl.useActionState=da,Rl.useOptimistic=function(c,f){var v=V();return ei!==null?Jt(v,ei,c,f):(v.baseState=c,[c,v.queue.dispatch])};var Bd={isMounted:function(c){return(c=c._reactInternals)?g(c)===c:!1},enqueueSetState:function(c,f,v){c=c._reactInternals;var M=ss(),R=Ye(M);R.payload=f,v!=null&&(R.callback=v),f=qe(c,R,M),f!==null&&(Xa(f,c,M),It(f,c,M))},enqueueReplaceState:function(c,f,v){c=c._reactInternals;var M=ss(),R=Ye(M);R.tag=1,R.payload=f,v!=null&&(R.callback=v),f=qe(c,R,M),f!==null&&(Xa(f,c,M),It(f,c,M))},enqueueForceUpdate:function(c,f){c=c._reactInternals;var v=ss(),M=Ye(v);M.tag=2,f!=null&&(M.callback=f),f=qe(c,M,v),f!==null&&(Xa(f,c,v),It(f,c,v))}},sm=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)},Lv=Error(a(461)),Ki=!1,Wa={dehydrated:null,treeContext:null,retryLane:0},As=E(null),wl=null,Hi=null,Iv=typeof AbortController<"u"?AbortController:function(){var c=[],f=this.signal={aborted:!1,addEventListener:function(v,M){c.push(M)}};this.abort=function(){f.aborted=!0,c.forEach(function(v){return v()})}},Oo=Ua.unstable_scheduleCallback,rc=Ua.unstable_NormalPriority,ni={$$typeof:Kr,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Dd=$t.S;$t.S=function(c,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&Le(c,f),Dd!==null&&Dd(c,f)};var No=E(null),ma=!1,Di=!1,Bl=!1,lu=typeof WeakSet=="function"?WeakSet:Set,Gi=null,oc=!1,Ji=null,Ms=!1,ls=null,lc=8192,Ud={getCacheForType:function(c){var f=Da(ni),v=f.data.get(c);return v===void 0&&(v=c(),f.data.set(c,v)),v}},Vf=0,Od=1,Nd=2,Hn=3,ii=4;if(typeof Symbol=="function"&&Symbol.for){var gn=Symbol.for;Vf=gn("selector.component"),Od=gn("selector.has_pseudo_class"),Nd=gn("selector.role"),Hn=gn("selector.test_id"),ii=gn("selector.text")}var Dn=typeof WeakMap=="function"?WeakMap:Map,Kt=0,En=null,fn=null,yn=0,mi=0,Wi=null,ai=!1,Ks=!1,Lo=!1,wr=0,Gn=0,Js=0,Br=0,Za=0,Es=0,Io=0,cu=null,Ws=null,uu=!1,io=0,Ui=1/0,Dr=null,Zs=null,pr=!1,Po=null,cc=0,Ld=0,uc=null,fc=0,cs=null;return qt.attemptContinuousHydration=function(c){if(c.tag===13){var f=st(c,67108864);f!==null&&Xa(f,c,67108864),_0(c,67108864)}},qt.attemptHydrationAtCurrentPriority=function(c){if(c.tag===13){var f=ss(),v=st(c,f);v!==null&&Xa(v,c,f),_0(c,f)}},qt.attemptSynchronousHydration=function(c){switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var f=U(c.pendingLanes);if(f!==0){for(c.pendingLanes|=2,c.entangledLanes|=2;f;){var v=1<<31-ys(f);c.entanglements[1]|=v,f&=~v}bt(c),(Kt&6)===0&&(Ui=La()+500,mt(0))}}break;case 13:f=st(c,2),f!==null&&Xa(f,c,2),p0(),_0(c,2)}},qt.batchedUpdates=function(c,f){return c(f)},qt.createComponentSelector=function(c){return{$$typeof:Vf,value:c}},qt.createContainer=function(c,f,v,M,R,O,J,ce,Se,Xe){return Ea(c,f,!1,null,v,M,O,J,ce,Se,Xe,null)},qt.createHasPseudoClassSelector=function(c){return{$$typeof:Od,value:c}},qt.createHydrationContainer=function(c,f,v,M,R,O,J,ce,Se,Xe,dt,St,wt){return c=Ea(v,M,!0,c,R,O,ce,Se,Xe,dt,St,wt),c.context=_f(null),v=c.current,M=ss(),R=Ye(M),R.callback=f??null,qe(v,R,M),c.current.lanes=M,q(c,M),bt(c),c},qt.createPortal=function(c,f,v){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mr,key:M==null?null:""+M,children:c,containerInfo:f,implementation:v}},qt.createRoleSelector=function(c){return{$$typeof:Nd,value:c}},qt.createTestNameSelector=function(c){return{$$typeof:Hn,value:c}},qt.createTextSelector=function(c){return{$$typeof:ii,value:c}},qt.defaultOnCaughtError=function(c){console.error(c)},qt.defaultOnRecoverableError=function(c){sm(c)},qt.defaultOnUncaughtError=function(c){sm(c)},qt.deferredUpdates=function(c){var f=$t.T,v=pa();try{return qa(32),$t.T=null,c()}finally{qa(v),$t.T=f}},qt.discreteUpdates=function(c,f,v,M,R){var O=$t.T,J=pa();try{return qa(2),$t.T=null,c(f,v,M,R)}finally{qa(J),$t.T=O,Kt===0&&(Ui=La()+500)}},qt.findAllNodes=as,qt.findBoundingRects=function(c,f){if(!Zr)throw Error(a(363));f=as(c,f),c=[];for(var v=0;v<f.length;v++)c.push(pd(f[v]));for(f=c.length-1;0<f;f--){v=c[f];for(var M=v.x,R=M+v.width,O=v.y,J=O+v.height,ce=f-1;0<=ce;ce--)if(f!==ce){var Se=c[ce],Xe=Se.x,dt=Xe+Se.width,St=Se.y,wt=St+Se.height;if(M>=Xe&&O>=St&&R<=dt&&J<=wt){c.splice(f,1);break}else if(M!==Xe||v.width!==Se.width||wt<O||St>J){if(!(O!==St||v.height!==Se.height||dt<M||Xe>R)){Xe>M&&(Se.width+=Xe-M,Se.x=M),dt<R&&(Se.width=R-Xe),c.splice(f,1);break}}else{St>O&&(Se.height+=St-O,Se.y=O),wt<J&&(Se.height=J-St),c.splice(f,1);break}}}return c},qt.findHostInstance=x0,qt.findHostInstanceWithNoPortals=function(c){return c=y(c),c=c!==null?C(c):null,c===null?null:Zc(c.stateNode)},qt.findHostInstanceWithWarning=function(c){return x0(c)},qt.flushPassiveEffects=Ma,qt.flushSyncFromReconciler=function(c){var f=Kt;Kt|=1;var v=$t.T,M=pa();try{if(qa(2),$t.T=null,c)return c()}finally{qa(M),$t.T=v,Kt=f,(Kt&6)===0&&mt(0)}},qt.flushSyncWork=p0,qt.focusWithin=function(c,f){if(!Zr)throw Error(a(363));for(c=nd(c),f=tv(c,f),f=Array.from(f),c=0;c<f.length;){var v=f[c++],M=v.tag;if(!Qr(v)){if((M===5||M===26||M===27)&&Pi(v.stateNode))return!0;for(v=v.child;v!==null;)f.push(v),v=v.sibling}}return!1},qt.getFindAllNodesFailureDescription=function(c,f){if(!Zr)throw Error(a(363));var v=0,M=[];c=[nd(c),0];for(var R=0;R<c.length;){var O=c[R++],J=O.tag,ce=c[R++],Se=f[ce];if((J!==5&&J!==26&&J!==27||!Qr(O))&&(Yc(O,Se)&&(M.push(pl(Se)),ce++,ce>v&&(v=ce)),ce<f.length))for(O=O.child;O!==null;)c.push(O,ce),O=O.sibling}if(v<f.length){for(c=[];v<f.length;v++)c.push(pl(f[v]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+c.join(" > ")}return null},qt.getPublicRootInstance=function(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 27:case 5:return Zc(c.child.stateNode);default:return c.child.stateNode}},qt.injectIntoDevTools=function(){var c={bundleType:0,version:ud,rendererPackageName:Sf,currentDispatcherRef:$t,findFiberByHostInstance:w0,reconcilerVersion:"19.0.0"};if(Af!==null&&(c.rendererConfig=Af),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(f.isDisabled||!f.supportsFiber)c=!0;else{try{nu=f.inject(c),bs=f}catch{}c=!!f.checkDCE}}return c},qt.isAlreadyRendering=function(){return!1},qt.observeVisibleRects=function(c,f,v,M){if(!Zr)throw Error(a(363));c=as(c,f);var R=U0(c,v,M).disconnect;return{disconnect:function(){R()}}},qt.shouldError=function(){return null},qt.shouldSuspend=function(){return!1},qt.startHostTransition=function(c,f,v,M){if(c.tag!==5)throw Error(a(476));var R=Kp(c).queue;Fh(c,R,f,_s,v===null?n:function(){var O=Kp(c).next.queue;return nl(c,O,{},ss()),v(M)})},qt.updateContainer=function(c,f,v,M){var R=f.current,O=ss();return av(R,O,c,f,v,M),O},qt.updateContainerSync=function(c,f,v,M){return f.tag===0&&Ma(),av(f.current,2,c,f,v,M),2},qt},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(L1)),L1.exports}var J3;function Y5(){return J3||(J3=1,N1.exports=X5()),N1.exports}var q5=Y5();const K5=Xb(q5);var F1={exports:{}},z1={};var W3;function J5(){return W3||(W3=1,(function(i){function e(H,K){var W=H.length;H.push(K);e:for(;0<W;){var me=W-1>>>1,ve=H[me];if(0<a(ve,K))H[me]=K,H[W]=ve,W=me;else break e}}function t(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var K=H[0],W=H.pop();if(W!==K){H[0]=W;e:for(var me=0,ve=H.length,Q=ve>>>1;me<Q;){var de=2*(me+1)-1,Te=H[de],Me=de+1,rt=H[Me];if(0>a(Te,W))Me<ve&&0>a(rt,Te)?(H[me]=rt,H[Me]=W,me=Me):(H[me]=Te,H[de]=W,me=de);else if(Me<ve&&0>a(rt,W))H[me]=rt,H[Me]=W,me=Me;else break e}}return K}function a(H,K){var W=H.sortIndex-K.sortIndex;return W!==0?W:H.id-K.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var d=[],p=[],x=1,g=null,_=3,y=!1,b=!1,C=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function D(H){for(var K=t(p);K!==null;){if(K.callback===null)n(p);else if(K.startTime<=H)n(p),K.sortIndex=K.expirationTime,e(d,K);else break;K=t(p)}}function U(H){if(C=!1,D(H),!b)if(t(d)!==null)b=!0,ae();else{var K=t(p);K!==null&&re(U,K.startTime-H)}}var F=!1,N=-1,z=5,j=-1;function L(){return!(i.unstable_now()-j<z)}function P(){if(F){var H=i.unstable_now();j=H;var K=!0;try{e:{b=!1,C&&(C=!1,S(N),N=-1),y=!0;var W=_;try{t:{for(D(H),g=t(d);g!==null&&!(g.expirationTime>H&&L());){var me=g.callback;if(typeof me=="function"){g.callback=null,_=g.priorityLevel;var ve=me(g.expirationTime<=H);if(H=i.unstable_now(),typeof ve=="function"){g.callback=ve,D(H),K=!0;break t}g===t(d)&&n(d),D(H)}else n(d);g=t(d)}if(g!==null)K=!0;else{var Q=t(p);Q!==null&&re(U,Q.startTime-H),K=!1}}break e}finally{g=null,_=W,y=!1}K=void 0}}finally{K?q():F=!1}}}var q;if(typeof w=="function")q=function(){w(P)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,se=ie.port2;ie.port1.onmessage=P,q=function(){se.postMessage(null)}}else q=function(){E(P,0)};function ae(){F||(F=!0,q())}function re(H,K){N=E(function(){H(i.unstable_now())},K)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(H){H.callback=null},i.unstable_continueExecution=function(){b||y||(b=!0,ae())},i.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<H?Math.floor(1e3/H):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_getFirstCallbackNode=function(){return t(d)},i.unstable_next=function(H){switch(_){case 1:case 2:case 3:var K=3;break;default:K=_}var W=_;_=K;try{return H()}finally{_=W}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(H,K){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var W=_;_=H;try{return K()}finally{_=W}},i.unstable_scheduleCallback=function(H,K,W){var me=i.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?me+W:me):W=me,H){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=W+ve,H={id:x++,callback:K,priorityLevel:H,startTime:W,expirationTime:ve,sortIndex:-1},W>me?(H.sortIndex=W,e(p,H),t(d)===null&&H===t(p)&&(C?(S(N),N=-1):C=!0,re(U,W-me))):(H.sortIndex=ve,e(d,H),b||y||(b=!0,ae())),H},i.unstable_shouldYield=L,i.unstable_wrapCallback=function(H){var K=_;return function(){var W=_;_=K;try{return H.apply(this,arguments)}finally{_=W}}}})(z1)),z1}var Z3;function W5(){return Z3||(Z3=1,F1.exports=J5()),F1.exports}var Q3=W5();function FS(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const a=FS(n,e,t);if(a)return a;n=e?null:n.sibling}}function ZC(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const zS=ZC(k.createContext(null));class QC extends k.Component{render(){return k.createElement(zS.Provider,{value:this._reactInternals},this.props.children)}}function $C(){const i=k.useContext(zS);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=k.useId();return k.useMemo(()=>{for(const t of[i,i?.alternate]){if(!t)continue;const n=FS(t,!1,a=>{let r=a.memoizedState;for(;r;){if(r.memoizedState===e)return!0;r=r.next}});if(n)return n}},[i,e])}const Z5=Symbol.for("react.context"),Q5=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===Z5;function $5(){const i=$C(),[e]=k.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;Q5(n)&&n!==zS&&!e.has(n)&&e.set(n,k.use(ZC(n))),t=t.return}return e}function eP(){const i=$5();return k.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>k.createElement(e,null,k.createElement(t.Provider,{...n,value:i.get(t)})),e=>k.createElement(QC,{...e})),[i])}function eR(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const tR=i=>i&&i.isOrthographicCamera,tP=i=>i&&i.hasOwnProperty("current"),nP=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),Tg=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?k.useLayoutEffect:k.useEffect;function HS(i){const e=k.useRef(i);return Tg(()=>void(e.current=i),[i]),e}function iP(){const i=$C(),e=eP();return k.useMemo(()=>({children:t})=>{const a=!!FS(i,!0,r=>r.type===k.StrictMode)?k.StrictMode:k.Fragment;return B.jsx(a,{children:B.jsx(e,{children:t})})},[i,e])}function aP({set:i}){return Tg(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const sP=(i=>(i=class extends k.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function nR(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function cp(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const ki={obj:i=>i===Object(i)&&!ki.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:a=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(ki.str(i)||ki.num(i)||ki.boo(i))return i===e;const r=ki.obj(i);if(r&&n==="reference")return i===e;const l=ki.arr(i);if(l&&t==="reference")return i===e;if((l||r)&&i===e)return!0;let u;for(u in i)if(!(u in e))return!1;if(r&&t==="shallow"&&n==="shallow"){for(u in a?e:i)if(!ki.equ(i[u],e[u],{strict:a,objects:"reference"}))return!1}else for(u in a?e:i)if(i[u]!==e[u])return!1;if(ki.und(u)){if(l&&i.length===0&&e.length===0||r&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function rP(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function oP(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const iR=["children","key","ref"];function lP(i){const e={};for(const t in i)iR.includes(t)||(e[t]=i[t]);return e}function ey(i,e,t,n){const a=i;let r=a?.__r3f;return r||(r={root:e,type:t,parent:null,children:[],props:lP(n),object:a,eventCount:0,handlers:{},isHidden:!1},a&&(a.__r3f=r)),r}function dg(i,e){if(!e.includes("-"))return{root:i,key:e,target:i[e]};if(e in i)return{root:i,key:e,target:i[e]};let t=i;const n=e.split("-");for(const a of n){if(typeof t!="object"||t===null){if(t!==void 0){const r=n.slice(n.indexOf(a)).join("-");return{root:t,key:r,target:void 0}}return{root:i,key:e,target:void 0}}e=a,i=t,t=t[e]}return{root:i,key:e,target:t}}const $3=/-\d+$/;function ty(i,e){if(ki.str(e.props.attach)){if($3.test(e.props.attach)){const a=e.props.attach.replace($3,""),{root:r,key:l}=dg(i.object,a);Array.isArray(r[l])||(r[l]=[])}const{root:t,key:n}=dg(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else ki.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function ny(i,e){if(ki.str(e.props.attach)){const{root:t,key:n}=dg(i.object,e.props.attach),a=e.previousAttach;a===void 0?delete t[n]:t[n]=a}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const Ub=[...iR,"args","dispose","attach","object","onUpdate","dispose"],eE=new Map;function cP(i){let e=eE.get(i.constructor);try{e||(e=new i.constructor,eE.set(i.constructor,e))}catch{}return e}function uP(i,e){const t={};for(const n in e)if(!Ub.includes(n)&&!ki.equ(e[n],i.props[n])){t[n]=e[n];for(const a in e)a.startsWith(`${n}-`)&&(t[a]=e[a])}for(const n in i.props){if(Ub.includes(n)||e.hasOwnProperty(n))continue;const{root:a,key:r}=dg(i.object,n);if(a.constructor&&a.constructor.length===0){const l=cP(a);ki.und(l)||(t[r]=l[r])}else t[r]=0}return t}const fP=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],hP=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Il(i,e){var t;const n=i.__r3f,a=n&&eR(n).getState(),r=n?.eventCount;for(const u in e){let d=e[u];if(Ub.includes(u))continue;if(n&&hP.test(u)){typeof d=="function"?n.handlers[u]=d:delete n.handlers[u],n.eventCount=Object.keys(n.handlers).length;continue}if(d===void 0)continue;let{root:p,key:x,target:g}=dg(i,u);if(g===void 0&&(typeof p!="object"||p===null))throw Error(`R3F: Cannot set "${u}". Ensure it is an object before setting "${x}".`);if(g instanceof Np&&d instanceof Np)g.mask=d.mask;else if(g instanceof ut&&nP(d))g.set(d);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&typeof g.copy=="function"&&d!=null&&d.constructor&&g.constructor===d.constructor)g.copy(d);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&Array.isArray(d))typeof g.fromArray=="function"?g.fromArray(d):g.set(...d);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&typeof d=="number")typeof g.setScalar=="function"?g.setScalar(d):g.set(d);else{var l;p[x]=d,a&&!a.linear&&fP.includes(x)&&(l=p[x])!=null&&l.isTexture&&p[x].format===_a&&p[x].type===ca&&(p[x].colorSpace=ti)}}if(n!=null&&n.parent&&a!=null&&a.internal&&(t=n.object)!=null&&t.isObject3D&&r!==n.eventCount){const u=n.object,d=a.internal.interaction.indexOf(u);d>-1&&a.internal.interaction.splice(d,1),n.eventCount&&u.raycast!==null&&a.internal.interaction.push(u)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Xp(n),i}function Xp(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function aR(i,e){i.manual||(tR(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const er=i=>i?.isObject3D;function Xx(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function sR(i,e,t,n){const a=t.get(e);a&&(t.delete(e),t.size===0&&(i.delete(n),a.target.releasePointerCapture(n)))}function dP(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,a)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(a)}),t.capturedMap.forEach((n,a)=>{sR(t.capturedMap,e,n,a)})}function pP(i){function e(d){const{internal:p}=i.getState(),x=d.offsetX-p.initialClick[0],g=d.offsetY-p.initialClick[1];return Math.round(Math.sqrt(x*x+g*g))}function t(d){return d.filter(p=>["Move","Over","Enter","Out","Leave"].some(x=>{var g;return(g=p.__r3f)==null?void 0:g.handlers["onPointer"+x]}))}function n(d,p){const x=i.getState(),g=new Set,_=[],y=p?p(x.internal.interaction):x.internal.interaction;for(let S=0;S<y.length;S++){const w=cp(y[S]);w&&(w.raycaster.camera=void 0)}x.previousRoot||x.events.compute==null||x.events.compute(d,x);function b(S){const w=cp(S);if(!w||!w.events.enabled||w.raycaster.camera===null)return[];if(w.raycaster.camera===void 0){var D;w.events.compute==null||w.events.compute(d,w,(D=w.previousRoot)==null?void 0:D.getState()),w.raycaster.camera===void 0&&(w.raycaster.camera=null)}return w.raycaster.camera?w.raycaster.intersectObject(S,!0):[]}let C=y.flatMap(b).sort((S,w)=>{const D=cp(S.object),U=cp(w.object);return!D||!U?S.distance-w.distance:U.events.priority-D.events.priority||S.distance-w.distance}).filter(S=>{const w=Xx(S);return g.has(w)?!1:(g.add(w),!0)});x.events.filter&&(C=x.events.filter(C,x));for(const S of C){let w=S.object;for(;w;){var E;(E=w.__r3f)!=null&&E.eventCount&&_.push({...S,eventObject:w}),w=w.parent}}if("pointerId"in d&&x.internal.capturedMap.has(d.pointerId))for(let S of x.internal.capturedMap.get(d.pointerId).values())g.has(Xx(S.intersection))||_.push(S.intersection);return _}function a(d,p,x,g){if(d.length){const _={stopped:!1};for(const y of d){let b=cp(y.object);if(b||y.object.traverseAncestors(C=>{const E=cp(C);if(E)return b=E,!1}),b){const{raycaster:C,pointer:E,camera:S,internal:w}=b,D=new te(E.x,E.y,0).unproject(S),U=L=>{var P,q;return(P=(q=w.capturedMap.get(L))==null?void 0:q.has(y.eventObject))!=null?P:!1},F=L=>{const P={intersection:y,target:p.target};w.capturedMap.has(L)?w.capturedMap.get(L).set(y.eventObject,P):w.capturedMap.set(L,new Map([[y.eventObject,P]])),p.target.setPointerCapture(L)},N=L=>{const P=w.capturedMap.get(L);P&&sR(w.capturedMap,y.eventObject,P,L)};let z={};for(let L in p){let P=p[L];typeof P!="function"&&(z[L]=P)}let j={...y,...z,pointer:E,intersections:d,stopped:_.stopped,delta:x,unprojectedPoint:D,ray:C.ray,camera:S,stopPropagation(){const L="pointerId"in p&&w.capturedMap.get(p.pointerId);if((!L||L.has(y.eventObject))&&(j.stopped=_.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(P=>P.eventObject===y.eventObject))){const P=d.slice(0,d.indexOf(y));r([...P,y])}},target:{hasPointerCapture:U,setPointerCapture:F,releasePointerCapture:N},currentTarget:{hasPointerCapture:U,setPointerCapture:F,releasePointerCapture:N},nativeEvent:p};if(g(j),_.stopped===!0)break}}}return d}function r(d){const{internal:p}=i.getState();for(const x of p.hovered.values())if(!d.length||!d.find(g=>g.object===x.object&&g.index===x.index&&g.instanceId===x.instanceId)){const _=x.eventObject.__r3f;if(p.hovered.delete(Xx(x)),_!=null&&_.eventCount){const y=_.handlers,b={...x,intersections:d};y.onPointerOut==null||y.onPointerOut(b),y.onPointerLeave==null||y.onPointerLeave(b)}}}function l(d,p){for(let x=0;x<p.length;x++){const g=p[x].__r3f;g==null||g.handlers.onPointerMissed==null||g.handlers.onPointerMissed(d)}}function u(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return p=>{const{internal:x}=i.getState();"pointerId"in p&&x.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{x.capturedMap.has(p.pointerId)&&(x.capturedMap.delete(p.pointerId),r([]))})}}return function(x){const{onPointerMissed:g,internal:_}=i.getState();_.lastEvent.current=x;const y=d==="onPointerMove",b=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",E=n(x,y?t:void 0),S=b?e(x):0;d==="onPointerDown"&&(_.initialClick=[x.offsetX,x.offsetY],_.initialHits=E.map(D=>D.eventObject)),b&&!E.length&&S<=2&&(l(x,_.interaction),g&&g(x)),y&&r(E);function w(D){const U=D.eventObject,F=U.__r3f;if(!(F!=null&&F.eventCount))return;const N=F.handlers;if(y){if(N.onPointerOver||N.onPointerEnter||N.onPointerOut||N.onPointerLeave){const z=Xx(D),j=_.hovered.get(z);j?j.stopped&&D.stopPropagation():(_.hovered.set(z,D),N.onPointerOver==null||N.onPointerOver(D),N.onPointerEnter==null||N.onPointerEnter(D))}N.onPointerMove==null||N.onPointerMove(D)}else{const z=N[d];z?(!b||_.initialHits.includes(U))&&(l(x,_.interaction.filter(j=>!_.initialHits.includes(j))),z(D)):b&&_.initialHits.includes(U)&&l(x,_.interaction.filter(j=>!_.initialHits.includes(j)))}}a(E,x,S,w)}}return{handlePointer:u}}const tE=i=>!!(i!=null&&i.render),GS=k.createContext(null),mP=(i,e)=>{const t=KC((u,d)=>{const p=new te,x=new te,g=new te;function _(S=d().camera,w=x,D=d().size){const{width:U,height:F,top:N,left:z}=D,j=U/F;w.isVector3?g.copy(w):g.set(...w);const L=S.getWorldPosition(p).distanceTo(g);if(tR(S))return{width:U/S.zoom,height:F/S.zoom,top:N,left:z,factor:1,distance:L,aspect:j};{const P=S.fov*Math.PI/180,q=2*Math.tan(P/2)*L,ie=q*(U/F);return{width:ie,height:q,top:N,left:z,factor:U/ie,distance:L,aspect:j}}}let y;const b=S=>u(w=>({performance:{...w.performance,current:S}})),C=new Ge;return{set:u,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(S=1)=>i(d(),S),advance:(S,w)=>e(S,w,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new US,pointer:C,mouse:C,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const S=d();y&&clearTimeout(y),S.performance.current!==S.performance.min&&b(S.performance.min),y=setTimeout(()=>b(d().performance.max),S.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:_},setEvents:S=>u(w=>({...w,events:{...w.events,...S}})),setSize:(S,w,D=0,U=0)=>{const F=d().camera,N={width:S,height:w,top:D,left:U};u(z=>({size:N,viewport:{...z.viewport,..._(F,x,N)}}))},setDpr:S=>u(w=>{const D=nR(S);return{viewport:{...w.viewport,dpr:D,initialDpr:w.viewport.initialDpr||D}}}),setFrameloop:(S="always")=>{const w=d().clock;w.stop(),w.elapsedTime=0,S!=="never"&&(w.start(),w.elapsedTime=0),u(()=>({frameloop:S}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:k.createRef(),active:!1,frames:0,priority:0,subscribe:(S,w,D)=>{const U=d().internal;return U.priority=U.priority+(w>0?1:0),U.subscribers.push({ref:S,priority:w,store:D}),U.subscribers=U.subscribers.sort((F,N)=>F.priority-N.priority),()=>{const F=d().internal;F!=null&&F.subscribers&&(F.priority=F.priority-(w>0?1:0),F.subscribers=F.subscribers.filter(N=>N.ref!==S))}}}}}),n=t.getState();let a=n.size,r=n.viewport.dpr,l=n.camera;return t.subscribe(()=>{const{camera:u,size:d,viewport:p,gl:x,set:g}=t.getState();if(d.width!==a.width||d.height!==a.height||p.dpr!==r){a=d,r=p.dpr,aR(u,d),p.dpr>0&&x.setPixelRatio(p.dpr);const _=typeof HTMLCanvasElement<"u"&&x.domElement instanceof HTMLCanvasElement;x.setSize(d.width,d.height,_)}u!==l&&(l=u,g(_=>({viewport:{..._.viewport,..._.viewport.getCurrentViewport(u)}})))}),t.subscribe(u=>i(u)),t};function VS(){const i=k.useContext(GS);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function tr(i=t=>t,e){return VS()(i,e)}function Ns(i,e=0){const t=VS(),n=t.getState().internal.subscribe,a=HS(i);return Tg(()=>n(a,e,t),[e,n,t]),null}const nE=new WeakMap,gP=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function rR(i,e){return function(t,...n){let a;return gP(t)?(a=nE.get(t),a||(a=new t,nE.set(t,a))):a=t,i&&i(a),Promise.all(n.map(r=>new Promise((l,u)=>a.load(r,d=>{er(d?.scene)&&Object.assign(d,rP(d.scene)),l(d)},e,d=>u(new Error(`Could not load ${r}: ${d?.message}`))))))}}function Oc(i,e,t,n){const a=Array.isArray(e)?e:[e],r=H5(rR(t,n),[i,...a],{equal:ki.equ});return Array.isArray(e)?r:r[0]}Oc.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return G5(rR(t),[i,...n])};Oc.clear=function(i,e){const t=Array.isArray(e)?e:[e];return V5([i,...t])};function vP(i){const e=K5(i);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:k.version}),e}const oR=0,Pp={},xP=/^three(?=[A-Z])/,Ky=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let _P=0;const yP=i=>typeof i=="function";function Jy(i){if(yP(i)){const e=`${_P++}`;return Pp[e]=i,e}else Object.assign(Pp,i)}function lR(i,e){const t=Ky(i),n=Pp[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function bP(i,e,t){var n;return i=Ky(i)in Pp?i:i.replace(xP,""),lR(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,ey(e.object,t,i,e)}function SP(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?ny(i.parent,i):er(i.object)&&(i.object.visible=!1),i.isHidden=!0,Xp(i)}}function cR(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?ty(i.parent,i):er(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,Xp(i)}}function kS(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var a,r;const l=Pp[Ky(e.type)];e.object=(a=e.props.object)!=null?a:new l(...(r=e.props.args)!=null?r:[]),e.object.__r3f=e}if(Il(e.object,e.props),e.props.attach)ty(i,e);else if(er(e.object)&&er(i.object)){const l=i.object.children.indexOf(t?.object);if(t&&l!==-1){const u=i.object.children.indexOf(e.object);if(u!==-1){i.object.children.splice(u,1);const d=u<l?l-1:l;i.object.children.splice(d,0,e.object)}else e.object.parent=i.object,i.object.children.splice(l,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const l of e.children)kS(e,l);Xp(e)}}function H1(i,e){e&&(e.parent=i,i.children.push(e),kS(i,e))}function iE(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),kS(i,e,t)}function uR(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():Q3.unstable_scheduleCallback(Q3.unstable_IdlePriority,e)}}function Ob(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?ny(i,e):er(e.object)&&er(i.object)&&(i.object.remove(e.object),dP(eR(e),e.object));const a=e.props.dispose!==null&&t!==!1;for(let r=e.children.length-1;r>=0;r--){const l=e.children[r];Ob(e,l,a)}e.children.length=0,delete e.object.__r3f,a&&e.type!=="primitive"&&e.object.type!=="Scene"&&uR(e.object),t===void 0&&Xp(e)}function AP(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const h_=[];function MP(){for(const[t]of h_){const n=t.parent;if(n){t.props.attach?ny(n,t):er(t.object)&&er(n.object)&&n.object.remove(t.object);for(const a of t.children)a.props.attach?ny(t,a):er(a.object)&&er(t.object)&&t.object.remove(a.object)}t.isHidden&&cR(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&uR(t.object)}for(const[t,n,a]of h_){t.props=n;const r=t.parent;if(r){var i,e;const l=Pp[Ky(t.type)];t.object=(i=t.props.object)!=null?i:new l(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,AP(a,t.object),Il(t.object,t.props),t.props.attach?ty(r,t):er(t.object)&&er(r.object)&&r.object.add(t.object);for(const u of t.children)u.props.attach?ty(t,u):er(u.object)&&er(t.object)&&t.object.add(u.object);Xp(t)}}h_.length=0}const G1=()=>{},aE={};let Yx=oR;const EP=0,TP=4,iy=vP({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:bP,removeChild:Ob,appendChild:H1,appendInitialChild:H1,insertBefore:iE,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||H1(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||Ob(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||iE(n,e,t)},getRootHostContext:()=>aE,getChildHostContext:()=>aE,commitUpdate(i,e,t,n,a){var r,l,u;lR(e,n);let d=!1;if((i.type==="primitive"&&t.object!==n.object||((r=n.args)==null?void 0:r.length)!==((l=t.args)==null?void 0:l.length)||(u=n.args)!=null&&u.some((x,g)=>{var _;return x!==((_=t.args)==null?void 0:_[g])}))&&(d=!0),d)h_.push([i,{...n},a]);else{const x=uP(i,n);Object.keys(x).length&&(Object.assign(i.props,x),Il(i.object,x))}(a.sibling===null||(a.flags&TP)===EP)&&MP()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i?.object,prepareForCommit:()=>null,preparePortalMount:i=>ey(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:SP,unhideInstance:cR,createTextInstance:G1,hideTextInstance:G1,unhideTextInstance:G1,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:k.createContext(null),setCurrentUpdatePriority(i){Yx=i},getCurrentUpdatePriority(){return Yx},resolveUpdatePriority(){var i;if(Yx!==oR)return Yx;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return l_.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return l_.ContinuousEventPriority;default:return l_.DefaultEventPriority}},resetFormInstance(){}}),wh=new Map,up={objects:"shallow",strict:!1};function CP(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:a,left:r}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:a,left:r}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function RP(i){const e=wh.get(i),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const a=typeof reportError=="function"?reportError:console.error,r=n||mP(Ib,rE),l=t||iy.createContainer(r,l_.ConcurrentRoot,null,!1,null,"",a,a,a,null);e||wh.set(i,{fiber:l,store:r});let u,d,p=!1,x=null;return{async configure(g={}){let _;x=new Promise(Q=>_=Q);let{gl:y,size:b,scene:C,events:E,onCreated:S,shadows:w=!1,linear:D=!1,flat:U=!1,legacy:F=!1,orthographic:N=!1,frameloop:z="always",dpr:j=[1,2],performance:L,raycaster:P,camera:q,onPointerMissed:ie}=g,se=r.getState(),ae=se.gl;if(!se.gl){const Q={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},de=typeof y=="function"?await y(Q):y;tE(de)?ae=de:ae=new PS({...Q,...y}),se.set({gl:ae})}let re=se.raycaster;re||se.set({raycaster:re=new Xy});const{params:H,...K}=P||{};if(ki.equ(K,re,up)||Il(re,{...K}),ki.equ(H,re.params,up)||Il(re,{params:{...re.params,...H}}),!se.camera||se.camera===d&&!ki.equ(d,q,up)){d=q;const Q=q?.isCamera,de=Q?q:N?new Zu(0,0,0,0,.1,1e3):new Ra(75,0,.1,1e3);Q||(de.position.z=5,q&&(Il(de,q),de.manual||("aspect"in q||"left"in q||"right"in q||"bottom"in q||"top"in q)&&(de.manual=!0,de.updateProjectionMatrix())),!se.camera&&!(q!=null&&q.rotation)&&de.lookAt(0,0,0)),se.set({camera:de}),re.camera=de}if(!se.scene){let Q;C!=null&&C.isScene?(Q=C,ey(Q,r,"",{})):(Q=new Mh,ey(Q,r,"",{}),C&&Il(Q,C)),se.set({scene:Q})}E&&!se.events.handlers&&se.set({events:E(r)});const W=CP(i,b);if(ki.equ(W,se.size,up)||se.setSize(W.width,W.height,W.top,W.left),j&&se.viewport.dpr!==nR(j)&&se.setDpr(j),se.frameloop!==z&&se.setFrameloop(z),se.onPointerMissed||se.set({onPointerMissed:ie}),L&&!ki.equ(L,se.performance,up)&&se.set(Q=>({performance:{...Q.performance,...L}})),!se.xr){var me;const Q=(Me,rt)=>{const xe=r.getState();xe.frameloop!=="never"&&rE(Me,!0,xe,rt)},de=()=>{const Me=r.getState();Me.gl.xr.enabled=Me.gl.xr.isPresenting,Me.gl.xr.setAnimationLoop(Me.gl.xr.isPresenting?Q:null),Me.gl.xr.isPresenting||Ib(Me)},Te={connect(){const Me=r.getState().gl;Me.xr.addEventListener("sessionstart",de),Me.xr.addEventListener("sessionend",de)},disconnect(){const Me=r.getState().gl;Me.xr.removeEventListener("sessionstart",de),Me.xr.removeEventListener("sessionend",de)}};typeof((me=ae.xr)==null?void 0:me.addEventListener)=="function"&&Te.connect(),se.set({xr:Te})}if(ae.shadowMap){const Q=ae.shadowMap.enabled,de=ae.shadowMap.type;if(ae.shadowMap.enabled=!!w,ki.boo(w))ae.shadowMap.type=jm;else if(ki.str(w)){var ve;const Te={basic:iT,percentage:hy,soft:jm,variance:jo};ae.shadowMap.type=(ve=Te[w])!=null?ve:jm}else ki.obj(w)&&Object.assign(ae.shadowMap,w);(Q!==ae.shadowMap.enabled||de!==ae.shadowMap.type)&&(ae.shadowMap.needsUpdate=!0)}return Wn.enabled=!F,p||(ae.outputColorSpace=D?Fr:ti,ae.toneMapping=U?Jo:Yb),se.legacy!==F&&se.set(()=>({legacy:F})),se.linear!==D&&se.set(()=>({linear:D})),se.flat!==U&&se.set(()=>({flat:U})),y&&!ki.fun(y)&&!tE(y)&&!ki.equ(y,ae,up)&&Il(ae,y),u=S,p=!0,_(),this},render(g){return!p&&!x&&this.configure(),x.then(()=>{iy.updateContainer(B.jsx(wP,{store:r,children:g,onCreated:u,rootElement:i}),l,null,()=>{})}),r},unmount(){fR(i)}}}function wP({store:i,children:e,onCreated:t,rootElement:n}){return Tg(()=>{const a=i.getState();a.set(r=>({internal:{...r.internal,active:!0}})),t&&t(a),i.getState().events.connected||a.events.connect==null||a.events.connect(n)},[]),B.jsx(GS.Provider,{value:i,children:e})}function fR(i,e){const t=wh.get(i),n=t?.fiber;if(n){const a=t?.store.getState();a&&(a.internal.active=!1),iy.updateContainer(null,n,null,()=>{a&&setTimeout(()=>{try{var r,l,u,d;a.events.disconnect==null||a.events.disconnect(),(r=a.gl)==null||(l=r.renderLists)==null||l.dispose==null||l.dispose(),(u=a.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(d=a.gl)!=null&&d.xr&&a.xr.disconnect(),oP(a.scene),wh.delete(i)}catch{}},500)})}}function BP(i,e,t){return B.jsx(DP,{children:i,container:e,state:t})}function DP({state:i={},children:e,container:t}){const{events:n,size:a,...r}=i,l=VS(),[u]=k.useState(()=>new Xy),[d]=k.useState(()=>new Ge),p=HS((g,_)=>{let y;if(_.camera&&a){const b=_.camera;y=g.viewport.getCurrentViewport(b,new te,a),b!==g.camera&&aR(b,a)}return{...g,..._,scene:t,raycaster:u,pointer:d,mouse:d,previousRoot:l,events:{...g.events,..._.events,...n},size:{...g.size,...a},viewport:{...g.viewport,...y},setEvents:b=>_.set(C=>({...C,events:{...C.events,...b}}))}}),x=k.useMemo(()=>{const g=KC((y,b)=>({...r,set:y,get:b})),_=y=>g.setState(b=>p.current(y,b));return _(l.getState()),l.subscribe(_),g},[l,t]);return B.jsx(B.Fragment,{children:iy.createPortal(B.jsx(GS.Provider,{value:x,children:e}),x,null)})}const UP=new Set,OP=new Set,NP=new Set;function V1(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function Qm(i,e){switch(i){case"before":return V1(UP,e);case"after":return V1(OP,e);case"tail":return V1(NP,e)}}let k1,j1;function Nb(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),k1=e.internal.subscribers;for(let a=0;a<k1.length;a++)j1=k1[a],j1.ref.current(j1.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let ay=!1,Lb=!1,X1,sE,fp;function hR(i){sE=requestAnimationFrame(hR),ay=!0,X1=0,Qm("before",i),Lb=!0;for(const t of wh.values()){var e;fp=t.store.getState(),fp.internal.active&&(fp.frameloop==="always"||fp.internal.frames>0)&&!((e=fp.gl.xr)!=null&&e.isPresenting)&&(X1+=Nb(i,fp))}if(Lb=!1,Qm("after",i),X1===0)return Qm("tail",i),ay=!1,cancelAnimationFrame(sE)}function Ib(i,e=1){var t;if(!i)return wh.forEach(n=>Ib(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):Lb?i.internal.frames=2:i.internal.frames=1,ay||(ay=!0,requestAnimationFrame(hR)))}function rE(i,e=!0,t,n){if(e&&Qm("before",i),t)Nb(i,t,n);else for(const a of wh.values())Nb(i,a.store.getState());e&&Qm("after",i)}const Y1={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function LP(i){const{handlePointer:e}=pP(i);return{priority:1,enabled:!0,compute(t,n,a){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(Y1).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:a}=i.getState();(t=a.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(a.lastEvent.current)},connect:t=>{const{set:n,events:a}=i.getState();if(a.disconnect==null||a.disconnect(),n(r=>({events:{...r.events,connected:t}})),a.handlers)for(const r in a.handlers){const l=a.handlers[r],[u,d]=Y1[r];t.addEventListener(u,l,{passive:d})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const a in n.handlers){const r=n.handlers[a],[l]=Y1[a];n.connected.removeEventListener(l,r)}t(a=>({events:{...a.events,connected:void 0}}))}}}}function oE(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function IP({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const a=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[r,l]=k.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),u=k.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:r,orientationHandler:null}),d=i?typeof i=="number"?i:i.scroll:null,p=i?typeof i=="number"?i:i.resize:null,x=k.useRef(!1);k.useEffect(()=>(x.current=!0,()=>void(x.current=!1)));const[g,_,y]=k.useMemo(()=>{const S=()=>{if(!u.current.element)return;const{left:w,top:D,width:U,height:F,bottom:N,right:z,x:j,y:L}=u.current.element.getBoundingClientRect(),P={left:w,top:D,width:U,height:F,bottom:N,right:z,x:j,y:L};u.current.element instanceof HTMLElement&&n&&(P.height=u.current.element.offsetHeight,P.width=u.current.element.offsetWidth),Object.freeze(P),x.current&&!HP(u.current.lastBounds,P)&&l(u.current.lastBounds=P)};return[S,p?oE(S,p):S,d?oE(S,d):S]},[l,n,d,p]);function b(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(S=>S.removeEventListener("scroll",y,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null),u.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",u.current.orientationHandler))}function C(){u.current.element&&(u.current.resizeObserver=new a(y),u.current.resizeObserver.observe(u.current.element),e&&u.current.scrollContainers&&u.current.scrollContainers.forEach(S=>S.addEventListener("scroll",y,{capture:!0,passive:!0})),u.current.orientationHandler=()=>{y()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",u.current.orientationHandler))}const E=S=>{!S||S===u.current.element||(b(),u.current.element=S,u.current.scrollContainers=dR(S),C())};return FP(y,!!e),PP(_),k.useEffect(()=>{b(),C()},[e,y,_]),k.useEffect(()=>b,[]),[E,r,g]}function PP(i){k.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function FP(i,e){k.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function dR(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:a}=window.getComputedStyle(i);return[t,n,a].some(r=>r==="auto"||r==="scroll")&&e.push(i),[...e,...dR(i.parentElement)]}const zP=["x","y","top","bottom","left","right","width","height"],HP=(i,e)=>zP.every(t=>i[t]===e[t]);function GP({ref:i,children:e,fallback:t,resize:n,style:a,gl:r,events:l=LP,eventSource:u,eventPrefix:d,shadows:p,linear:x,flat:g,legacy:_,orthographic:y,frameloop:b,dpr:C,performance:E,raycaster:S,camera:w,scene:D,onPointerMissed:U,onCreated:F,...N}){k.useMemo(()=>Jy(w5),[]);const z=iP(),[j,L]=IP({scroll:!0,debounce:{scroll:50,resize:0},...n}),P=k.useRef(null),q=k.useRef(null);k.useImperativeHandle(i,()=>P.current);const ie=HS(U),[se,ae]=k.useState(!1),[re,H]=k.useState(!1);if(se)throw se;if(re)throw re;const K=k.useRef(null);Tg(()=>{const me=P.current;if(L.width>0&&L.height>0&&me){K.current||(K.current=RP(me));async function ve(){await K.current.configure({gl:r,scene:D,events:l,shadows:p,linear:x,flat:g,legacy:_,orthographic:y,frameloop:b,dpr:C,performance:E,raycaster:S,camera:w,size:L,onPointerMissed:(...Q)=>ie.current==null?void 0:ie.current(...Q),onCreated:Q=>{Q.events.connect==null||Q.events.connect(u?tP(u)?u.current:u:q.current),d&&Q.setEvents({compute:(de,Te)=>{const Me=de[d+"X"],rt=de[d+"Y"];Te.pointer.set(Me/Te.size.width*2-1,-(rt/Te.size.height)*2+1),Te.raycaster.setFromCamera(Te.pointer,Te.camera)}}),F?.(Q)}}),K.current.render(B.jsx(z,{children:B.jsx(sP,{set:H,children:B.jsx(k.Suspense,{fallback:B.jsx(aP,{set:ae}),children:e??null})})}))}ve()}}),k.useEffect(()=>{const me=P.current;if(me)return()=>fR(me)},[]);const W=u?"none":"auto";return B.jsx("div",{ref:q,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:W,...a},...N,children:B.jsx("div",{ref:j,style:{width:"100%",height:"100%"},children:B.jsx("canvas",{ref:P,style:{display:"block"},children:t})})})}function VP(i){return B.jsx(QC,{children:B.jsx(GP,{...i})})}function sy(){return sy=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},sy.apply(null,arguments)}const kP=i=>i;function jP(i,e=kP){const t=Rc.useSyncExternalStore(i.subscribe,Rc.useCallback(()=>e(i.getState()),[i,e]),Rc.useCallback(()=>e(i.getInitialState()),[i,e]));return Rc.useDebugValue(t),t}const lE=i=>{const e=qC(i),t=n=>jP(e,n);return Object.assign(t,e),t},pR=(i=>i?lE(i):lE);let Dm=0;const XP=pR(i=>(_p.onStart=(e,t,n)=>{i({active:!0,item:e,loaded:t,total:n,progress:(t-Dm)/(n-Dm)*100})},_p.onLoad=()=>{i({active:!1})},_p.onError=e=>i(t=>({errors:[...t.errors,e]})),_p.onProgress=(e,t,n)=>{t===n&&(Dm=n),i({active:!0,item:e,loaded:t,total:n,progress:(t-Dm)/(n-Dm)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),YP=i=>(e,t,n)=>{const a=n.subscribe;return n.subscribe=((l,u,d)=>{let p=l;if(u){const x=d?.equalityFn||Object.is;let g=l(n.getState());p=_=>{const y=l(_);if(!x(g,y)){const b=g;u(g=y,b)}},d?.fireImmediately&&u(g,g)}return a(p)}),i(e,t,n)},qP=YP,mR=k.createContext(null);function KP({map:i,children:e,onChange:t,domElement:n}){const a=i.map(d=>d.name+d.keys).join("-"),r=k.useMemo(()=>pR(qP(()=>i.reduce((d,p)=>({...d,[p.name]:!1}),{}))),[a]),l=k.useMemo(()=>[r.subscribe,r.getState,r],[a]),u=r.setState;return k.useEffect(()=>{const p=i.map(({name:y,keys:b,up:C})=>({keys:b,up:C,fn:E=>{u({[y]:E}),t&&t(y,E,l[1]())}})).reduce((y,{keys:b,fn:C,up:E=!0})=>(b.forEach(S=>y[S]={fn:C,pressed:!1,up:E}),y),{}),x=({key:y,code:b})=>{const C=p[y]||p[b];if(!C)return;const{fn:E,pressed:S,up:w}=C;C.pressed=!0,(w||!S)&&E(!0)},g=({key:y,code:b})=>{const C=p[y]||p[b];if(!C)return;const{fn:E,up:S}=C;C.pressed=!1,S&&E(!1)},_=n||window;return _.addEventListener("keydown",x,{passive:!0}),_.addEventListener("keyup",g,{passive:!0}),()=>{_.removeEventListener("keydown",x),_.removeEventListener("keyup",g)}},[n,a]),k.createElement(mR.Provider,{value:l,children:e})}function Lr(i){const[e,t,n]=k.useContext(mR);return i?n(i):[e,t]}const jS=parseInt(Dh.replace(/\D+/g,""));function cE(i,e){if(e===UT)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===J_||e===eS){let t=i.getIndex();if(t===null){const l=[],u=i.getAttribute("position");if(u!==void 0){for(let d=0;d<u.count;d++)l.push(d);i.setIndex(l),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,a=[];if(t)if(e===J_)for(let l=1;l<=n;l++)a.push(t.getX(0)),a.push(t.getX(l)),a.push(t.getX(l+1));else for(let l=0;l<n;l++)l%2===0?(a.push(t.getX(l)),a.push(t.getX(l+1)),a.push(t.getX(l+2))):(a.push(t.getX(l+2)),a.push(t.getX(l+1)),a.push(t.getX(l)));a.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=i.clone();return r.setIndex(a),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var uo=Uint8Array,Pu=Uint16Array,Pb=Uint32Array,gR=new uo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vR=new uo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),JP=new uo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xR=function(i,e){for(var t=new Pu(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var a=new Pb(t[30]),n=1;n<30;++n)for(var r=t[n];r<t[n+1];++r)a[r]=r-t[n]<<5|n;return[t,a]},_R=xR(gR,2),yR=_R[0],WP=_R[1];yR[28]=258,WP[258]=28;var ZP=xR(vR,0),QP=ZP[0],Fb=new Pu(32768);for(var Ni=0;Ni<32768;++Ni){var Eu=(Ni&43690)>>>1|(Ni&21845)<<1;Eu=(Eu&52428)>>>2|(Eu&13107)<<2,Eu=(Eu&61680)>>>4|(Eu&3855)<<4,Fb[Ni]=((Eu&65280)>>>8|(Eu&255)<<8)>>>1}var $m=(function(i,e,t){for(var n=i.length,a=0,r=new Pu(e);a<n;++a)++r[i[a]-1];var l=new Pu(e);for(a=0;a<e;++a)l[a]=l[a-1]+r[a-1]<<1;var u;if(t){u=new Pu(1<<e);var d=15-e;for(a=0;a<n;++a)if(i[a])for(var p=a<<4|i[a],x=e-i[a],g=l[i[a]-1]++<<x,_=g|(1<<x)-1;g<=_;++g)u[Fb[g]>>>d]=p}else for(u=new Pu(n),a=0;a<n;++a)i[a]&&(u[a]=Fb[l[i[a]-1]++]>>>15-i[a]);return u}),Cg=new uo(288);for(var Ni=0;Ni<144;++Ni)Cg[Ni]=8;for(var Ni=144;Ni<256;++Ni)Cg[Ni]=9;for(var Ni=256;Ni<280;++Ni)Cg[Ni]=7;for(var Ni=280;Ni<288;++Ni)Cg[Ni]=8;var bR=new uo(32);for(var Ni=0;Ni<32;++Ni)bR[Ni]=5;var $P=$m(Cg,9,1),e8=$m(bR,5,1),q1=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Vo=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},K1=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},t8=function(i){return(i/8|0)+(i&7&&1)},n8=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof Pu?Pu:i instanceof Pb?Pb:uo)(t-e);return n.set(i.subarray(e,t)),n},i8=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new uo(0);var a=!e||t,r=!t||t.i;t||(t={}),e||(e=new uo(n*3));var l=function(xe){var fe=e.length;if(xe>fe){var Fe=new uo(Math.max(fe*2,xe));Fe.set(e),e=Fe}},u=t.f||0,d=t.p||0,p=t.b||0,x=t.l,g=t.d,_=t.m,y=t.n,b=n*8;do{if(!x){t.f=u=Vo(i,d,1);var C=Vo(i,d+1,3);if(d+=3,C)if(C==1)x=$P,g=e8,_=9,y=5;else if(C==2){var D=Vo(i,d,31)+257,U=Vo(i,d+10,15)+4,F=D+Vo(i,d+5,31)+1;d+=14;for(var N=new uo(F),z=new uo(19),j=0;j<U;++j)z[JP[j]]=Vo(i,d+j*3,7);d+=U*3;for(var L=q1(z),P=(1<<L)-1,q=$m(z,L,1),j=0;j<F;){var ie=q[Vo(i,d,P)];d+=ie&15;var E=ie>>>4;if(E<16)N[j++]=E;else{var se=0,ae=0;for(E==16?(ae=3+Vo(i,d,3),d+=2,se=N[j-1]):E==17?(ae=3+Vo(i,d,7),d+=3):E==18&&(ae=11+Vo(i,d,127),d+=7);ae--;)N[j++]=se}}var re=N.subarray(0,D),H=N.subarray(D);_=q1(re),y=q1(H),x=$m(re,_,1),g=$m(H,y,1)}else throw"invalid block type";else{var E=t8(d)+4,S=i[E-4]|i[E-3]<<8,w=E+S;if(w>n){if(r)throw"unexpected EOF";break}a&&l(p+S),e.set(i.subarray(E,w),p),t.b=p+=S,t.p=d=w*8;continue}if(d>b){if(r)throw"unexpected EOF";break}}a&&l(p+131072);for(var K=(1<<_)-1,W=(1<<y)-1,me=d;;me=d){var se=x[K1(i,d)&K],ve=se>>>4;if(d+=se&15,d>b){if(r)throw"unexpected EOF";break}if(!se)throw"invalid length/literal";if(ve<256)e[p++]=ve;else if(ve==256){me=d,x=null;break}else{var Q=ve-254;if(ve>264){var j=ve-257,de=gR[j];Q=Vo(i,d,(1<<de)-1)+yR[j],d+=de}var Te=g[K1(i,d)&W],Me=Te>>>4;if(!Te)throw"invalid distance";d+=Te&15;var H=QP[Me];if(Me>3){var de=vR[Me];H+=K1(i,d)&(1<<de)-1,d+=de}if(d>b){if(r)throw"unexpected EOF";break}a&&l(p+131072);for(var rt=p+Q;p<rt;p+=4)e[p]=e[p-H],e[p+1]=e[p+1-H],e[p+2]=e[p+2-H],e[p+3]=e[p+3-H];p=rt}}t.l=x,t.p=me,t.b=p,x&&(u=1,t.m=_,t.d=g,t.n=y)}while(!u);return p==e.length?e:n8(e,0,p)},a8=new uo(0),s8=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function qx(i,e){return i8((s8(i),i.subarray(2,-4)),e)}var r8=typeof TextDecoder<"u"&&new TextDecoder,o8=0;try{r8.decode(a8,{stream:!0}),o8=1}catch{}const l8=i=>i&&i.isCubeTexture;class c8 extends Xi{constructor(e,t){var n,a;const r=l8(e),u=((a=r?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?a:1024)/4,d=Math.floor(Math.log2(u)),p=Math.pow(2,d),x=3*Math.max(p,112),g=4*p,_=[r?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/x}`,`#define CUBEUV_TEXEL_HEIGHT ${1/g}`,`#define CUBEUV_MAX_MIP ${d}.0`],y=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,b=_.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${jS>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,C={map:{value:e},height:{value:t?.height||15},radius:{value:t?.radius||100}},E=new Mg(1,16),S=new hi({uniforms:C,fragmentShader:b,vertexShader:y,side:Oi});super(E,S)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}function SR(i,e,t={}){const n=new te,a=new ts,r=new te,l=new Wt,u=new Wt,d=new Wt;t.preserveMatrix=t.preserveMatrix!==void 0?t.preserveMatrix:!0,t.preservePosition=t.preservePosition!==void 0?t.preservePosition:!0,t.preserveHipPosition=t.preserveHipPosition!==void 0?t.preserveHipPosition:!1,t.useTargetMatrix=t.useTargetMatrix!==void 0?t.useTargetMatrix:!1,t.hip=t.hip!==void 0?t.hip:"hip",t.names=t.names||{};const p=e.isObject3D?e.skeleton.bones:ry(e),x=i.isObject3D?i.skeleton.bones:ry(i);let g,_,y,b,C;if(i.isObject3D?i.skeleton.pose():(t.useTargetMatrix=!0,t.preserveMatrix=!1),t.preservePosition){C=[];for(let E=0;E<x.length;E++)C.push(x[E].position.clone())}if(t.preserveMatrix){i.updateMatrixWorld(),i.matrixWorld.identity();for(let E=0;E<i.children.length;++E)i.children[E].updateMatrixWorld(!0)}if(t.offsets){g=[];for(let E=0;E<x.length;++E)_=x[E],y=t.names[_.name]||_.name,t.offsets[y]&&(_.matrix.multiply(t.offsets[y]),_.matrix.decompose(_.position,_.quaternion,_.scale),_.updateMatrixWorld()),g.push(_.matrixWorld.clone())}for(let E=0;E<x.length;++E){if(_=x[E],y=t.names[_.name]||_.name,b=AR(y,p),d.copy(_.matrixWorld),b){if(b.updateMatrixWorld(),t.useTargetMatrix?u.copy(b.matrixWorld):(u.copy(i.matrixWorld).invert(),u.multiply(b.matrixWorld)),r.setFromMatrixScale(u),u.scale(r.set(1/r.x,1/r.y,1/r.z)),d.makeRotationFromQuaternion(a.setFromRotationMatrix(u)),i.isObject3D){const S=x.indexOf(_),w=g?g[S]:l.copy(i.skeleton.boneInverses[S]).invert();d.multiply(w)}d.copyPosition(u)}_.parent&&_.parent.isBone?(_.matrix.copy(_.parent.matrixWorld).invert(),_.matrix.multiply(d)):_.matrix.copy(d),t.preserveHipPosition&&y===t.hip&&_.matrix.setPosition(n.set(0,_.position.y,0)),_.matrix.decompose(_.position,_.quaternion,_.scale),_.updateMatrixWorld()}if(t.preservePosition)for(let E=0;E<x.length;++E)_=x[E],y=t.names[_.name]||_.name,y!==t.hip&&_.position.copy(C[E]);t.preserveMatrix&&i.updateMatrixWorld(!0)}function u8(i,e,t,n={}){n.useFirstFramePosition=n.useFirstFramePosition!==void 0?n.useFirstFramePosition:!1,n.fps=n.fps!==void 0?n.fps:30,n.names=n.names||[],e.isObject3D||(e=h8(e));const a=Math.round(t.duration*(n.fps/1e3)*1e3),r=1/n.fps,l=[],u=new LS(e),d=ry(i.skeleton),p=[];let x,g,_,y,b;u.clipAction(t).play(),u.update(0),e.updateMatrixWorld();for(let C=0;C<a;++C){const E=C*r;SR(i,e,n);for(let S=0;S<d.length;++S)b=n.names[d[S].name]||d[S].name,_=AR(b,e.skeleton),_&&(g=d[S],y=p[S]=p[S]||{bone:g},n.hip===b&&(y.pos||(y.pos={times:new Float32Array(a),values:new Float32Array(a*3)}),n.useFirstFramePosition&&(C===0&&(x=g.position.clone()),g.position.sub(x)),y.pos.times[C]=E,g.position.toArray(y.pos.values,C*3)),y.quat||(y.quat={times:new Float32Array(a),values:new Float32Array(a*4)}),y.quat.times[C]=E,g.quaternion.toArray(y.quat.values,C*4));u.update(r),e.updateMatrixWorld()}for(let C=0;C<p.length;++C)y=p[C],y&&(y.pos&&l.push(new Xu(".bones["+y.bone.name+"].position",y.pos.times,y.pos.values)),l.push(new ju(".bones["+y.bone.name+"].quaternion",y.quat.times,y.quat.values)));return u.uncacheAction(t),new Rh(t.name,-1,l)}function f8(i){const e=new Map,t=new Map,n=i.clone();return MR(i,n,function(a,r){e.set(r,a),t.set(a,r)}),n.traverse(function(a){if(!a.isSkinnedMesh)return;const r=a,l=e.get(a),u=l.skeleton.bones;r.skeleton=l.skeleton.clone(),r.bindMatrix.copy(l.bindMatrix),r.skeleton.bones=u.map(function(d){return t.get(d)}),r.bind(r.skeleton,r.bindMatrix)}),n}function AR(i,e){for(let t=0,n=ry(e);t<n.length;t++)if(i===n[t].name)return n[t]}function ry(i){return Array.isArray(i)?i:i.bones}function h8(i){const e=new zC(i.bones[0]);return e.skeleton=i,e}function MR(i,e,t){t(i,e);for(let n=0;n<i.children.length;n++)MR(i.children[n],e.children[n],t)}const ER={retarget:SR,retargetClip:u8,clone:f8};function oy(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,n=i.length;t<n;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const gh="srgb",Dc="srgb-linear",uE=3001,d8=3e3;class XS extends ds{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new x8(t)}),this.register(function(t){return new _8(t)}),this.register(function(t){return new R8(t)}),this.register(function(t){return new w8(t)}),this.register(function(t){return new B8(t)}),this.register(function(t){return new b8(t)}),this.register(function(t){return new S8(t)}),this.register(function(t){return new A8(t)}),this.register(function(t){return new M8(t)}),this.register(function(t){return new v8(t)}),this.register(function(t){return new E8(t)}),this.register(function(t){return new y8(t)}),this.register(function(t){return new C8(t)}),this.register(function(t){return new T8(t)}),this.register(function(t){return new m8(t)}),this.register(function(t){return new D8(t)}),this.register(function(t){return new U8(t)})}load(e,t,n,a){const r=this;let l;if(this.resourcePath!=="")l=this.resourcePath;else if(this.path!==""){const p=Fu.extractUrlBase(e);l=Fu.resolveURL(p,this.path)}else l=Fu.extractUrlBase(e);this.manager.itemStart(e);const u=function(p){a?a(p):console.error(p),r.manager.itemError(e),r.manager.itemEnd(e)},d=new hs(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(p){try{r.parse(p,l,function(x){t(x),r.manager.itemEnd(e)},u)}catch(x){u(x)}},n,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,a){let r;const l={},u={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(oy(new Uint8Array(e.slice(0,4)))===TR){try{l[Ln.KHR_BINARY_GLTF]=new O8(e)}catch(x){a&&a(x);return}r=JSON.parse(l[Ln.KHR_BINARY_GLTF].content)}else r=JSON.parse(oy(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){a&&a(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const d=new Y8(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let p=0;p<this.pluginCallbacks.length;p++){const x=this.pluginCallbacks[p](d);x.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),u[x.name]=x,l[x.name]=!0}if(r.extensionsUsed)for(let p=0;p<r.extensionsUsed.length;++p){const x=r.extensionsUsed[p],g=r.extensionsRequired||[];switch(x){case Ln.KHR_MATERIALS_UNLIT:l[x]=new g8;break;case Ln.KHR_DRACO_MESH_COMPRESSION:l[x]=new N8(r,this.dracoLoader);break;case Ln.KHR_TEXTURE_TRANSFORM:l[x]=new L8;break;case Ln.KHR_MESH_QUANTIZATION:l[x]=new I8;break;default:g.indexOf(x)>=0&&u[x]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+x+'".')}}d.setExtensions(l),d.setPlugins(u),d.parse(n,a)}parseAsync(e,t){const n=this;return new Promise(function(a,r){n.parse(e,t,a,r)})}}function p8(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Ln={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class m8{constructor(e){this.parser=e,this.name=Ln.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,a=t.length;n<a;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let a=t.cache.get(n);if(a)return a;const r=t.json,d=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let p;const x=new ut(16777215);d.color!==void 0&&x.setRGB(d.color[0],d.color[1],d.color[2],Dc);const g=d.range!==void 0?d.range:0;switch(d.type){case"directional":p=new BS(x),p.target.position.set(0,0,-1),p.add(p.target);break;case"point":p=new wS(x),p.distance=g;break;case"spot":p=new RS(x),p.distance=g,d.spot=d.spot||{},d.spot.innerConeAngle=d.spot.innerConeAngle!==void 0?d.spot.innerConeAngle:0,d.spot.outerConeAngle=d.spot.outerConeAngle!==void 0?d.spot.outerConeAngle:Math.PI/4,p.angle=d.spot.outerConeAngle,p.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,p.target.position.set(0,0,-1),p.add(p.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return p.position.set(0,0,0),p.decay=2,Mc(p,d),d.intensity!==void 0&&(p.intensity=d.intensity),p.name=t.createUniqueName(d.name||"light_"+e),a=Promise.resolve(p),t.cache.add(n,a),a}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],u=(r.extensions&&r.extensions[this.name]||{}).light;return u===void 0?null:this._loadLight(u).then(function(d){return n._getNodeRef(t.cache,u,d)})}}class g8{constructor(){this.name=Ln.KHR_MATERIALS_UNLIT}getMaterialType(){return $a}extendParams(e,t,n){const a=[];e.color=new ut(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const l=r.baseColorFactor;e.color.setRGB(l[0],l[1],l[2],Dc),e.opacity=l[3]}r.baseColorTexture!==void 0&&a.push(n.assignTexture(e,"map",r.baseColorTexture,gh))}return Promise.all(a)}}class v8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const a=this.parser.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=a.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class x8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=[],l=a.extensions[this.name];if(l.clearcoatFactor!==void 0&&(t.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){const u=l.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ge(u,u)}return Promise.all(r)}}class _8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const a=this.parser.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=a.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class y8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=[],l=a.extensions[this.name];return l.iridescenceFactor!==void 0&&(t.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(t.iridescenceIOR=l.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(r)}}class b8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new ut(0,0,0),t.sheenRoughness=0,t.sheen=1;const l=a.extensions[this.name];if(l.sheenColorFactor!==void 0){const u=l.sheenColorFactor;t.sheenColor.setRGB(u[0],u[1],u[2],Dc)}return l.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",l.sheenColorTexture,gh)),l.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(r)}}class S8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=[],l=a.extensions[this.name];return l.transmissionFactor!==void 0&&(t.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",l.transmissionTexture)),Promise.all(r)}}class A8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=[],l=a.extensions[this.name];t.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",l.thicknessTexture)),t.attenuationDistance=l.attenuationDistance||1/0;const u=l.attenuationColor||[1,1,1];return t.attenuationColor=new ut().setRGB(u[0],u[1],u[2],Dc),Promise.all(r)}}class M8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const a=this.parser.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=a.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class E8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=[],l=a.extensions[this.name];t.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",l.specularTexture));const u=l.specularColorFactor||[1,1,1];return t.specularColor=new ut().setRGB(u[0],u[1],u[2],Dc),l.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",l.specularColorTexture,gh)),Promise.all(r)}}class T8{constructor(e){this.parser=e,this.name=Ln.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=[],l=a.extensions[this.name];return t.bumpScale=l.bumpFactor!==void 0?l.bumpFactor:1,l.bumpTexture!==void 0&&r.push(n.assignTexture(t,"bumpMap",l.bumpTexture)),Promise.all(r)}}class C8{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:po}extendMaterialParams(e,t){const n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const r=[],l=a.extensions[this.name];return l.anisotropyStrength!==void 0&&(t.anisotropy=l.anisotropyStrength),l.anisotropyRotation!==void 0&&(t.anisotropyRotation=l.anisotropyRotation),l.anisotropyTexture!==void 0&&r.push(n.assignTexture(t,"anisotropyMap",l.anisotropyTexture)),Promise.all(r)}}class R8{constructor(e){this.parser=e,this.name=Ln.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,a=n.textures[e];if(!a.extensions||!a.extensions[this.name])return null;const r=a.extensions[this.name],l=t.options.ktx2Loader;if(!l){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,l)}}class w8{constructor(e){this.parser=e,this.name=Ln.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,a=n.json,r=a.textures[e];if(!r.extensions||!r.extensions[t])return null;const l=r.extensions[t],u=a.images[l.source];let d=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);p!==null&&(d=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,l.source,d);if(a.extensionsRequired&&a.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class B8{constructor(e){this.parser=e,this.name=Ln.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,a=n.json,r=a.textures[e];if(!r.extensions||!r.extensions[t])return null;const l=r.extensions[t],u=a.images[l.source];let d=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);p!==null&&(d=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,l.source,d);if(a.extensionsRequired&&a.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class D8{constructor(e){this.name=Ln.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const a=n.extensions[this.name],r=this.parser.getDependency("buffer",a.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(u){const d=a.byteOffset||0,p=a.byteLength||0,x=a.count,g=a.byteStride,_=new Uint8Array(u,d,p);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(x,g,_,a.mode,a.filter).then(function(y){return y.buffer}):l.ready.then(function(){const y=new ArrayBuffer(x*g);return l.decodeGltfBuffer(new Uint8Array(y),x,g,_,a.mode,a.filter),y})})}else return null}}class U8{constructor(e){this.name=Ln.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const a=t.meshes[n.mesh];for(const p of a.primitives)if(p.mode!==co.TRIANGLES&&p.mode!==co.TRIANGLE_STRIP&&p.mode!==co.TRIANGLE_FAN&&p.mode!==void 0)return null;const l=n.extensions[this.name].attributes,u=[],d={};for(const p in l)u.push(this.parser.getDependency("accessor",l[p]).then(x=>(d[p]=x,d[p])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(p=>{const x=p.pop(),g=x.isGroup?x.children:[x],_=p[0].count,y=[];for(const b of g){const C=new Wt,E=new te,S=new ts,w=new te(1,1,1),D=new uS(b.geometry,b.material,_);for(let U=0;U<_;U++)d.TRANSLATION&&E.fromBufferAttribute(d.TRANSLATION,U),d.ROTATION&&S.fromBufferAttribute(d.ROTATION,U),d.SCALE&&w.fromBufferAttribute(d.SCALE,U),D.setMatrixAt(U,C.compose(E,S,w));for(const U in d)if(U==="_COLOR_0"){const F=d[U];D.instanceColor=new Eh(F.array,F.itemSize,F.normalized)}else U!=="TRANSLATION"&&U!=="ROTATION"&&U!=="SCALE"&&b.geometry.setAttribute(U,d[U]);Pn.prototype.copy.call(D,b),this.parser.assignFinalMaterial(D),y.push(D)}return x.isGroup?(x.clear(),x.add(...y),x):y[0]}))}}const TR="glTF",Um=12,fE={JSON:1313821514,BIN:5130562};class O8{constructor(e){this.name=Ln.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Um);if(this.header={magic:oy(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==TR)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Um,a=new DataView(e,Um);let r=0;for(;r<n;){const l=a.getUint32(r,!0);r+=4;const u=a.getUint32(r,!0);if(r+=4,u===fE.JSON){const d=new Uint8Array(e,Um+r,l);this.content=oy(d)}else if(u===fE.BIN){const d=Um+r;this.body=e.slice(d,d+l)}r+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class N8{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ln.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,a=this.dracoLoader,r=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,u={},d={},p={};for(const x in l){const g=zb[x]||x.toLowerCase();u[g]=l[x]}for(const x in e.attributes){const g=zb[x]||x.toLowerCase();if(l[x]!==void 0){const _=n.accessors[e.attributes[x]],y=Ap[_.componentType];p[g]=y.name,d[g]=_.normalized===!0}}return t.getDependency("bufferView",r).then(function(x){return new Promise(function(g,_){a.decodeDracoFile(x,function(y){for(const b in y.attributes){const C=y.attributes[b],E=d[b];E!==void 0&&(C.normalized=E)}g(y)},u,p,Dc,_)})})}}class L8{constructor(){this.name=Ln.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class I8{constructor(){this.name=Ln.KHR_MESH_QUANTIZATION}}class CR extends kp{constructor(e,t,n,a){super(e,t,n,a)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,a=this.valueSize,r=e*a*3+a;for(let l=0;l!==a;l++)t[l]=n[r+l];return t}interpolate_(e,t,n,a){const r=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=u*2,p=u*3,x=a-t,g=(n-t)/x,_=g*g,y=_*g,b=e*p,C=b-p,E=-2*y+3*_,S=y-_,w=1-E,D=S-_+g;for(let U=0;U!==u;U++){const F=l[C+U+u],N=l[C+U+d]*x,z=l[b+U+u],j=l[b+U]*x;r[U]=w*F+D*N+E*z+S*j}return r}}const P8=new ts;class F8 extends CR{interpolate_(e,t,n,a){const r=super.interpolate_(e,t,n,a);return P8.fromArray(r).normalize().toArray(r),r}}const co={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ap={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},hE={9728:la,9729:In,9984:dy,9985:bp,9986:uh,9987:fo},dE={33071:ea,33648:Tp,10497:Gu},J1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},zb={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...jS>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Tu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},z8={CUBICSPLINE:void 0,LINEAR:Bp,STEP:wp},W1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function H8(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new ra({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Wo})),i.DefaultMaterial}function ah(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Mc(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function G8(i,e,t){let n=!1,a=!1,r=!1;for(let p=0,x=e.length;p<x;p++){const g=e[p];if(g.POSITION!==void 0&&(n=!0),g.NORMAL!==void 0&&(a=!0),g.COLOR_0!==void 0&&(r=!0),n&&a&&r)break}if(!n&&!a&&!r)return Promise.resolve(i);const l=[],u=[],d=[];for(let p=0,x=e.length;p<x;p++){const g=e[p];if(n){const _=g.POSITION!==void 0?t.getDependency("accessor",g.POSITION):i.attributes.position;l.push(_)}if(a){const _=g.NORMAL!==void 0?t.getDependency("accessor",g.NORMAL):i.attributes.normal;u.push(_)}if(r){const _=g.COLOR_0!==void 0?t.getDependency("accessor",g.COLOR_0):i.attributes.color;d.push(_)}}return Promise.all([Promise.all(l),Promise.all(u),Promise.all(d)]).then(function(p){const x=p[0],g=p[1],_=p[2];return n&&(i.morphAttributes.position=x),a&&(i.morphAttributes.normal=g),r&&(i.morphAttributes.color=_),i.morphTargetsRelative=!0,i})}function V8(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,a=t.length;n<a;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function k8(i){let e;const t=i.extensions&&i.extensions[Ln.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Z1(t.attributes):e=i.indices+":"+Z1(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,a=i.targets.length;n<a;n++)e+=":"+Z1(i.targets[n]);return e}function Z1(i){let e="";const t=Object.keys(i).sort();for(let n=0,a=t.length;n<a;n++)e+=t[n]+":"+i[t[n]]+";";return e}function Hb(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function j8(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const X8=new Wt;class Y8{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new p8,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,a=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,a=navigator.userAgent.indexOf("Firefox")>-1,r=a?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||a&&r<98?this.textureLoader=new EC(this.options.manager):this.textureLoader=new OC(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new hs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,a=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(l){const u={scene:l[0][a.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:a.asset,parser:n,userData:{}};return ah(r,u,a),Mc(u,a),Promise.all(n._invokeAll(function(d){return d.afterRoot&&d.afterRoot(u)})).then(function(){for(const d of u.scenes)d.updateMatrixWorld();e(u)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let a=0,r=t.length;a<r;a++){const l=t[a].joints;for(let u=0,d=l.length;u<d;u++)e[l[u]].isBone=!0}for(let a=0,r=e.length;a<r;a++){const l=e[a];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(n[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const a=n.clone(),r=(l,u)=>{const d=this.associations.get(l);d!=null&&this.associations.set(u,d);for(const[p,x]of l.children.entries())r(x,u.children[p])};return r(n,a),a.name+="_instance_"+e.uses[t]++,a}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const a=e(t[n]);if(a)return a}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let a=0;a<t.length;a++){const r=e(t[a]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let a=this.cache.get(n);if(!a){switch(e){case"scene":a=this.loadScene(t);break;case"node":a=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":a=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":a=this.loadAccessor(t);break;case"bufferView":a=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":a=this.loadBuffer(t);break;case"material":a=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":a=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":a=this.loadSkin(t);break;case"animation":a=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":a=this.loadCamera(t);break;default:if(a=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!a)throw new Error("Unknown type: "+e);break}this.cache.add(n,a)}return a}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,a=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(a.map(function(r,l){return n.getDependency(e,l)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ln.KHR_BINARY_GLTF].body);const a=this.options;return new Promise(function(r,l){n.load(Fu.resolveURL(t.uri,a.path),r,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const a=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+a)})}loadAccessor(e){const t=this,n=this.json,a=this.json.accessors[e];if(a.bufferView===void 0&&a.sparse===void 0){const l=J1[a.type],u=Ap[a.componentType],d=a.normalized===!0,p=new u(a.count*l);return Promise.resolve(new Mn(p,l,d))}const r=[];return a.bufferView!==void 0?r.push(this.getDependency("bufferView",a.bufferView)):r.push(null),a.sparse!==void 0&&(r.push(this.getDependency("bufferView",a.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",a.sparse.values.bufferView))),Promise.all(r).then(function(l){const u=l[0],d=J1[a.type],p=Ap[a.componentType],x=p.BYTES_PER_ELEMENT,g=x*d,_=a.byteOffset||0,y=a.bufferView!==void 0?n.bufferViews[a.bufferView].byteStride:void 0,b=a.normalized===!0;let C,E;if(y&&y!==g){const S=Math.floor(_/y),w="InterleavedBuffer:"+a.bufferView+":"+a.componentType+":"+S+":"+a.count;let D=t.cache.get(w);D||(C=new p(u,S*y,a.count*y/x),D=new yg(C,y/x),t.cache.add(w,D)),E=new ku(D,d,_%y/x,b)}else u===null?C=new p(a.count*d):C=new p(u,_,a.count*d),E=new Mn(C,d,b);if(a.sparse!==void 0){const S=J1.SCALAR,w=Ap[a.sparse.indices.componentType],D=a.sparse.indices.byteOffset||0,U=a.sparse.values.byteOffset||0,F=new w(l[1],D,a.sparse.count*S),N=new p(l[2],U,a.sparse.count*d);u!==null&&(E=new Mn(E.array.slice(),E.itemSize,E.normalized));for(let z=0,j=F.length;z<j;z++){const L=F[z];if(E.setX(L,N[z*d]),d>=2&&E.setY(L,N[z*d+1]),d>=3&&E.setZ(L,N[z*d+2]),d>=4&&E.setW(L,N[z*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return E})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,l=t.images[r];let u=this.textureLoader;if(l.uri){const d=n.manager.getHandler(l.uri);d!==null&&(u=d)}return this.loadTextureImage(e,r,u)}loadTextureImage(e,t,n){const a=this,r=this.json,l=r.textures[e],u=r.images[t],d=(u.uri||u.bufferView)+":"+l.sampler;if(this.textureCache[d])return this.textureCache[d];const p=this.loadImageSource(t,n).then(function(x){x.flipY=!1,x.name=l.name||u.name||"",x.name===""&&typeof u.uri=="string"&&u.uri.startsWith("data:image/")===!1&&(x.name=u.uri);const _=(r.samplers||{})[l.sampler]||{};return x.magFilter=hE[_.magFilter]||In,x.minFilter=hE[_.minFilter]||fo,x.wrapS=dE[_.wrapS]||Gu,x.wrapT=dE[_.wrapT]||Gu,a.associations.set(x,{textures:e}),x}).catch(function(){return null});return this.textureCache[d]=p,p}loadImageSource(e,t){const n=this,a=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(g=>g.clone());const l=a.images[e],u=self.URL||self.webkitURL;let d=l.uri||"",p=!1;if(l.bufferView!==void 0)d=n.getDependency("bufferView",l.bufferView).then(function(g){p=!0;const _=new Blob([g],{type:l.mimeType});return d=u.createObjectURL(_),d});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const x=Promise.resolve(d).then(function(g){return new Promise(function(_,y){let b=_;t.isImageBitmapLoader===!0&&(b=function(C){const E=new ui(C);E.needsUpdate=!0,_(E)}),t.load(Fu.resolveURL(g,r.path),b,void 0,y)})}).then(function(g){return p===!0&&u.revokeObjectURL(d),Mc(g,l),g.userData.mimeType=l.mimeType||j8(l.uri),g}).catch(function(g){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),g});return this.sourceCache[e]=x,x}assignTexture(e,t,n,a){const r=this;return this.getDependency("texture",n.index).then(function(l){if(!l)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(l=l.clone(),l.channel=n.texCoord),r.extensions[Ln.KHR_TEXTURE_TRANSFORM]){const u=n.extensions!==void 0?n.extensions[Ln.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const d=r.associations.get(l);l=r.extensions[Ln.KHR_TEXTURE_TRANSFORM].extendTexture(l,u),r.associations.set(l,d)}}return a!==void 0&&(typeof a=="number"&&(a=a===uE?gh:Dc),"colorSpace"in l?l.colorSpace=a:l.encoding=a===gh?uE:d8),e[t]=l,l})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const a=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,l=t.attributes.normal===void 0;if(e.isPoints){const u="PointsMaterial:"+n.uuid;let d=this.cache.get(u);d||(d=new Vp,ya.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,d.sizeAttenuation=!1,this.cache.add(u,d)),n=d}else if(e.isLine){const u="LineBasicMaterial:"+n.uuid;let d=this.cache.get(u);d||(d=new Os,ya.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,this.cache.add(u,d)),n=d}if(a||r||l){let u="ClonedMaterial:"+n.uuid+":";a&&(u+="derivative-tangents:"),r&&(u+="vertex-colors:"),l&&(u+="flat-shading:");let d=this.cache.get(u);d||(d=n.clone(),r&&(d.vertexColors=!0),l&&(d.flatShading=!0),a&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(u,d),this.associations.set(d,this.associations.get(n))),n=d}e.material=n}getMaterialType(){return ra}loadMaterial(e){const t=this,n=this.json,a=this.extensions,r=n.materials[e];let l;const u={},d=r.extensions||{},p=[];if(d[Ln.KHR_MATERIALS_UNLIT]){const g=a[Ln.KHR_MATERIALS_UNLIT];l=g.getMaterialType(),p.push(g.extendParams(u,r,t))}else{const g=r.pbrMetallicRoughness||{};if(u.color=new ut(1,1,1),u.opacity=1,Array.isArray(g.baseColorFactor)){const _=g.baseColorFactor;u.color.setRGB(_[0],_[1],_[2],Dc),u.opacity=_[3]}g.baseColorTexture!==void 0&&p.push(t.assignTexture(u,"map",g.baseColorTexture,gh)),u.metalness=g.metallicFactor!==void 0?g.metallicFactor:1,u.roughness=g.roughnessFactor!==void 0?g.roughnessFactor:1,g.metallicRoughnessTexture!==void 0&&(p.push(t.assignTexture(u,"metalnessMap",g.metallicRoughnessTexture)),p.push(t.assignTexture(u,"roughnessMap",g.metallicRoughnessTexture))),l=this._invokeOne(function(_){return _.getMaterialType&&_.getMaterialType(e)}),p.push(Promise.all(this._invokeAll(function(_){return _.extendMaterialParams&&_.extendMaterialParams(e,u)})))}r.doubleSided===!0&&(u.side=Oi);const x=r.alphaMode||W1.OPAQUE;if(x===W1.BLEND?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,x===W1.MASK&&(u.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&l!==$a&&(p.push(t.assignTexture(u,"normalMap",r.normalTexture)),u.normalScale=new Ge(1,1),r.normalTexture.scale!==void 0)){const g=r.normalTexture.scale;u.normalScale.set(g,g)}if(r.occlusionTexture!==void 0&&l!==$a&&(p.push(t.assignTexture(u,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(u.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&l!==$a){const g=r.emissiveFactor;u.emissive=new ut().setRGB(g[0],g[1],g[2],Dc)}return r.emissiveTexture!==void 0&&l!==$a&&p.push(t.assignTexture(u,"emissiveMap",r.emissiveTexture,gh)),Promise.all(p).then(function(){const g=new l(u);return r.name&&(g.name=r.name),Mc(g,r),t.associations.set(g,{materials:e}),r.extensions&&ah(a,g,r),g})}createUniqueName(e){const t=Qn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,a=this.primitiveCache;function r(u){return n[Ln.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,t).then(function(d){return pE(d,u,t)})}const l=[];for(let u=0,d=e.length;u<d;u++){const p=e[u],x=k8(p),g=a[x];if(g)l.push(g.promise);else{let _;p.extensions&&p.extensions[Ln.KHR_DRACO_MESH_COMPRESSION]?_=r(p):_=pE(new rn,p,t),a[x]={primitive:p,promise:_},l.push(_)}}return Promise.all(l)}loadMesh(e){const t=this,n=this.json,a=this.extensions,r=n.meshes[e],l=r.primitives,u=[];for(let d=0,p=l.length;d<p;d++){const x=l[d].material===void 0?H8(this.cache):this.getDependency("material",l[d].material);u.push(x)}return u.push(t.loadGeometries(l)),Promise.all(u).then(function(d){const p=d.slice(0,d.length-1),x=d[d.length-1],g=[];for(let y=0,b=x.length;y<b;y++){const C=x[y],E=l[y];let S;const w=p[y];if(E.mode===co.TRIANGLES||E.mode===co.TRIANGLE_STRIP||E.mode===co.TRIANGLE_FAN||E.mode===void 0)S=r.isSkinnedMesh===!0?new cS(C,w):new Xi(C,w),S.isSkinnedMesh===!0&&S.normalizeSkinWeights(),E.mode===co.TRIANGLE_STRIP?S.geometry=cE(S.geometry,eS):E.mode===co.TRIANGLE_FAN&&(S.geometry=cE(S.geometry,J_));else if(E.mode===co.LINES)S=new Qo(C,w);else if(E.mode===co.LINE_STRIP)S=new Uc(C,w);else if(E.mode===co.LINE_LOOP)S=new fS(C,w);else if(E.mode===co.POINTS)S=new hS(C,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+E.mode);Object.keys(S.geometry.morphAttributes).length>0&&V8(S,r),S.name=t.createUniqueName(r.name||"mesh_"+e),Mc(S,r),E.extensions&&ah(a,S,E),t.assignFinalMaterial(S),g.push(S)}for(let y=0,b=g.length;y<b;y++)t.associations.set(g[y],{meshes:e,primitives:y});if(g.length===1)return r.extensions&&ah(a,g[0],r),g[0];const _=new wc;r.extensions&&ah(a,_,r),t.associations.set(_,{meshes:e});for(let y=0,b=g.length;y<b;y++)_.add(g[y]);return _})}loadCamera(e){let t;const n=this.json.cameras[e],a=n[n.type];if(!a){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Ra(iS.radToDeg(a.yfov),a.aspectRatio||1,a.znear||1,a.zfar||2e6):n.type==="orthographic"&&(t=new Zu(-a.xmag,a.xmag,a.ymag,-a.ymag,a.znear,a.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Mc(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let a=0,r=t.joints.length;a<r;a++)n.push(this._loadNodeShallow(t.joints[a]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(a){const r=a.pop(),l=a,u=[],d=[];for(let p=0,x=l.length;p<x;p++){const g=l[p];if(g){u.push(g);const _=new Wt;r!==null&&_.fromArray(r.array,p*16),d.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[p])}return new bg(u,d)})}loadAnimation(e){const t=this.json,n=this,a=t.animations[e],r=a.name?a.name:"animation_"+e,l=[],u=[],d=[],p=[],x=[];for(let g=0,_=a.channels.length;g<_;g++){const y=a.channels[g],b=a.samplers[y.sampler],C=y.target,E=C.node,S=a.parameters!==void 0?a.parameters[b.input]:b.input,w=a.parameters!==void 0?a.parameters[b.output]:b.output;C.node!==void 0&&(l.push(this.getDependency("node",E)),u.push(this.getDependency("accessor",S)),d.push(this.getDependency("accessor",w)),p.push(b),x.push(C))}return Promise.all([Promise.all(l),Promise.all(u),Promise.all(d),Promise.all(p),Promise.all(x)]).then(function(g){const _=g[0],y=g[1],b=g[2],C=g[3],E=g[4],S=[];for(let w=0,D=_.length;w<D;w++){const U=_[w],F=y[w],N=b[w],z=C[w],j=E[w];if(U===void 0)continue;U.updateMatrix&&U.updateMatrix();const L=n._createAnimationTracks(U,F,N,z,j);if(L)for(let P=0;P<L.length;P++)S.push(L[P])}return new Rh(r,void 0,S)})}createNodeMesh(e){const t=this.json,n=this,a=t.nodes[e];return a.mesh===void 0?null:n.getDependency("mesh",a.mesh).then(function(r){const l=n._getNodeRef(n.meshCache,a.mesh,r);return a.weights!==void 0&&l.traverse(function(u){if(u.isMesh)for(let d=0,p=a.weights.length;d<p;d++)u.morphTargetInfluences[d]=a.weights[d]}),l})}loadNode(e){const t=this.json,n=this,a=t.nodes[e],r=n._loadNodeShallow(e),l=[],u=a.children||[];for(let p=0,x=u.length;p<x;p++)l.push(n.getDependency("node",u[p]));const d=a.skin===void 0?Promise.resolve(null):n.getDependency("skin",a.skin);return Promise.all([r,Promise.all(l),d]).then(function(p){const x=p[0],g=p[1],_=p[2];_!==null&&x.traverse(function(y){y.isSkinnedMesh&&y.bind(_,X8)});for(let y=0,b=g.length;y<b;y++)x.add(g[y]);return x})}_loadNodeShallow(e){const t=this.json,n=this.extensions,a=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],l=r.name?a.createUniqueName(r.name):"",u=[],d=a._invokeOne(function(p){return p.createNodeMesh&&p.createNodeMesh(e)});return d&&u.push(d),r.camera!==void 0&&u.push(a.getDependency("camera",r.camera).then(function(p){return a._getNodeRef(a.cameraCache,r.camera,p)})),a._invokeAll(function(p){return p.createNodeAttachment&&p.createNodeAttachment(e)}).forEach(function(p){u.push(p)}),this.nodeCache[e]=Promise.all(u).then(function(p){let x;if(r.isBone===!0?x=new Cy:p.length>1?x=new wc:p.length===1?x=p[0]:x=new Pn,x!==p[0])for(let g=0,_=p.length;g<_;g++)x.add(p[g]);if(r.name&&(x.userData.name=r.name,x.name=l),Mc(x,r),r.extensions&&ah(n,x,r),r.matrix!==void 0){const g=new Wt;g.fromArray(r.matrix),x.applyMatrix4(g)}else r.translation!==void 0&&x.position.fromArray(r.translation),r.rotation!==void 0&&x.quaternion.fromArray(r.rotation),r.scale!==void 0&&x.scale.fromArray(r.scale);return a.associations.has(x)||a.associations.set(x,{}),a.associations.get(x).nodes=e,x}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],a=this,r=new wc;n.name&&(r.name=a.createUniqueName(n.name)),Mc(r,n),n.extensions&&ah(t,r,n);const l=n.nodes||[],u=[];for(let d=0,p=l.length;d<p;d++)u.push(a.getDependency("node",l[d]));return Promise.all(u).then(function(d){for(let x=0,g=d.length;x<g;x++)r.add(d[x]);const p=x=>{const g=new Map;for(const[_,y]of a.associations)(_ instanceof ya||_ instanceof ui)&&g.set(_,y);return x.traverse(_=>{const y=a.associations.get(_);y!=null&&g.set(_,y)}),g};return a.associations=p(r),r})}_createAnimationTracks(e,t,n,a,r){const l=[],u=e.name?e.name:e.uuid,d=[];Tu[r.path]===Tu.weights?e.traverse(function(_){_.morphTargetInfluences&&d.push(_.name?_.name:_.uuid)}):d.push(u);let p;switch(Tu[r.path]){case Tu.weights:p=Ch;break;case Tu.rotation:p=ju;break;case Tu.position:case Tu.scale:p=Xu;break;default:switch(n.itemSize){case 1:p=Ch;break;case 2:case 3:default:p=Xu;break}break}const x=a.interpolation!==void 0?z8[a.interpolation]:Bp,g=this._getArrayFromAccessor(n);for(let _=0,y=d.length;_<y;_++){const b=new p(d[_]+"."+Tu[r.path],t.array,g,x);a.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(b),l.push(b)}return l}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=Hb(t.constructor),a=new Float32Array(t.length);for(let r=0,l=t.length;r<l;r++)a[r]=t[r]*n;t=a}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const a=this instanceof ju?F8:CR;return new a(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function q8(i,e,t){const n=e.attributes,a=new ns;if(n.POSITION!==void 0){const u=t.json.accessors[n.POSITION],d=u.min,p=u.max;if(d!==void 0&&p!==void 0){if(a.set(new te(d[0],d[1],d[2]),new te(p[0],p[1],p[2])),u.normalized){const x=Hb(Ap[u.componentType]);a.min.multiplyScalar(x),a.max.multiplyScalar(x)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const u=new te,d=new te;for(let p=0,x=r.length;p<x;p++){const g=r[p];if(g.POSITION!==void 0){const _=t.json.accessors[g.POSITION],y=_.min,b=_.max;if(y!==void 0&&b!==void 0){if(d.setX(Math.max(Math.abs(y[0]),Math.abs(b[0]))),d.setY(Math.max(Math.abs(y[1]),Math.abs(b[1]))),d.setZ(Math.max(Math.abs(y[2]),Math.abs(b[2]))),_.normalized){const C=Hb(Ap[_.componentType]);d.multiplyScalar(C)}u.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}a.expandByVector(u)}i.boundingBox=a;const l=new za;a.getCenter(l.center),l.radius=a.min.distanceTo(a.max)/2,i.boundingSphere=l}function pE(i,e,t){const n=e.attributes,a=[];function r(l,u){return t.getDependency("accessor",l).then(function(d){i.setAttribute(u,d)})}for(const l in n){const u=zb[l]||l.toLowerCase();u in i.attributes||a.push(r(n[l],u))}if(e.indices!==void 0&&!i.index){const l=t.getDependency("accessor",e.indices).then(function(u){i.setIndex(u)});a.push(l)}return Mc(i,e),q8(i,e,t),Promise.all(a).then(function(){return e.targets!==void 0?G8(i,e.targets,t):i})}class K8 extends TS{constructor(e){super(e),this.type=wa}parse(e){const l=function(j,L){switch(j){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(L||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(L||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(L||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(L||""))}},g=function(j,L,P){L=L||1024;let ie=j.pos,se=-1,ae=0,re="",H=String.fromCharCode.apply(null,new Uint16Array(j.subarray(ie,ie+128)));for(;0>(se=H.indexOf(`
`))&&ae<L&&ie<j.byteLength;)re+=H,ae+=H.length,ie+=128,H+=String.fromCharCode.apply(null,new Uint16Array(j.subarray(ie,ie+128)));return-1<se?(j.pos+=ae+se+1,re+H.slice(0,se)):!1},_=function(j){const L=/^#\?(\S+)/,P=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,q=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,ie=/^\s*FORMAT=(\S+)\s*$/,se=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,ae={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let re,H;for((j.pos>=j.byteLength||!(re=g(j)))&&l(1,"no header found"),(H=re.match(L))||l(3,"bad initial token"),ae.valid|=1,ae.programtype=H[1],ae.string+=re+`
`;re=g(j),re!==!1;){if(ae.string+=re+`
`,re.charAt(0)==="#"){ae.comments+=re+`
`;continue}if((H=re.match(P))&&(ae.gamma=parseFloat(H[1])),(H=re.match(q))&&(ae.exposure=parseFloat(H[1])),(H=re.match(ie))&&(ae.valid|=2,ae.format=H[1]),(H=re.match(se))&&(ae.valid|=4,ae.height=parseInt(H[1],10),ae.width=parseInt(H[2],10)),ae.valid&2&&ae.valid&4)break}return ae.valid&2||l(3,"missing format specifier"),ae.valid&4||l(3,"missing image size specifier"),ae},y=function(j,L,P){const q=L;if(q<8||q>32767||j[0]!==2||j[1]!==2||j[2]&128)return new Uint8Array(j);q!==(j[2]<<8|j[3])&&l(3,"wrong scanline width");const ie=new Uint8Array(4*L*P);ie.length||l(4,"unable to allocate buffer space");let se=0,ae=0;const re=4*q,H=new Uint8Array(4),K=new Uint8Array(re);let W=P;for(;W>0&&ae<j.byteLength;){ae+4>j.byteLength&&l(1),H[0]=j[ae++],H[1]=j[ae++],H[2]=j[ae++],H[3]=j[ae++],(H[0]!=2||H[1]!=2||(H[2]<<8|H[3])!=q)&&l(3,"bad rgbe scanline format");let me=0,ve;for(;me<re&&ae<j.byteLength;){ve=j[ae++];const de=ve>128;if(de&&(ve-=128),(ve===0||me+ve>re)&&l(3,"bad scanline data"),de){const Te=j[ae++];for(let Me=0;Me<ve;Me++)K[me++]=Te}else K.set(j.subarray(ae,ae+ve),me),me+=ve,ae+=ve}const Q=q;for(let de=0;de<Q;de++){let Te=0;ie[se]=K[de+Te],Te+=q,ie[se+1]=K[de+Te],Te+=q,ie[se+2]=K[de+Te],Te+=q,ie[se+3]=K[de+Te],se+=4}W--}return ie},b=function(j,L,P,q){const ie=j[L+3],se=Math.pow(2,ie-128)/255;P[q+0]=j[L+0]*se,P[q+1]=j[L+1]*se,P[q+2]=j[L+2]*se,P[q+3]=1},C=function(j,L,P,q){const ie=j[L+3],se=Math.pow(2,ie-128)/255;P[q+0]=dh.toHalfFloat(Math.min(j[L+0]*se,65504)),P[q+1]=dh.toHalfFloat(Math.min(j[L+1]*se,65504)),P[q+2]=dh.toHalfFloat(Math.min(j[L+2]*se,65504)),P[q+3]=dh.toHalfFloat(1)},E=new Uint8Array(e);E.pos=0;const S=_(E),w=S.width,D=S.height,U=y(E.subarray(E.pos),w,D);let F,N,z;switch(this.type){case ji:z=U.length/4;const j=new Float32Array(z*4);for(let P=0;P<z;P++)b(U,P*4,j,P*4);F=j,N=ji;break;case wa:z=U.length/4;const L=new Uint16Array(z*4);for(let P=0;P<z;P++)C(U,P*4,L,P*4);F=L,N=wa;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:w,height:D,data:F,header:S.string,gamma:S.gamma,exposure:S.exposure,type:N}}setDataType(e){return this.type=e,this}load(e,t,n,a){function r(l,u){switch(l.type){case ji:case wa:"colorSpace"in l?l.colorSpace="srgb-linear":l.encoding=3e3,l.minFilter=In,l.magFilter=In,l.generateMipmaps=!1,l.flipY=!0;break}t&&t(l,u)}return super.load(e,r,n,a)}}const Om=jS>=152;class J8 extends TS{constructor(e){super(e),this.type=wa}parse(e){const L=Math.pow(2.7182818,2.2);function P(G,Z){for(var he=0,we=0;we<65536;++we)(we==0||G[we>>3]&1<<(we&7))&&(Z[he++]=we);for(var ze=he-1;he<65536;)Z[he++]=0;return ze}function q(G){for(var Z=0;Z<16384;Z++)G[Z]={},G[Z].len=0,G[Z].lit=0,G[Z].p=null}const ie={l:0,c:0,lc:0};function se(G,Z,he,we,ze){for(;he<G;)Z=Z<<8|It(we,ze),he+=8;he-=G,ie.l=Z>>he&(1<<G)-1,ie.c=Z,ie.lc=he}const ae=new Array(59);function re(G){for(var Z=0;Z<=58;++Z)ae[Z]=0;for(var Z=0;Z<65537;++Z)ae[G[Z]]+=1;for(var he=0,Z=58;Z>0;--Z){var we=he+ae[Z]>>1;ae[Z]=he,he=we}for(var Z=0;Z<65537;++Z){var ze=G[Z];ze>0&&(G[Z]=ze|ae[ze]++<<6)}}function H(G,Z,he,we,ze,Pe,ot){for(var nt=he,at=0,V=0;ze<=Pe;ze++){if(nt.value-he.value>we)return!1;se(6,at,V,G,nt);var ne=ie.l;if(at=ie.c,V=ie.lc,ot[ze]=ne,ne==63){if(nt.value-he.value>we)throw"Something wrong with hufUnpackEncTable";se(8,at,V,G,nt);var le=ie.l+6;if(at=ie.c,V=ie.lc,ze+le>Pe+1)throw"Something wrong with hufUnpackEncTable";for(;le--;)ot[ze++]=0;ze--}else if(ne>=59){var le=ne-59+2;if(ze+le>Pe+1)throw"Something wrong with hufUnpackEncTable";for(;le--;)ot[ze++]=0;ze--}}re(ot)}function K(G){return G&63}function W(G){return G>>6}function me(G,Z,he,we){for(;Z<=he;Z++){var ze=W(G[Z]),Pe=K(G[Z]);if(ze>>Pe)throw"Invalid table entry";if(Pe>14){var ot=we[ze>>Pe-14];if(ot.len)throw"Invalid table entry";if(ot.lit++,ot.p){var nt=ot.p;ot.p=new Array(ot.lit);for(var at=0;at<ot.lit-1;++at)ot.p[at]=nt[at]}else ot.p=new Array(1);ot.p[ot.lit-1]=Z}else if(Pe)for(var V=0,at=1<<14-Pe;at>0;at--){var ot=we[(ze<<14-Pe)+V];if(ot.len||ot.p)throw"Invalid table entry";ot.len=Pe,ot.lit=Z,V++}}return!0}const ve={c:0,lc:0};function Q(G,Z,he,we){G=G<<8|It(he,we),Z+=8,ve.c=G,ve.lc=Z}const de={c:0,lc:0};function Te(G,Z,he,we,ze,Pe,ot,nt,at,V){if(G==Z){we<8&&(Q(he,we,ze,ot),he=ve.c,we=ve.lc),we-=8;var ne=he>>we,ne=new Uint8Array([ne])[0];if(at.value+ne>V)return!1;for(var le=nt[at.value-1];ne-- >0;)nt[at.value++]=le}else if(at.value<V)nt[at.value++]=G;else return!1;de.c=he,de.lc=we}function Me(G){return G&65535}function rt(G){var Z=Me(G);return Z>32767?Z-65536:Z}const xe={a:0,b:0};function fe(G,Z){var he=rt(G),we=rt(Z),ze=we,Pe=he+(ze&1)+(ze>>1),ot=Pe,nt=Pe-ze;xe.a=ot,xe.b=nt}function Fe(G,Z){var he=Me(G),we=Me(Z),ze=he-(we>>1)&65535,Pe=we+ze-32768&65535;xe.a=Pe,xe.b=ze}function et(G,Z,he,we,ze,Pe,ot){for(var nt=ot<16384,at=he>ze?ze:he,V=1,ne;V<=at;)V<<=1;for(V>>=1,ne=V,V>>=1;V>=1;){for(var le=0,_e=le+Pe*(ze-ne),oe=Pe*V,Ne=Pe*ne,je=we*V,$e=we*ne,ct,_t,Rt,Tt;le<=_e;le+=Ne){for(var Ut=le,on=le+we*(he-ne);Ut<=on;Ut+=$e){var Ht=Ut+je,Jt=Ut+oe,xn=Jt+je;nt?(fe(G[Ut+Z],G[Jt+Z]),ct=xe.a,Rt=xe.b,fe(G[Ht+Z],G[xn+Z]),_t=xe.a,Tt=xe.b,fe(ct,_t),G[Ut+Z]=xe.a,G[Ht+Z]=xe.b,fe(Rt,Tt),G[Jt+Z]=xe.a,G[xn+Z]=xe.b):(Fe(G[Ut+Z],G[Jt+Z]),ct=xe.a,Rt=xe.b,Fe(G[Ht+Z],G[xn+Z]),_t=xe.a,Tt=xe.b,Fe(ct,_t),G[Ut+Z]=xe.a,G[Ht+Z]=xe.b,Fe(Rt,Tt),G[Jt+Z]=xe.a,G[xn+Z]=xe.b)}if(he&V){var Jt=Ut+oe;nt?fe(G[Ut+Z],G[Jt+Z]):Fe(G[Ut+Z],G[Jt+Z]),ct=xe.a,G[Jt+Z]=xe.b,G[Ut+Z]=ct}}if(ze&V)for(var Ut=le,on=le+we*(he-ne);Ut<=on;Ut+=$e){var Ht=Ut+je;nt?fe(G[Ut+Z],G[Ht+Z]):Fe(G[Ut+Z],G[Ht+Z]),ct=xe.a,G[Ht+Z]=xe.b,G[Ut+Z]=ct}ne=V,V>>=1}return le}function ht(G,Z,he,we,ze,Pe,ot,nt,at,V){for(var ne=0,le=0,_e=nt,oe=Math.trunc(ze.value+(Pe+7)/8);ze.value<oe;)for(Q(ne,le,he,ze),ne=ve.c,le=ve.lc;le>=14;){var Ne=ne>>le-14&16383,je=Z[Ne];if(je.len)le-=je.len,Te(je.lit,ot,ne,le,he,we,ze,at,V,_e),ne=de.c,le=de.lc;else{if(!je.p)throw"hufDecode issues";var $e;for($e=0;$e<je.lit;$e++){for(var ct=K(G[je.p[$e]]);le<ct&&ze.value<oe;)Q(ne,le,he,ze),ne=ve.c,le=ve.lc;if(le>=ct&&W(G[je.p[$e]])==(ne>>le-ct&(1<<ct)-1)){le-=ct,Te(je.p[$e],ot,ne,le,he,we,ze,at,V,_e),ne=de.c,le=de.lc;break}}if($e==je.lit)throw"hufDecode issues"}}var _t=8-Pe&7;for(ne>>=_t,le-=_t;le>0;){var je=Z[ne<<14-le&16383];if(je.len)le-=je.len,Te(je.lit,ot,ne,le,he,we,ze,at,V,_e),ne=de.c,le=de.lc;else throw"hufDecode issues"}return!0}function yt(G,Z,he,we,ze,Pe){var ot={value:0},nt=he.value,at=qe(Z,he),V=qe(Z,he);he.value+=4;var ne=qe(Z,he);if(he.value+=4,at<0||at>=65537||V<0||V>=65537)throw"Something wrong with HUF_ENCSIZE";var le=new Array(65537),_e=new Array(16384);q(_e);var oe=we-(he.value-nt);if(H(G,Z,he,oe,at,V,le),ne>8*(we-(he.value-nt)))throw"Something wrong with hufUncompress";me(le,at,V,_e),ht(le,_e,G,Z,he,ne,V,Pe,ze,ot)}function Xt(G,Z,he){for(var we=0;we<he;++we)Z[we]=G[Z[we]]}function Ot(G){for(var Z=1;Z<G.length;Z++){var he=G[Z-1]+G[Z]-128;G[Z]=he}}function ke(G,Z){for(var he=0,we=Math.floor((G.length+1)/2),ze=0,Pe=G.length-1;!(ze>Pe||(Z[ze++]=G[he++],ze>Pe));)Z[ze++]=G[we++]}function $(G){for(var Z=G.byteLength,he=new Array,we=0,ze=new DataView(G);Z>0;){var Pe=ze.getInt8(we++);if(Pe<0){var ot=-Pe;Z-=ot+1;for(var nt=0;nt<ot;nt++)he.push(ze.getUint8(we++))}else{var ot=Pe;Z-=2;for(var at=ze.getUint8(we++),nt=0;nt<ot+1;nt++)he.push(at)}}return he}function Qe(G,Z,he,we,ze,Pe){var Ht=new DataView(Pe.buffer),ot=he[G.idx[0]].width,nt=he[G.idx[0]].height,at=3,V=Math.floor(ot/8),ne=Math.ceil(ot/8),le=Math.ceil(nt/8),_e=ot-(ne-1)*8,oe=nt-(le-1)*8,Ne={value:0},je=new Array(at),$e=new Array(at),ct=new Array(at),_t=new Array(at),Rt=new Array(at);for(let Pt=0;Pt<at;++Pt)Rt[Pt]=Z[G.idx[Pt]],je[Pt]=Pt<1?0:je[Pt-1]+ne*le,$e[Pt]=new Float32Array(64),ct[Pt]=new Uint16Array(64),_t[Pt]=new Uint16Array(ne*64);for(let Pt=0;Pt<le;++Pt){var Tt=8;Pt==le-1&&(Tt=oe);var Ut=8;for(let zn=0;zn<ne;++zn){zn==ne-1&&(Ut=_e);for(let Yt=0;Yt<at;++Yt)ct[Yt].fill(0),ct[Yt][0]=ze[je[Yt]++],st(Ne,we,ct[Yt]),pt(ct[Yt],$e[Yt]),it($e[Yt]);bt($e);for(let Yt=0;Yt<at;++Yt)mt($e[Yt],_t[Yt],zn*64)}let Rn=0;for(let zn=0;zn<at;++zn){const Yt=he[G.idx[zn]].type;for(let Bi=8*Pt;Bi<8*Pt+Tt;++Bi){Rn=Rt[zn][Bi];for(let Un=0;Un<V;++Un){const jn=Un*64+(Bi&7)*8;Ht.setUint16(Rn+0*Yt,_t[zn][jn+0],!0),Ht.setUint16(Rn+2*Yt,_t[zn][jn+1],!0),Ht.setUint16(Rn+4*Yt,_t[zn][jn+2],!0),Ht.setUint16(Rn+6*Yt,_t[zn][jn+3],!0),Ht.setUint16(Rn+8*Yt,_t[zn][jn+4],!0),Ht.setUint16(Rn+10*Yt,_t[zn][jn+5],!0),Ht.setUint16(Rn+12*Yt,_t[zn][jn+6],!0),Ht.setUint16(Rn+14*Yt,_t[zn][jn+7],!0),Rn+=16*Yt}}if(V!=ne)for(let Bi=8*Pt;Bi<8*Pt+Tt;++Bi){const Un=Rt[zn][Bi]+8*V*2*Yt,jn=V*64+(Bi&7)*8;for(let di=0;di<Ut;++di)Ht.setUint16(Un+di*2*Yt,_t[zn][jn+di],!0)}}}for(var on=new Uint16Array(ot),Ht=new DataView(Pe.buffer),Jt=0;Jt<at;++Jt){he[G.idx[Jt]].decoded=!0;var xn=he[G.idx[Jt]].type;if(he[Jt].type==2)for(var Gt=0;Gt<nt;++Gt){const Pt=Rt[Jt][Gt];for(var pn=0;pn<ot;++pn)on[pn]=Ht.getUint16(Pt+pn*2*xn,!0);for(var pn=0;pn<ot;++pn)Ht.setFloat32(Pt+pn*2*xn,Ue(on[pn]),!0)}}}function st(G,Z,he){for(var we,ze=1;ze<64;)we=Z[G.value],we==65280?ze=64:we>>8==255?ze+=we&255:(he[ze]=we,ze++),G.value++}function pt(G,Z){Z[0]=Ue(G[0]),Z[1]=Ue(G[1]),Z[2]=Ue(G[5]),Z[3]=Ue(G[6]),Z[4]=Ue(G[14]),Z[5]=Ue(G[15]),Z[6]=Ue(G[27]),Z[7]=Ue(G[28]),Z[8]=Ue(G[2]),Z[9]=Ue(G[4]),Z[10]=Ue(G[7]),Z[11]=Ue(G[13]),Z[12]=Ue(G[16]),Z[13]=Ue(G[26]),Z[14]=Ue(G[29]),Z[15]=Ue(G[42]),Z[16]=Ue(G[3]),Z[17]=Ue(G[8]),Z[18]=Ue(G[12]),Z[19]=Ue(G[17]),Z[20]=Ue(G[25]),Z[21]=Ue(G[30]),Z[22]=Ue(G[41]),Z[23]=Ue(G[43]),Z[24]=Ue(G[9]),Z[25]=Ue(G[11]),Z[26]=Ue(G[18]),Z[27]=Ue(G[24]),Z[28]=Ue(G[31]),Z[29]=Ue(G[40]),Z[30]=Ue(G[44]),Z[31]=Ue(G[53]),Z[32]=Ue(G[10]),Z[33]=Ue(G[19]),Z[34]=Ue(G[23]),Z[35]=Ue(G[32]),Z[36]=Ue(G[39]),Z[37]=Ue(G[45]),Z[38]=Ue(G[52]),Z[39]=Ue(G[54]),Z[40]=Ue(G[20]),Z[41]=Ue(G[22]),Z[42]=Ue(G[33]),Z[43]=Ue(G[38]),Z[44]=Ue(G[46]),Z[45]=Ue(G[51]),Z[46]=Ue(G[55]),Z[47]=Ue(G[60]),Z[48]=Ue(G[21]),Z[49]=Ue(G[34]),Z[50]=Ue(G[37]),Z[51]=Ue(G[47]),Z[52]=Ue(G[50]),Z[53]=Ue(G[56]),Z[54]=Ue(G[59]),Z[55]=Ue(G[61]),Z[56]=Ue(G[35]),Z[57]=Ue(G[36]),Z[58]=Ue(G[48]),Z[59]=Ue(G[49]),Z[60]=Ue(G[57]),Z[61]=Ue(G[58]),Z[62]=Ue(G[62]),Z[63]=Ue(G[63])}function it(G){const Z=.5*Math.cos(.7853975),he=.5*Math.cos(3.14159/16),we=.5*Math.cos(3.14159/8),ze=.5*Math.cos(3*3.14159/16),Pe=.5*Math.cos(5*3.14159/16),ot=.5*Math.cos(3*3.14159/8),nt=.5*Math.cos(7*3.14159/16);for(var at=new Array(4),V=new Array(4),ne=new Array(4),le=new Array(4),_e=0;_e<8;++_e){var oe=_e*8;at[0]=we*G[oe+2],at[1]=ot*G[oe+2],at[2]=we*G[oe+6],at[3]=ot*G[oe+6],V[0]=he*G[oe+1]+ze*G[oe+3]+Pe*G[oe+5]+nt*G[oe+7],V[1]=ze*G[oe+1]-nt*G[oe+3]-he*G[oe+5]-Pe*G[oe+7],V[2]=Pe*G[oe+1]-he*G[oe+3]+nt*G[oe+5]+ze*G[oe+7],V[3]=nt*G[oe+1]-Pe*G[oe+3]+ze*G[oe+5]-he*G[oe+7],ne[0]=Z*(G[oe+0]+G[oe+4]),ne[3]=Z*(G[oe+0]-G[oe+4]),ne[1]=at[0]+at[3],ne[2]=at[1]-at[2],le[0]=ne[0]+ne[1],le[1]=ne[3]+ne[2],le[2]=ne[3]-ne[2],le[3]=ne[0]-ne[1],G[oe+0]=le[0]+V[0],G[oe+1]=le[1]+V[1],G[oe+2]=le[2]+V[2],G[oe+3]=le[3]+V[3],G[oe+4]=le[3]-V[3],G[oe+5]=le[2]-V[2],G[oe+6]=le[1]-V[1],G[oe+7]=le[0]-V[0]}for(var Ne=0;Ne<8;++Ne)at[0]=we*G[16+Ne],at[1]=ot*G[16+Ne],at[2]=we*G[48+Ne],at[3]=ot*G[48+Ne],V[0]=he*G[8+Ne]+ze*G[24+Ne]+Pe*G[40+Ne]+nt*G[56+Ne],V[1]=ze*G[8+Ne]-nt*G[24+Ne]-he*G[40+Ne]-Pe*G[56+Ne],V[2]=Pe*G[8+Ne]-he*G[24+Ne]+nt*G[40+Ne]+ze*G[56+Ne],V[3]=nt*G[8+Ne]-Pe*G[24+Ne]+ze*G[40+Ne]-he*G[56+Ne],ne[0]=Z*(G[Ne]+G[32+Ne]),ne[3]=Z*(G[Ne]-G[32+Ne]),ne[1]=at[0]+at[3],ne[2]=at[1]-at[2],le[0]=ne[0]+ne[1],le[1]=ne[3]+ne[2],le[2]=ne[3]-ne[2],le[3]=ne[0]-ne[1],G[0+Ne]=le[0]+V[0],G[8+Ne]=le[1]+V[1],G[16+Ne]=le[2]+V[2],G[24+Ne]=le[3]+V[3],G[32+Ne]=le[3]-V[3],G[40+Ne]=le[2]-V[2],G[48+Ne]=le[1]-V[1],G[56+Ne]=le[0]-V[0]}function bt(G){for(var Z=0;Z<64;++Z){var he=G[0][Z],we=G[1][Z],ze=G[2][Z];G[0][Z]=he+1.5747*ze,G[1][Z]=he-.1873*we-.4682*ze,G[2][Z]=he+1.8556*we}}function mt(G,Z,he){for(var we=0;we<64;++we)Z[he+we]=dh.toHalfFloat(Ct(G[we]))}function Ct(G){return G<=1?Math.sign(G)*Math.pow(Math.abs(G),2.2):Math.sign(G)*Math.pow(L,Math.abs(G)-1)}function ee(G){return new DataView(G.array.buffer,G.offset.value,G.size)}function X(G){var Z=G.viewer.buffer.slice(G.offset.value,G.offset.value+G.size),he=new Uint8Array($(Z)),we=new Uint8Array(he.length);return Ot(he),ke(he,we),new DataView(we.buffer)}function Ae(G){var Z=G.array.slice(G.offset.value,G.offset.value+G.size),he=qx(Z),we=new Uint8Array(he.length);return Ot(he),ke(he,we),new DataView(we.buffer)}function He(G){for(var Z=G.viewer,he={value:G.offset.value},we=new Uint16Array(G.width*G.scanlineBlockSize*(G.channels*G.type)),ze=new Uint8Array(8192),Pe=0,ot=new Array(G.channels),nt=0;nt<G.channels;nt++)ot[nt]={},ot[nt].start=Pe,ot[nt].end=ot[nt].start,ot[nt].nx=G.width,ot[nt].ny=G.lines,ot[nt].size=G.type,Pe+=ot[nt].nx*ot[nt].ny*ot[nt].size;var at=ft(Z,he),V=ft(Z,he);if(V>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(at<=V)for(var nt=0;nt<V-at+1;nt++)ze[nt+at]=Et(Z,he);var ne=new Uint16Array(65536),le=P(ze,ne),_e=qe(Z,he);yt(G.array,Z,he,_e,we,Pe);for(var nt=0;nt<G.channels;++nt)for(var oe=ot[nt],Ne=0;Ne<ot[nt].size;++Ne)et(we,oe.start+Ne,oe.nx,oe.size,oe.ny,oe.nx*oe.size,le);Xt(ne,we,Pe);for(var je=0,$e=new Uint8Array(we.buffer.byteLength),ct=0;ct<G.lines;ct++)for(var _t=0;_t<G.channels;_t++){var oe=ot[_t],Rt=oe.nx*oe.size,Tt=new Uint8Array(we.buffer,oe.end*2,Rt*2);$e.set(Tt,je),je+=Rt*2,oe.end+=Rt}return new DataView($e.buffer)}function Ze(G){var Z=G.array.slice(G.offset.value,G.offset.value+G.size),he=qx(Z);const we=G.lines*G.channels*G.width,ze=G.type==1?new Uint16Array(we):new Uint32Array(we);let Pe=0,ot=0;const nt=new Array(4);for(let at=0;at<G.lines;at++)for(let V=0;V<G.channels;V++){let ne=0;switch(G.type){case 1:nt[0]=Pe,nt[1]=nt[0]+G.width,Pe=nt[1]+G.width;for(let le=0;le<G.width;++le){const _e=he[nt[0]++]<<8|he[nt[1]++];ne+=_e,ze[ot]=ne,ot++}break;case 2:nt[0]=Pe,nt[1]=nt[0]+G.width,nt[2]=nt[1]+G.width,Pe=nt[2]+G.width;for(let le=0;le<G.width;++le){const _e=he[nt[0]++]<<24|he[nt[1]++]<<16|he[nt[2]++]<<8;ne+=_e,ze[ot]=ne,ot++}break}}return new DataView(ze.buffer)}function Le(G){var Z=G.viewer,he={value:G.offset.value},we=new Uint8Array(G.width*G.lines*(G.channels*G.type*2)),ze={version:gt(Z,he),unknownUncompressedSize:gt(Z,he),unknownCompressedSize:gt(Z,he),acCompressedSize:gt(Z,he),dcCompressedSize:gt(Z,he),rleCompressedSize:gt(Z,he),rleUncompressedSize:gt(Z,he),rleRawSize:gt(Z,he),totalAcUncompressedCount:gt(Z,he),totalDcUncompressedCount:gt(Z,he),acCompression:gt(Z,he)};if(ze.version<2)throw"EXRLoader.parse: "+ba.compression+" version "+ze.version+" is unsupported";for(var Pe=new Array,ot=ft(Z,he)-2;ot>0;){var nt=Nt(Z.buffer,he),at=Et(Z,he),V=at>>2&3,ne=(at>>4)-1,le=new Int8Array([ne])[0],_e=Et(Z,he);Pe.push({name:nt,index:le,type:_e,compression:V}),ot-=nt.length+3}for(var oe=ba.channels,Ne=new Array(G.channels),je=0;je<G.channels;++je){var $e=Ne[je]={},ct=oe[je];$e.name=ct.name,$e.compression=0,$e.decoded=!1,$e.type=ct.pixelType,$e.pLinear=ct.pLinear,$e.width=G.width,$e.height=G.lines}for(var _t={idx:new Array(3)},Rt=0;Rt<G.channels;++Rt)for(var $e=Ne[Rt],je=0;je<Pe.length;++je){var Tt=Pe[je];$e.name==Tt.name&&($e.compression=Tt.compression,Tt.index>=0&&(_t.idx[Tt.index]=Rt),$e.offset=Rt)}if(ze.acCompressedSize>0)switch(ze.acCompression){case 0:var Ht=new Uint16Array(ze.totalAcUncompressedCount);yt(G.array,Z,he,ze.acCompressedSize,Ht,ze.totalAcUncompressedCount);break;case 1:var Ut=G.array.slice(he.value,he.value+ze.totalAcUncompressedCount),on=qx(Ut),Ht=new Uint16Array(on.buffer);he.value+=ze.totalAcUncompressedCount;break}if(ze.dcCompressedSize>0){var Jt={array:G.array,offset:he,size:ze.dcCompressedSize},xn=new Uint16Array(Ae(Jt).buffer);he.value+=ze.dcCompressedSize}if(ze.rleRawSize>0){var Ut=G.array.slice(he.value,he.value+ze.rleCompressedSize),on=qx(Ut),Gt=$(on.buffer);he.value+=ze.rleCompressedSize}for(var pn=0,Pt=new Array(Ne.length),je=0;je<Pt.length;++je)Pt[je]=new Array;for(var Rn=0;Rn<G.lines;++Rn)for(var zn=0;zn<Ne.length;++zn)Pt[zn].push(pn),pn+=Ne[zn].width*G.type*2;Qe(_t,Pt,Ne,Ht,xn,we);for(var je=0;je<Ne.length;++je){var $e=Ne[je];if(!$e.decoded)switch($e.compression){case 2:for(var Yt=0,Bi=0,Rn=0;Rn<G.lines;++Rn){for(var Un=Pt[je][Yt],jn=0;jn<$e.width;++jn){for(var di=0;di<2*$e.type;++di)we[Un++]=Gt[Bi+di*$e.width*$e.height];Bi++}Yt++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(we.buffer)}function Nt(G,Z){for(var he=new Uint8Array(G),we=0;he[Z.value+we]!=0;)we+=1;var ze=new TextDecoder().decode(he.slice(Z.value,Z.value+we));return Z.value=Z.value+we+1,ze}function xt(G,Z,he){var we=new TextDecoder().decode(new Uint8Array(G).slice(Z.value,Z.value+he));return Z.value=Z.value+he,we}function Vt(G,Z){var he=Ye(G,Z),we=qe(G,Z);return[he,we]}function Lt(G,Z){var he=qe(G,Z),we=qe(G,Z);return[he,we]}function Ye(G,Z){var he=G.getInt32(Z.value,!0);return Z.value=Z.value+4,he}function qe(G,Z){var he=G.getUint32(Z.value,!0);return Z.value=Z.value+4,he}function It(G,Z){var he=G[Z.value];return Z.value=Z.value+1,he}function Et(G,Z){var he=G.getUint8(Z.value);return Z.value=Z.value+1,he}const gt=function(G,Z){let he;return"getBigInt64"in DataView.prototype?he=Number(G.getBigInt64(Z.value,!0)):he=G.getUint32(Z.value+4,!0)+Number(G.getUint32(Z.value,!0)<<32),Z.value+=8,he};function Dt(G,Z){var he=G.getFloat32(Z.value,!0);return Z.value+=4,he}function pe(G,Z){return dh.toHalfFloat(Dt(G,Z))}function Ue(G){var Z=(G&31744)>>10,he=G&1023;return(G>>15?-1:1)*(Z?Z===31?he?NaN:1/0:Math.pow(2,Z-15)*(1+he/1024):6103515625e-14*(he/1024))}function ft(G,Z){var he=G.getUint16(Z.value,!0);return Z.value+=2,he}function vt(G,Z){return Ue(ft(G,Z))}function tt(G,Z,he,we){for(var ze=he.value,Pe=[];he.value<ze+we-1;){var ot=Nt(Z,he),nt=Ye(G,he),at=Et(G,he);he.value+=3;var V=Ye(G,he),ne=Ye(G,he);Pe.push({name:ot,pixelType:nt,pLinear:at,xSampling:V,ySampling:ne})}return he.value+=1,Pe}function Je(G,Z){var he=Dt(G,Z),we=Dt(G,Z),ze=Dt(G,Z),Pe=Dt(G,Z),ot=Dt(G,Z),nt=Dt(G,Z),at=Dt(G,Z),V=Dt(G,Z);return{redX:he,redY:we,greenX:ze,greenY:Pe,blueX:ot,blueY:nt,whiteX:at,whiteY:V}}function Bt(G,Z){var he=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],we=Et(G,Z);return he[we]}function Qt(G,Z){var he=qe(G,Z),we=qe(G,Z),ze=qe(G,Z),Pe=qe(G,Z);return{xMin:he,yMin:we,xMax:ze,yMax:Pe}}function Fn(G,Z){var he=["INCREASING_Y"],we=Et(G,Z);return he[we]}function Cn(G,Z){var he=Dt(G,Z),we=Dt(G,Z);return[he,we]}function fa(G,Z){var he=Dt(G,Z),we=Dt(G,Z),ze=Dt(G,Z);return[he,we,ze]}function Va(G,Z,he,we,ze){if(we==="string"||we==="stringvector"||we==="iccProfile")return xt(Z,he,ze);if(we==="chlist")return tt(G,Z,he,ze);if(we==="chromaticities")return Je(G,he);if(we==="compression")return Bt(G,he);if(we==="box2i")return Qt(G,he);if(we==="lineOrder")return Fn(G,he);if(we==="float")return Dt(G,he);if(we==="v2f")return Cn(G,he);if(we==="v3f")return fa(G,he);if(we==="int")return Ye(G,he);if(we==="rational")return Vt(G,he);if(we==="timecode")return Lt(G,he);if(we==="preview")return he.value+=ze,"skipped";he.value+=ze}function zl(G,Z,he){const we={};if(G.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";we.version=G.getUint8(4);const ze=G.getUint8(5);we.spec={singleTile:!!(ze&2),longName:!!(ze&4),deepFormat:!!(ze&8),multiPart:!!(ze&16)},he.value=8;for(var Pe=!0;Pe;){var ot=Nt(Z,he);if(ot==0)Pe=!1;else{var nt=Nt(Z,he),at=qe(G,he),V=Va(G,Z,he,nt,at);V===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${nt}'.`):we[ot]=V}}if((ze&-5)!=0)throw console.error("EXRHeader:",we),"THREE.EXRLoader: provided file is currently unsupported.";return we}function go(G,Z,he,we,ze){const Pe={size:0,viewer:Z,array:he,offset:we,width:G.dataWindow.xMax-G.dataWindow.xMin+1,height:G.dataWindow.yMax-G.dataWindow.yMin+1,channels:G.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:G.channels[0].pixelType,uncompress:null,getter:null,format:null,[Om?"colorSpace":"encoding"]:null};switch(G.compression){case"NO_COMPRESSION":Pe.lines=1,Pe.uncompress=ee;break;case"RLE_COMPRESSION":Pe.lines=1,Pe.uncompress=X;break;case"ZIPS_COMPRESSION":Pe.lines=1,Pe.uncompress=Ae;break;case"ZIP_COMPRESSION":Pe.lines=16,Pe.uncompress=Ae;break;case"PIZ_COMPRESSION":Pe.lines=32,Pe.uncompress=He;break;case"PXR24_COMPRESSION":Pe.lines=16,Pe.uncompress=Ze;break;case"DWAA_COMPRESSION":Pe.lines=32,Pe.uncompress=Le;break;case"DWAB_COMPRESSION":Pe.lines=256,Pe.uncompress=Le;break;default:throw"EXRLoader.parse: "+G.compression+" is unsupported"}if(Pe.scanlineBlockSize=Pe.lines,Pe.type==1)switch(ze){case ji:Pe.getter=vt,Pe.inputSize=2;break;case wa:Pe.getter=ft,Pe.inputSize=2;break}else if(Pe.type==2)switch(ze){case ji:Pe.getter=Dt,Pe.inputSize=4;break;case wa:Pe.getter=pe,Pe.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Pe.type+" for "+G.compression+".";Pe.blockCount=(G.dataWindow.yMax+1)/Pe.scanlineBlockSize;for(var ot=0;ot<Pe.blockCount;ot++)gt(Z,we);Pe.outputChannels=Pe.channels==3?4:Pe.channels;const nt=Pe.width*Pe.height*Pe.outputChannels;switch(ze){case ji:Pe.byteArray=new Float32Array(nt),Pe.channels<Pe.outputChannels&&Pe.byteArray.fill(1,0,nt);break;case wa:Pe.byteArray=new Uint16Array(nt),Pe.channels<Pe.outputChannels&&Pe.byteArray.fill(15360,0,nt);break;default:console.error("THREE.EXRLoader: unsupported type: ",ze);break}return Pe.bytesPerLine=Pe.width*Pe.inputSize*Pe.channels,Pe.outputChannels==4?Pe.format=_a:Pe.format=vg,Om?Pe.colorSpace="srgb-linear":Pe.encoding=3e3,Pe}const sr=new DataView(e),ta=new Uint8Array(e),ms={value:0},ba=zl(sr,e,ms),en=go(ba,sr,ta,ms,this.type),ha={value:0},hn={R:0,G:1,B:2,A:3,Y:0};for(let G=0;G<en.height/en.scanlineBlockSize;G++){const Z=qe(sr,ms);en.size=qe(sr,ms),en.lines=Z+en.scanlineBlockSize>en.height?en.height-Z:en.scanlineBlockSize;const we=en.size<en.lines*en.bytesPerLine?en.uncompress(en):ee(en);ms.value+=en.size;for(let ze=0;ze<en.scanlineBlockSize;ze++){const Pe=ze+G*en.scanlineBlockSize;if(Pe>=en.height)break;for(let ot=0;ot<en.channels;ot++){const nt=hn[ba.channels[ot].name];for(let at=0;at<en.width;at++){ha.value=(ze*(en.channels*en.width)+ot*en.width+at)*en.inputSize;const V=(en.height-1-Pe)*(en.width*en.outputChannels)+at*en.outputChannels+nt;en.byteArray[V]=en.getter(we,ha)}}}}return{header:ba,width:en.width,height:en.height,data:en.byteArray,format:en.format,[Om?"colorSpace":"encoding"]:en[Om?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,a){function r(l,u){Om?l.colorSpace=u.colorSpace:l.encoding=u.encoding,l.minFilter=In,l.magFilter=In,l.generateMipmaps=!1,l.flipY=!1,t&&t(l,u)}return super.load(e,r,n,a)}}const Q1=new WeakMap;class W8 extends ds{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,a){const r=new hs(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,l=>{const u={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(l,u).then(t).catch(a)},n,a)}decodeDracoFile(e,t,n,a){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:a||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const d in t.attributeTypes){const p=t.attributeTypes[d];p.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[d]=p.name)}const n=JSON.stringify(t);if(Q1.has(e)){const d=Q1.get(e);if(d.key===n)return d.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let a;const r=this.workerNextTaskID++,l=e.byteLength,u=this._getWorker(r,l).then(d=>(a=d,new Promise((p,x)=>{a._callbacks[r]={resolve:p,reject:x},a.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(d=>this._createGeometry(d.geometry));return u.catch(()=>!0).then(()=>{a&&r&&this._releaseTask(a,r)}),Q1.set(e,{key:n,promise:u}),u}_createGeometry(e){const t=new rn;e.index&&t.setIndex(new Mn(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const a=e.attributes[n],r=a.name,l=a.array,u=a.itemSize;t.setAttribute(r,new Mn(l,u))}return t}_loadLibrary(e,t){const n=new hs(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((a,r)=>{n.load(e,a,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const a=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const r=Z8.toString(),l=["/* draco decoder */",a,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([l]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const a=new Worker(this.workerSourceURL);a._callbacks={},a._taskCosts={},a._taskLoad=0,a.postMessage({type:"init",decoderConfig:this.decoderConfig}),a.onmessage=function(r){const l=r.data;switch(l.type){case"decode":a._callbacks[l.id].resolve(l);break;case"error":a._callbacks[l.id].reject(l);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+l.type+'"')}},this.workerPool.push(a)}else this.workerPool.sort(function(a,r){return a._taskLoad>r._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Z8(){let i,e;onmessage=function(l){const u=l.data;switch(u.type){case"init":i=u.decoderConfig,e=new Promise(function(x){i.onModuleLoaded=function(g){x({draco:g})},DracoDecoderModule(i)});break;case"decode":const d=u.buffer,p=u.taskConfig;e.then(x=>{const g=x.draco,_=new g.Decoder,y=new g.DecoderBuffer;y.Init(new Int8Array(d),d.byteLength);try{const b=t(g,_,y,p),C=b.attributes.map(E=>E.array.buffer);b.index&&C.push(b.index.array.buffer),self.postMessage({type:"decode",id:u.id,geometry:b},C)}catch(b){console.error(b),self.postMessage({type:"error",id:u.id,error:b.message})}finally{g.destroy(y),g.destroy(_)}});break}};function t(l,u,d,p){const x=p.attributeIDs,g=p.attributeTypes;let _,y;const b=u.GetEncodedGeometryType(d);if(b===l.TRIANGULAR_MESH)_=new l.Mesh,y=u.DecodeBufferToMesh(d,_);else if(b===l.POINT_CLOUD)_=new l.PointCloud,y=u.DecodeBufferToPointCloud(d,_);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||_.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const C={index:null,attributes:[]};for(const E in x){const S=self[g[E]];let w,D;if(p.useUniqueIDs)D=x[E],w=u.GetAttributeByUniqueId(_,D);else{if(D=u.GetAttributeId(_,l[x[E]]),D===-1)continue;w=u.GetAttribute(_,D)}C.attributes.push(a(l,u,_,E,S,w))}return b===l.TRIANGULAR_MESH&&(C.index=n(l,u,_)),l.destroy(_),C}function n(l,u,d){const x=d.num_faces()*3,g=x*4,_=l._malloc(g);u.GetTrianglesUInt32Array(d,g,_);const y=new Uint32Array(l.HEAPF32.buffer,_,x).slice();return l._free(_),{array:y,itemSize:1}}function a(l,u,d,p,x,g){const _=g.num_components(),b=d.num_points()*_,C=b*x.BYTES_PER_ELEMENT,E=r(l,x),S=l._malloc(C);u.GetAttributeDataArrayForAllPoints(d,g,E,C,S);const w=new x(l.HEAPF32.buffer,S,b).slice();return l._free(S),{name:p,array:w,itemSize:_}}function r(l,u){switch(u){case Float32Array:return l.DT_FLOAT32;case Int8Array:return l.DT_INT8;case Int16Array:return l.DT_INT16;case Int32Array:return l.DT_INT32;case Uint8Array:return l.DT_UINT8;case Uint16Array:return l.DT_UINT16;case Uint32Array:return l.DT_UINT32}}}let Kx;const $1=()=>{if(Kx)return Kx;const i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let a=i;WebAssembly.validate(t)&&(a=e);let r;const l=WebAssembly.instantiate(u(a),{}).then(g=>{r=g.instance,r.exports.__wasm_call_ctors()});function u(g){const _=new Uint8Array(g.length);for(let b=0;b<g.length;++b){const C=g.charCodeAt(b);_[b]=C>96?C-71:C>64?C-65:C>47?C+4:C>46?63:62}let y=0;for(let b=0;b<g.length;++b)_[y++]=_[b]<60?n[_[b]]:(_[b]-60)*64+_[++b];return _.buffer.slice(0,y)}function d(g,_,y,b,C,E){const S=r.exports.sbrk,w=y+3&-4,D=S(w*b),U=S(C.length),F=new Uint8Array(r.exports.memory.buffer);F.set(C,U);const N=g(D,y,b,U,C.length);if(N===0&&E&&E(D,w,b),_.set(F.subarray(D,D+y*b)),S(D-S(0)),N!==0)throw new Error(`Malformed buffer data: ${N}`)}const p={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},x={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return Kx={ready:l,supported:!0,decodeVertexBuffer(g,_,y,b,C){d(r.exports.meshopt_decodeVertexBuffer,g,_,y,b,r.exports[p[C]])},decodeIndexBuffer(g,_,y,b){d(r.exports.meshopt_decodeIndexBuffer,g,_,y,b)},decodeIndexSequence(g,_,y,b){d(r.exports.meshopt_decodeIndexSequence,g,_,y,b)},decodeGltfBuffer(g,_,y,b,C,E){d(r.exports[x[C]],g,_,y,b,r.exports[p[E]])}},Kx};let Jx=null,RR="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function wR(i=!0,e=!0,t){return n=>{t&&t(n),i&&(Jx||(Jx=new W8),Jx.setDecoderPath(typeof i=="string"?i:RR),n.setDRACOLoader(Jx)),e&&n.setMeshoptDecoder(typeof $1=="function"?$1():$1)}}const Rg=(i,e,t,n)=>Oc(XS,i,wR(e,t,n));Rg.preload=(i,e,t,n)=>Oc.preload(XS,i,wR(e,t,n));Rg.clear=i=>Oc.clear(XS,i);Rg.setDecoderPath=i=>{RR=i};const Zi={LEFT:1,RIGHT:2,MIDDLE:4},De=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),hp={NONE:0,IN:1,OUT:-1};function sh(i){return i.isPerspectiveCamera}function Uu(i){return i.isOrthographicCamera}const Cu=Math.PI*2,mE=Math.PI/2,BR=1e-5,Nm=Math.PI/180;function ko(i,e,t){return Math.max(e,Math.min(t,i))}function wi(i,e=BR){return Math.abs(i)<e}function gi(i,e,t=BR){return wi(i-e,t)}function gE(i,e){return Math.round(i/e)*e}function Lm(i){return isFinite(i)?i:i<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Im(i){return Math.abs(i)<Number.MAX_VALUE?i:i*(1/0)}function Wx(i,e,t,n,a=1/0,r){n=Math.max(1e-4,n);const l=2/n,u=l*r,d=1/(1+u+.48*u*u+.235*u*u*u);let p=i-e;const x=e,g=a*n;p=ko(p,-g,g),e=i-p;const _=(t.value+l*p)*r;t.value=(t.value-l*_)*d;let y=e+(p+_)*d;return x-i>0==y>x&&(y=x,t.value=(y-x)/r),y}function vE(i,e,t,n,a=1/0,r,l){n=Math.max(1e-4,n);const u=2/n,d=u*r,p=1/(1+d+.48*d*d+.235*d*d*d);let x=e.x,g=e.y,_=e.z,y=i.x-x,b=i.y-g,C=i.z-_;const E=x,S=g,w=_,D=a*n,U=D*D,F=y*y+b*b+C*C;if(F>U){const re=Math.sqrt(F);y=y/re*D,b=b/re*D,C=C/re*D}x=i.x-y,g=i.y-b,_=i.z-C;const N=(t.x+u*y)*r,z=(t.y+u*b)*r,j=(t.z+u*C)*r;t.x=(t.x-u*N)*p,t.y=(t.y-u*z)*p,t.z=(t.z-u*j)*p,l.x=x+(y+N)*p,l.y=g+(b+z)*p,l.z=_+(C+j)*p;const L=E-i.x,P=S-i.y,q=w-i.z,ie=l.x-E,se=l.y-S,ae=l.z-w;return L*ie+P*se+q*ae>0&&(l.x=E,l.y=S,l.z=w,t.x=(l.x-E)/r,t.y=(l.y-S)/r,t.z=(l.z-w)/r),l}function eb(i,e){e.set(0,0),i.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=i.length,e.y/=i.length}function tb(i,e){return Uu(i)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class Q8{_listeners={};addEventListener(e,t){const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const a=this._listeners[e];if(a!==void 0){const r=a.indexOf(t);r!==-1&&a.splice(r,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const n=this._listeners[e.type];if(n!==void 0){e.target=this;const a=n.slice(0);for(let r=0,l=a.length;r<l;r++)a[r].call(this,e)}}}const $8="3.1.2",Zx=1/8,eF=/Mac/.test(globalThis?.navigator?.platform);let cn,xE,Qx,nb,gr,Sn,oi,dp,Pm,Nl,Ll,rh,_E,yE,Nr,pp,mp,bE,ib,SE,ab,sb,$x,tF=class Gb extends Q8{static install(e){cn=e.THREE,xE=Object.freeze(new cn.Vector3(0,0,0)),Qx=Object.freeze(new cn.Vector3(0,1,0)),nb=Object.freeze(new cn.Vector3(0,0,1)),gr=new cn.Vector2,Sn=new cn.Vector3,oi=new cn.Vector3,dp=new cn.Vector3,Pm=new cn.Vector3,Nl=new cn.Vector3,Ll=new cn.Vector3,rh=new cn.Vector3,_E=new cn.Vector3,yE=new cn.Vector3,Nr=new cn.Spherical,pp=new cn.Spherical,mp=new cn.Box3,bE=new cn.Box3,ib=new cn.Sphere,SE=new cn.Quaternion,ab=new cn.Quaternion,sb=new cn.Matrix4,$x=new cn.Raycaster}static get ACTION(){return De}minPolarAngle=0;maxPolarAngle=Math.PI;minAzimuthAngle=-1/0;maxAzimuthAngle=1/0;minDistance=Number.EPSILON;maxDistance=1/0;infinityDolly=!1;minZoom=.01;maxZoom=1/0;smoothTime=.25;draggingSmoothTime=.125;maxSpeed=1/0;azimuthRotateSpeed=1;polarRotateSpeed=1;dollySpeed=1;dollyDragInverted=!1;truckSpeed=2;dollyToCursor=!1;dragToOffset=!1;boundaryFriction=0;restThreshold=.01;colliderMeshes=[];mouseButtons;touches;cancel=()=>{};lockPointer;unlockPointer;_enabled=!0;_camera;_yAxisUpSpace;_yAxisUpSpaceInverse;_state=De.NONE;_domElement;_viewport=null;_target;_targetEnd;_focalOffset;_focalOffsetEnd;_spherical;_sphericalEnd;_lastDistance;_zoom;_zoomEnd;_lastZoom;_cameraUp0;_target0;_position0;_zoom0;_focalOffset0;_dollyControlCoord;_changedDolly=0;_changedZoom=0;_nearPlaneCorners;_hasRested=!0;_boundary;_boundaryEnclosesCamera=!1;_needsUpdate=!0;_updatedLastTime=!1;_elementRect=new DOMRect;_isDragging=!1;_dragNeedsUpdate=!0;_activePointers=[];_lockedPointer=null;_interactiveArea=new DOMRect(0,0,1,1);_isUserControllingRotate=!1;_isUserControllingDolly=!1;_isUserControllingTruck=!1;_isUserControllingOffset=!1;_isUserControllingZoom=!1;_lastDollyDirection=hp.NONE;_thetaVelocity={value:0};_phiVelocity={value:0};_radiusVelocity={value:0};_targetVelocity=new cn.Vector3;_focalOffsetVelocity=new cn.Vector3;_zoomVelocity={value:0};set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,t){super(),typeof cn>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new cn.Quaternion().setFromUnitVectors(this._camera.up,Qx),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=De.NONE,this._target=new cn.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new cn.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new cn.Spherical().setFromVector3(Sn.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new cn.Vector3,new cn.Vector3,new cn.Vector3,new cn.Vector3],this._updateNearPlaneCorners(),this._boundary=new cn.Box3(new cn.Vector3(-1/0,-1/0,-1/0),new cn.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new cn.Vector2,this.mouseButtons={left:De.ROTATE,middle:De.DOLLY,right:De.TRUCK,wheel:sh(this._camera)?De.DOLLY:Uu(this._camera)?De.ZOOM:De.NONE},this.touches={one:De.TOUCH_ROTATE,two:sh(this._camera)?De.TOUCH_DOLLY_TRUCK:Uu(this._camera)?De.TOUCH_ZOOM_TRUCK:De.NONE,three:De.TOUCH_TRUCK};const n=new cn.Vector2,a=new cn.Vector2,r=new cn.Vector2,l=S=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const U=this._domElement.getBoundingClientRect(),F=S.clientX/U.width,N=S.clientY/U.height;if(F<this._interactiveArea.left||F>this._interactiveArea.right||N<this._interactiveArea.top||N>this._interactiveArea.bottom)return}const w=S.pointerType!=="mouse"?null:(S.buttons&Zi.LEFT)===Zi.LEFT?Zi.LEFT:(S.buttons&Zi.MIDDLE)===Zi.MIDDLE?Zi.MIDDLE:(S.buttons&Zi.RIGHT)===Zi.RIGHT?Zi.RIGHT:null;if(w!==null){const U=this._findPointerByMouseButton(w);U&&this._disposePointer(U)}if((S.buttons&Zi.LEFT)===Zi.LEFT&&this._lockedPointer)return;const D={pointerId:S.pointerId,clientX:S.clientX,clientY:S.clientY,deltaX:0,deltaY:0,mouseButton:w};this._activePointers.push(D),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.addEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",d),this._isDragging=!0,_(S)},u=S=>{S.cancelable&&S.preventDefault();const w=S.pointerId,D=this._lockedPointer||this._findPointerById(w);if(D){if(D.clientX=S.clientX,D.clientY=S.clientY,D.deltaX=S.movementX,D.deltaY=S.movementY,this._state=0,S.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(S.buttons&Zi.LEFT)===Zi.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(S.buttons&Zi.MIDDLE)===Zi.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(S.buttons&Zi.RIGHT)===Zi.RIGHT&&(this._state=this._state|this.mouseButtons.right);y()}},d=S=>{const w=this._findPointerById(S.pointerId);if(!(w&&w===this._lockedPointer)){if(w&&this._disposePointer(w),S.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=De.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=De.NONE;b()}};let p=-1;const x=S=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===De.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const z=this._domElement.getBoundingClientRect(),j=S.clientX/z.width,L=S.clientY/z.height;if(j<this._interactiveArea.left||j>this._interactiveArea.right||L<this._interactiveArea.top||L>this._interactiveArea.bottom)return}if(S.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===De.ROTATE||this.mouseButtons.wheel===De.TRUCK){const z=performance.now();p-z<1e3&&this._getClientRect(this._elementRect),p=z}const w=eF?-1:-3,D=S.deltaMode===1&&!S.ctrlKey?S.deltaY/w:S.deltaY/(w*10),U=this.dollyToCursor?(S.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,F=this.dollyToCursor?(S.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(S.ctrlKey?De.ZOOM:this.mouseButtons.wheel){case De.ROTATE:{this._rotateInternal(S.deltaX,S.deltaY),this._isUserControllingRotate=!0;break}case De.TRUCK:{this._truckInternal(S.deltaX,S.deltaY,!1,!1),this._isUserControllingTruck=!0;break}case De.SCREEN_PAN:{this._truckInternal(S.deltaX,S.deltaY,!1,!0),this._isUserControllingTruck=!0;break}case De.OFFSET:{this._truckInternal(S.deltaX,S.deltaY,!0,!1),this._isUserControllingOffset=!0;break}case De.DOLLY:{this._dollyInternal(-D,U,F),this._isUserControllingDolly=!0;break}case De.ZOOM:{this._zoomInternal(-D,U,F),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},g=S=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===Gb.ACTION.NONE){const w=S instanceof PointerEvent?S.pointerId:0,D=this._findPointerById(w);D&&this._disposePointer(D),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d);return}S.preventDefault()}},_=S=>{if(!this._enabled)return;if(eb(this._activePointers,gr),this._getClientRect(this._elementRect),n.copy(gr),a.copy(gr),this._activePointers.length>=2){const D=gr.x-this._activePointers[1].clientX,U=gr.y-this._activePointers[1].clientY,F=Math.sqrt(D*D+U*U);r.set(0,F);const N=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,z=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;a.set(N,z)}if(this._state=0,!S)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in S&&S.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(S.buttons&Zi.LEFT)===Zi.LEFT&&(this._state=this._state|this.mouseButtons.left),(S.buttons&Zi.MIDDLE)===Zi.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(S.buttons&Zi.RIGHT)===Zi.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&De.ROTATE)===De.ROTATE||(this._state&De.TOUCH_ROTATE)===De.TOUCH_ROTATE||(this._state&De.TOUCH_DOLLY_ROTATE)===De.TOUCH_DOLLY_ROTATE||(this._state&De.TOUCH_ZOOM_ROTATE)===De.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&De.TRUCK)===De.TRUCK||(this._state&De.SCREEN_PAN)===De.SCREEN_PAN||(this._state&De.TOUCH_TRUCK)===De.TOUCH_TRUCK||(this._state&De.TOUCH_SCREEN_PAN)===De.TOUCH_SCREEN_PAN||(this._state&De.TOUCH_DOLLY_TRUCK)===De.TOUCH_DOLLY_TRUCK||(this._state&De.TOUCH_DOLLY_SCREEN_PAN)===De.TOUCH_DOLLY_SCREEN_PAN||(this._state&De.TOUCH_ZOOM_TRUCK)===De.TOUCH_ZOOM_TRUCK||(this._state&De.TOUCH_ZOOM_SCREEN_PAN)===De.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&De.DOLLY)===De.DOLLY||(this._state&De.TOUCH_DOLLY)===De.TOUCH_DOLLY||(this._state&De.TOUCH_DOLLY_TRUCK)===De.TOUCH_DOLLY_TRUCK||(this._state&De.TOUCH_DOLLY_SCREEN_PAN)===De.TOUCH_DOLLY_SCREEN_PAN||(this._state&De.TOUCH_DOLLY_OFFSET)===De.TOUCH_DOLLY_OFFSET||(this._state&De.TOUCH_DOLLY_ROTATE)===De.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&De.ZOOM)===De.ZOOM||(this._state&De.TOUCH_ZOOM)===De.TOUCH_ZOOM||(this._state&De.TOUCH_ZOOM_TRUCK)===De.TOUCH_ZOOM_TRUCK||(this._state&De.TOUCH_ZOOM_SCREEN_PAN)===De.TOUCH_ZOOM_SCREEN_PAN||(this._state&De.TOUCH_ZOOM_OFFSET)===De.TOUCH_ZOOM_OFFSET||(this._state&De.TOUCH_ZOOM_ROTATE)===De.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&De.OFFSET)===De.OFFSET||(this._state&De.TOUCH_OFFSET)===De.TOUCH_OFFSET||(this._state&De.TOUCH_DOLLY_OFFSET)===De.TOUCH_DOLLY_OFFSET||(this._state&De.TOUCH_ZOOM_OFFSET)===De.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},y=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,eb(this._activePointers,gr);const w=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,D=w?-w.deltaX:a.x-gr.x,U=w?-w.deltaY:a.y-gr.y;if(a.copy(gr),((this._state&De.ROTATE)===De.ROTATE||(this._state&De.TOUCH_ROTATE)===De.TOUCH_ROTATE||(this._state&De.TOUCH_DOLLY_ROTATE)===De.TOUCH_DOLLY_ROTATE||(this._state&De.TOUCH_ZOOM_ROTATE)===De.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(D,U),this._isUserControllingRotate=!0),(this._state&De.DOLLY)===De.DOLLY||(this._state&De.ZOOM)===De.ZOOM){const F=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,N=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,z=this.dollyDragInverted?-1:1;(this._state&De.DOLLY)===De.DOLLY?(this._dollyInternal(z*U*Zx,F,N),this._isUserControllingDolly=!0):(this._zoomInternal(z*U*Zx,F,N),this._isUserControllingZoom=!0)}if((this._state&De.TOUCH_DOLLY)===De.TOUCH_DOLLY||(this._state&De.TOUCH_ZOOM)===De.TOUCH_ZOOM||(this._state&De.TOUCH_DOLLY_TRUCK)===De.TOUCH_DOLLY_TRUCK||(this._state&De.TOUCH_ZOOM_TRUCK)===De.TOUCH_ZOOM_TRUCK||(this._state&De.TOUCH_DOLLY_SCREEN_PAN)===De.TOUCH_DOLLY_SCREEN_PAN||(this._state&De.TOUCH_ZOOM_SCREEN_PAN)===De.TOUCH_ZOOM_SCREEN_PAN||(this._state&De.TOUCH_DOLLY_OFFSET)===De.TOUCH_DOLLY_OFFSET||(this._state&De.TOUCH_ZOOM_OFFSET)===De.TOUCH_ZOOM_OFFSET||(this._state&De.TOUCH_DOLLY_ROTATE)===De.TOUCH_DOLLY_ROTATE||(this._state&De.TOUCH_ZOOM_ROTATE)===De.TOUCH_ZOOM_ROTATE){const F=gr.x-this._activePointers[1].clientX,N=gr.y-this._activePointers[1].clientY,z=Math.sqrt(F*F+N*N),j=r.y-z;r.set(0,z);const L=this.dollyToCursor?(a.x-this._elementRect.x)/this._elementRect.width*2-1:0,P=this.dollyToCursor?(a.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&De.TOUCH_DOLLY)===De.TOUCH_DOLLY||(this._state&De.TOUCH_DOLLY_ROTATE)===De.TOUCH_DOLLY_ROTATE||(this._state&De.TOUCH_DOLLY_TRUCK)===De.TOUCH_DOLLY_TRUCK||(this._state&De.TOUCH_DOLLY_SCREEN_PAN)===De.TOUCH_DOLLY_SCREEN_PAN||(this._state&De.TOUCH_DOLLY_OFFSET)===De.TOUCH_DOLLY_OFFSET?(this._dollyInternal(j*Zx,L,P),this._isUserControllingDolly=!0):(this._zoomInternal(j*Zx,L,P),this._isUserControllingZoom=!0)}((this._state&De.TRUCK)===De.TRUCK||(this._state&De.TOUCH_TRUCK)===De.TOUCH_TRUCK||(this._state&De.TOUCH_DOLLY_TRUCK)===De.TOUCH_DOLLY_TRUCK||(this._state&De.TOUCH_ZOOM_TRUCK)===De.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(D,U,!1,!1),this._isUserControllingTruck=!0),((this._state&De.SCREEN_PAN)===De.SCREEN_PAN||(this._state&De.TOUCH_SCREEN_PAN)===De.TOUCH_SCREEN_PAN||(this._state&De.TOUCH_DOLLY_SCREEN_PAN)===De.TOUCH_DOLLY_SCREEN_PAN||(this._state&De.TOUCH_ZOOM_SCREEN_PAN)===De.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(D,U,!1,!0),this._isUserControllingTruck=!0),((this._state&De.OFFSET)===De.OFFSET||(this._state&De.TOUCH_OFFSET)===De.TOUCH_OFFSET||(this._state&De.TOUCH_DOLLY_OFFSET)===De.TOUCH_DOLLY_OFFSET||(this._state&De.TOUCH_ZOOM_OFFSET)===De.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(D,U,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},b=()=>{eb(this._activePointers,gr),a.copy(gr),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",C),this._domElement.ownerDocument.addEventListener("pointerlockerror",E),this._domElement.ownerDocument.addEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",d),_())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),this._domElement?.ownerDocument.exitPointerLock(),this._domElement?.ownerDocument.removeEventListener("pointerlockchange",C),this._domElement?.ownerDocument.removeEventListener("pointerlockerror",E),this.cancel()};const C=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},E=()=>{this.unlockPointer()};this._addAllEventListeners=S=>{this._domElement=S,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",l),this._domElement.addEventListener("pointercancel",d),this._domElement.addEventListener("wheel",x,{passive:!1}),this._domElement.addEventListener("contextmenu",g)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",l),this._domElement.removeEventListener("pointercancel",d),this._domElement.removeEventListener("wheel",x,{passive:!1}),this._domElement.removeEventListener("contextmenu",g),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.removeEventListener("pointerlockchange",C),this._domElement.ownerDocument.removeEventListener("pointerlockerror",E))},this.cancel=()=>{this._state!==De.NONE&&(this._state=De.NONE,this._activePointers.length=0,b())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=ko(e.width,0,1),this._interactiveArea.height=ko(e.height,0,1),this._interactiveArea.x=ko(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=ko(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const a=ko(e,this.minAzimuthAngle,this.maxAzimuthAngle),r=ko(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=a,this._sphericalEnd.phi=r,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const l=!n||gi(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&gi(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(l)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=hp.NONE,this._changedDolly=0,this._dollyToNoClamp(ko(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const l=this._collisionTest(),u=gi(l,this._spherical.radius);if(!(n>e)&&u)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,l)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const r=!t||gi(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(r)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Pm).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||gi(this._target.x,this._targetEnd.x,this.restThreshold)&&gi(this._target.y,this._targetEnd.y,this.restThreshold)&&gi(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=ko(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||gi(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),Nl.setFromMatrixColumn(this._camera.matrix,0),Ll.setFromMatrixColumn(this._camera.matrix,1),Nl.multiplyScalar(e),Ll.multiplyScalar(-t);const a=Sn.copy(Nl).add(Ll),r=oi.copy(this._targetEnd).add(a);return this.moveTo(r.x,r.y,r.z,n)}forward(e,t=!1){Sn.setFromMatrixColumn(this._camera.matrix,0),Sn.crossVectors(this._camera.up,Sn),Sn.multiplyScalar(e);const n=oi.copy(this._targetEnd).add(Sn);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return Sn.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+Sn.x,this._targetEnd.y+Sn.y,this._targetEnd.z+Sn.z,t)}moveTo(e,t,n,a=!1){this._isUserControllingTruck=!1;const r=Sn.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),this._needsUpdate=!0,a||this._target.copy(this._targetEnd);const l=!a||gi(this._target.x,this._targetEnd.x,this.restThreshold)&&gi(this._target.y,this._targetEnd.y,this.restThreshold)&&gi(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(l)}lookInDirectionOf(e,t,n,a=!1){const u=Sn.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(u.x,u.y,u.z,a)}fitToBox(e,t,{cover:n=!1,paddingLeft:a=0,paddingRight:r=0,paddingBottom:l=0,paddingTop:u=0}={}){const d=[],p=e.isBox3?mp.copy(e):mp.setFromObject(e);p.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const x=gE(this._sphericalEnd.theta,mE),g=gE(this._sphericalEnd.phi,mE);d.push(this.rotateTo(x,g,t));const _=Sn.setFromSpherical(this._sphericalEnd).normalize(),y=SE.setFromUnitVectors(_,nb),b=gi(Math.abs(_.y),1);b&&y.multiply(ab.setFromAxisAngle(Qx,x)),y.multiply(this._yAxisUpSpaceInverse);const C=bE.makeEmpty();oi.copy(p.min).applyQuaternion(y),C.expandByPoint(oi),oi.copy(p.min).setX(p.max.x).applyQuaternion(y),C.expandByPoint(oi),oi.copy(p.min).setY(p.max.y).applyQuaternion(y),C.expandByPoint(oi),oi.copy(p.max).setZ(p.min.z).applyQuaternion(y),C.expandByPoint(oi),oi.copy(p.min).setZ(p.max.z).applyQuaternion(y),C.expandByPoint(oi),oi.copy(p.max).setY(p.min.y).applyQuaternion(y),C.expandByPoint(oi),oi.copy(p.max).setX(p.min.x).applyQuaternion(y),C.expandByPoint(oi),oi.copy(p.max).applyQuaternion(y),C.expandByPoint(oi),C.min.x-=a,C.min.y-=l,C.max.x+=r,C.max.y+=u,y.setFromUnitVectors(nb,_),b&&y.premultiply(ab.invert()),y.premultiply(this._yAxisUpSpace);const E=C.getSize(Sn),S=C.getCenter(oi).applyQuaternion(y);if(sh(this._camera)){const w=this.getDistanceToFitBox(E.x,E.y,E.z,n);d.push(this.moveTo(S.x,S.y,S.z,t)),d.push(this.dollyTo(w,t)),d.push(this.setFocalOffset(0,0,0,t))}else if(Uu(this._camera)){const w=this._camera,D=w.right-w.left,U=w.top-w.bottom,F=n?Math.max(D/E.x,U/E.y):Math.min(D/E.x,U/E.y);d.push(this.moveTo(S.x,S.y,S.z,t)),d.push(this.zoomTo(F,t)),d.push(this.setFocalOffset(0,0,0,t))}return Promise.all(d)}fitToSphere(e,t){const n=[],r="isObject3D"in e?Gb.createBoundingSphere(e,ib):ib.copy(e);if(n.push(this.moveTo(r.center.x,r.center.y,r.center.z,t)),sh(this._camera)){const l=this.getDistanceToFitSphere(r.radius);n.push(this.dollyTo(l,t))}else if(Uu(this._camera)){const l=this._camera.right-this._camera.left,u=this._camera.top-this._camera.bottom,d=2*r.radius,p=Math.min(l/d,u/d);n.push(this.zoomTo(p,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,a,r,l,u=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=hp.NONE,this._changedDolly=0;const d=oi.set(a,r,l),p=Sn.set(e,t,n);this._targetEnd.copy(d),this._sphericalEnd.setFromVector3(p.sub(d).applyQuaternion(this._yAxisUpSpace)),this._needsUpdate=!0,u||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const x=!u||gi(this._target.x,this._targetEnd.x,this.restThreshold)&&gi(this._target.y,this._targetEnd.y,this.restThreshold)&&gi(this._target.z,this._targetEnd.z,this.restThreshold)&&gi(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&gi(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&gi(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(x)}lerp(e,t,n,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=hp.NONE,this._changedDolly=0;const r=Sn.set(...e.target);if("spherical"in e)Nr.set(...e.spherical);else{const g=oi.set(...e.position);Nr.setFromVector3(g.sub(r).applyQuaternion(this._yAxisUpSpace))}const l=dp.set(...t.target);if("spherical"in t)pp.set(...t.spherical);else{const g=oi.set(...t.position);pp.setFromVector3(g.sub(l).applyQuaternion(this._yAxisUpSpace))}this._targetEnd.copy(r.lerp(l,n));const u=pp.theta-Nr.theta,d=pp.phi-Nr.phi,p=pp.radius-Nr.radius;this._sphericalEnd.set(Nr.radius+p*n,Nr.phi+d*n,Nr.theta+u*n),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const x=!a||gi(this._target.x,this._targetEnd.x,this.restThreshold)&&gi(this._target.y,this._targetEnd.y,this.restThreshold)&&gi(this._target.z,this._targetEnd.z,this.restThreshold)&&gi(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&gi(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&gi(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(x)}lerpLookAt(e,t,n,a,r,l,u,d,p,x,g,_,y,b=!1){return this.lerp({position:[e,t,n],target:[a,r,l]},{position:[u,d,p],target:[x,g,_]},y,b)}setPosition(e,t,n,a=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,a)}setTarget(e,t,n,a=!1){const r=this.getPosition(Sn),l=this.setLookAt(r.x,r.y,r.z,e,t,n,a);return this._sphericalEnd.phi=ko(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),l}setFocalOffset(e,t,n,a=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,a||this._focalOffset.copy(this._focalOffsetEnd);const r=!a||gi(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&gi(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&gi(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),Nl.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Ll.setFromMatrixColumn(this._camera.matrixWorldInverse,1),rh.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const a=Sn.set(e,t,n),r=a.distanceTo(this._camera.position),l=a.sub(this._camera.position);Nl.multiplyScalar(l.x),Ll.multiplyScalar(l.y),rh.multiplyScalar(l.z),Sn.copy(Nl).add(Ll).add(rh),Sn.z=Sn.z+r,this.dollyTo(r,!1),this.setFocalOffset(-Sn.x,Sn.y,-Sn.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,a){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new cn.Vector4,typeof e=="number"?this._viewport.set(e,t,n,a):this._viewport.copy(e)}getDistanceToFitBox(e,t,n,a=!1){if(tb(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const r=e/t,l=this._camera.getEffectiveFOV()*Nm,u=this._camera.aspect;return((a?r>u:r<u)?t:e/u)*.5/Math.tan(l*.5)+n*.5}getDistanceToFitSphere(e){if(tb(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*Nm,n=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,a=1<this._camera.aspect?t:n;return e/Math.sin(a*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new cn.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new cn.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new cn.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new cn.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){return this._sphericalEnd.theta=(this._sphericalEnd.theta%Cu+Cu)%Cu,this._sphericalEnd.theta>Math.PI&&(this._sphericalEnd.theta-=Cu),this._spherical.theta+=Cu*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Cu),this}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!gi(this._camera.up.x,this._cameraUp0.x)||!gi(this._camera.up.y,this._cameraUp0.y)||!gi(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const n=this.getPosition(Sn);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,Qx),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=Sn.subVectors(this._target,this._camera.position).normalize(),t=oi.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(Sn);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,a=this._sphericalEnd.radius-this._spherical.radius,r=_E.subVectors(this._targetEnd,this._target),l=yE.subVectors(this._focalOffsetEnd,this._focalOffset),u=this._zoomEnd-this._zoom;if(wi(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const g=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Wx(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,g,1/0,e),this._needsUpdate=!0}if(wi(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const g=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Wx(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,g,1/0,e),this._needsUpdate=!0}if(wi(a))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const g=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Wx(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,g,this.maxSpeed,e),this._needsUpdate=!0}if(wi(r.x)&&wi(r.y)&&wi(r.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const g=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;vE(this._target,this._targetEnd,this._targetVelocity,g,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(wi(l.x)&&wi(l.y)&&wi(l.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const g=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;vE(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,g,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(wi(u))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const g=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Wx(this._zoom,this._zoomEnd,this._zoomVelocity,g,1/0,e)}if(this.dollyToCursor){if(sh(this._camera)&&this._changedDolly!==0){const g=this._spherical.radius-this._lastDistance,_=this._camera,y=this._getCameraDirection(Pm),b=Sn.copy(y).cross(_.up).normalize();b.lengthSq()===0&&(b.x=1);const C=oi.crossVectors(b,y),E=this._sphericalEnd.radius*Math.tan(_.getEffectiveFOV()*Nm*.5),w=(this._sphericalEnd.radius-g-this._sphericalEnd.radius)/this._sphericalEnd.radius,D=dp.copy(this._targetEnd).add(b.multiplyScalar(this._dollyControlCoord.x*E*_.aspect)).add(C.multiplyScalar(this._dollyControlCoord.y*E)),U=Sn.copy(this._targetEnd).lerp(D,w),F=this._lastDollyDirection===hp.IN&&this._spherical.radius<=this.minDistance,N=this._lastDollyDirection===hp.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(F||N)){this._sphericalEnd.radius-=g,this._spherical.radius-=g;const j=oi.copy(y).multiplyScalar(-g);U.add(j)}this._boundary.clampPoint(U,U);const z=oi.subVectors(U,this._targetEnd);this._targetEnd.copy(U),this._target.add(z),this._changedDolly-=g,wi(this._changedDolly)&&(this._changedDolly=0)}else if(Uu(this._camera)&&this._changedZoom!==0){const g=this._zoom-this._lastZoom,_=this._camera,y=Sn.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(_.near+_.far)/(_.near-_.far)).unproject(_),b=oi.set(0,0,-1).applyQuaternion(_.quaternion),C=dp.copy(y).add(b.multiplyScalar(-y.dot(_.up))),S=-(this._zoom-g-this._zoom)/this._zoom,w=this._getCameraDirection(Pm),D=this._targetEnd.dot(w),U=Sn.copy(this._targetEnd).lerp(C,S),F=U.dot(w),N=w.multiplyScalar(F-D);U.sub(N),this._boundary.clampPoint(U,U);const z=oi.subVectors(U,this._targetEnd);this._targetEnd.copy(U),this._target.add(z),this._changedZoom-=g,wi(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const d=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,d),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!wi(this._focalOffset.x)||!wi(this._focalOffset.y)||!wi(this._focalOffset.z))&&(this._camera.matrix.compose(this._camera.position,this._camera.quaternion,this._camera.scale),Nl.setFromMatrixColumn(this._camera.matrix,0),Ll.setFromMatrixColumn(this._camera.matrix,1),rh.setFromMatrixColumn(this._camera.matrix,2),Nl.multiplyScalar(this._focalOffset.x),Ll.multiplyScalar(-this._focalOffset.y),rh.multiplyScalar(this._focalOffset.z),Sn.copy(Nl).add(Ll).add(rh),this._camera.position.add(Sn),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Sn.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const x=this._needsUpdate;return x&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):x?(this.dispatchEvent({type:"update"}),wi(t,this.restThreshold)&&wi(n,this.restThreshold)&&wi(a,this.restThreshold)&&wi(r.x,this.restThreshold)&&wi(r.y,this.restThreshold)&&wi(r.z,this.restThreshold)&&wi(l.x,this.restThreshold)&&wi(l.y,this.restThreshold)&&wi(l.z,this.restThreshold)&&wi(u,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!x&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=x,this._needsUpdate=!1,x}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Lm(this.maxDistance),minZoom:this.minZoom,maxZoom:Lm(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Lm(this.maxPolarAngle),minAzimuthAngle:Lm(this.minAzimuthAngle),maxAzimuthAngle:Lm(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:Sn.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=Im(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=Im(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=Im(n.maxPolarAngle),this.minAzimuthAngle=Im(n.minAzimuthAngle),this.maxAzimuthAngle=Im(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),Nr.setFromVector3(Sn.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Nr.theta,Nr.phi,t),this.dollyTo(Nr.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",$8),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const a=t.lengthSq();if(a===0)return e;const r=oi.copy(t).add(e),u=this._boundary.clampPoint(r,dp).sub(r),d=u.lengthSq();if(d===0)return e.add(t);if(d===a)return e;if(n===0)return e.add(t).add(u);{const p=1+n*d/t.dot(u);return e.add(oi.copy(t).multiplyScalar(p)).add(u.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(sh(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*Nm,a=Math.tan(n*.5)*t,r=a*e.aspect;this._nearPlaneCorners[0].set(-r,-a,0),this._nearPlaneCorners[1].set(r,-a,0),this._nearPlaneCorners[2].set(r,a,0),this._nearPlaneCorners[3].set(-r,a,0)}else if(Uu(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,a=e.right*t,r=e.top*t,l=e.bottom*t;this._nearPlaneCorners[0].set(n,r,0),this._nearPlaneCorners[1].set(a,r,0),this._nearPlaneCorners[2].set(a,l,0),this._nearPlaneCorners[3].set(n,l,0)}}_truckInternal=(e,t,n,a)=>{let r,l;if(sh(this._camera)){const u=Sn.copy(this._camera.position).sub(this._target),d=this._camera.getEffectiveFOV()*Nm,p=u.length()*Math.tan(d*.5);r=this.truckSpeed*e*p/this._elementRect.height,l=this.truckSpeed*t*p/this._elementRect.height}else if(Uu(this._camera)){const u=this._camera;r=this.truckSpeed*e*(u.right-u.left)/u.zoom/this._elementRect.width,l=this.truckSpeed*t*(u.top-u.bottom)/u.zoom/this._elementRect.height}else return;a?(n?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(r,0,!0),this.forward(-l,!0)):n?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y+l,this._focalOffsetEnd.z,!0):this.truck(r,l,!0)};_rotateInternal=(e,t)=>{const n=Cu*this.azimuthRotateSpeed*e/this._elementRect.height,a=Cu*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(n,a,!0)};_dollyInternal=(e,t,n)=>{const a=Math.pow(.95,-e*this.dollySpeed),r=this._sphericalEnd.radius,l=this._sphericalEnd.radius*a,u=ko(l,this.minDistance,this.maxDistance),d=u-l;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(l,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(d,!0),this._dollyToNoClamp(u,!0)):this._dollyToNoClamp(u,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?l:u)-r,this._dollyControlCoord.set(t,n)),this._lastDollyDirection=Math.sign(-e)};_zoomInternal=(e,t,n)=>{const a=Math.pow(.95,e*this.dollySpeed),r=this._zoom,l=this._zoom*a;this.zoomTo(l,!0),this.dollyToCursor&&(this._changedZoom+=l-r,this._dollyControlCoord.set(t,n))};_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||tb(this._camera,"_collisionTest"))return e;const n=this._getTargetDirection(Pm);sb.lookAt(xE,n,this._camera.up);for(let a=0;a<4;a++){const r=oi.copy(this._nearPlaneCorners[a]);r.applyMatrix4(sb);const l=dp.addVectors(this._target,r);$x.set(l,n),$x.far=this._spherical.radius+1;const u=$x.intersectObjects(this.colliderMeshes);u.length!==0&&u[0].distance<e&&(e=u[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const n=()=>{this.removeEventListener("rest",n),t()};this.addEventListener("rest",n)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new cn.Sphere){const n=t,a=n.center;mp.makeEmpty(),e.traverseVisible(l=>{l.isMesh&&mp.expandByObject(l)}),mp.getCenter(a);let r=0;return e.traverseVisible(l=>{if(!l.isMesh)return;const u=l;if(!u.geometry)return;const d=u.geometry.clone();d.applyMatrix4(u.matrixWorld);const x=d.attributes.position;for(let g=0,_=x.count;g<_;g++)Sn.fromBufferAttribute(x,g),r=Math.max(r,a.distanceToSquared(Sn))}),n.radius=Math.sqrt(r),n}};const nF=k.forwardRef((i,e)=>{const{impl:t,camera:n,domElement:a,makeDefault:r,onControlStart:l,onControl:u,onControlEnd:d,onTransitionStart:p,onUpdate:x,onWake:g,onRest:_,onSleep:y,onStart:b,onEnd:C,onChange:E,regress:S,...w}=i,D=t??tF;k.useMemo(()=>{const re={Box3:ns,MathUtils:{clamp:iS.clamp},Matrix4:Wt,Quaternion:ts,Raycaster:Xy,Sphere:za,Spherical:FC,Vector2:Ge,Vector3:te,Vector4:kn};D.install({THREE:re}),Jy({CameraControlsImpl:D})},[D]);const U=tr(re=>re.camera),F=tr(re=>re.gl),N=tr(re=>re.invalidate),z=tr(re=>re.events),j=tr(re=>re.setEvents),L=tr(re=>re.set),P=tr(re=>re.get),q=tr(re=>re.performance),ie=n||U,se=a||z.connected||F.domElement,ae=k.useMemo(()=>new D(ie),[D,ie]);return Ns((re,H)=>{ae.update(H)},-1),k.useEffect(()=>(ae.connect(se),()=>void ae.disconnect()),[se,ae]),k.useEffect(()=>{function re(){N(),S&&q.regress()}const H=Me=>{re(),l?.(Me),b?.(Me)},K=Me=>{re(),u?.(Me),E?.(Me)},W=Me=>{d?.(Me),C?.(Me)},me=Me=>{re(),p?.(Me),E?.(Me)},ve=Me=>{re(),x?.(Me),E?.(Me)},Q=Me=>{re(),g?.(Me),E?.(Me)},de=Me=>{_?.(Me)},Te=Me=>{y?.(Me)};return ae.addEventListener("controlstart",H),ae.addEventListener("control",K),ae.addEventListener("controlend",W),ae.addEventListener("transitionstart",me),ae.addEventListener("update",ve),ae.addEventListener("wake",Q),ae.addEventListener("rest",de),ae.addEventListener("sleep",Te),()=>{ae.removeEventListener("controlstart",H),ae.removeEventListener("control",K),ae.removeEventListener("controlend",W),ae.removeEventListener("transitionstart",me),ae.removeEventListener("update",ve),ae.removeEventListener("wake",Q),ae.removeEventListener("rest",de),ae.removeEventListener("sleep",Te)}},[ae,N,j,S,q,l,u,d,p,x,g,_,y,E,b,C]),k.useEffect(()=>{if(r){const re=P().controls;return L({controls:ae}),()=>L({controls:re})}},[r,ae]),k.createElement("primitive",sy({ref:e,object:ae},w))});function iF(i,e){const t=k.useRef(null),[n]=k.useState(()=>e?e instanceof Pn?{current:e}:e:t),[a]=k.useState(()=>new LS(void 0));k.useLayoutEffect(()=>{e&&(n.current=e instanceof Pn?e:e.current),a._root=n.current});const r=k.useRef({}),l=k.useMemo(()=>{const u={};return i.forEach(d=>Object.defineProperty(u,d.name,{enumerable:!0,get(){if(n.current)return r.current[d.name]||(r.current[d.name]=a.clipAction(d,n.current))},configurable:!0})),{ref:n,clips:i,actions:u,names:i.map(d=>d.name),mixer:a}},[i]);return Ns((u,d)=>a.update(d)),k.useEffect(()=>{const u=n.current;return()=>{r.current={},a.stopAllAction(),Object.values(l.actions).forEach(d=>{u&&a.uncacheAction(d,u)})}},[i]),l}const DR=(i,e,t)=>{let n;switch(i){case ca:n=new Uint8ClampedArray(e*t*4);break;case wa:n=new Uint16Array(e*t*4);break;case Zo:n=new Uint32Array(e*t*4);break;case py:n=new Int8Array(e*t*4);break;case my:n=new Int16Array(e*t*4);break;case gg:n=new Int32Array(e*t*4);break;case ji:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let e_;const aF=(i,e,t,n)=>{if(e_!==void 0)return e_;const a=new ua(1,1,n);e.setRenderTarget(a);const r=new Xi(new Ju,new $a({color:16777215}));e.render(r,t),e.setRenderTarget(null);const l=DR(i,a.width,a.height);return e.readRenderTargetPixels(a,0,0,a.width,a.height,l),a.dispose(),r.geometry.dispose(),r.material.dispose(),e_=l[0]!==0,e_};class YS{_renderer;_rendererIsDisposable=!1;_material;_scene;_camera;_quad;_renderTarget;_width;_height;_type;_colorSpace;_supportsReadPixels=!0;constructor(e){this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:_a,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:e.renderTargetOptions?.anisotropy!==void 0?e.renderTargetOptions?.anisotropy:1,generateMipmaps:e.renderTargetOptions?.generateMipmaps!==void 0?e.renderTargetOptions?.generateMipmaps:!1,magFilter:e.renderTargetOptions?.magFilter!==void 0?e.renderTargetOptions?.magFilter:In,minFilter:e.renderTargetOptions?.minFilter!==void 0?e.renderTargetOptions?.minFilter:In,samples:e.renderTargetOptions?.samples!==void 0?e.renderTargetOptions?.samples:void 0,wrapS:e.renderTargetOptions?.wrapS!==void 0?e.renderTargetOptions?.wrapS:ea,wrapT:e.renderTargetOptions?.wrapT!==void 0?e.renderTargetOptions?.wrapT:ea};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=YS.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Mh,this._camera=new Zu,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!aF(this._type,this._renderer,this._camera,t)){let n;switch(this._type){case wa:n=this._renderer.extensions.has("EXT_color_buffer_float")?ji:void 0;break}n!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${ji}`),this._type=n):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Xi(new Ju,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new ua(this.width,this.height,t),this._renderTarget.texture.mapping=e.renderTargetOptions?.mapping!==void 0?e.renderTargetOptions?.mapping:zu}static instantiateRenderer(){const e=new PS;return e.setSize(128,128),e}render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)};toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=DR(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new ho(this.toArray(),this.width,this.height,_a,this._type,e?.mapping||zu,e?.wrapS||ea,e?.wrapT||ea,e?.magFilter||In,e?.minFilter||In,e?.anisotropy||1,Fr);return t.generateMipmaps=e?.generateMipmaps!==void 0?e?.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof hi&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof ui&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof ui&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class UR extends Error{}class OR extends Error{}const Fm=(i,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(i);if(n)return n[1];const a=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(i);if(a){const r=a[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return r&&r.length===3?r.map(l=>l.replace(/<\/?rdf:li>/g,"")):a[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},sF=i=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(i):e=i.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),a=e.slice(t,n+10);try{const r=Fm(a,"hdrgm:GainMapMin","0"),l=Fm(a,"hdrgm:GainMapMax"),u=Fm(a,"hdrgm:Gamma","1"),d=Fm(a,"hdrgm:OffsetSDR","0.015625"),p=Fm(a,"hdrgm:OffsetHDR","0.015625"),x=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(a),g=x?x[1]:"0",_=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(a);if(!_)throw new Error("Incomplete gainmap metadata");const y=_[1];return{gainMapMin:Array.isArray(r)?r.map(b=>parseFloat(b)):[parseFloat(r),parseFloat(r),parseFloat(r)],gainMapMax:Array.isArray(l)?l.map(b=>parseFloat(b)):[parseFloat(l),parseFloat(l),parseFloat(l)],gamma:Array.isArray(u)?u.map(b=>parseFloat(b)):[parseFloat(u),parseFloat(u),parseFloat(u)],offsetSdr:Array.isArray(d)?d.map(b=>parseFloat(b)):[parseFloat(d),parseFloat(d),parseFloat(d)],offsetHdr:Array.isArray(p)?p.map(b=>parseFloat(b)):[parseFloat(p),parseFloat(p),parseFloat(p)],hdrCapacityMin:parseFloat(g),hdrCapacityMax:parseFloat(y)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class rF{options;constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const a=this.options.debug,r=new DataView(e.buffer);if(r.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const l=r.byteLength;let u=2,d=0,p;for(;u<l;){if(++d>250){n(new Error(`Found no marker after ${d} loops `));return}if(r.getUint8(u)!==255){n(new Error(`Not a valid marker at offset 0x${u.toString(16)}, found: 0x${r.getUint8(u).toString(16)}`));return}if(p=r.getUint8(u+1),a&&console.log(`Marker: ${p.toString(16)}`),p===226){a&&console.log("Found APP2 marker (0xffe2)");const x=u+4;if(r.getUint32(x)===1297106432){const g=x+4;let _;if(r.getUint16(g)===18761)_=!1;else if(r.getUint16(g)===19789)_=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(r.getUint16(g+2,!_)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const y=r.getUint32(g+4,!_);if(y<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const b=g+y,C=r.getUint16(b,!_),E=b+2;let S=0;for(let F=E;F<E+12*C;F+=12)r.getUint16(F,!_)===45057&&(S=r.getUint32(F+8,!_));const D=b+2+C*12+4,U=[];for(let F=D;F<D+S*16;F+=16){const N={MPType:r.getUint32(F,!_),size:r.getUint32(F+4,!_),dataOffset:r.getUint32(F+8,!_),dependantImages:r.getUint32(F+12,!_),start:-1,end:-1,isFII:!1};N.dataOffset?(N.start=g+N.dataOffset,N.isFII=!1):(N.start=0,N.isFII=!0),N.end=N.start+N.size,U.push(N)}if(this.options.extractNonFII&&U.length){const F=new Blob([r]),N=[];for(const z of U){if(z.isFII&&!this.options.extractFII)continue;const j=F.slice(z.start,z.end+1,"image/jpeg");N.push(j)}t(N)}}}u+=2+r.getUint16(u+2)}})}}const oF=async i=>{const e=sF(i);if(!e)throw new OR("Gain map XMP metadata not found");const n=await new rF({extractFII:!0,extractNonFII:!0}).extract(i);if(n.length!==2)throw new UR("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},AE=i=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=a=>{t(a)},n.src=URL.createObjectURL(i)});class lF extends ds{_renderer;_renderTargetOptions;_internalLoadingManager;_config;constructor(e,t){super(t),this._config=e,e.renderer&&(this._renderer=e.renderer),this._internalLoadingManager=new ky}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new ui,sdr:new ui});return this._config.createQuadRenderer({width:16,height:16,type:wa,colorSpace:Fr,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(e,t,n){const a=t?new Blob([t],{type:"image/jpeg"}):void 0,r=new Blob([e],{type:"image/jpeg"});let l,u,d=!1;if(typeof createImageBitmap>"u"){const p=await Promise.all([a?AE(a):Promise.resolve(void 0),AE(r)]);u=p[0],l=p[1],d=n==="flipY"}else{const p=await Promise.all([a?createImageBitmap(a,{imageOrientation:n||"flipY"}):Promise.resolve(void 0),createImageBitmap(r,{imageOrientation:n||"flipY"})]);u=p[0],l=p[1]}return{sdrImage:l,gainMapImage:u,needsFlip:d}}createTextures(e,t,n){const a=new ui(t||new ImageData(2,2),zu,ea,ea,In,bb,_a,ca,1,Fr);a.flipY=n,a.needsUpdate=!0;const r=new ui(e,zu,ea,ea,In,bb,_a,ca,1,ti);return r.flipY=n,r.needsUpdate=!0,{gainMap:a,sdr:r}}updateQuadRenderer(e,t,n,a,r){e.width=t.width,e.height=t.height,e.material.gainMap=n,e.material.sdr=a,e.material.gainMapMin=r.gainMapMin,e.material.gainMapMax=r.gainMapMax,e.material.offsetHdr=r.offsetHdr,e.material.offsetSdr=r.offsetSdr,e.material.gamma=r.gamma,e.material.hdrCapacityMin=r.hdrCapacityMin,e.material.hdrCapacityMax=r.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,r.hdrCapacityMax),e.material.needsUpdate=!0}}const cF=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,uF=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class fF extends hi{_maxDisplayBoost;_hdrCapacityMin;_hdrCapacityMax;constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:a,gainMapMax:r,maxDisplayBoost:l,hdrCapacityMin:u,hdrCapacityMax:d,sdr:p,gainMap:x}){super({name:"GainMapDecoderMaterial",vertexShader:cF,fragmentShader:uF,uniforms:{sdr:{value:p},gainMap:{value:x},gamma:{value:new te(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new te().fromArray(t)},offsetSdr:{value:new te().fromArray(n)},gainMapMin:{value:new te().fromArray(a)},gainMapMax:{value:new te().fromArray(r)},weightFactor:{value:(Math.log2(l)-u)/(d-u)}},blending:es,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=l,this._hdrCapacityMin=u,this._hdrCapacityMax=d,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class NR extends lF{constructor(e,t){super({renderer:e,createMaterial:n=>new fF(n),createQuadRenderer:n=>new YS(n)},t)}async render(e,t,n,a){const{sdrImage:r,gainMapImage:l,needsFlip:u}=await this.processImages(n,a,"flipY"),{gainMap:d,sdr:p}=this.createTextures(r,l,u);this.updateQuadRenderer(e,r,d,p,t),e.render()}}class hF extends NR{load([e,t,n],a,r,l){const u=this.prepareQuadRenderer();let d,p,x;const g=async()=>{if(d&&p&&x){try{await this.render(u,x,d,p)}catch(L){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof l=="function"&&l(L),u.disposeOnDemandRenderer();return}typeof a=="function"&&a(u),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),u.disposeOnDemandRenderer()}};let _=!0,y=0,b=0,C=!0,E=0,S=0,w=!0,D=0,U=0;const F=()=>{if(typeof r=="function"){const L=y+E+D,P=b+S+U,q=_&&C&&w;r(new ProgressEvent("progress",{lengthComputable:q,loaded:P,total:L}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const N=new hs(this._internalLoadingManager);N.setResponseType("arraybuffer"),N.setRequestHeader(this.requestHeader),N.setPath(this.path),N.setWithCredentials(this.withCredentials),N.load(e,async L=>{if(typeof L=="string")throw new Error("Invalid sdr buffer");d=L,await g()},L=>{_=L.lengthComputable,b=L.loaded,y=L.total,F()},L=>{this.manager.itemError(e),typeof l=="function"&&l(L)});const z=new hs(this._internalLoadingManager);z.setResponseType("arraybuffer"),z.setRequestHeader(this.requestHeader),z.setPath(this.path),z.setWithCredentials(this.withCredentials),z.load(t,async L=>{if(typeof L=="string")throw new Error("Invalid gainmap buffer");p=L,await g()},L=>{C=L.lengthComputable,S=L.loaded,E=L.total,F()},L=>{this.manager.itemError(t),typeof l=="function"&&l(L)});const j=new hs(this._internalLoadingManager);return j.setRequestHeader(this.requestHeader),j.setPath(this.path),j.setWithCredentials(this.withCredentials),j.load(n,async L=>{if(typeof L!="string")throw new Error("Invalid metadata string");x=JSON.parse(L),await g()},L=>{w=L.lengthComputable,U=L.loaded,D=L.total,F()},L=>{this.manager.itemError(n),typeof l=="function"&&l(L)}),u}}class dF extends NR{load(e,t,n,a){const r=this.prepareQuadRenderer(),l=new hs(this._internalLoadingManager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(this.withCredentials),this.manager.itemStart(e),l.load(e,async u=>{if(typeof u=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const d=new Uint8Array(u);let p,x,g;try{const _=await oF(d);p=_.sdr,x=_.gainMap,g=_.metadata}catch(_){if(_ instanceof OR||_ instanceof UR)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),g={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},p=d;else throw _}try{await this.render(r,g,p.buffer,x?.buffer)}catch(_){this.manager.itemError(e),typeof a=="function"&&a(_),r.disposeOnDemandRenderer();return}typeof t=="function"&&t(r),this.manager.itemEnd(e),r.disposeOnDemandRenderer()},n,u=>{this.manager.itemError(e),typeof a=="function"&&a(u)}),r}}const pg={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},LR="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Mp=i=>Array.isArray(i),qS=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function Wy({files:i=qS,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:a}={}){t&&(KS(t),i=pg[t],e=LR);const r=Mp(i),{extension:l,isCubemap:u}=JS(i),d=WS(l);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+i);const p=tr(y=>y.gl);k.useLayoutEffect(()=>{if(l!=="webp"&&l!=="jpg"&&l!=="jpeg")return;function y(){Oc.clear(d,r?[i]:i)}p.domElement.addEventListener("webglcontextlost",y,{once:!0})},[i,p.domElement]);const x=Oc(d,r?[i]:i,y=>{(l==="webp"||l==="jpg"||l==="jpeg")&&y.setRenderer(p),y.setPath==null||y.setPath(e),a&&a(y)});let g=r?x[0]:x;if(l==="jpg"||l==="jpeg"||l==="webp"){var _;g=(_=g.renderTarget)==null?void 0:_.texture}return g.mapping=u?Fl:Ep,g.colorSpace=n??(u?"srgb":"srgb-linear"),g}const pF={files:qS,path:"",preset:void 0,extensions:void 0};Wy.preload=i=>{const e={...pF,...i};let{files:t,path:n=""}=e;const{preset:a,extensions:r}=e;a&&(KS(a),t=pg[a],n=LR);const{extension:l}=JS(t);if(l==="webp"||l==="jpg"||l==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const u=WS(l);if(!u)throw new Error("useEnvironment: Unrecognized file extension: "+t);Oc.preload(u,Mp(t)?[t]:t,d=>{d.setPath==null||d.setPath(n),r&&r(d)})};const mF={files:qS,preset:void 0};Wy.clear=i=>{const e={...mF,...i};let{files:t}=e;const{preset:n}=e;n&&(KS(n),t=pg[n]);const{extension:a}=JS(t),r=WS(a);if(!r)throw new Error("useEnvironment: Unrecognized file extension: "+t);Oc.clear(r,Mp(t)?[t]:t)};function KS(i){if(!(i in pg))throw new Error("Preset must be one of: "+Object.keys(pg).join(", "))}function JS(i){var e;const t=Mp(i)&&i.length===6,n=Mp(i)&&i.length===3&&i.some(l=>l.endsWith("json")),a=Mp(i)?i[0]:i;return{extension:t?"cube":n?"webp":a.startsWith("data:application/exr")?"exr":a.startsWith("data:application/hdr")?"hdr":a.startsWith("data:image/jpeg")?"jpg":(e=a.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function WS(i){return i==="cube"?MC:i==="hdr"?K8:i==="exr"?J8:i==="jpg"||i==="jpeg"?dF:i==="webp"?hF:null}const gF=i=>i.current&&i.current.isScene,vF=i=>gF(i)?i.current:i;function ZS(i,e,t,n,a={}){var r,l,u,d;a={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...a};const p=vF(e||t),x=p.background,g=p.environment,_={backgroundBlurriness:p.backgroundBlurriness,backgroundIntensity:p.backgroundIntensity,backgroundRotation:(r=(l=p.backgroundRotation)==null||l.clone==null?void 0:l.clone())!==null&&r!==void 0?r:[0,0,0],environmentIntensity:p.environmentIntensity,environmentRotation:(u=(d=p.environmentRotation)==null||d.clone==null?void 0:d.clone())!==null&&u!==void 0?u:[0,0,0]};return i!=="only"&&(p.environment=n),i&&(p.background=n),Il(p,a),()=>{i!=="only"&&(p.environment=g),i&&(p.background=x),Il(p,_)}}function QS({scene:i,background:e=!1,map:t,...n}){const a=tr(r=>r.scene);return k.useLayoutEffect(()=>{if(t)return ZS(e,i,a,t,n)}),null}function IR({background:i=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:a,backgroundRotation:r,environmentIntensity:l,environmentRotation:u,...d}){const p=Wy(d),x=tr(g=>g.scene);return k.useLayoutEffect(()=>ZS(i,e,x,p,{backgroundBlurriness:t??n,backgroundIntensity:a,backgroundRotation:r,environmentIntensity:l,environmentRotation:u})),k.useEffect(()=>()=>{p.dispose()},[p]),null}function xF({children:i,near:e=.1,far:t=1e3,resolution:n=256,frames:a=1,map:r,background:l=!1,blur:u,backgroundBlurriness:d,backgroundIntensity:p,backgroundRotation:x,environmentIntensity:g,environmentRotation:_,scene:y,files:b,path:C,preset:E=void 0,extensions:S}){const w=tr(j=>j.gl),D=tr(j=>j.scene),U=k.useRef(null),[F]=k.useState(()=>new Mh),N=k.useMemo(()=>{const j=new oS(n);return j.texture.type=wa,j},[n]);k.useEffect(()=>()=>{N.dispose()},[N]),k.useLayoutEffect(()=>{if(a===1){const j=w.autoClear;w.autoClear=!0,U.current.update(w,F),w.autoClear=j}return ZS(l,y,D,N.texture,{backgroundBlurriness:u??d,backgroundIntensity:p,backgroundRotation:x,environmentIntensity:g,environmentRotation:_})},[i,F,N.texture,y,D,l,a,w]);let z=1;return Ns(()=>{if(a===1/0||z<a){const j=w.autoClear;w.autoClear=!0,U.current.update(w,F),w.autoClear=j,z++}}),k.createElement(k.Fragment,null,BP(k.createElement(k.Fragment,null,i,k.createElement("cubeCamera",{ref:U,args:[e,t,N]}),b||E?k.createElement(IR,{background:!0,files:b,preset:E,path:C,extensions:S}):r?k.createElement(QS,{background:!0,map:r,extensions:S}):null),F))}function _F(i){var e,t,n,a;const r=Wy(i),l=i.map||r;k.useMemo(()=>Jy({GroundProjectedEnvImpl:c8}),[]),k.useEffect(()=>()=>{r.dispose()},[r]);const u=k.useMemo(()=>[l],[l]),d=(e=i.ground)==null?void 0:e.height,p=(t=i.ground)==null?void 0:t.radius,x=(n=(a=i.ground)==null?void 0:a.scale)!==null&&n!==void 0?n:1e3;return k.createElement(k.Fragment,null,k.createElement(QS,sy({},i,{map:l})),k.createElement("groundProjectedEnvImpl",{args:u,scale:x,height:d,radius:p}))}function yF(i){return i.ground?k.createElement(_F,i):i.map?k.createElement(QS,i):i.children?k.createElement(xF,i):k.createElement(IR,i)}var rb=1/1e3,bF=1e3,SF=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(i){typeof document<"u"&&document.hidden!==void 0&&(i?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=i)}get delta(){return this._delta*rb}get fixedDelta(){return this._fixedDelta*rb}set fixedDelta(i){this._fixedDelta=i*bF}get elapsed(){return this._elapsed*rb}update(i){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(i!==void 0?i:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(i){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},AF=(()=>{const i=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new rn;return t.setAttribute("position",new Mn(i,3)),t.setAttribute("uv",new Mn(e,2)),t})(),_r=class Vb{static get fullscreenGeometry(){return AF}constructor(e="Pass",t=new Mh,n=new Zu){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Xi(Vb.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Mh),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=Yu){}render(e,t,n,a,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof ua||t instanceof ya||t instanceof ui||t instanceof Vb)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},MF=class extends _r{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(i,e,t,n,a){const r=i.state.buffers.stencil;r.setLocked(!1),r.setTest(!1)}},EF=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,PR="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",FR=class extends hi{constructor(){super({name:"CopyMaterial",defines:{DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new Zn(null),depthBuffer:new Zn(null),channelWeights:new Zn(null),opacity:new Zn(1)},blending:es,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:EF,vertexShader:PR}),this.depthFunc=ng}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(i){const e=i!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=i}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(i){const e=i!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=i}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(i){i!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=i):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(i){this.uniforms.inputBuffer.value=i}getOpacity(i){return this.uniforms.opacity.value}setOpacity(i){this.uniforms.opacity.value=i}},TF=class extends _r{constructor(i,e=!0){super("CopyPass"),this.fullscreenMaterial=new FR,this.needsSwap=!1,this.renderTarget=i,i===void 0&&(this.renderTarget=new ua(1,1,{minFilter:In,magFilter:In,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(i){this.autoResize=i}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(i){this.autoResize=i}render(i,e,t,n,a){this.fullscreenMaterial.inputBuffer=e.texture,i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){this.autoResize&&this.renderTarget.setSize(i,e)}initialize(i,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==ca?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":i!==null&&i.outputColorSpace===ti&&(this.renderTarget.texture.colorSpace=ti))}},ME=new ut,zR=class extends _r{constructor(i=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=i,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(i,e,t){this.color=i,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(i){this.overrideClearColor=i}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(i){this.overrideClearAlpha=i}render(i,e,t,n,a){const r=this.overrideClearColor,l=this.overrideClearAlpha,u=i.getClearAlpha(),d=r!==null,p=l>=0;d?(i.getClearColor(ME),i.setClearColor(r,p?l:u)):p&&i.setClearAlpha(l),i.setRenderTarget(this.renderToScreen?null:e),i.clear(this.color,this.depth,this.stencil),d?i.setClearColor(ME,u):p&&i.setClearAlpha(u)}},CF=class extends _r{constructor(i,e){super("MaskPass",i,e),this.needsSwap=!1,this.clearPass=new zR(!1,!1,!0),this.inverse=!1}set mainScene(i){this.scene=i}set mainCamera(i){this.camera=i}get inverted(){return this.inverse}set inverted(i){this.inverse=i}get clear(){return this.clearPass.enabled}set clear(i){this.clearPass.enabled=i}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(i){this.inverted=i}render(i,e,t,n,a){const r=i.getContext(),l=i.state.buffers,u=this.scene,d=this.camera,p=this.clearPass,x=this.inverted?0:1,g=1-x;l.color.setMask(!1),l.depth.setMask(!1),l.color.setLocked(!0),l.depth.setLocked(!0),l.stencil.setTest(!0),l.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),l.stencil.setFunc(r.ALWAYS,x,4294967295),l.stencil.setClear(g),l.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?p.render(i,null):(p.render(i,e),p.render(i,t))),this.renderToScreen?(i.setRenderTarget(null),i.render(u,d)):(i.setRenderTarget(e),i.render(u,d),i.setRenderTarget(t),i.render(u,d)),l.color.setLocked(!1),l.depth.setLocked(!1),l.stencil.setLocked(!1),l.stencil.setFunc(r.EQUAL,1,4294967295),l.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),l.stencil.setLocked(!0)}},RF=class{constructor(i=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:n=0,frameBufferType:a}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,a,n),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new TF,this.depthTexture=null,this.passes=[],this.timer=new SF,this.autoRenderToScreen=!0,this.setRenderer(i)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(i){const e=this.inputBuffer,t=this.multisampling;t>0&&i>0?(this.inputBuffer.samples=i,this.outputBuffer.samples=i,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==i&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,i),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(i){if(this.renderer=i,i!==null){const e=i.getSize(new Ge),t=i.getContext().getContextAttributes().alpha,n=this.inputBuffer.texture.type;n===ca&&i.outputColorSpace===ti&&(this.inputBuffer.texture.colorSpace=ti,this.outputBuffer.texture.colorSpace=ti,this.inputBuffer.dispose(),this.outputBuffer.dispose()),i.autoClear=!1,this.setSize(e.width,e.height);for(const a of this.passes)a.initialize(i,t,n)}}replaceRenderer(i,e=!0){const t=this.renderer,n=t.domElement.parentNode;return this.setRenderer(i),e&&n!==null&&(n.removeChild(t.domElement),n.appendChild(i.domElement)),t}createDepthTexture(){const i=this.depthTexture=new By;return this.inputBuffer.depthTexture=i,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(i.format=Ah,i.type=Sh):i.type=Zo,i}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const i of this.passes)i.setDepthTexture(null)}}createBuffer(i,e,t,n){const a=this.renderer,r=a===null?new Ge:a.getDrawingBufferSize(new Ge),l={minFilter:In,magFilter:In,stencilBuffer:e,depthBuffer:i,type:t},u=new ua(r.width,r.height,l);return n>0&&(u.samples=n),t===ca&&a!==null&&a.outputColorSpace===ti&&(u.texture.colorSpace=ti),u.texture.name="EffectComposer.Buffer",u.texture.generateMipmaps=!1,u}setMainScene(i){for(const e of this.passes)e.mainScene=i}setMainCamera(i){for(const e of this.passes)e.mainCamera=i}addPass(i,e){const t=this.passes,n=this.renderer,a=n.getDrawingBufferSize(new Ge),r=n.getContext().getContextAttributes().alpha,l=this.inputBuffer.texture.type;if(i.setRenderer(n),i.setSize(a.width,a.height),i.initialize(n,r,l),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),i.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,i):t.push(i),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),i.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const u=this.createDepthTexture();for(i of t)i.setDepthTexture(u)}else i.setDepthTexture(this.depthTexture)}removePass(i){const e=this.passes,t=e.indexOf(i);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const r=(u,d)=>u||d.needsDepthTexture;e.reduce(r,!1)||(i.getDepthTexture()===this.depthTexture&&i.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(i.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const i=this.passes;this.deleteDepthTexture(),i.length>0&&(this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!1),this.passes=[])}render(i){const e=this.renderer,t=this.copyPass;let n=this.inputBuffer,a=this.outputBuffer,r=!1,l,u,d;i===void 0&&(this.timer.update(),i=this.timer.getDelta());for(const p of this.passes)p.enabled&&(p.render(e,n,a,i,r),p.needsSwap&&(r&&(t.renderToScreen=p.renderToScreen,l=e.getContext(),u=e.state.buffers.stencil,u.setFunc(l.NOTEQUAL,1,4294967295),t.render(e,n,a,i,r),u.setFunc(l.EQUAL,1,4294967295)),d=n,n=a,a=d),p instanceof CF?r=!0:p instanceof MF&&(r=!1))}setSize(i,e,t){const n=this.renderer,a=n.getSize(new Ge);(i===void 0||e===void 0)&&(i=a.width,e=a.height),(a.width!==i||a.height!==e)&&n.setSize(i,e,t);const r=n.getDrawingBufferSize(new Ge);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height);for(const l of this.passes)l.setSize(r.width,r.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const i of this.passes)i.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),_r.fullscreenGeometry.dispose()}},yh={NONE:0,DEPTH:1,CONVOLUTION:2},ci={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},wF=class{constructor(){this.shaderParts=new Map([[ci.FRAGMENT_HEAD,null],[ci.FRAGMENT_MAIN_UV,null],[ci.FRAGMENT_MAIN_IMAGE,null],[ci.VERTEX_HEAD,null],[ci.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=yh.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Fr}},ob=!1,EE=class{constructor(i=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(i),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case Oi:t=this.materialsFlatShadedDoubleSide;break;case oa:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case Oi:t=this.materialsDoubleSide;break;case oa:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(i){if(!(i instanceof hi))return i.clone();const e=i.uniforms,t=new Map;for(const a in e){const r=e[a].value;r.isRenderTargetTexture&&(e[a].value=null,t.set(a,r))}const n=i.clone();for(const a of t)e[a[0]].value=a[1],n.uniforms[a[0]].value=a[1];return n}setMaterial(i){if(this.disposeMaterials(),this.material=i,i!==null){const e=this.materials=[this.cloneMaterial(i),this.cloneMaterial(i),this.cloneMaterial(i)];for(const t of e)t.uniforms=Object.assign({},i.uniforms),t.side=Wo;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.side=oa,n}),this.materialsDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.side=Oi,n}),this.materialsFlatShaded=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n.side=oa,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n.side=Oi,n})}}render(i,e,t){const n=i.shadowMap.enabled;if(i.shadowMap.enabled=!1,ob){const a=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),i.render(e,t);for(const r of a)r[0].material=r[1];this.meshCount!==a.size&&a.clear()}else{const a=e.overrideMaterial;e.overrideMaterial=this.material,i.render(e,t),e.overrideMaterial=a}i.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const i=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of i)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return ob}static set workaroundEnabled(i){ob=i}},Ru=-1,Us=class extends Hr{constructor(i,e=Ru,t=Ru,n=1){super(),this.resizable=i,this.baseSize=new Ge(1,1),this.preferredSize=new Ge(e,t),this.target=this.preferredSize,this.s=n,this.effectiveSize=new Ge,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const i=this.baseSize,e=this.preferredSize,t=this.effectiveSize,n=this.scale;e.width!==Ru?t.width=e.width:e.height!==Ru?t.width=Math.round(e.height*(i.width/Math.max(i.height,1))):t.width=Math.round(i.width*n),e.height!==Ru?t.height=e.height:e.width!==Ru?t.height=Math.round(e.width/Math.max(i.width/Math.max(i.height,1),1)):t.height=Math.round(i.height*n)}get width(){return this.effectiveSize.width}set width(i){this.preferredWidth=i}get height(){return this.effectiveSize.height}set height(i){this.preferredHeight=i}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(i){this.s!==i&&(this.s=i,this.preferredSize.setScalar(Ru),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(i){this.scale=i}get baseWidth(){return this.baseSize.width}set baseWidth(i){this.baseSize.width!==i&&(this.baseSize.width=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(i){this.baseWidth=i}get baseHeight(){return this.baseSize.height}set baseHeight(i){this.baseSize.height!==i&&(this.baseSize.height=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(i){this.baseHeight=i}setBaseSize(i,e){(this.baseSize.width!==i||this.baseSize.height!==e)&&(this.baseSize.set(i,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(i){this.preferredSize.width!==i&&(this.preferredSize.width=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(i){this.preferredWidth=i}get preferredHeight(){return this.preferredSize.height}set preferredHeight(i){this.preferredSize.height!==i&&(this.preferredSize.height=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(i){this.preferredHeight=i}setPreferredSize(i,e){(this.preferredSize.width!==i||this.preferredSize.height!==e)&&(this.preferredSize.set(i,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(i){this.s=i.scale,this.baseSize.set(i.baseWidth,i.baseHeight),this.preferredSize.set(i.preferredWidth,i.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return Ru}},Jn={ADD:0,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},BF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),y.a*opacity);}",DF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),y.a*opacity);}",UF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",OF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),y.a*opacity);}",NF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),y.a*opacity);}",LF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),y.a*opacity);}",IF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),y.a*opacity);}",PF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),y.a*opacity);}",FF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),y.a*opacity);}",zF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),y.a*opacity);}",HF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),y.a*opacity);}",GF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),y.a*opacity);}",VF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),y.a*opacity);}",kF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),y.a*opacity);}",jF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),y.a*opacity);}",XF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",YF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),y.a*opacity);}",qF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",KF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",JF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),y.a*opacity);}",WF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),y.a*opacity);}",ZF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",QF="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",$F="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),y.a*opacity);}",ez="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",tz="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",nz="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),y.a*opacity);}",iz="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),y.a*opacity);}",az="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",sz="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),y.a*opacity);}",rz="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",oz=new Map([[Jn.ADD,BF],[Jn.AVERAGE,DF],[Jn.COLOR,UF],[Jn.COLOR_BURN,OF],[Jn.COLOR_DODGE,NF],[Jn.DARKEN,LF],[Jn.DIFFERENCE,IF],[Jn.DIVIDE,PF],[Jn.DST,null],[Jn.EXCLUSION,FF],[Jn.HARD_LIGHT,zF],[Jn.HARD_MIX,HF],[Jn.HUE,GF],[Jn.INVERT,VF],[Jn.INVERT_RGB,kF],[Jn.LIGHTEN,jF],[Jn.LINEAR_BURN,XF],[Jn.LINEAR_DODGE,YF],[Jn.LINEAR_LIGHT,qF],[Jn.LUMINOSITY,KF],[Jn.MULTIPLY,JF],[Jn.NEGATION,WF],[Jn.NORMAL,ZF],[Jn.OVERLAY,QF],[Jn.PIN_LIGHT,$F],[Jn.REFLECT,ez],[Jn.SATURATION,tz],[Jn.SCREEN,nz],[Jn.SOFT_LIGHT,iz],[Jn.SRC,az],[Jn.SUBTRACT,sz],[Jn.VIVID_LIGHT,rz]]),lz=class extends Hr{constructor(i,e=1){super(),this._blendFunction=i,this.opacity=new Zn(e)}getOpacity(){return this.opacity.value}setOpacity(i){this.opacity.value=i}get blendFunction(){return this._blendFunction}set blendFunction(i){this._blendFunction=i,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(i){this.blendFunction=i}getShaderCode(){return oz.get(this.blendFunction)}},kb=class extends Hr{constructor(i,e,{attributes:t=yh.NONE,blendFunction:n=Jn.NORMAL,defines:a=new Map,uniforms:r=new Map,extensions:l=null,vertexShader:u=null}={}){super(),this.name=i,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=u,this.defines=a,this.uniforms=r,this.extensions=l,this.blendMode=new lz(n),this.blendMode.addEventListener("change",d=>this.setChanged()),this._inputColorSpace=Fr,this._outputColorSpace=qo}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(i){this._inputColorSpace=i,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(i){this._outputColorSpace=i,this.setChanged()}set mainScene(i){}set mainCamera(i){}getName(){return this.name}setRenderer(i){this.renderer=i}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(i){this.attributes=i,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(i){this.fragmentShader=i,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(i){this.vertexShader=i,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(i,e=Yu){}update(i,e,t){}setSize(i,e){}initialize(i,e,t){}dispose(){for(const i of Object.keys(this)){const e=this[i];(e instanceof ua||e instanceof ya||e instanceof ui||e instanceof _r)&&this[i].dispose()}}},$S={MEDIUM:2,LARGE:3},cz=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,uz="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",fz=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],hz=class extends hi{constructor(i=new kn){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Zn(null),texelSize:new Zn(new kn),scale:new Zn(1),kernel:new Zn(0)},blending:es,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:cz,vertexShader:uz}),this.setTexelSize(i.x,i.y),this.kernelSize=$S.MEDIUM}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.inputBuffer=i}get kernelSequence(){return fz[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(i){this.uniforms.scale.value=i}getScale(){return this.uniforms.scale.value}setScale(i){this.uniforms.scale.value=i}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(i){this.uniforms.kernel.value=i}setKernel(i){this.kernel=i}setTexelSize(i,e){this.uniforms.texelSize.value.set(i,e,i*.5,e*.5)}setSize(i,e){const t=1/i,n=1/e;this.uniforms.texelSize.value.set(t,n,t*.5,n*.5)}},dz=class extends _r{constructor({kernelSize:i=$S.MEDIUM,resolutionScale:e=.5,width:t=Us.AUTO_SIZE,height:n=Us.AUTO_SIZE,resolutionX:a=t,resolutionY:r=n}={}){super("KawaseBlurPass"),this.renderTargetA=new ua(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const l=this.resolution=new Us(this,a,r,e);l.addEventListener("change",u=>this.setSize(l.baseWidth,l.baseHeight)),this._blurMaterial=new hz,this._blurMaterial.kernelSize=i,this.copyMaterial=new FR}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(i){this._blurMaterial=i}get dithering(){return this.copyMaterial.dithering}set dithering(i){this.copyMaterial.dithering=i}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(i){this.blurMaterial.kernelSize=i}get width(){return this.resolution.width}set width(i){this.resolution.preferredWidth=i}get height(){return this.resolution.height}set height(i){this.resolution.preferredHeight=i}get scale(){return this.blurMaterial.scale}set scale(i){this.blurMaterial.scale=i}getScale(){return this.blurMaterial.scale}setScale(i){this.blurMaterial.scale=i}getKernelSize(){return this.kernelSize}setKernelSize(i){this.kernelSize=i}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}render(i,e,t,n,a){const r=this.scene,l=this.camera,u=this.renderTargetA,d=this.renderTargetB,p=this.blurMaterial,x=p.kernelSequence;let g=e;this.fullscreenMaterial=p;for(let _=0,y=x.length;_<y;++_){const b=(_&1)===0?u:d;p.kernel=x[_],p.inputBuffer=g.texture,i.setRenderTarget(b),i.render(r,l),g=b}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=g.texture,i.setRenderTarget(this.renderToScreen?null:t),i.render(r,l)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e);const n=t.width,a=t.height;this.renderTargetA.setSize(n,a),this.renderTargetB.setSize(n,a),this.blurMaterial.setSize(i,e)}initialize(i,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==ca?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):i!==null&&i.outputColorSpace===ti&&(this.renderTargetA.texture.colorSpace=ti,this.renderTargetB.texture.colorSpace=ti))}static get AUTO_SIZE(){return Us.AUTO_SIZE}},pz=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,mz=class extends hi{constructor(i=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Dh.replace(/\D+/g,"")},uniforms:{inputBuffer:new Zn(null),threshold:new Zn(0),smoothing:new Zn(1),range:new Zn(null)},blending:es,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:pz,vertexShader:PR}),this.colorOutput=i,this.luminanceRange=e}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get threshold(){return this.uniforms.threshold.value}set threshold(i){this.smoothing>0||i>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=i}getThreshold(){return this.threshold}setThreshold(i){this.threshold=i}get smoothing(){return this.uniforms.smoothing.value}set smoothing(i){this.threshold>0||i>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=i}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(i){this.smoothing=i}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(i){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(i){i?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(i){return this.colorOutput}setColorOutputEnabled(i){this.colorOutput=i}get useRange(){return this.luminanceRange!==null}set useRange(i){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(i){i!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=i,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(i){this.luminanceRange=i}},gz=class extends _r{constructor({renderTarget:i,luminanceRange:e,colorOutput:t,resolutionScale:n=1,width:a=Us.AUTO_SIZE,height:r=Us.AUTO_SIZE,resolutionX:l=a,resolutionY:u=r}={}){super("LuminancePass"),this.fullscreenMaterial=new mz(t,e),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new ua(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const d=this.resolution=new Us(this,l,u,n);d.addEventListener("change",p=>this.setSize(d.baseWidth,d.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(i,e,t,n,a){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height)}initialize(i,e,t){t!==void 0&&t!==ca&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},vz=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,xz="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",_z=class extends hi{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Zn(null),texelSize:new Zn(new Ge)},blending:es,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:vz,vertexShader:xz})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},yz=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,bz="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",Sz=class extends hi{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Zn(null),supportBuffer:new Zn(null),texelSize:new Zn(new Ge),radius:new Zn(.85)},blending:es,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:yz,vertexShader:bz})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}set supportBuffer(i){this.uniforms.supportBuffer.value=i}get radius(){return this.uniforms.radius.value}set radius(i){this.uniforms.radius.value=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},Az=class extends _r{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new ua(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new _z,this.upsamplingMaterial=new Sz,this.resolution=new Ge}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(i){if(this.levels!==i){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<i;++t){const n=e.clone();n.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(n)}this.upsamplingMipmaps.push(e);for(let t=1,n=i-1;t<n;++t){const a=e.clone();a.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(a)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(i){this.upsamplingMaterial.radius=i}render(i,e,t,n,a){const{scene:r,camera:l}=this,{downsamplingMaterial:u,upsamplingMaterial:d}=this,{downsamplingMipmaps:p,upsamplingMipmaps:x}=this;let g=e;this.fullscreenMaterial=u;for(let _=0,y=p.length;_<y;++_){const b=p[_];u.setSize(g.width,g.height),u.inputBuffer=g.texture,i.setRenderTarget(b),i.render(r,l),g=b}this.fullscreenMaterial=d;for(let _=x.length-1;_>=0;--_){const y=x[_];d.setSize(g.width,g.height),d.inputBuffer=g.texture,d.supportBuffer=p[_].texture,i.setRenderTarget(y),i.render(r,l),g=y}}setSize(i,e){const t=this.resolution;t.set(i,e);let n=t.width,a=t.height;for(let r=0,l=this.downsamplingMipmaps.length;r<l;++r)n=Math.round(n*.5),a=Math.round(a*.5),this.downsamplingMipmaps[r].setSize(n,a),r<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[r].setSize(n,a)}initialize(i,e,t){if(t!==void 0){const n=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const a of n)a.texture.type=t;if(t!==ca)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(i!==null&&i.outputColorSpace===ti)for(const a of n)a.texture.colorSpace=ti}}dispose(){super.dispose();for(const i of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))i.dispose()}},Mz=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,Ez=class extends kb{constructor({blendFunction:i=Jn.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:n=!0,intensity:a=1,radius:r=.85,levels:l=8,kernelSize:u=$S.LARGE,resolutionScale:d=.5,width:p=Us.AUTO_SIZE,height:x=Us.AUTO_SIZE,resolutionX:g=p,resolutionY:_=x}={}){super("BloomEffect",Mz,{blendFunction:i,uniforms:new Map([["map",new Zn(null)],["intensity",new Zn(a)]])}),this.renderTarget=new ua(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new dz({kernelSize:u}),this.luminancePass=new gz({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new Az,this.mipmapBlurPass.enabled=n,this.mipmapBlurPass.radius=r,this.mipmapBlurPass.levels=l,this.uniforms.get("map").value=n?this.mipmapBlurPass.texture:this.renderTarget.texture;const y=this.resolution=new Us(this,g,_,d);y.addEventListener("change",b=>this.setSize(y.baseWidth,y.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(i){this.resolution.preferredWidth=i}get height(){return this.resolution.height}set height(i){this.resolution.preferredHeight=i}get dithering(){return this.blurPass.dithering}set dithering(i){this.blurPass.dithering=i}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(i){this.blurPass.kernelSize=i}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(i){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(i){this.uniforms.get("intensity").value=i}getIntensity(){return this.intensity}setIntensity(i){this.intensity=i}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}update(i,e,t){const n=this.renderTarget,a=this.luminancePass;a.enabled?(a.render(i,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(i,a.renderTarget):this.blurPass.render(i,a.renderTarget,n)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(i,e):this.blurPass.render(i,e,n)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(i,e),this.mipmapBlurPass.setSize(i,e)}initialize(i,e,t){this.blurPass.initialize(i,e,t),this.luminancePass.initialize(i,e,t),this.mipmapBlurPass.initialize(i,e,t),t!==void 0&&(this.renderTarget.texture.type=t,i!==null&&i.outputColorSpace===ti&&(this.renderTarget.texture.colorSpace=ti))}},HR=class extends _r{constructor(i,e,t=null){super("RenderPass",i,e),this.needsSwap=!1,this.clearPass=new zR,this.overrideMaterialManager=t===null?null:new EE(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(i){this.scene=i}set mainCamera(i){this.camera=i}get renderToScreen(){return super.renderToScreen}set renderToScreen(i){super.renderToScreen=i,this.clearPass.renderToScreen=i}get overrideMaterial(){const i=this.overrideMaterialManager;return i!==null?i.material:null}set overrideMaterial(i){const e=this.overrideMaterialManager;i!==null?e!==null?e.setMaterial(i):this.overrideMaterialManager=new EE(i):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(i){this.overrideMaterial=i}get clear(){return this.clearPass.enabled}set clear(i){this.clearPass.enabled=i}getSelection(){return this.selection}setSelection(i){this.selection=i}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(i){this.ignoreBackground=i}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(i){this.skipShadowMapUpdate=i}getClearPass(){return this.clearPass}render(i,e,t,n,a){const r=this.scene,l=this.camera,u=this.selection,d=l.layers.mask,p=r.background,x=i.shadowMap.autoUpdate,g=this.renderToScreen?null:e;u!==null&&l.layers.set(u.getLayer()),this.skipShadowMapUpdate&&(i.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(r.background=null),this.clearPass.enabled&&this.clearPass.render(i,e),i.setRenderTarget(g),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(i,r,l):i.render(r,l),l.layers.mask=d,r.background=p,i.shadowMap.autoUpdate=x}},Tz=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,Cz="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",Rz=class extends hi{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Zn(null),normalBuffer:new Zn(null),texelSize:new Zn(new Ge)},blending:es,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Tz,vertexShader:Cz})}set depthBuffer(i){this.uniforms.depthBuffer.value=i}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=Yu){this.depthBuffer=i,this.depthPacking=e}set normalBuffer(i){this.uniforms.normalBuffer.value=i,i!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(i){this.normalBuffer=i}setTexelSize(i,e){this.uniforms.texelSize.value.set(i,e)}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},wz=class extends _r{constructor({normalBuffer:i=null,resolutionScale:e=.5,width:t=Us.AUTO_SIZE,height:n=Us.AUTO_SIZE,resolutionX:a=t,resolutionY:r=n}={}){super("DepthDownsamplingPass");const l=new Rz;l.normalBuffer=i,this.fullscreenMaterial=l,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new ua(1,1,{minFilter:la,magFilter:la,depthBuffer:!1,type:ji}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const u=this.resolution=new Us(this,a,r,e);u.addEventListener("change",d=>this.setSize(u.baseWidth,u.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(i,e=Yu){this.fullscreenMaterial.depthBuffer=i,this.fullscreenMaterial.depthPacking=e}render(i,e,t,n,a){i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height),this.fullscreenMaterial.setSize(i,e)}initialize(i,e,t){const n=i.getContext();if(!(n.getExtension("EXT_color_buffer_float")||n.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},Bz=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Dz="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",Uz=class extends hi{constructor(i,e,t,n,a=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Dh.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Zn(null),depthBuffer:new Zn(null),resolution:new Zn(new Ge),texelSize:new Zn(new Ge),cameraNear:new Zn(.3),cameraFar:new Zn(1e3),aspect:new Zn(1),time:new Zn(0)},blending:es,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:a}),i&&this.setShaderParts(i),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(n)}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(i){this.uniforms.depthBuffer.value=i}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=Yu){this.depthBuffer=i,this.depthPacking=e}setShaderData(i){this.setShaderParts(i.shaderParts),this.setDefines(i.defines),this.setUniforms(i.uniforms),this.setExtensions(i.extensions)}setShaderParts(i){return this.fragmentShader=Bz.replace(ci.FRAGMENT_HEAD,i.get(ci.FRAGMENT_HEAD)||"").replace(ci.FRAGMENT_MAIN_UV,i.get(ci.FRAGMENT_MAIN_UV)||"").replace(ci.FRAGMENT_MAIN_IMAGE,i.get(ci.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Dz.replace(ci.VERTEX_HEAD,i.get(ci.VERTEX_HEAD)||"").replace(ci.VERTEX_MAIN_SUPPORT,i.get(ci.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(i){for(const e of i.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(i){for(const e of i.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(i){this.extensions={};for(const e of i)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(i){this.encodeOutput!==i&&(i?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(i){return this.encodeOutput}setOutputEncodingEnabled(i){this.encodeOutput=i}get time(){return this.uniforms.time.value}set time(i){this.uniforms.time.value=i}setDeltaTime(i){this.uniforms.time.value+=i}adoptCameraSettings(i){this.copyCameraSettings(i)}copyCameraSettings(i){i&&(this.uniforms.cameraNear.value=i.near,this.uniforms.cameraFar.value=i.far,i instanceof Ra?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(i,e){const t=this.uniforms;t.resolution.value.set(i,e),t.texelSize.value.set(1/i,1/e),t.aspect.value=i/e}static get Section(){return ci}};function TE(i,e,t){for(const n of e){const a="$1"+i+n.charAt(0).toUpperCase()+n.slice(1),r=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const l of t.entries())l[1]!==null&&t.set(l[0],l[1].replace(r,a))}}function Oz(i,e,t){let n=e.getFragmentShader(),a=e.getVertexShader();const r=n!==void 0&&/mainImage/.test(n),l=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(l&&(t.attributes&yh.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!r&&!l)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const u=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,d=t.shaderParts;let p=d.get(ci.FRAGMENT_HEAD)||"",x=d.get(ci.FRAGMENT_MAIN_UV)||"",g=d.get(ci.FRAGMENT_MAIN_IMAGE)||"",_=d.get(ci.VERTEX_HEAD)||"",y=d.get(ci.VERTEX_MAIN_SUPPORT)||"";const b=new Set,C=new Set;if(l&&(x+=`	${i}MainUv(UV);
`,t.uvTransformation=!0),a!==null&&/mainSupport/.test(a)){const w=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a);y+=`	${i}MainSupport(`,y+=w?`vUv);
`:`);
`;for(const D of a.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const U of D[1].split(/\s*,\s*/))t.varyings.add(U),b.add(U),C.add(U);for(const D of a.matchAll(u))C.add(D[1])}for(const w of n.matchAll(u))C.add(w[1]);for(const w of e.defines.keys())C.add(w.replace(/\([\w\s,]*\)/g,""));for(const w of e.uniforms.keys())C.add(w);C.delete("while"),C.delete("for"),C.delete("if"),e.uniforms.forEach((w,D)=>t.uniforms.set(i+D.charAt(0).toUpperCase()+D.slice(1),w)),e.defines.forEach((w,D)=>t.defines.set(i+D.charAt(0).toUpperCase()+D.slice(1),w));const E=new Map([["fragment",n],["vertex",a]]);TE(i,C,t.defines),TE(i,C,E),n=E.get("fragment"),a=E.get("vertex");const S=e.blendMode;if(t.blendModes.set(S.blendFunction,S),r){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(g+=e.inputColorSpace===ti?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==qo?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const w=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;g+=`${i}MainImage(color0, UV, `,(t.attributes&yh.DEPTH)!==0&&w.test(n)&&(g+="depth, ",t.readDepth=!0),g+=`color1);
	`;const D=i+"BlendOpacity";t.uniforms.set(D,S.opacity),g+=`color0 = blend${S.blendFunction}(color0, color1, ${D});

	`,p+=`uniform float ${D};

`}if(p+=n+`
`,a!==null&&(_+=a+`
`),d.set(ci.FRAGMENT_HEAD,p),d.set(ci.FRAGMENT_MAIN_UV,x),d.set(ci.FRAGMENT_MAIN_IMAGE,g),d.set(ci.VERTEX_HEAD,_),d.set(ci.VERTEX_MAIN_SUPPORT,y),e.extensions!==null)for(const w of e.extensions)t.extensions.add(w)}}var Nz=class extends _r{constructor(i,...e){super("EffectPass"),this.fullscreenMaterial=new Uz(null,null,null,i),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(i){for(const e of this.effects)e.mainScene=i}set mainCamera(i){this.fullscreenMaterial.copyCameraSettings(i);for(const e of this.effects)e.mainCamera=i}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(i){this.fullscreenMaterial.encodeOutput=i}get dithering(){return this.fullscreenMaterial.dithering}set dithering(i){const e=this.fullscreenMaterial;e.dithering=i,e.needsUpdate=!0}setEffects(i){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=i.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const i=new wF;let e=0;for(const l of this.effects)if(l.blendMode.blendFunction===Jn.DST)i.attributes|=l.getAttributes()&yh.DEPTH;else{if((i.attributes&l.getAttributes()&yh.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${l.name})`);Oz("e"+e++,l,i)}let t=i.shaderParts.get(ci.FRAGMENT_HEAD),n=i.shaderParts.get(ci.FRAGMENT_MAIN_IMAGE),a=i.shaderParts.get(ci.FRAGMENT_MAIN_UV);const r=/\bblend\b/g;for(const l of i.blendModes.values())t+=l.getShaderCode().replace(r,`blend${l.blendFunction}`)+`
`;(i.attributes&yh.DEPTH)!==0?(i.readDepth&&(n=`float depth = readDepth(UV);

	`+n),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,i.colorSpace===ti&&(n+=`color0 = sRGBToLinear(color0);
	`),i.uvTransformation?(a=`vec2 transformedUv = vUv;
`+a,i.defines.set("UV","transformedUv")):i.defines.set("UV","vUv"),i.shaderParts.set(ci.FRAGMENT_HEAD,t),i.shaderParts.set(ci.FRAGMENT_MAIN_IMAGE,n),i.shaderParts.set(ci.FRAGMENT_MAIN_UV,a);for(const[l,u]of i.shaderParts)u!==null&&i.shaderParts.set(l,u.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(i)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(i,e=Yu){this.fullscreenMaterial.depthBuffer=i,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(i,e)}render(i,e,t,n,a){for(const r of this.effects)r.update(i,e,n);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,r.time+=n*this.timeScale,i.setRenderTarget(this.renderToScreen?null:t),i.render(this.scene,this.camera)}}setSize(i,e){this.fullscreenMaterial.setSize(i,e);for(const t of this.effects)t.setSize(i,e)}initialize(i,e,t){this.renderer=i;for(const n of this.effects)n.initialize(i,e,t);this.updateMaterial(),t!==void 0&&t!==ca&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const i of this.effects)i.removeEventListener("change",this.listener),i.dispose()}handleEvent(i){switch(i.type){case"change":this.recompile();break}}},Lz=class extends _r{constructor(i,e,{renderTarget:t,resolutionScale:n=1,width:a=Us.AUTO_SIZE,height:r=Us.AUTO_SIZE,resolutionX:l=a,resolutionY:u=r}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new HR(i,e,new yS);const d=this.renderPass;d.ignoreBackground=!0,d.skipShadowMapUpdate=!0;const p=d.getClearPass();p.overrideClearColor=new ut(7829503),p.overrideClearAlpha=1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new ua(1,1,{minFilter:la,magFilter:la}),this.renderTarget.texture.name="NormalPass.Target");const x=this.resolution=new Us(this,l,u,n);x.addEventListener("change",g=>this.setSize(x.baseWidth,x.baseHeight))}set mainScene(i){this.renderPass.mainScene=i}set mainCamera(i){this.renderPass.mainCamera=i}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}render(i,e,t,n,a){const r=this.renderToScreen?null:this.renderTarget;this.renderPass.render(i,r,r)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height)}};function eg(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}new Ge;new Ge;function GR(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}var oo=function i(e,t,n){var a=this;GR(this,i),eg(this,"dot2",function(r,l){return a.x*r+a.y*l}),eg(this,"dot3",function(r,l,u){return a.x*r+a.y*l+a.z*u}),this.x=e,this.y=t,this.z=n},Iz=[new oo(1,1,0),new oo(-1,1,0),new oo(1,-1,0),new oo(-1,-1,0),new oo(1,0,1),new oo(-1,0,1),new oo(1,0,-1),new oo(-1,0,-1),new oo(0,1,1),new oo(0,-1,1),new oo(0,1,-1),new oo(0,-1,-1)],CE=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],RE=new Array(512),wE=new Array(512),Pz=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var t=0;t<256;t++){var n;t&1?n=CE[t]^e&255:n=CE[t]^e>>8&255,RE[t]=RE[t+256]=n,wE[t]=wE[t+256]=Iz[n%12]}};Pz(0);function Fz(i){if(typeof i=="number")i=Math.abs(i);else if(typeof i=="string"){var e=i;i=0;for(var t=0;t<e.length;t++)i=(i+(t+1)*(e.charCodeAt(t)%96))%2147483647}return i===0&&(i=311),i}function BE(i){var e=Fz(i);return function(){var t=e*48271%2147483647;return e=t,t/2147483647}}var zz=function i(e){var t=this;GR(this,i),eg(this,"seed",0),eg(this,"init",function(n){t.seed=n,t.value=BE(n)}),eg(this,"value",BE(this.seed)),this.init(e)};new zz(Math.random());const Hz=k.createContext(null),DE=i=>(i.getAttributes()&2)===2,Gz=k.memo(k.forwardRef(({children:i,camera:e,scene:t,resolutionScale:n,enabled:a=!0,renderPriority:r=1,autoClear:l=!0,depthBuffer:u,enableNormalPass:d,stencilBuffer:p,multisampling:x=8,frameBufferType:g=wa},_)=>{const{gl:y,scene:b,camera:C,size:E}=tr(),S=t||b,w=e||C,[D,U,F]=k.useMemo(()=>{const j=new RF(y,{depthBuffer:u,stencilBuffer:p,multisampling:x,frameBufferType:g});j.addPass(new HR(S,w));let L=null,P=null;return d&&(P=new Lz(S,w),P.enabled=!1,j.addPass(P),n!==void 0&&(L=new wz({normalBuffer:P.texture,resolutionScale:n}),L.enabled=!1,j.addPass(L))),[j,P,L]},[w,y,u,p,x,g,S,d,n]);k.useEffect(()=>D?.setSize(E.width,E.height),[D,E]),Ns((j,L)=>{if(a){const P=y.autoClear;y.autoClear=l,p&&!l&&y.clearStencil(),D.render(L),y.autoClear=P}},a?r:0);const N=k.useRef(null);k.useLayoutEffect(()=>{const j=[],L=N.current.__r3f;if(L&&D){const P=L.children;for(let q=0;q<P.length;q++){const ie=P[q].object;if(ie instanceof kb){const se=[ie];if(!DE(ie)){let re=null;for(;(re=P[q+1]?.object)instanceof kb&&!DE(re);)se.push(re),q++}const ae=new Nz(w,...se);j.push(ae)}else ie instanceof _r&&j.push(ie)}for(const q of j)D?.addPass(q);U&&(U.enabled=!0),F&&(F.enabled=!0)}return()=>{for(const P of j)D?.removePass(P);U&&(U.enabled=!1),F&&(F.enabled=!1)}},[D,i,w,U,F]),k.useEffect(()=>{const j=y.toneMapping;return y.toneMapping=Jo,()=>{y.toneMapping=j}},[y]);const z=k.useMemo(()=>({composer:D,normalPass:U,downSamplingPass:F,resolutionScale:n,camera:w,scene:S}),[D,U,F,n,w,S]);return k.useImperativeHandle(_,()=>D,[D]),B.jsx(Hz.Provider,{value:z,children:B.jsx("group",{ref:N,children:i})})}));let Vz=0;const UE=new WeakMap,kz=(i,e)=>function({blendFunction:t=e?.blendFunction,opacity:n=e?.opacity,...a}){let r=UE.get(i);if(!r){const d=`@react-three/postprocessing/${i.name}-${Vz++}`;Jy({[d]:i}),UE.set(i,r=d)}const l=tr(d=>d.camera),u=Rc.useMemo(()=>[...e?.args??[],...a.args??[{...e,...a}]],[JSON.stringify(a)]);return B.jsx(r,{camera:l,"blendMode-blendFunction":t,"blendMode-opacity-value":n,...a,args:u})},jz=kz(Ez,{blendFunction:0}),Xz="_hud_1qn9r_5",Yz={hud:Xz};function qz({children:i}){return B.jsx("div",{className:Yz.hud,children:i})}const Kz="_connector_rriev_5",Jz="_vertical_rriev_23",Wz="_bar_rriev_31",Zz="_horizontal_rriev_45",Qz="_bottom_rriev_67",$z="_top_rriev_81",e6="_left_rriev_103",t6="_right_rriev_125",n6="_jewel_rriev_209",gp={connector:Kz,vertical:Jz,bar:Wz,horizontal:Zz,bottom:Qz,top:$z,left:e6,right:t6,jewel:n6};function ly({position:i="bottom",className:e=""}){const t=i==="left"||i==="right";return B.jsxs("div",{className:`${gp.connector} ${gp[i]} ${t?gp.horizontal:gp.vertical} ${e}`,children:[B.jsx("div",{className:gp.bar}),B.jsx("div",{className:gp.jewel})]})}var VR=eT();const i6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20-%20Ice%20theme%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%231a202e'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%230d1018'%20stroke='%232a3a4a'%20stroke-width='1'/%3e%3c!--%20Ground%20shadow%20--%3e%3cellipse%20cx='32'%20cy='56'%20rx='16'%20ry='3'%20fill='%234a8fb8'%20opacity='0.3'/%3e%3c!--%20Impact%20crack%20lines%20--%3e%3cline%20x1='32'%20y1='56'%20x2='18'%20y2='60'%20stroke='%235ba4d0'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cline%20x1='32'%20y1='56'%20x2='46'%20y2='60'%20stroke='%235ba4d0'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cline%20x1='32'%20y1='56'%20x2='24'%20y2='62'%20stroke='%234a8fb8'%20stroke-width='1'%20stroke-linecap='round'/%3e%3cline%20x1='32'%20y1='56'%20x2='40'%20y2='62'%20stroke='%234a8fb8'%20stroke-width='1'%20stroke-linecap='round'/%3e%3c!--%20Main%20ice%20shard%20-%20bold%20clean%20shape%20--%3e%3cpolygon%20points='32,4%2040,28%2038,42%2032,56%2026,42%2024,28'%20fill='%235ba4d0'%20stroke='%238ed3f7'%20stroke-width='2'%20stroke-linejoin='round'/%3e%3c!--%20Inner%20highlight%20--%3e%3cpolygon%20points='32,8%2036,28%2034,40%2032,50'%20fill='%238ed3f7'%20opacity='0.6'/%3e%3c!--%20Side%20shards%20--%3e%3cpolygon%20points='14,20%2020,32%2014,44'%20fill='%234a8fb8'%20stroke='%236ab8e0'%20stroke-width='1.5'%20stroke-linejoin='round'/%3e%3cpolygon%20points='50,20%2044,32%2050,44'%20fill='%234a8fb8'%20stroke='%236ab8e0'%20stroke-width='1.5'%20stroke-linejoin='round'/%3e%3c!--%20Shard%20highlights%20--%3e%3cline%20x1='32'%20y1='6'%20x2='32'%20y2='18'%20stroke='%23c0e8ff'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cline%20x1='16'%20y1='24'%20x2='16'%20y2='32'%20stroke='%238ed3f7'%20stroke-width='1'%20stroke-linecap='round'/%3e%3cline%20x1='48'%20y1='24'%20x2='48'%20y2='32'%20stroke='%238ed3f7'%20stroke-width='1'%20stroke-linecap='round'/%3e%3c/svg%3e",a6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%232e1a1a'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%2317110d'%20stroke='%23442a2a'%20stroke-width='1'/%3e%3c!--%20Ground%20impact%20glow%20--%3e%3cellipse%20cx='32'%20cy='56'%20rx='18'%20ry='4'%20fill='%23e85a30'%20opacity='0.4'/%3e%3cellipse%20cx='32'%20cy='56'%20rx='12'%20ry='2'%20fill='%23ffa040'%20opacity='0.3'/%3e%3c!--%20Impact%20crack%20lines%20--%3e%3cline%20x1='32'%20y1='56'%20x2='14'%20y2='60'%20stroke='%23e85a30'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cline%20x1='32'%20y1='56'%20x2='50'%20y2='60'%20stroke='%23e85a30'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cline%20x1='32'%20y1='56'%20x2='22'%20y2='62'%20stroke='%23c04820'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cline%20x1='32'%20y1='56'%20x2='42'%20y2='62'%20stroke='%23c04820'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c!--%20Fire%20trail%20--%3e%3cpath%20d='M32,8%20L38,16%20L34,20%20L40,28%20L32,36'%20fill='none'%20stroke='%23ffa040'%20stroke-width='3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M32,8%20L26,16%20L30,20%20L24,28%20L32,36'%20fill='none'%20stroke='%23e85a30'%20stroke-width='3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c!--%20Main%20meteor%20-%20bold%20circle%20--%3e%3ccircle%20cx='32'%20cy='42'%20r='12'%20fill='%23c04820'%20stroke='%23e85a30'%20stroke-width='2.5'/%3e%3c!--%20Rock%20texture%20--%3e%3ccircle%20cx='28'%20cy='40'%20r='3'%20fill='%238a3018'%20opacity='0.8'/%3e%3ccircle%20cx='36'%20cy='44'%20r='2.5'%20fill='%236a2010'%20opacity='0.7'/%3e%3ccircle%20cx='34'%20cy='38'%20r='2'%20fill='%235a1808'%20opacity='0.6'/%3e%3c!--%20Hot%20glow%20highlight%20--%3e%3ccircle%20cx='30'%20cy='38'%20r='4'%20fill='%23ffa040'%20opacity='0.5'/%3e%3ccircle%20cx='28'%20cy='36'%20r='2'%20fill='%23ffd080'%20opacity='0.6'/%3e%3c!--%20Embers%20--%3e%3ccircle%20cx='22'%20cy='20'%20r='2'%20fill='%23ffa040'/%3e%3ccircle%20cx='42'%20cy='18'%20r='1.5'%20fill='%23e85a30'/%3e%3ccircle%20cx='18'%20cy='32'%20r='1.5'%20fill='%23e85a30'/%3e%3ccircle%20cx='46'%20cy='30'%20r='2'%20fill='%23ffa040'/%3e%3c/svg%3e",kR="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%231a1a2e'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%230d0d17'%20stroke='%232a2a44'%20stroke-width='1'/%3e%3c!--%20Motion%20trail%20lines%20--%3e%3cline%20x1='6'%20y1='20'%20x2='24'%20y2='20'%20stroke='%237a5aaa'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cline%20x1='4'%20y1='28'%20x2='28'%20y2='28'%20stroke='%239070c0'%20stroke-width='2.5'%20stroke-linecap='round'/%3e%3cline%20x1='2'%20y1='36'%20x2='30'%20y2='36'%20stroke='%23a888d8'%20stroke-width='3'%20stroke-linecap='round'/%3e%3cline%20x1='4'%20y1='44'%20x2='28'%20y2='44'%20stroke='%239070c0'%20stroke-width='2.5'%20stroke-linecap='round'/%3e%3cline%20x1='6'%20y1='52'%20x2='24'%20y2='52'%20stroke='%237a5aaa'%20stroke-width='2'%20stroke-linecap='round'/%3e%3c!--%20Force%20field%20dome%20--%3e%3cpath%20d='M34,8%20Q58,16%2058,36%20Q58,56%2034,64'%20fill='none'%20stroke='%23a888d8'%20stroke-width='3'%20stroke-linecap='round'/%3e%3c!--%20Inner%20dome%20lines%20--%3e%3cpath%20d='M36,14%20Q52,20%2052,36%20Q52,52%2036,58'%20fill='none'%20stroke='%239070c0'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cpath%20d='M38,20%20Q46,24%2046,36%20Q46,48%2038,52'%20fill='none'%20stroke='%237a5aaa'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c!--%20Shield%20fill%20--%3e%3cpath%20d='M34,10%20Q56,18%2056,36%20Q56,54%2034,62%20L34,10'%20fill='%237a5aaa'%20opacity='0.15'/%3e%3c!--%20Energy%20glow%20on%20edge%20--%3e%3ccircle%20cx='54'%20cy='24'%20r='3'%20fill='%23c0a8e8'%20opacity='0.8'/%3e%3ccircle%20cx='56'%20cy='36'%20r='2.5'%20fill='%23d0b8f0'%20opacity='0.9'/%3e%3ccircle%20cx='54'%20cy='48'%20r='3'%20fill='%23c0a8e8'%20opacity='0.8'/%3e%3c!--%20Bright%20leading%20edge%20highlight%20--%3e%3cpath%20d='M56,28%20Q60,32%2060,36%20Q60,40%2056,44'%20fill='none'%20stroke='%23e0d0ff'%20stroke-width='2'%20stroke-linecap='round'/%3e%3c!--%20Trail%20particles%20--%3e%3ccircle%20cx='16'%20cy='24'%20r='2'%20fill='%237a5aaa'%20opacity='0.7'/%3e%3ccircle%20cx='12'%20cy='36'%20r='2.5'%20fill='%239070c0'%20opacity='0.6'/%3e%3ccircle%20cx='16'%20cy='48'%20r='2'%20fill='%237a5aaa'%20opacity='0.7'/%3e%3ccircle%20cx='8'%20cy='32'%20r='1.5'%20fill='%236a4a9a'%20opacity='0.5'/%3e%3ccircle%20cx='8'%20cy='40'%20r='1.5'%20fill='%236a4a9a'%20opacity='0.5'/%3e%3c/svg%3e",OE="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20-%20Mana%20theme%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%231a1a2e'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%230d0d17'%20stroke='%232a3a5a'%20stroke-width='1'/%3e%3c!--%20Outer%20aura%20glow%20--%3e%3cellipse%20cx='32'%20cy='32'%20rx='24'%20ry='26'%20fill='url(%23auraGlow)'%20opacity='0.4'/%3e%3c!--%20Body%20silhouette%20--%3e%3cpath%20d='M32,12%20C32,12%2024,18%2024,28%20C24,34%2026,38%2028,42%20L26,52%20L32,50%20L38,52%20L36,42%20C38,38%2040,34%2040,28%20C40,18%2032,12%2032,12%20Z'%20fill='%231a1a3a'%20stroke='%234a6090'%20stroke-width='1.5'/%3e%3c!--%20Inner%20mana%20energy%20--%3e%3cellipse%20cx='32'%20cy='28'%20rx='8'%20ry='10'%20fill='url(%23manaCore)'%20opacity='0.9'/%3e%3c!--%20Energy%20veins%20--%3e%3cpath%20d='M32,20%20L32,36'%20stroke='%2360a0ff'%20stroke-width='1.5'%20stroke-linecap='round'%20opacity='0.8'/%3e%3cpath%20d='M28,24%20L32,28%20L36,24'%20stroke='%2360a0ff'%20stroke-width='1'%20stroke-linecap='round'%20fill='none'%20opacity='0.6'/%3e%3cpath%20d='M28,32%20L32,28%20L36,32'%20stroke='%2360a0ff'%20stroke-width='1'%20stroke-linecap='round'%20fill='none'%20opacity='0.6'/%3e%3c!--%20Mana%20particles%20--%3e%3ccircle%20cx='20'%20cy='22'%20r='2'%20fill='%2380c0ff'%20opacity='0.7'/%3e%3ccircle%20cx='44'%20cy='24'%20r='1.5'%20fill='%2360a0ff'%20opacity='0.6'/%3e%3ccircle%20cx='18'%20cy='36'%20r='1.5'%20fill='%2360a0ff'%20opacity='0.5'/%3e%3ccircle%20cx='46'%20cy='38'%20r='2'%20fill='%2380c0ff'%20opacity='0.7'/%3e%3ccircle%20cx='24'%20cy='46'%20r='1'%20fill='%2340a0ff'%20opacity='0.5'/%3e%3ccircle%20cx='40'%20cy='44'%20r='1.5'%20fill='%2360a0ff'%20opacity='0.6'/%3e%3c!--%20Heart%20symbol%20(health%20cost%20indicator)%20--%3e%3cpath%20d='M32,50%20L30,48%20C28,46%2026,44%2026,42%20C26,40%2027.5,39%2029,39%20C30,39%2031,39.5%2032,40.5%20C33,39.5%2034,39%2035,39%20C36.5,39%2038,40%2038,42%20C38,44%2036,46%2034,48%20Z'%20fill='%23c04040'%20stroke='%23ff6060'%20stroke-width='0.5'%20opacity='0.9'/%3e%3c!--%20Bright%20core%20highlight%20--%3e%3ccircle%20cx='32'%20cy='26'%20r='3'%20fill='%23a0d0ff'%20opacity='0.6'/%3e%3ccircle%20cx='31'%20cy='25'%20r='1.5'%20fill='%23ffffff'%20opacity='0.5'/%3e%3c!--%20Defs%20for%20gradients%20--%3e%3cdefs%3e%3cradialGradient%20id='auraGlow'%20cx='50%25'%20cy='50%25'%20r='50%25'%3e%3cstop%20offset='0%25'%20stop-color='%2360a0ff'/%3e%3cstop%20offset='100%25'%20stop-color='%2360a0ff'%20stop-opacity='0'/%3e%3c/radialGradient%3e%3cradialGradient%20id='manaCore'%20cx='50%25'%20cy='40%25'%20r='50%25'%3e%3cstop%20offset='0%25'%20stop-color='%23a0d0ff'/%3e%3cstop%20offset='50%25'%20stop-color='%234080ff'/%3e%3cstop%20offset='100%25'%20stop-color='%232040a0'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e",s6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%231a1a2e'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%230d0d17'%20stroke='%232a2a44'%20stroke-width='1'/%3e%3c!--%20Motion%20trail%20--%3e%3cline%20x1='4'%20y1='32'%20x2='18'%20y2='32'%20stroke='%237a5aaa'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cline%20x1='8'%20y1='28'%20x2='20'%20y2='30'%20stroke='%236a4a9a'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cline%20x1='8'%20y1='36'%20x2='20'%20y2='34'%20stroke='%236a4a9a'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c!--%20Trail%20particles%20--%3e%3ccircle%20cx='10'%20cy='26'%20r='1.5'%20fill='%239070c0'%20opacity='0.6'/%3e%3ccircle%20cx='6'%20cy='32'%20r='2'%20fill='%23a888d8'%20opacity='0.5'/%3e%3ccircle%20cx='10'%20cy='38'%20r='1.5'%20fill='%239070c0'%20opacity='0.6'/%3e%3ccircle%20cx='14'%20cy='24'%20r='1'%20fill='%237a5aaa'%20opacity='0.4'/%3e%3ccircle%20cx='14'%20cy='40'%20r='1'%20fill='%237a5aaa'%20opacity='0.4'/%3e%3c!--%20Main%20bolt%20shape%20-%20elongated%20diamond%20--%3e%3cpolygon%20points='24,32%2036,24%2056,32%2036,40'%20fill='%239070c0'%20stroke='%23c0a8e8'%20stroke-width='2'%20stroke-linejoin='round'/%3e%3c!--%20Inner%20energy%20core%20--%3e%3cpolygon%20points='28,32%2038,26%2050,32%2038,38'%20fill='%23a888d8'%20opacity='0.7'/%3e%3cpolygon%20points='32,32%2040,28%2046,32%2040,36'%20fill='%23c0a8e8'%20opacity='0.8'/%3e%3c!--%20Bright%20center%20highlight%20--%3e%3cellipse%20cx='40'%20cy='32'%20rx='4'%20ry='2'%20fill='%23e0d0ff'%20opacity='0.9'/%3e%3cellipse%20cx='42'%20cy='32'%20rx='2'%20ry='1'%20fill='%23ffffff'%20opacity='0.8'/%3e%3c!--%20Tip%20glow%20--%3e%3ccircle%20cx='54'%20cy='32'%20r='4'%20fill='%23c0a8e8'%20opacity='0.5'/%3e%3ccircle%20cx='56'%20cy='32'%20r='2'%20fill='%23e0d0ff'%20opacity='0.7'/%3e%3c!--%20Energy%20wisps%20--%3e%3cpath%20d='M36,22%20Q42,18%2046,22'%20fill='none'%20stroke='%23a888d8'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M36,42%20Q42,46%2046,42'%20fill='none'%20stroke='%23a888d8'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e",r6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%231a1a2e'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%230d0d17'%20stroke='%232a2a44'%20stroke-width='1'/%3e%3c!--%20Outer%20explosion%20rays%20--%3e%3cline%20x1='32'%20y1='4'%20x2='32'%20y2='14'%20stroke='%237a5aaa'%20stroke-width='2.5'%20stroke-linecap='round'/%3e%3cline%20x1='32'%20y1='50'%20x2='32'%20y2='60'%20stroke='%237a5aaa'%20stroke-width='2.5'%20stroke-linecap='round'/%3e%3cline%20x1='4'%20y1='32'%20x2='14'%20y2='32'%20stroke='%237a5aaa'%20stroke-width='2.5'%20stroke-linecap='round'/%3e%3cline%20x1='50'%20y1='32'%20x2='60'%20y2='32'%20stroke='%237a5aaa'%20stroke-width='2.5'%20stroke-linecap='round'/%3e%3c!--%20Diagonal%20rays%20--%3e%3cline%20x1='10'%20y1='10'%20x2='18'%20y2='18'%20stroke='%236a4a9a'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cline%20x1='46'%20y1='18'%20x2='54'%20y2='10'%20stroke='%236a4a9a'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cline%20x1='10'%20y1='54'%20x2='18'%20y2='46'%20stroke='%236a4a9a'%20stroke-width='2'%20stroke-linecap='round'/%3e%3cline%20x1='46'%20y1='46'%20x2='54'%20y2='54'%20stroke='%236a4a9a'%20stroke-width='2'%20stroke-linecap='round'/%3e%3c!--%20Outer%20ring%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='18'%20fill='none'%20stroke='%239070c0'%20stroke-width='3'%20opacity='0.6'/%3e%3c!--%20Inner%20ring%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='12'%20fill='%237a5aaa'%20opacity='0.3'%20stroke='%23a888d8'%20stroke-width='2'/%3e%3c!--%20Core%20explosion%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='8'%20fill='%239070c0'%20stroke='%23c0a8e8'%20stroke-width='2'/%3e%3c!--%20Inner%20glow%20layers%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='5'%20fill='%23a888d8'%20opacity='0.8'/%3e%3ccircle%20cx='32'%20cy='32'%20r='3'%20fill='%23c0a8e8'%20opacity='0.9'/%3e%3ccircle%20cx='32'%20cy='32'%20r='1.5'%20fill='%23ffffff'%20opacity='0.95'/%3e%3c!--%20Energy%20sparks%20--%3e%3ccircle%20cx='22'%20cy='22'%20r='2'%20fill='%23c0a8e8'%20opacity='0.8'/%3e%3ccircle%20cx='42'%20cy='22'%20r='2'%20fill='%23c0a8e8'%20opacity='0.8'/%3e%3ccircle%20cx='22'%20cy='42'%20r='2'%20fill='%23c0a8e8'%20opacity='0.8'/%3e%3ccircle%20cx='42'%20cy='42'%20r='2'%20fill='%23c0a8e8'%20opacity='0.8'/%3e%3c!--%20Bright%20edge%20highlights%20--%3e%3ccircle%20cx='20'%20cy='32'%20r='1.5'%20fill='%23e0d0ff'%20opacity='0.7'/%3e%3ccircle%20cx='44'%20cy='32'%20r='1.5'%20fill='%23e0d0ff'%20opacity='0.7'/%3e%3ccircle%20cx='32'%20cy='20'%20r='1.5'%20fill='%23e0d0ff'%20opacity='0.7'/%3e%3ccircle%20cx='32'%20cy='44'%20r='1.5'%20fill='%23e0d0ff'%20opacity='0.7'/%3e%3c/svg%3e",NE="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20-%20Healing%20theme%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%232e1a1a'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%23170d0d'%20stroke='%23442a2a'%20stroke-width='1'/%3e%3cdefs%3e%3clinearGradient%20id='potionGlow'%20x1='0%25'%20y1='0%25'%20x2='100%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%23ff6b6b'/%3e%3cstop%20offset='50%25'%20style='stop-color:%23ee5a5a'/%3e%3cstop%20offset='100%25'%20style='stop-color:%23cc4444'/%3e%3c/linearGradient%3e%3clinearGradient%20id='glassShine'%20x1='0%25'%20y1='0%25'%20x2='100%25'%20y2='0%25'%3e%3cstop%20offset='0%25'%20style='stop-color:rgba(255,255,255,0.4)'/%3e%3cstop%20offset='50%25'%20style='stop-color:rgba(255,255,255,0.1)'/%3e%3cstop%20offset='100%25'%20style='stop-color:rgba(255,255,255,0)'/%3e%3c/linearGradient%3e%3cfilter%20id='innerGlow'%3e%3cfeGaussianBlur%20stdDeviation='2'%20result='blur'/%3e%3cfeComposite%20in='SourceGraphic'%20in2='blur'%20operator='over'/%3e%3c/filter%3e%3c/defs%3e%3c!--%20Cork/stopper%20--%3e%3crect%20x='24'%20y='10'%20width='16'%20height='8'%20rx='2'%20fill='%238B5A2B'%20stroke='%236d4520'%20stroke-width='1'/%3e%3crect%20x='25'%20y='11'%20width='6'%20height='6'%20rx='1'%20fill='%23A0522D'%20opacity='0.6'/%3e%3c!--%20Bottle%20neck%20--%3e%3cpath%20d='M26%2018%20L26%2024%20Q26%2026%2028%2026%20L36%2026%20Q38%2026%2038%2024%20L38%2018'%20fill='%232a3a4a'%20stroke='%234a5a6a'%20stroke-width='1'/%3e%3c!--%20Bottle%20body%20--%3e%3cpath%20d='M28%2026%20L22%2034%20Q18%2040%2018%2046%20L18%2052%20Q18%2058%2024%2058%20L40%2058%20Q46%2058%2046%2052%20L46%2046%20Q46%2040%2042%2034%20L36%2026'%20fill='url(%23potionGlow)'%20stroke='%23aa3333'%20stroke-width='1.5'%20filter='url(%23innerGlow)'/%3e%3c!--%20Glass%20shine%20--%3e%3cpath%20d='M28%2028%20L24%2034%20Q22%2038%2022%2042%20L22%2050%20Q22%2054%2026%2054'%20fill='none'%20stroke='url(%23glassShine)'%20stroke-width='3'%20stroke-linecap='round'/%3e%3c!--%20Bubbles%20--%3e%3ccircle%20cx='28'%20cy='46'%20r='2'%20fill='rgba(255,255,255,0.5)'/%3e%3ccircle%20cx='36'%20cy='50'%20r='1.5'%20fill='rgba(255,255,255,0.4)'/%3e%3ccircle%20cx='32'%20cy='42'%20r='1'%20fill='rgba(255,255,255,0.6)'/%3e%3c!--%20Heart%20symbol%20--%3e%3cpath%20d='M32%2040%20C30%2038%2027%2038%2027%2041%20C27%2044%2032%2048%2032%2048%20C32%2048%2037%2044%2037%2041%20C37%2038%2034%2038%2032%2040'%20fill='%23ffcccc'%20opacity='0.8'/%3e%3c/svg%3e",LE="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20-%20Consumable%20theme%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%231a1a2e'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%230d0d17'%20stroke='%232a2a44'%20stroke-width='1'/%3e%3cdefs%3e%3clinearGradient%20id='potBody'%20x1='0%25'%20y1='0%25'%20x2='0%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%235a5a5a'/%3e%3cstop%20offset='30%25'%20style='stop-color:%234a4a4a'/%3e%3cstop%20offset='100%25'%20style='stop-color:%23303030'/%3e%3c/linearGradient%3e%3clinearGradient%20id='potRim'%20x1='0%25'%20y1='0%25'%20x2='0%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%236a6a6a'/%3e%3cstop%20offset='100%25'%20style='stop-color:%234a4a4a'/%3e%3c/linearGradient%3e%3cradialGradient%20id='stewHighlight'%20cx='30%25'%20cy='30%25'%20r='50%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%23e8a060'/%3e%3cstop%20offset='100%25'%20style='stop-color:%23a85d32'/%3e%3c/radialGradient%3e%3cfilter%20id='glow'%3e%3cfeGaussianBlur%20stdDeviation='1.5'%20result='blur'/%3e%3cfeComposite%20in='SourceGraphic'%20in2='blur'%20operator='over'/%3e%3c/filter%3e%3c/defs%3e%3c!--%20Steam%20wisps%20--%3e%3cpath%20d='M24%2016%20Q22%2010%2025%206'%20stroke='rgba(255,255,255,0.5)'%20stroke-width='2'%20fill='none'%20stroke-linecap='round'/%3e%3cpath%20d='M32%2014%20Q30%208%2033%204'%20stroke='rgba(255,255,255,0.6)'%20stroke-width='2'%20fill='none'%20stroke-linecap='round'/%3e%3cpath%20d='M40%2016%20Q38%2010%2041%206'%20stroke='rgba(255,255,255,0.5)'%20stroke-width='2'%20fill='none'%20stroke-linecap='round'/%3e%3c!--%20Pot%20handles%20--%3e%3cellipse%20cx='14'%20cy='40'%20rx='4'%20ry='5'%20fill='none'%20stroke='url(%23potRim)'%20stroke-width='3'/%3e%3cellipse%20cx='50'%20cy='40'%20rx='4'%20ry='5'%20fill='none'%20stroke='url(%23potRim)'%20stroke-width='3'/%3e%3c!--%20Pot%20body%20--%3e%3cpath%20d='M16%2030%20L16%2050%20Q16%2058%2026%2058%20L38%2058%20Q48%2058%2048%2050%20L48%2030'%20fill='url(%23potBody)'%20stroke='%232a2a2a'%20stroke-width='1'/%3e%3c!--%20Pot%20rim%20--%3e%3cellipse%20cx='32'%20cy='30'%20rx='18'%20ry='5'%20fill='url(%23potRim)'%20stroke='%232a2a2a'%20stroke-width='1'/%3e%3c!--%20Stew%20surface%20--%3e%3cellipse%20cx='32'%20cy='30'%20rx='14'%20ry='3.5'%20fill='url(%23stewHighlight)'%20filter='url(%23glow)'/%3e%3c!--%20Stew%20chunks%20-%20carrots%20--%3e%3cellipse%20cx='26'%20cy='29'%20rx='2.5'%20ry='1.2'%20fill='%23e87830'%20transform='rotate(-15%2026%2029)'/%3e%3cellipse%20cx='38'%20cy='31'%20rx='2'%20ry='1'%20fill='%23e87830'%20transform='rotate(20%2038%2031)'/%3e%3c!--%20Stew%20chunks%20-%20potatoes%20--%3e%3cellipse%20cx='32'%20cy='28'%20rx='2.5'%20ry='1.5'%20fill='%23d4b896'/%3e%3cellipse%20cx='24'%20cy='31'%20rx='1.5'%20ry='1'%20fill='%23d4b896'/%3e%3c!--%20Stew%20chunks%20-%20meat%20--%3e%3cellipse%20cx='36'%20cy='29'%20rx='2'%20ry='1.2'%20fill='%238b5030'/%3e%3cellipse%20cx='28'%20cy='30'%20rx='1.5'%20ry='1'%20fill='%238b5030'/%3e%3c!--%20Herbs/green%20--%3e%3ccircle%20cx='30'%20cy='29'%20r='0.7'%20fill='%236a9a50'/%3e%3ccircle%20cx='34'%20cy='30'%20r='0.5'%20fill='%236a9a50'/%3e%3ccircle%20cx='40'%20cy='29'%20r='0.6'%20fill='%236a9a50'/%3e%3c!--%20Pot%20shine%20--%3e%3cpath%20d='M20%2034%20L20%2046'%20stroke='rgba(255,255,255,0.15)'%20stroke-width='2'%20stroke-linecap='round'/%3e%3c!--%20Rim%20highlight%20--%3e%3cpath%20d='M18%2028%20Q32%2022%2046%2028'%20fill='none'%20stroke='rgba(255,255,255,0.2)'%20stroke-width='1.5'/%3e%3c/svg%3e",Fa={ice:{id:"ice",name:"Ice",primary:"#5ba4d0",secondary:"#8ed3f7",glow:"#5ba4d0",dark:"#1a3a4a"},fire:{id:"fire",name:"Fire",primary:"#e85a30",secondary:"#ffa040",glow:"#ff6b35",dark:"#4a1a10"},arcane:{id:"arcane",name:"Arcane",primary:"#9070c0",secondary:"#c0a8e8",glow:"#bb77ff",dark:"#2a1a3a"},mana:{id:"mana",name:"Mana",primary:"#4080ff",secondary:"#80c0ff",glow:"#60a0ff",dark:"#0d1a3a"},healing:{id:"healing",name:"Healing",primary:"#e85050",secondary:"#ff8080",glow:"#ff6b6b",dark:"#3a1010"}},Bh={SKILL_1:{id:"skill_1",label:"Ice Shard",description:"Hurl a freezing shard of ice at your target, dealing frost damage.",type:"Cast",element:"ice",defaultKey:"KeyQ",fsmAction:"ATTACK",displayKey:"Q",icon:i6,manaCost:15},SKILL_2:{id:"skill_2",label:"Meteor",description:"Conjure a blazing meteor from the sky, crashing down with explosive fire damage.",type:"Cast",element:"fire",defaultKey:"KeyW",fsmAction:"CAST",displayKey:"W",icon:a6,manaCost:35},SKILL_3:{id:"skill_3",label:"Arcane Rush",description:"Channel arcane power to dash forward at high speed. Drains mana while active.",type:"Channel",element:"arcane",defaultKey:"KeyE",fsmAction:"MOVE",displayKey:"E",icon:kR,manaCost:0,manaPerSecond:15},SKILL_4:{id:"skill_4",label:"Mana Body",description:"Sacrifice your life force to infuse your body with pure mana, greatly increasing mana regeneration.",type:"Buff",element:"mana",defaultKey:"KeyR",fsmAction:"CAST",displayKey:"R",icon:OE,healthCost:25,manaCost:0,buff:{id:"mana_body",name:"Mana Body",icon:OE,duration:30,manaRegenBonus:10}},PRIMARY_ATTACK:{id:"primary_attack",label:"Arcane Bolt",description:"Launch a bolt of arcane energy at your target, restoring mana on hit.",type:"Attack",element:"arcane",defaultKey:"MouseLeft",fsmAction:"ATTACK",displayKey:"LMB",icon:s6,manaGain:8},SECONDARY_ATTACK:{id:"secondary_attack",label:"Arcane Blast",description:"Channel a powerful blast of arcane energy at your target.",type:"Cast",element:"arcane",defaultKey:"MouseRight",fsmAction:"CAST",displayKey:"RMB",icon:r6,manaCost:20},POTION:{id:"potion",label:"Health Potion",description:"Drink a restorative potion that heals you over time.",type:"Consumable",element:"healing",defaultKey:"KeyD",fsmAction:"INSTANT",displayKey:"D",icon:NE,manaCost:0,buff:{id:"health_potion",name:"Regeneration",icon:NE,duration:10,healthRegenBonus:8}},FOOD:{id:"food",label:"Mana Biscuit",description:"Eat an enchanted biscuit that restores mana over time.",type:"Consumable",element:"mana",defaultKey:"KeyF",fsmAction:"INSTANT",displayKey:"F",icon:LE,manaCost:0,buff:{id:"food_buff",name:"Mana Infused",icon:LE,duration:15,manaRegenBonus:5}}},eA=i=>{const e=Object.values(Bh).find(t=>t.id===i);return e?.element&&Fa[e.element]||null},IE=i=>Object.values(Bh).find(t=>t.id===i)?.fsmAction||null,Xo=i=>Object.values(Bh).find(e=>e.id===i),o6=i=>i?i.dragType?i.dragType:i.type==="Consumable"?"consumable":"skill":null,l6=()=>Object.values(Bh).filter(i=>i.type!=="Consumable"),c6=()=>Object.values(Bh).filter(i=>i.type==="Consumable"),jR="player_slotmap",tA=[{id:"slot_1",defaultAction:"skill_1",position:0,slotType:"skill"},{id:"slot_2",defaultAction:"skill_2",position:1,slotType:"skill"},{id:"slot_3",defaultAction:"skill_3",position:2,slotType:"skill"},{id:"slot_4",defaultAction:"skill_4",position:3,slotType:"skill"}],nA=[{id:"slot_lmb",defaultAction:"primary_attack",position:4,slotType:"skill"},{id:"slot_rmb",defaultAction:"secondary_attack",position:5,slotType:"skill"}],cy=[{id:"slot_consumable_1",defaultAction:"potion",position:6,slotType:"consumable"},{id:"slot_consumable_2",defaultAction:"food",position:7,slotType:"consumable"}],Ih=[{id:"slot_pixie_1",defaultAction:null,position:8,slotType:"pixie"},{id:"slot_pixie_2",defaultAction:null,position:9,slotType:"pixie"},{id:"slot_pixie_3",defaultAction:null,position:10,slotType:"pixie"}],wg=[...tA,...nA,...cy,...Ih],XR=i=>wg.find(t=>t.id===i)?.slotType||null,YR=()=>wg.reduce((i,e)=>(i[e.id]=e.defaultAction,i),{}),yp=i=>{try{localStorage.setItem(jR,JSON.stringify(i))}catch(e){console.warn("Failed to save slotmap:",e)}},u6=()=>{const i=YR();try{const e=localStorage.getItem(jR);if(e){const t=JSON.parse(e),n={...i,...t};return yp(n),n}}catch(e){console.warn("Failed to load slotmap:",e)}return yp(i),i},qR=k.createContext(null);function f6({children:i}){const[e,t]=k.useState(u6),n=k.useCallback(_=>e[_]||null,[e]),a=k.useCallback(_=>{const y=e[_];return y&&Object.values(Bh).find(b=>b.id===y)||null},[e]),r=k.useCallback(_=>{const y=Object.entries(e).find(([b,C])=>C===_);return y?y[0]:null},[e]),l=k.useCallback((_,y)=>{t(b=>{const C={...b},E=Object.keys(C).find(S=>C[S]===y);return E&&E!==_&&(C[E]=b[_]),C[_]=y,yp(C),C})},[]),u=k.useCallback((_,y)=>{_!==y&&t(b=>{const C={...b},E=b[_],S=b[y];return C[_]=S,C[y]=E,yp(C),C})},[]),d=k.useCallback(_=>{t(y=>{const b={...y};return b[_]=null,yp(b),b})},[]),p=k.useCallback(()=>{const _=YR();t(_),yp(_)},[]),x=k.useCallback(()=>Object.values(Bh).filter(_=>_.type!=="Consumable"||_.element==="healing"),[]),g=k.useMemo(()=>({slotMap:e,getActionForSlot:n,getActionObjectForSlot:a,getSlotForAction:r,assignToSlot:l,swapSlots:u,clearSlot:d,resetToDefaults:p,getAssignableActions:x,SKILL_SLOTS:tA,MOUSE_SLOTS:nA,CONSUMABLE_SLOTS:cy,ALL_SLOTS:wg}),[e,n,a,r,l,u,d,p,x]);return B.jsx(qR.Provider,{value:g,children:i})}function ar(){return k.useContext(qR)}const KR=k.createContext(null);function h6({dragging:i,position:e}){return i?VR.createPortal(B.jsx("div",{style:{position:"fixed",left:e.x,top:e.y,transform:"translate(-50%, -50%)",pointerEvents:"none",zIndex:1e4,opacity:.9,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.5))"},children:i.icon&&B.jsx("div",{style:{width:48,height:48,borderRadius:8,background:"linear-gradient(180deg, rgba(60,45,30,0.95) 0%, rgba(25,18,10,0.98) 100%)",border:"2px solid #8a6a40",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 0 20px rgba(255,180,80,0.3)"},children:B.jsx("img",{src:i.icon,alt:i.label,style:{width:32,height:32}})})}),document.body):null}function d6({children:i}){const[e,t]=k.useState(null),[n,a]=k.useState({x:0,y:0}),[r,l]=k.useState(new Map),{assignToSlot:u,swapSlots:d}=ar(),p=k.useCallback((S,w,D=null)=>{t({...S,sourceSlot:D}),a(w)},[]),x=k.useCallback(S=>{a(S)},[]),g=k.useCallback(S=>{if(!e)return;let w=null;if(r.forEach((D,U)=>{S.x>=D.left&&S.x<=D.right&&S.y>=D.top&&S.y<=D.bottom&&(w=U)}),w){const D=XR(w);e.dragType===D&&(e.sourceSlot&&e.sourceSlot!==w?d(e.sourceSlot,w):e.sourceSlot||u(w,e.id))}t(null)},[e,r,u,d]),_=k.useCallback(()=>{t(null)},[]),y=k.useCallback((S,w)=>{l(D=>{const U=new Map(D);return U.set(S,w),U})},[]),b=k.useCallback(S=>{l(w=>{const D=new Map(w);return D.delete(S),D})},[]),C=k.useCallback(S=>{if(!e)return!1;const w=r.get(S);return w?n.x>=w.left&&n.x<=w.right&&n.y>=w.top&&n.y<=w.bottom:!1},[e,r,n]),E=k.useMemo(()=>({dragging:e,isDragging:!!e,startDrag:p,updateDrag:x,endDrag:g,cancelDrag:_,registerDropTarget:y,unregisterDropTarget:b,isSlotHovered:C}),[e,p,x,g,_,y,b,C]);return k.useEffect(()=>{if(!e)return;const S=U=>{const F=U.touches?U.touches[0]:U;x({x:F.clientX,y:F.clientY})},w=U=>{const F=U.changedTouches?U.changedTouches[0]:U;g({x:F.clientX,y:F.clientY})},D=U=>{U.key==="Escape"&&_()};return window.addEventListener("mousemove",S),window.addEventListener("mouseup",w),window.addEventListener("touchmove",S,{passive:!1}),window.addEventListener("touchend",w),window.addEventListener("touchcancel",_),window.addEventListener("keydown",D),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",w),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",w),window.removeEventListener("touchcancel",_),window.removeEventListener("keydown",D)}},[e,x,g,_]),B.jsxs(KR.Provider,{value:E,children:[i,B.jsx(h6,{dragging:e,position:n})]})}function Zy(){const i=k.useContext(KR);if(!i)throw new Error("useDragDrop must be used within a DragDropProvider");return i}function iA(i){const{startDrag:e,isDragging:t}=Zy(),n=k.useRef(null),a=k.useRef(null),r=o6(i);return{handlers:k.useMemo(()=>({onPointerDown:u=>{i&&(a.current={x:u.clientX,y:u.clientY},u.pointerType==="touch"&&(n.current=setTimeout(()=>{e({...i,dragType:r},a.current)},300)))},onPointerMove:u=>{if(!(!a.current||!i)&&u.pointerType==="mouse"){const d=u.clientX-a.current.x,p=u.clientY-a.current.y;Math.sqrt(d*d+p*p)>5&&(e({...i,dragType:r},{x:u.clientX,y:u.clientY}),a.current=null)}},onPointerUp:()=>{n.current&&(clearTimeout(n.current),n.current=null),a.current=null},onPointerCancel:()=>{n.current&&(clearTimeout(n.current),n.current=null),a.current=null}}),[i,e,r]),isDragging:t}}function JR(i){const{registerDropTarget:e,unregisterDropTarget:t,isSlotHovered:n,isDragging:a}=Zy(),r=k.useRef(null);k.useEffect(()=>{if(!r.current)return;const u=()=>{if(r.current){const d=r.current.getBoundingClientRect();e(i,d)}};return u(),window.addEventListener("resize",u),window.addEventListener("scroll",u,!0),()=>{t(i),window.removeEventListener("resize",u),window.removeEventListener("scroll",u,!0)}},[i,e,t]);const l=n(i);return{ref:r,isHovered:l,isDragging:a}}const p6="_pressed_6i6om_273",m6="_key_6i6om_319",g6="_disabled_6i6om_365",v6="_tooltip_6i6om_409",Qi={"skill-bar":"_skill-bar_6i6om_5","skill-slot":"_skill-slot_6i6om_107","skill-icon":"_skill-icon_6i6om_169","drop-hover":"_drop-hover_6i6om_241",pressed:p6,key:m6,disabled:g6,"slot-wrapper":"_slot-wrapper_6i6om_401",tooltip:v6,"tooltip-header":"_tooltip-header_6i6om_499","tooltip-name":"_tooltip-name_6i6om_529","tooltip-badges":"_tooltip-badges_6i6om_543","tooltip-element":"_tooltip-element_6i6om_555","tooltip-type":"_tooltip-type_6i6om_581","tooltip-desc":"_tooltip-desc_6i6om_607","tooltip-stats":"_tooltip-stats_6i6om_623","tooltip-mana":"_tooltip-mana_6i6om_643","tooltip-mana-gain":"_tooltip-mana-gain_6i6om_651","tooltip-health":"_tooltip-health_6i6om_659","tooltip-heal":"_tooltip-heal_6i6om_659","tooltip-buff":"_tooltip-buff_6i6om_675"},WR=k.memo(k.forwardRef(function({slotId:e,actionId:t,keyBind:n,icon:a,active:r,disabled:l,tooltip:u,...d},p){const[x,g]=k.useState(!1),{ref:_,isHovered:y,isDragging:b}=JR(e),{startDrag:C}=Zy(),E=k.useRef(null),S=k.useRef(null),w=XR(e),D=z=>{_.current=z,p&&(typeof p=="function"?p(z):p.current=z)},U=z=>{!t||!a||(S.current={x:z.clientX,y:z.clientY},z.pointerType==="touch"&&(E.current=setTimeout(()=>{C({id:t,icon:a,label:u?.name||t,dragType:w},S.current,e)},300)))},F=z=>{if(!(!S.current||!t||!a)&&z.pointerType==="mouse"){const j=z.clientX-S.current.x,L=z.clientY-S.current.y;Math.sqrt(j*j+L*L)>5&&(C({id:t,icon:a,label:u?.name||t,dragType:w},{x:z.clientX,y:z.clientY},e),S.current=null)}},N=()=>{E.current&&(clearTimeout(E.current),E.current=null),S.current=null};return B.jsxs("div",{ref:D,className:Qi["slot-wrapper"],onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),onPointerDown:U,onPointerMove:F,onPointerUp:N,onPointerCancel:N,children:[B.jsxs("button",{className:`${Qi["skill-slot"]} ${r?Qi.pressed:""} ${l?Qi.disabled:""} ${y&&b?Qi["drop-hover"]:""}`,disabled:l,...d,children:[a&&B.jsx("img",{src:a,alt:"",className:Qi["skill-icon"]}),B.jsx("span",{className:Qi.key,children:n})]}),u&&x&&!b&&B.jsxs("div",{className:Qi.tooltip,children:[B.jsx(ly,{position:"bottom"}),B.jsxs("div",{className:Qi["tooltip-header"],children:[B.jsx("span",{className:Qi["tooltip-name"],children:u.name}),B.jsxs("div",{className:Qi["tooltip-badges"],children:[u.element&&B.jsx("span",{className:Qi["tooltip-element"],style:{"--element-color":u.element.primary},children:u.element.name}),u.type&&B.jsx("span",{className:Qi["tooltip-type"],children:u.type})]})]}),u.description&&B.jsx("p",{className:Qi["tooltip-desc"],children:u.description}),B.jsxs("div",{className:Qi["tooltip-stats"],children:[u.manaCost>0&&B.jsxs("span",{className:Qi["tooltip-mana"],children:["Mana: ",u.manaCost]}),u.manaGain>0&&B.jsxs("span",{className:Qi["tooltip-mana-gain"],children:["Mana: +",u.manaGain]}),u.manaPerSecond>0&&B.jsxs("span",{className:Qi["tooltip-mana"],children:["Mana/sec: ",u.manaPerSecond]}),u.healthCost>0&&B.jsxs("span",{className:Qi["tooltip-health"],children:["Health: ",u.healthCost]}),u.buff&&B.jsxs("span",{className:Qi["tooltip-buff"],children:["Duration: ",u.buff.duration,"s"]}),u.buff?.healthRegenBonus>0&&B.jsxs("span",{className:Qi["tooltip-heal"],children:["Heal/sec: +",u.buff.healthRegenBonus]}),u.buff?.manaRegenBonus>0&&B.jsxs("span",{className:Qi["tooltip-mana-gain"],children:["Mana/sec: +",u.buff.manaRegenBonus]})]})]})]})}));function x6({children:i}){return B.jsx("div",{className:Qi["skill-bar"],children:i})}const _6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20-%20Nature/Healing%20theme%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%231a2e1a'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%230d170d'%20stroke='%232a442a'%20stroke-width='1'/%3e%3cdefs%3e%3cradialGradient%20id='verdantGlow'%20cx='50%25'%20cy='50%25'%20r='50%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%2380ffa0'/%3e%3cstop%20offset='50%25'%20style='stop-color:%2340ff80'/%3e%3cstop%20offset='100%25'%20style='stop-color:%2320cc50'/%3e%3c/radialGradient%3e%3cfilter%20id='verdantBlur'%3e%3cfeGaussianBlur%20stdDeviation='3'%20result='blur'/%3e%3cfeComposite%20in='SourceGraphic'%20in2='blur'%20operator='over'/%3e%3c/filter%3e%3c/defs%3e%3c!--%20Outer%20glow%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='18'%20fill='%2340ff80'%20opacity='0.15'%20filter='url(%23verdantBlur)'/%3e%3c!--%20Core%20orb%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='12'%20fill='url(%23verdantGlow)'%20filter='url(%23verdantBlur)'/%3e%3ccircle%20cx='32'%20cy='32'%20r='8'%20fill='%2380ffc0'/%3e%3ccircle%20cx='28'%20cy='28'%20r='3'%20fill='rgba(255,255,255,0.6)'/%3e%3c!--%20Wings%20-%20left%20--%3e%3cellipse%20cx='18'%20cy='28'%20rx='8'%20ry='12'%20fill='rgba(64,255,128,0.4)'%20stroke='%2340ff80'%20stroke-width='1.5'/%3e%3cellipse%20cx='18'%20cy='28'%20rx='5'%20ry='8'%20fill='rgba(128,255,192,0.3)'/%3e%3c!--%20Wings%20-%20right%20--%3e%3cellipse%20cx='46'%20cy='28'%20rx='8'%20ry='12'%20fill='rgba(64,255,128,0.4)'%20stroke='%2340ff80'%20stroke-width='1.5'/%3e%3cellipse%20cx='46'%20cy='28'%20rx='5'%20ry='8'%20fill='rgba(128,255,192,0.3)'/%3e%3c!--%20Sparkles%20--%3e%3ccircle%20cx='20'%20cy='48'%20r='2'%20fill='%2380ffa0'/%3e%3ccircle%20cx='44'%20cy='48'%20r='2'%20fill='%2380ffa0'/%3e%3ccircle%20cx='32'%20cy='14'%20r='2'%20fill='%23a0ffc0'/%3e%3ccircle%20cx='12'%20cy='36'%20r='1.5'%20fill='%2360ff90'%20opacity='0.8'/%3e%3ccircle%20cx='52'%20cy='36'%20r='1.5'%20fill='%2360ff90'%20opacity='0.8'/%3e%3c/svg%3e",y6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20-%20Mana/Water%20theme%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%231a1a2e'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%230d0d18'%20stroke='%232a2a4a'%20stroke-width='1'/%3e%3cdefs%3e%3cradialGradient%20id='azureGlow'%20cx='50%25'%20cy='50%25'%20r='50%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%2380c0ff'/%3e%3cstop%20offset='50%25'%20style='stop-color:%2340a0ff'/%3e%3cstop%20offset='100%25'%20style='stop-color:%232080cc'/%3e%3c/radialGradient%3e%3cfilter%20id='azureBlur'%3e%3cfeGaussianBlur%20stdDeviation='3'%20result='blur'/%3e%3cfeComposite%20in='SourceGraphic'%20in2='blur'%20operator='over'/%3e%3c/filter%3e%3c/defs%3e%3c!--%20Outer%20glow%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='18'%20fill='%2340a0ff'%20opacity='0.15'%20filter='url(%23azureBlur)'/%3e%3c!--%20Core%20orb%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='12'%20fill='url(%23azureGlow)'%20filter='url(%23azureBlur)'/%3e%3ccircle%20cx='32'%20cy='32'%20r='8'%20fill='%2380c0ff'/%3e%3ccircle%20cx='28'%20cy='28'%20r='3'%20fill='rgba(255,255,255,0.6)'/%3e%3c!--%20Wings%20-%20left%20--%3e%3cellipse%20cx='18'%20cy='28'%20rx='8'%20ry='12'%20fill='rgba(64,160,255,0.4)'%20stroke='%2340a0ff'%20stroke-width='1.5'/%3e%3cellipse%20cx='18'%20cy='28'%20rx='5'%20ry='8'%20fill='rgba(128,192,255,0.3)'/%3e%3c!--%20Wings%20-%20right%20--%3e%3cellipse%20cx='46'%20cy='28'%20rx='8'%20ry='12'%20fill='rgba(64,160,255,0.4)'%20stroke='%2340a0ff'%20stroke-width='1.5'/%3e%3cellipse%20cx='46'%20cy='28'%20rx='5'%20ry='8'%20fill='rgba(128,192,255,0.3)'/%3e%3c!--%20Sparkles%20--%3e%3ccircle%20cx='20'%20cy='48'%20r='2'%20fill='%2380c0ff'/%3e%3ccircle%20cx='44'%20cy='48'%20r='2'%20fill='%2380c0ff'/%3e%3ccircle%20cx='32'%20cy='14'%20r='2'%20fill='%23a0d0ff'/%3e%3ccircle%20cx='12'%20cy='36'%20r='1.5'%20fill='%2360b0ff'%20opacity='0.8'/%3e%3ccircle%20cx='52'%20cy='36'%20r='1.5'%20fill='%2360b0ff'%20opacity='0.8'/%3e%3c/svg%3e",b6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20-%20Arcane/Magic%20theme%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%232a1a2e'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%23160d18'%20stroke='%23442a4a'%20stroke-width='1'/%3e%3cdefs%3e%3cradialGradient%20id='violetGlow'%20cx='50%25'%20cy='50%25'%20r='50%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%23c080ff'/%3e%3cstop%20offset='50%25'%20style='stop-color:%23a040ff'/%3e%3cstop%20offset='100%25'%20style='stop-color:%238020cc'/%3e%3c/radialGradient%3e%3cfilter%20id='violetBlur'%3e%3cfeGaussianBlur%20stdDeviation='3'%20result='blur'/%3e%3cfeComposite%20in='SourceGraphic'%20in2='blur'%20operator='over'/%3e%3c/filter%3e%3c/defs%3e%3c!--%20Outer%20glow%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='18'%20fill='%23a040ff'%20opacity='0.15'%20filter='url(%23violetBlur)'/%3e%3c!--%20Core%20orb%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='12'%20fill='url(%23violetGlow)'%20filter='url(%23violetBlur)'/%3e%3ccircle%20cx='32'%20cy='32'%20r='8'%20fill='%23c080ff'/%3e%3ccircle%20cx='28'%20cy='28'%20r='3'%20fill='rgba(255,255,255,0.6)'/%3e%3c!--%20Wings%20-%20left%20--%3e%3cellipse%20cx='18'%20cy='28'%20rx='8'%20ry='12'%20fill='rgba(160,64,255,0.4)'%20stroke='%23a040ff'%20stroke-width='1.5'/%3e%3cellipse%20cx='18'%20cy='28'%20rx='5'%20ry='8'%20fill='rgba(192,128,255,0.3)'/%3e%3c!--%20Wings%20-%20right%20--%3e%3cellipse%20cx='46'%20cy='28'%20rx='8'%20ry='12'%20fill='rgba(160,64,255,0.4)'%20stroke='%23a040ff'%20stroke-width='1.5'/%3e%3cellipse%20cx='46'%20cy='28'%20rx='5'%20ry='8'%20fill='rgba(192,128,255,0.3)'/%3e%3c!--%20Sparkles%20--%3e%3ccircle%20cx='20'%20cy='48'%20r='2'%20fill='%23c080ff'/%3e%3ccircle%20cx='44'%20cy='48'%20r='2'%20fill='%23c080ff'/%3e%3ccircle%20cx='32'%20cy='14'%20r='2'%20fill='%23d0a0ff'/%3e%3ccircle%20cx='12'%20cy='36'%20r='1.5'%20fill='%23b060ff'%20opacity='0.8'/%3e%3ccircle%20cx='52'%20cy='36'%20r='1.5'%20fill='%23b060ff'%20opacity='0.8'/%3e%3c/svg%3e",S6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2064%2064'%3e%3c!--%20Dark%20background%20-%20Fire/Vitality%20theme%20--%3e%3crect%20width='64'%20height='64'%20rx='4'%20fill='%232e1a1a'/%3e%3crect%20x='2'%20y='2'%20width='60'%20height='60'%20rx='3'%20fill='%23180d0d'%20stroke='%234a2a2a'%20stroke-width='1'/%3e%3cdefs%3e%3cradialGradient%20id='crimsonGlow'%20cx='50%25'%20cy='50%25'%20r='50%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%23ff9080'/%3e%3cstop%20offset='50%25'%20style='stop-color:%23ff6040'/%3e%3cstop%20offset='100%25'%20style='stop-color:%23cc4020'/%3e%3c/radialGradient%3e%3cfilter%20id='crimsonBlur'%3e%3cfeGaussianBlur%20stdDeviation='3'%20result='blur'/%3e%3cfeComposite%20in='SourceGraphic'%20in2='blur'%20operator='over'/%3e%3c/filter%3e%3c/defs%3e%3c!--%20Outer%20glow%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='18'%20fill='%23ff6040'%20opacity='0.15'%20filter='url(%23crimsonBlur)'/%3e%3c!--%20Core%20orb%20--%3e%3ccircle%20cx='32'%20cy='32'%20r='12'%20fill='url(%23crimsonGlow)'%20filter='url(%23crimsonBlur)'/%3e%3ccircle%20cx='32'%20cy='32'%20r='8'%20fill='%23ff9080'/%3e%3ccircle%20cx='28'%20cy='28'%20r='3'%20fill='rgba(255,255,255,0.6)'/%3e%3c!--%20Wings%20-%20left%20--%3e%3cellipse%20cx='18'%20cy='28'%20rx='8'%20ry='12'%20fill='rgba(255,96,64,0.4)'%20stroke='%23ff6040'%20stroke-width='1.5'/%3e%3cellipse%20cx='18'%20cy='28'%20rx='5'%20ry='8'%20fill='rgba(255,144,128,0.3)'/%3e%3c!--%20Wings%20-%20right%20--%3e%3cellipse%20cx='46'%20cy='28'%20rx='8'%20ry='12'%20fill='rgba(255,96,64,0.4)'%20stroke='%23ff6040'%20stroke-width='1.5'/%3e%3cellipse%20cx='46'%20cy='28'%20rx='5'%20ry='8'%20fill='rgba(255,144,128,0.3)'/%3e%3c!--%20Sparkles%20--%3e%3ccircle%20cx='20'%20cy='48'%20r='2'%20fill='%23ff9080'/%3e%3ccircle%20cx='44'%20cy='48'%20r='2'%20fill='%23ff9080'/%3e%3ccircle%20cx='32'%20cy='14'%20r='2'%20fill='%23ffa090'/%3e%3ccircle%20cx='12'%20cy='36'%20r='1.5'%20fill='%23ff7060'%20opacity='0.8'/%3e%3ccircle%20cx='52'%20cy='36'%20r='1.5'%20fill='%23ff7060'%20opacity='0.8'/%3e%3c/svg%3e",ZR="player_pixies",A6=3,Cc={verdant:{id:"verdant",name:"Verdant Sprite",description:"A gentle forest spirit that mends wounds over time",color:"#40ff80",glowColor:"#20ff60",icon:_6,dragType:"pixie",buff:{type:"healthRegen",value:3}},azure:{id:"azure",name:"Azure Wisp",description:"A mystical wisp that restores magical energy",color:"#40a0ff",glowColor:"#2080ff",icon:y6,dragType:"pixie",buff:{type:"manaRegen",value:4}},violet:{id:"violet",name:"Violet Shimmer",description:"An arcane spirit that expands your mana pool",color:"#a040ff",glowColor:"#8020ff",icon:b6,dragType:"pixie",buff:{type:"maxMana",value:25}},crimson:{id:"crimson",name:"Crimson Ember",description:"A fiery sprite that bolsters your vitality",color:"#ff6040",glowColor:"#ff4020",icon:S6,dragType:"pixie",buff:{type:"maxHealth",value:25}}},QR=k.createContext(null),M6=()=>{try{const i=localStorage.getItem(ZR);if(i)return JSON.parse(i).collected||["verdant","azure","violet","crimson"]}catch(i){console.warn("Failed to load pixies:",i)}return["verdant","azure","violet","crimson"]},PE=i=>{try{localStorage.setItem(ZR,JSON.stringify({collected:i}))}catch(e){console.warn("Failed to save pixies:",e)}};function E6({children:i}){const[e,t]=k.useState(M6),{slotMap:n}=ar(),a=k.useMemo(()=>Ih.map(g=>n[g.id]).filter(Boolean),[n]);k.useEffect(()=>{PE(e)},[e]);const r=k.useCallback(g=>Cc[g]?(t(_=>_.includes(g)?_:[..._,g]),!0):!1,[]),l=k.useMemo(()=>{const g={healthRegen:0,manaRegen:0,maxHealth:0,maxMana:0};return a.forEach(_=>{const y=Cc[_];y?.buff&&(g[y.buff.type]+=y.buff.value)}),g},[a]),u=k.useMemo(()=>a.map(g=>Cc[g]).filter(Boolean),[a]),d=k.useMemo(()=>e.filter(g=>!a.includes(g)).map(g=>Cc[g]).filter(Boolean),[e,a]),p=k.useCallback(()=>{const g=["verdant","azure","violet","crimson"];t(g),PE(g)},[]),x=k.useMemo(()=>({collected:e,equipped:a,activeBuffs:l,equippedPixies:u,unequippedPixies:d,collectPixie:r,resetToDefaults:p,MAX_EQUIPPED:A6,PIXIES:Cc}),[e,a,l,u,d,r,p]);return B.jsx(QR.Provider,{value:x,children:i})}function aA(){const i=k.useContext(QR);if(!i)throw new Error("usePixies must be used within a PixiesProvider");return i}const T6=(i,e)=>e?Xo(e)?.manaPerSecond>0:!1,zm=100,lb=100,cb=5,ub=2,FE=100,wn={IDLE:"idle",CASTING:"casting",ATTACKING:"attacking",MOVING:"moving",DEAD:"dead"},zE={[wn.IDLE]:"Idle",[wn.CASTING]:"Spell1",[wn.ATTACKING]:"Staff_Attack",[wn.MOVING]:"Run",[wn.DEAD]:"Death"},jb={[wn.IDLE]:{CAST:wn.CASTING,ATTACK:wn.ATTACKING,MOVE:wn.MOVING,DIE:wn.DEAD},[wn.CASTING]:{FINISH:wn.IDLE,CANCEL:wn.IDLE,CAST:wn.CASTING,ATTACK:wn.ATTACKING,MOVE:wn.MOVING,DIE:wn.DEAD},[wn.ATTACKING]:{FINISH:wn.IDLE,CANCEL:wn.IDLE,CAST:wn.CASTING,ATTACK:wn.ATTACKING,MOVE:wn.MOVING,DIE:wn.DEAD},[wn.MOVING]:{STOP:wn.IDLE,CAST:wn.CASTING,ATTACK:wn.ATTACKING,DIE:wn.DEAD},[wn.DEAD]:{REVIVE:wn.IDLE}},C6={current:wn.IDLE,previous:null,activeAction:null,completedAction:null,interruptCounter:0,interruptedAction:null,interruptedProgress:0};function R6(i,e){if(e.type==="SET_ACTIVE_ACTION"){const a=e.payload?.actionId,r=e.payload?.currentProgress??0,u=(i.current===wn.CASTING||i.current===wn.ATTACKING)&&i.activeAction&&a&&a!==i.activeAction;return{...i,activeAction:a,interruptCounter:u?i.interruptCounter+1:i.interruptCounter,interruptedAction:u?i.activeAction:i.interruptedAction,interruptedProgress:u?r:i.interruptedProgress}}if(e.type==="CLEAR_INTERRUPTED")return{...i,interruptedAction:null,interruptedProgress:0};if(e.type==="CLEAR_COMPLETED")return{...i,completedAction:null};const n=jb[i.current]?.[e.type];if(n){const a=i.current===wn.CASTING||i.current===wn.ATTACKING,r=e.type==="FINISH",l=e.type==="CANCEL"||e.type==="STOP",u=e.actionId&&e.actionId!==i.activeAction,d=a&&!r&&!l&&(e.type==="MOVE"||u),p=e.actionId??i.activeAction,x=e.type==="MOVE"?T6("MOVE",p):!0,g=e.type==="FINISH"||e.type==="CANCEL"||e.type==="STOP"||e.type==="MOVE"&&!x?null:p;return{...i,current:n,previous:i.current,completedAction:r?i.activeAction:null,interruptCounter:d?i.interruptCounter+1:i.interruptCounter,interruptedAction:d?i.activeAction:i.interruptedAction,interruptedProgress:d?e.progress??i.interruptedProgress:i.interruptedProgress,activeAction:g}}return i}const $R=k.createContext(null);function w6({children:i}){const[e,t]=k.useReducer(R6,C6),[n,a]=k.useState(0),[r,l]=k.useState(zm),[u,d]=k.useState(lb),[p,x]=k.useState([]),g=k.useRef(0),_=k.useRef(0),y=k.useRef(zm),b=k.useRef(lb),C=k.useRef([]),E=k.useRef(new Set),S=k.useRef(e.current),w=k.useRef(null),D=k.useRef(new Set),U=k.useRef(!1),F=k.useRef(null),{activeBuffs:N}=aA(),z=k.useCallback(fe=>{g.current=fe;const Fe=performance.now();Fe-_.current>50&&(_.current=Fe,a(fe))},[]),j=k.useCallback(()=>{a(g.current)},[]);k.useEffect(()=>{y.current=r},[r]),k.useEffect(()=>{b.current=u},[u]),k.useEffect(()=>{C.current=p},[p]),k.useEffect(()=>{w.current=e.activeAction},[e.activeAction]);const L=k.useCallback(()=>{let fe=0;const Fe=Date.now();for(const et of C.current)et.expiresAt>Fe&&et.manaRegenBonus&&(fe+=et.manaRegenBonus);return fe+=N?.manaRegen||0,fe},[N?.manaRegen]),P=k.useCallback(()=>{let fe=0;const Fe=Date.now();for(const et of C.current)et.expiresAt>Fe&&et.healthRegenBonus&&(fe+=et.healthRegenBonus);return fe+=N?.healthRegen||0,fe},[N?.healthRegen]),q=zm+(N?.maxMana||0),ie=lb+(N?.maxHealth||0);k.useCallback(()=>{const fe=w.current;if(fe){const Fe=Xo(fe);if(Fe?.manaPerSecond)return Fe.manaPerSecond}return 0},[]),k.useEffect(()=>{const fe=setInterval(()=>{const Fe=Date.now(),et=FE/1e3;l(ht=>{let yt=ht;const Xt=cb+L();yt+=Xt*et;const Ot=w.current;if(Ot){const ke=Xo(Ot);ke?.manaPerSecond&&(yt-=ke.manaPerSecond*et)}return yt=Math.max(0,Math.min(q,yt)),y.current=yt,yt}),d(ht=>{const yt=ub+P();let Xt=ht+yt*et;return Xt=Math.max(0,Math.min(ie,Xt)),b.current=Xt,Xt}),x(ht=>{const yt=ht.filter(Xt=>Xt.expiresAt>Fe);return yt.length!==ht.length?(C.current=yt,yt):ht})},FE);return()=>clearInterval(fe)},[L,P,q,ie]),k.useEffect(()=>{e.current===wn.MOVING&&e.activeAction&&r<=0&&Xo(e.activeAction)?.manaPerSecond&&t({type:"STOP",actionId:null})},[r,e.current,e.activeAction]);const se=k.useCallback(fe=>fe===0?!0:y.current<fe?!1:(l(Fe=>Math.max(0,Fe-fe)),y.current=Math.max(0,y.current-fe),!0),[]),ae=k.useCallback(fe=>fe===0?!0:b.current<=fe?!1:(d(Fe=>Math.max(1,Fe-fe)),b.current=Math.max(1,b.current-fe),!0),[]),re=k.useCallback(fe=>{if(!fe)return;const Fe=Date.now(),et={id:fe.id,name:fe.name,icon:fe.icon,duration:fe.duration,expiresAt:Fe+fe.duration*1e3,manaRegenBonus:fe.manaRegenBonus||0,healthRegenBonus:fe.healthRegenBonus||0};x(ht=>{const Xt=[...ht.filter(Ot=>Ot.id!==fe.id),et];return C.current=Xt,Xt})},[]),H=k.useCallback(fe=>{l(Fe=>Math.min(zm,Fe+fe)),y.current=Math.min(zm,y.current+fe)},[]);k.useEffect(()=>{if(e.completedAction){const fe=Xo(e.completedAction);fe?.buff&&re(fe.buff),fe?.manaGain&&H(fe.manaGain),t({type:"CLEAR_COMPLETED"})}},[e.completedAction,re,H]),k.useLayoutEffect(()=>{S.current=e.current},[e.current]);const K=k.useCallback(fe=>(E.current.add(fe),()=>E.current.delete(fe)),[]);k.useEffect(()=>{E.current.forEach(fe=>fe(e.current,e.previous))},[e.current,e.previous]);const W=k.useCallback(fe=>{t({type:fe})},[]),me=k.useCallback((fe,Fe,et=!1)=>{Fe?D.current.add(fe):D.current.delete(fe);const ht=IE(fe);if(ht)if(Fe){if(U.current=et,ht==="INSTANT"){const Xt=Xo(fe),Ot=Xt?.manaCost??0,ke=Xt?.healthCost??0;if(ke>0&&!ae(ke)||Ot>0&&!se(Ot))return;Xt?.buff&&re(Xt.buff);return}const yt=jb[S.current]||{};if(ht in yt){const Xt=Xo(fe),Ot=Xt?.manaCost??0,ke=Xt?.healthCost??0;if(ke>0&&!ae(ke)||Ot>0&&!se(Ot))return;t({type:ht,actionId:fe,progress:g.current})}}else ht==="MOVE"&&t({type:"STOP",actionId:null})},[W,se,ae,re]);k.useEffect(()=>{F.current=me},[me]);const ve=k.useRef({0:null,2:null});k.useEffect(()=>{const fe=Fe=>{const et=ve.current[Fe.button];et&&(D.current.delete(et),ve.current[Fe.button]=null)};return document.addEventListener("mouseup",fe,!0),()=>document.removeEventListener("mouseup",fe,!0)},[]);const Q=k.useCallback(()=>{const fe=e.activeAction;if(!fe)return!1;if(U.current)return U.current=!1,!1;if(!D.current.has(fe))return!1;const Fe=IE(fe);if(!Fe||Fe!=="CAST"&&Fe!=="ATTACK")return!1;const et=Xo(fe),ht=et?.manaCost??0,yt=et?.healthCost??0;return yt>0&&!ae(yt)||ht>0&&!se(ht)?!1:(et?.manaGain&&H(et.manaGain),z(0),w.current=fe,!0)},[e.activeAction,se,ae,H,z]),de=k.useCallback(fe=>e.current===fe,[e.current]),Te=k.useCallback(fe=>{const Fe=jb[e.current]||{};return fe.toUpperCase()in Fe},[e.current]),Me=zE[e.current]||zE[wn.IDLE],rt=k.useMemo(()=>{const fe=Date.now();let Fe=0,et=0;for(const yt of p)yt.expiresAt>fe&&(yt.manaRegenBonus&&(Fe+=yt.manaRegenBonus),yt.healthRegenBonus&&(et+=yt.healthRegenBonus));Fe+=N?.manaRegen||0,et+=N?.healthRegen||0;let ht=0;if(e.activeAction){const yt=Xo(e.activeAction);yt?.manaPerSecond&&(ht=yt.manaPerSecond)}return{mana:{base:cb,buff:Fe,drain:ht,net:cb+Fe-ht},health:{base:ub,buff:et,net:ub+et}}},[p,e.activeAction,N]),xe=k.useMemo(()=>({state:e.current,previousState:e.previous,activeAction:e.activeAction,interruptCounter:e.interruptCounter,interruptedAction:e.interruptedAction,interruptedProgress:e.interruptedProgress,animation:Me,castProgress:n,castProgressRef:g,setCastProgress:z,syncCastProgressUI:j,mana:r,maxMana:q,health:u,maxHealth:ie,buffs:p,regenInfo:rt,handleInput:me,dispatchAction:W,tryRecast:Q,subscribe:K,is:de,can:Te,STATES:wn,mouseButtonActionsRef:ve}),[e,Me,n,z,j,r,u,p,rt,me,W,Q,K,de,Te,q,ie]);return B.jsx($R.Provider,{value:xe,children:i})}function ps(){return k.useContext($R)||{}}const B6="_wrapper_1mx91_5",D6="_orb_1mx91_13",U6="_liquidWave_1mx91_1",O6="_health_1mx91_131",N6="_mana_1mx91_159",L6="_tooltip_1mx91_307",I6="_tooltipFadeIn_1mx91_1",P6="_total_1mx91_417",F6="_bonus_1mx91_443",z6="_positive_1mx91_445",H6="_drain_1mx91_453",G6="_negative_1mx91_455",xa={wrapper:B6,orb:D6,"orb-fill":"_orb-fill_1mx91_57",liquidWave:U6,health:O6,mana:N6,"orb-label":"_orb-label_1mx91_239","orb-value":"_orb-value_1mx91_263",tooltip:L6,tooltipFadeIn:I6,"tooltip-title":"_tooltip-title_1mx91_375","tooltip-row":"_tooltip-row_1mx91_399",total:P6,"tooltip-value":"_tooltip-value_1mx91_433",bonus:F6,positive:z6,drain:H6,negative:G6},fb=i=>i>=0?`+${i}`:i.toString();function HE({type:i="health",label:e="Health"}){const{mana:t,maxMana:n,health:a,maxHealth:r,regenInfo:l}=ps(),[u,d]=k.useState(!1),{fillPercent:p,currentValue:x,regen:g}=k.useMemo(()=>i==="mana"?{fillPercent:Math.round(t/n*100),currentValue:Math.round(t),regen:l.mana}:{fillPercent:Math.round(a/r*100),currentValue:Math.round(a),regen:l.health},[i,t,n,a,r,l]);return B.jsxs("div",{className:xa.wrapper,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[B.jsxs("div",{className:`${xa.orb} ${xa[i]}`,children:[B.jsx("div",{className:xa["orb-fill"],style:{"--fill-percent":`${p}%`}}),B.jsx("span",{className:xa["orb-label"],children:e}),B.jsx("span",{className:xa["orb-value"],children:x})]}),u&&B.jsxs("div",{className:xa.tooltip,children:[B.jsxs("div",{className:xa["tooltip-title"],children:[e," Regeneration"]}),B.jsxs("div",{className:xa["tooltip-row"],children:[B.jsx("span",{children:"Base"}),B.jsxs("span",{className:xa["tooltip-value"],children:[fb(g.base),"/s"]})]}),g.buff>0&&B.jsxs("div",{className:xa["tooltip-row"],children:[B.jsx("span",{children:"Buff Bonus"}),B.jsxs("span",{className:`${xa["tooltip-value"]} ${xa.bonus}`,children:[fb(g.buff),"/s"]})]}),i==="mana"&&g.drain>0&&B.jsxs("div",{className:xa["tooltip-row"],children:[B.jsx("span",{children:"Active Drain"}),B.jsxs("span",{className:`${xa["tooltip-value"]} ${xa.drain}`,children:["-",g.drain,"/s"]})]}),B.jsxs("div",{className:`${xa["tooltip-row"]} ${xa.total}`,children:[B.jsx("span",{children:"Total"}),B.jsxs("span",{className:`${xa["tooltip-value"]} ${g.net>=0?xa.positive:xa.negative}`,children:[fb(g.net),"/s"]})]})]})]})}const V6="_shatter_fcbyp_25",k6="_fragment_fcbyp_423",fs={"casting-bar-container":"_casting-bar-container_fcbyp_5","shatter-overlay":"_shatter-overlay_fcbyp_25","casting-bar":"_casting-bar_fcbyp_5","skill-icon":"_skill-icon_fcbyp_103","bar-track":"_bar-track_fcbyp_145","bar-fill":"_bar-fill_fcbyp_177","fill-interrupted":"_fill-interrupted_fcbyp_225","bar-spark":"_bar-spark_fcbyp_257","skill-name":"_skill-name_fcbyp_291",shatter:V6,"shatter-fragments":"_shatter-fragments_fcbyp_407",fragment:k6};function ew(i){return i?.element&&Fa[i.element]||null}function j6({actionId:i,progress:e}){const t=Xo(i),n=Math.round(e*100),a=ew(t);return B.jsx("div",{className:fs["shatter-overlay"],children:B.jsxs("div",{className:`${fs["casting-bar"]} ${fs.shatter}`,style:a?{"--element-primary":a.primary,"--element-secondary":a.secondary,"--element-glow":a.glow}:void 0,children:[t?.icon&&B.jsx("div",{className:fs["skill-icon"],children:B.jsx("img",{src:t.icon,alt:""})}),B.jsxs("div",{className:fs["bar-track"],children:[B.jsx("div",{className:`${fs["bar-fill"]} ${fs["fill-interrupted"]}`,style:{width:`${n}%`}}),B.jsx("span",{className:fs["skill-name"],children:"Interrupted!"})]}),B.jsx("div",{className:fs["shatter-fragments"],children:[...Array(8)].map((r,l)=>B.jsx("div",{className:fs.fragment,style:{"--i":l}},l))})]})})}function X6(){const{state:i,activeAction:e,castProgress:t,interruptCounter:n,interruptedAction:a,interruptedProgress:r,STATES:l}=ps(),[u,d]=k.useState(!1),[p,x]=k.useState(0),[g,_]=k.useState(null),y=k.useRef(0),b=i===l.CASTING||i===l.ATTACKING;k.useEffect(()=>{if(n>y.current&&a){y.current=n,_(a),x(r),d(!0);const D=setTimeout(()=>{d(!1),_(null)},400);return()=>clearTimeout(D)}},[n,a,r]);const C=b&&e?Xo(e):null,E=ew(C),w=Math.round((t??0)*100);return B.jsxs("div",{className:fs["casting-bar-container"],children:[u&&g&&B.jsx(j6,{actionId:g,progress:p}),b&&e&&C&&B.jsxs("div",{className:fs["casting-bar"],style:E?{"--element-primary":E.primary,"--element-secondary":E.secondary,"--element-glow":E.glow}:void 0,children:[C?.icon&&B.jsx("div",{className:fs["skill-icon"],children:B.jsx("img",{src:C.icon,alt:""})}),B.jsxs("div",{className:fs["bar-track"],children:[B.jsx("div",{className:fs["bar-fill"],style:{width:`${w}%`}}),B.jsx("div",{className:fs["bar-spark"],style:{left:`${w}%`}}),B.jsx("span",{className:fs["skill-name"],children:C?.label||"Casting"})]})]})]})}const Y6="_tooltip_w2ryv_225",Tn={"buff-bar":"_buff-bar_w2ryv_5","buff-icon":"_buff-icon_w2ryv_25","buff-active":"_buff-active_w2ryv_49","buff-pulse":"_buff-pulse_w2ryv_101","buff-image":"_buff-image_w2ryv_133","buff-sweep":"_buff-sweep_w2ryv_149","buff-timer":"_buff-timer_w2ryv_171","buff-wrapper":"_buff-wrapper_w2ryv_215",tooltip:Y6,"tooltip-connector":"_tooltip-connector_w2ryv_351","tooltip-header":"_tooltip-header_w2ryv_405","tooltip-name":"_tooltip-name_w2ryv_435","tooltip-type":"_tooltip-type_w2ryv_447","tooltip-desc":"_tooltip-desc_w2ryv_471","tooltip-effect":"_tooltip-effect_w2ryv_485","tooltip-duration":"_tooltip-duration_w2ryv_507","tooltip-type-active":"_tooltip-type-active_w2ryv_525","tooltip-active-hint":"_tooltip-active-hint_w2ryv_539","buff-passive":"_buff-passive_w2ryv_559","tooltip-type-passive":"_tooltip-type-passive_w2ryv_645"},tw={mana_body:{description:"Your body is infused with pure mana, greatly increasing mana regeneration.",effect:"+10 Mana per second"},arcane_rush:{description:"Surging with arcane energy, you knock back enemies on impact.",effect:"Pushes enemies away"},health_potion:{description:"A restorative potion courses through your veins, healing your wounds.",effect:"+8 Health per second"},food_buff:{description:"An enchanted biscuit infuses you with arcane energy, restoring your mana.",effect:"+5 Mana per second"}},q6=k.memo(function({buff:e,now:t}){const n=Math.max(0,(e.expiresAt-t)/1e3),a=n/e.duration,[r,l]=k.useState(!1),u=tw[e.id]||{};return B.jsxs("div",{className:Tn["buff-wrapper"],onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[B.jsxs("div",{className:Tn["buff-icon"],children:[B.jsx("img",{src:e.icon,alt:e.name,className:Tn["buff-image"]}),B.jsx("div",{className:Tn["buff-sweep"],style:{"--progress":a}}),B.jsxs("span",{className:Tn["buff-timer"],children:[Math.ceil(n),"s"]})]}),r&&B.jsxs("div",{className:Tn.tooltip,children:[B.jsxs("div",{className:Tn["tooltip-header"],children:[B.jsx("span",{className:Tn["tooltip-name"],children:e.name}),B.jsx("span",{className:Tn["tooltip-type"],children:"Buff"})]}),u.description&&B.jsx("p",{className:Tn["tooltip-desc"],children:u.description}),u.effect&&B.jsx("p",{className:Tn["tooltip-effect"],children:u.effect}),B.jsxs("p",{className:Tn["tooltip-duration"],children:[Math.ceil(n),"s remaining"]}),B.jsx("div",{className:Tn["tooltip-connector"]})]})]})}),K6=k.memo(function({id:e,name:t,icon:n}){const[a,r]=k.useState(!1),l=tw[e]||{};return B.jsxs("div",{className:Tn["buff-wrapper"],onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[B.jsxs("div",{className:`${Tn["buff-icon"]} ${Tn["buff-active"]}`,children:[B.jsx("img",{src:n,alt:t,className:Tn["buff-image"]}),B.jsx("div",{className:Tn["buff-pulse"]})]}),a&&B.jsxs("div",{className:Tn.tooltip,children:[B.jsxs("div",{className:Tn["tooltip-header"],children:[B.jsx("span",{className:Tn["tooltip-name"],children:t}),B.jsx("span",{className:`${Tn["tooltip-type"]} ${Tn["tooltip-type-active"]}`,children:"Active"})]}),l.description&&B.jsx("p",{className:Tn["tooltip-desc"],children:l.description}),l.effect&&B.jsx("p",{className:Tn["tooltip-effect"],children:l.effect}),B.jsx("p",{className:Tn["tooltip-active-hint"],children:"Active while held"}),B.jsx("div",{className:Tn["tooltip-connector"]})]})]})}),J6={healthRegen:{label:"Health Regen",suffix:"/sec"},manaRegen:{label:"Mana Regen",suffix:"/sec"},maxHealth:{label:"Max Health",suffix:""},maxMana:{label:"Max Mana",suffix:""}},W6=k.memo(function({pixie:e}){const[t,n]=k.useState(!1),a=J6[e.buff.type];return B.jsxs("div",{className:Tn["buff-wrapper"],onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[B.jsx("div",{className:`${Tn["buff-icon"]} ${Tn["buff-passive"]}`,style:{"--pixie-color":e.color},children:B.jsx("img",{src:e.icon,alt:e.name,className:Tn["buff-image"]})}),t&&B.jsxs("div",{className:Tn.tooltip,children:[B.jsxs("div",{className:Tn["tooltip-header"],children:[B.jsx("span",{className:Tn["tooltip-name"],children:e.name}),B.jsx("span",{className:`${Tn["tooltip-type"]} ${Tn["tooltip-type-passive"]}`,children:"Passive"})]}),B.jsx("p",{className:Tn["tooltip-desc"],children:e.description}),B.jsxs("p",{className:Tn["tooltip-effect"],style:{color:e.color},children:["+",e.buff.value," ",a.label,a.suffix]}),B.jsx("div",{className:Tn["tooltip-connector"]})]})]})});function Z6(){const{buffs:i,state:e,activeAction:t,STATES:n}=ps(),{slotMap:a}=ar(),[r,l]=k.useState(Date.now()),u=e===n.MOVING&&t==="skill_3",d=k.useMemo(()=>Ih.map(_=>a?.[_.id]).filter(Boolean).map(_=>Cc[_]).filter(Boolean),[a]),p=i&&i.length>0,x=d&&d.length>0;return k.useEffect(()=>{if(!p)return;const _=setInterval(()=>{l(Date.now())},100);return()=>clearInterval(_)},[p]),p||u||x?B.jsxs("div",{className:Tn["buff-bar"],children:[d.map(_=>B.jsx(W6,{pixie:_},_.id)),u&&B.jsx(K6,{id:"arcane_rush",name:"Arcane Rush",icon:kR}),i.map(_=>B.jsx(q6,{buff:_,now:r},_.id))]}):null}const Q6={primary:"#ffffff",secondary:"#cccccc"},$6=`
  varying vec2 vUv;
  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
`,eH=`
  uniform float uTime;
  uniform float uProgress;
  uniform float uOpacity;
  uniform vec3 uColor;
  uniform vec3 uSecondaryColor;
  
  varying vec2 vUv;
  
  #define PI 3.14159265359
  
  float ring(vec2 uv, float radius, float thickness) {
    float dist = length(uv);
    return smoothstep(radius - thickness, radius, dist) - smoothstep(radius, radius + thickness, dist);
  }
  
  float rune(vec2 uv, float angle, float time) {
    vec2 rotated = vec2(
      uv.x * cos(angle) - uv.y * sin(angle),
      uv.x * sin(angle) + uv.y * cos(angle)
    );
    float runePattern = sin(rotated.x * 20.0 + time * 2.0) * sin(rotated.y * 20.0 - time * 1.5);
    return smoothstep(0.3, 0.8, runePattern);
  }
  
  void main() {
    vec2 uv = vUv * 2.0 - 1.0;
    float dist = length(uv);
    float angle = atan(uv.y, uv.x);
    
    // Outer ring
    float outerRing = ring(uv, 0.9, 0.03);
    
    // Inner ring
    float innerRing = ring(uv, 0.6, 0.02);
    
    // Progress ring (fills as cast progresses)
    float progressAngle = -PI + uProgress * 2.0 * PI;
    float progressRing = ring(uv, 0.75, 0.04);
    progressRing *= step(angle, progressAngle);
    
    // Rotating rune patterns
    float runeRing = ring(uv, 0.75, 0.15);
    float runes = rune(uv, uTime * 0.5, uTime) * runeRing;
    
    // Spinning lines
    float numLines = 8.0;
    float lineAngle = mod(angle + uTime * 0.8, PI * 2.0 / numLines);
    float lines = smoothstep(0.02, 0.0, abs(lineAngle - PI / numLines)) * step(0.4, dist) * step(dist, 0.85);
    
    // Center glow
    float centerGlow = smoothstep(0.4, 0.0, dist) * 0.5;
    
    // Particle-like sparkles
    float sparkle = sin(angle * 12.0 + uTime * 3.0) * sin(dist * 30.0 - uTime * 5.0);
    sparkle = smoothstep(0.7, 1.0, sparkle) * step(0.3, dist) * step(dist, 0.9);
    
    // Combine all effects
    float pattern = outerRing + innerRing + progressRing * 0.8 + runes * 0.3 + lines * 0.5 + centerGlow + sparkle * 0.6;
    
    // Mix colors
    vec3 color = mix(uColor, uSecondaryColor, sin(angle * 3.0 + uTime) * 0.5 + 0.5);
    color = mix(color, uSecondaryColor, centerGlow);
    
    // Pulsing effect
    float pulse = sin(uTime * 4.0) * 0.15 + 0.85;
    
    gl_FragColor = vec4(color, pattern * uOpacity * pulse);
  }
`;function tH({position:i=[0,.02,0]}){const e=k.useRef(),t=k.useRef(),{state:n,activeAction:a,castProgressRef:r,STATES:l}=ps(),u=k.useMemo(()=>a?eA(a):null,[a]),d=(n===l.CASTING||n===l.ATTACKING||n===l.MOVING)&&u,p=n===l.MOVING,x=k.useMemo(()=>u?{primary:u.primary,secondary:u.secondary}:Q6,[u]),g=k.useMemo(()=>new hi({vertexShader:$6,fragmentShader:eH,uniforms:{uTime:{value:0},uProgress:{value:0},uOpacity:{value:0},uColor:{value:new ut(x.primary)},uSecondaryColor:{value:new ut(x.secondary)}},transparent:!0,side:Oi,depthWrite:!1,blending:ir}),[]);return Ns((_,y)=>{if(!t.current)return;const b=t.current.uniforms,C=d?1:0,E=b.uOpacity.value;if(!d&&E<.01){b.uOpacity.value=0;return}if(b.uTime.value+=y,b.uProgress.value=p?1:r.current,b.uOpacity.value+=(C-E)*y*8,b.uColor.value.getHexString()!==x.primary.replace("#","")&&(b.uColor.value.set(x.primary),b.uSecondaryColor.value.set(x.secondary)),e.current){const S=d?1:.5,w=y*6;e.current.scale.x+=(S-e.current.scale.x)*w,e.current.scale.y+=(S-e.current.scale.y)*w,e.current.scale.z+=(S-e.current.scale.z)*w}}),B.jsxs("mesh",{ref:e,position:i,rotation:[-Math.PI/2,0,0],scale:.5,children:[B.jsx("planeGeometry",{args:[2.5,2.5,1,1]}),B.jsx("primitive",{object:g,ref:t,attach:"material"})]})}const nH=`
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  
  void main() {
    vNormal = normalize(normalMatrix * normal);
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
  }
`;function iH({pulseSpeed:i=5,waveFreq:e=3,waveSpeed:t=6,colorShift:n="0.1, 0.15, 0.25"}={}){return`
    uniform float uTime;
    uniform float uOpacity;
    uniform vec3 uColor;
    
    varying vec3 vNormal;
    varying vec3 vViewPosition;
    
    void main() {
      vec3 viewDir = normalize(vViewPosition);
      float fresnel = pow(1.0 - abs(dot(viewDir, normalize(vNormal))), 3.0);
      
      // Energy variation
      float pulse = sin(uTime * ${i.toFixed(1)}) * 0.12 + 0.88;
      float wave = sin(vNormal.y * ${e.toFixed(1)} + uTime * ${t.toFixed(1)}) * 0.08 + 0.92;
      
      float alpha = fresnel * uOpacity * pulse * wave * 0.5;
      
      // Color shift based on fresnel
      vec3 color = uColor + vec3(${n}) * fresnel;
      
      gl_FragColor = vec4(color, alpha);
    }
  `}function nw({color:i="#77bbff",pulseSpeed:e=5,waveFreq:t=3,waveSpeed:n=6,colorShift:a="0.1, 0.15, 0.25"}={}){return new hi({vertexShader:nH,fragmentShader:iH({pulseSpeed:e,waveFreq:t,waveSpeed:n,colorShift:a}),uniforms:{uTime:{value:0},uOpacity:{value:0},uColor:{value:new ut(i)}},transparent:!0,side:oa,depthWrite:!1,blending:ir})}const aH=Fa.arcane.glow;function sH({position:i=[0,0,0]}){const e=k.useRef(),t=k.useRef(),n=k.useRef(),{state:a,activeAction:r,STATES:l}=ps(),u=a===l.MOVING&&r==="skill_3",d=k.useMemo(()=>new Oh(1.7,32,32),[]),p=k.useMemo(()=>nw({color:aH,pulseSpeed:6,waveFreq:4,waveSpeed:8,colorShift:"0.15, 0.05, 0.2"}),[]);return Ns((x,g)=>{if(!n.current||!t.current)return;const _=n.current.uniforms,y=u?1:0,b=_.uOpacity.value;if(!u&&b<.01){_.uOpacity.value=0,e.current&&(e.current.visible=!1),t.current.scale.setScalar(.5);return}e.current&&(e.current.visible=!0);const C=b+(y-b)*g*8;_.uTime.value+=g,_.uOpacity.value=C;const E=u?1:.5,S=t.current.scale;S.x+=(E-S.x)*g*6,S.y+=(E-S.y)*g*6,S.z+=(E-S.z)*g*6}),B.jsx("group",{ref:e,position:i,visible:!1,children:B.jsxs("mesh",{ref:t,scale:.5,children:[B.jsx("primitive",{object:d,attach:"geometry"}),B.jsx("primitive",{object:p,ref:n,attach:"material"})]})})}const rH=Fa.mana.glow,oH=["mana_body"];function lH({position:i=[0,0,0]}){const e=k.useRef(),t=k.useRef(),n=k.useRef(),{buffs:a}=ps(),r=a.some(d=>oH.includes(d.id)),l=k.useMemo(()=>new Oh(2,32,32),[]),u=k.useMemo(()=>nw({color:rH,pulseSpeed:5,waveFreq:3,waveSpeed:6,colorShift:"0.1, 0.15, 0.25"}),[]);return Ns((d,p)=>{if(!n.current||!t.current)return;const x=n.current.uniforms,g=r?1:0,_=x.uOpacity.value;if(!r&&_<.01){x.uOpacity.value=0,e.current&&(e.current.visible=!1),t.current.scale.setScalar(.5);return}e.current&&(e.current.visible=!0);const y=_+(g-_)*p*8;x.uTime.value+=p,x.uOpacity.value=y;const b=r?1:.5,C=t.current.scale;C.x+=(b-C.x)*p*6,C.y+=(b-C.y)*p*6,C.z+=(b-C.z)*p*6}),B.jsx("group",{ref:e,position:i,visible:!1,children:B.jsxs("mesh",{ref:t,scale:.5,children:[B.jsx("primitive",{object:l,attach:"geometry"}),B.jsx("primitive",{object:u,ref:n,attach:"material"})]})})}const cH=5,uH=.07,iw=.4,fH=3.5,hH=new ut(Fa.arcane.primary);function dH({sourceClone:i,spawnTime:e,index:t}){const n=k.useRef(),a=k.useRef(.55),{clone:r,materials:l}=k.useMemo(()=>{if(!i)return{clone:null,materials:[]};const u=ER.clone(i),d=[],p=.7+t*.08,x=hH.clone().multiplyScalar(p);return u.traverse(g=>{if(g.isMesh){const _=new $a({color:x,transparent:!0,opacity:.55,depthWrite:!1});g.material=_,g.castShadow=!1,g.receiveShadow=!1,d.push(_)}}),{clone:u,materials:d}},[i,t]);return Ns(u=>{if(!r||!i||!n.current)return;const d=u.clock.elapsedTime-e,p=d/iw,x=Math.max(0,.55*(1-p));a.current=x,l.forEach(b=>{b.opacity=x}),n.current.position.z=-d*fH;const g=1-p*.15;n.current.scale.setScalar(g);const _=[],y=[];i.traverse(b=>{b.isBone&&_.push(b)}),r.traverse(b=>{b.isBone&&y.push(b)}),_.forEach((b,C)=>{y[C]&&(y[C].position.copy(b.position),y[C].quaternion.copy(b.quaternion),y[C].scale.copy(b.scale))})}),r?B.jsx("group",{ref:n,children:B.jsx("primitive",{object:r})}):null}function pH({wizardRef:i}){const{state:e,activeAction:t,STATES:n}=ps(),[a,r]=k.useState([]),l=k.useRef(0),u=k.useRef(0),d=e===n.MOVING&&t==="skill_3";return Ns(p=>{const x=p.clock.elapsedTime;if(r(_=>_.filter(y=>x-y.spawnTime<iw)),!d||!i?.current||x-u.current<uH)return;u.current=x;const g={id:l.current++,spawnTime:x};r(_=>_.length>=cH?[..._.slice(1),g]:[..._,g])}),a.length===0?null:B.jsx("group",{children:a.map((p,x)=>B.jsx(dH,{sourceClone:i?.current,spawnTime:p.spawnTime,index:x},p.id))})}const Sc=16,wu=8,GE=.8,hb=3,mH=.6,gH=1.2,vH=1.8,tg=.12,VE=new ut(Fa.healing.primary),kE=new ut(Fa.mana.glow),xH=()=>{const i=document.createElement("canvas");i.width=64,i.height=64;const e=i.getContext("2d"),t=e.createRadialGradient(32,32,0,32,32,32);return t.addColorStop(0,"rgba(255, 255, 255, 1)"),t.addColorStop(.2,"rgba(255, 255, 255, 0.9)"),t.addColorStop(.4,"rgba(255, 255, 255, 0.5)"),t.addColorStop(.7,"rgba(255, 255, 255, 0.15)"),t.addColorStop(1,"rgba(255, 255, 255, 0)"),e.fillStyle=t,e.fillRect(0,0,64,64),new eC(i)};function jE({isActive:i,color:e,particleTexture:t}){const n=k.useRef(),a=k.useRef(0),r=k.useRef(0),{positions:l,lifetimes:u,speeds:d,offsets:p,swayPhases:x,sizes:g}=k.useMemo(()=>{const b=new Float32Array(Sc*3),C=new Float32Array(Sc),E=new Float32Array(Sc),S=new Float32Array(Sc*2),w=new Float32Array(Sc),D=new Float32Array(Sc);for(let U=0;U<Sc;U++){C[U]=Math.random(),E[U]=mH*(.7+Math.random()*.6);const F=Math.random()*Math.PI*2,N=GE*(.3+Math.random()*.7);S[U*2]=Math.cos(F)*N,S[U*2+1]=Math.sin(F)*N,w[U]=Math.random()*Math.PI*2,D[U]=tg*(.6+Math.random()*.8),b[U*3]=S[U*2],b[U*3+1]=C[U]*hb,b[U*3+2]=S[U*2+1]}return{positions:b,lifetimes:C,speeds:E,offsets:S,swayPhases:w,sizes:D}},[]),_=k.useMemo(()=>{const b=new rn;return b.setAttribute("position",new Mn(l,3)),b.setAttribute("color",new Mn(new Float32Array(Sc*3),3)),b.setAttribute("size",new Mn(g,1)),b},[l,g]),y=k.useMemo(()=>new Vp({size:tg,map:t,transparent:!0,opacity:0,depthWrite:!1,blending:ir,vertexColors:!0,sizeAttenuation:!0}),[t]);return Ns((b,C)=>{if(!n.current)return;const E=n.current.geometry,S=E.attributes.position,w=E.attributes.color,D=E.attributes.size,U=n.current.material;r.current+=C;const F=i?1:0;if(a.current+=(F-a.current)*C*3,U.opacity=a.current,a.current<.01&&!i){U.opacity=0;return}for(let N=0;N<Sc;N++){if(u[N]+=C*d[N]/hb,u[N]>=1){u[N]=0;const ie=Math.random()*Math.PI*2,se=GE*(.3+Math.random()*.7);p[N*2]=Math.cos(ie)*se,p[N*2+1]=Math.sin(ie)*se,x[N]=Math.random()*Math.PI*2,g[N]=tg*(.6+Math.random()*.8)}const z=.15*Math.sin(u[N]*Math.PI),j=Math.sin(r.current*2+x[N])*z,L=Math.cos(r.current*2.3+x[N])*z;S.array[N*3]=p[N*2]+j,S.array[N*3+1]=u[N]*hb,S.array[N*3+2]=p[N*2+1]+L;let P=1;u[N]<.15?P=u[N]/.15:u[N]>.7&&(P=1-(u[N]-.7)/.3);const q=1+.2*Math.sin(r.current*3+x[N]);D.array[N]=g[N]*q*(.5+P*.5),w.array[N*3]=e.r*P,w.array[N*3+1]=e.g*P,w.array[N*3+2]=e.b*P}S.needsUpdate=!0,w.needsUpdate=!0,D.needsUpdate=!0}),B.jsxs("points",{ref:n,children:[B.jsx("primitive",{object:_,attach:"geometry"}),B.jsx("primitive",{object:y,attach:"material"})]})}function XE({isActive:i,color:e,particleTexture:t,orbitDirection:n=1,heightOffset:a=0}){const r=k.useRef(),l=k.useRef(0),u=k.useRef(0),{angles:d,heights:p,sizes:x}=k.useMemo(()=>{const y=new Float32Array(wu),b=new Float32Array(wu),C=new Float32Array(wu);for(let E=0;E<wu;E++)y[E]=E/wu*Math.PI*2,b[E]=a+(Math.random()-.5)*.3,C[E]=tg*(.8+Math.random()*.4);return{angles:y,heights:b,sizes:C}},[a]),g=k.useMemo(()=>{const y=new rn;return y.setAttribute("position",new Mn(new Float32Array(wu*3),3)),y.setAttribute("color",new Mn(new Float32Array(wu*3),3)),y.setAttribute("size",new Mn(x,1)),y},[x]),_=k.useMemo(()=>new Vp({size:tg,map:t,transparent:!0,opacity:0,depthWrite:!1,blending:ir,vertexColors:!0,sizeAttenuation:!0}),[t]);return Ns((y,b)=>{if(!r.current)return;const C=r.current.geometry,E=C.attributes.position,S=C.attributes.color,w=C.attributes.size,D=r.current.material;u.current+=b;const U=i?1:0;if(l.current+=(U-l.current)*b*3,D.opacity=l.current*.85,l.current<.01&&!i){D.opacity=0;return}for(let F=0;F<wu;F++){const N=d[F]+u.current*vH*n,z=Math.sin(u.current*1.5+d[F])*.1,j=gH+Math.sin(u.current*2+d[F]*2)*.1;E.array[F*3]=Math.cos(N)*j,E.array[F*3+1]=p[F]+z,E.array[F*3+2]=Math.sin(N)*j;const L=.7+.3*Math.sin(u.current*4+d[F]*3);w.array[F]=x[F]*L,S.array[F*3]=e.r*L,S.array[F*3+1]=e.g*L,S.array[F*3+2]=e.b*L}E.needsUpdate=!0,S.needsUpdate=!0,w.needsUpdate=!0}),B.jsxs("points",{ref:r,children:[B.jsx("primitive",{object:g,attach:"geometry"}),B.jsx("primitive",{object:_,attach:"material"})]})}function _H({position:i=[0,0,0]}){const{buffs:e}=ps(),t=e?.some(r=>r.id==="health_potion")??!1,n=e?.some(r=>r.id==="food_buff")??!1,a=k.useMemo(()=>xH(),[]);return B.jsxs("group",{position:i,children:[B.jsx(jE,{isActive:t,color:VE,particleTexture:a}),B.jsx(XE,{isActive:t,color:VE,particleTexture:a,orbitDirection:1,heightOffset:1}),B.jsx(jE,{isActive:n,color:kE,particleTexture:a}),B.jsx(XE,{isActive:n,color:kE,particleTexture:a,orbitDirection:-1,heightOffset:1.5})]})}const aw={};Object.values(Fa).forEach(i=>{aw[i.id]=new ra({color:i.glow,emissive:i.glow,emissiveIntensity:4,toneMapped:!1})});const yH=new $a({color:new ut("#8b30a0"),transparent:!0,opacity:.75});function bH(i){const e=Rc.useRef(),t=Rc.useRef(),n=k.useRef(null),a=k.useRef(null),r=k.useRef(new Map),l=k.useRef(null),u=k.useRef(0),{scene:d,animations:p}=Rg("/models/Wizard-transformed.glb"),x=Rc.useMemo(()=>ER.clone(d),[d]),{actions:g}=iF(p,x),{animation:_,state:y,activeAction:b,setCastProgress:C,syncCastProgressUI:E,dispatchAction:S,tryRecast:w,STATES:D,buffs:U}=ps();k.useEffect(()=>{t.current=x},[x]),k.useEffect(()=>{x.traverse(N=>{N.isMesh&&(r.current.set(N,N.material.clone()),N.name.includes("Wizard_Staff")&&(n.current=N,a.current=N.material.clone()))})},[x]);const F=y===D.MOVING&&b==="skill_3";return k.useEffect(()=>{F?x.traverse(N=>{N.isMesh&&(N.material=yH)}):x.traverse(N=>{N.isMesh&&r.current.has(N)&&(N.material=r.current.get(N))})},[F,x]),k.useEffect(()=>{if(!n.current)return;const N=b?eA(b):null;N&&y!==D.IDLE?n.current.material=aw[N.id]||a.current:n.current.material=a.current},[y,b,D]),k.useEffect(()=>{const N=g?.[_];if(!N)return;l.current=N,Object.values(g).forEach(j=>{j!==N&&j?.fadeOut(.2)}),y===D.CASTING||y===D.ATTACKING?(N.setLoop(Zb,1),N.clampWhenFinished=!0,C(0)):N.setLoop(Qb),N.reset().fadeIn(.2).play()},[_,g,y,b,D,C]),Ns(()=>{const N=l.current;if(N&&(y===D.CASTING||y===D.ATTACKING)){const z=N.getClip().duration,L=Math.min(N.time,z)/z;C(L),L>=.99&&(E(),w()?(N.reset().play(),u.current++):S("FINISH"))}}),B.jsxs("group",{ref:e,...i,dispose:null,children:[B.jsx("primitive",{object:x}),B.jsx(tH,{position:[0,.02,0]}),B.jsx(sH,{position:[0,1.5,0]}),B.jsx(lH,{position:[0,1.5,0]}),B.jsx(_H,{position:[0,0,0]}),B.jsx(pH,{wizardRef:t})]})}Rg.preload("/models/Wizard-transformed.glb");const SH={"menu-bar":"_menu-bar_13p6d_1"},AH="_active_1gnl8_179",MH="_drawer_1gnl8_225",Ec={"menu-button-wrapper":"_menu-button-wrapper_1gnl8_19","menu-button-tooltip":"_menu-button-tooltip_1gnl8_29","menu-button-tooltip-text":"_menu-button-tooltip-text_1gnl8_65","menu-button":"_menu-button_1gnl8_19",active:AH,"rotate-active":"_rotate-active_1gnl8_209",drawer:MH,"drawer-title":"_drawer-title_1gnl8_311","scroll-list":"_scroll-list_1gnl8_361"},Bg=k.forwardRef(function({icon:e,isOpen:t=!1,onClick:n,label:a,tooltip:r,activeAnimation:l="scale",className:u=""},d){const p=l==="rotate"?Ec["rotate-active"]:"";return B.jsxs("div",{className:Ec["menu-button-wrapper"],children:[B.jsx("button",{ref:d,className:`${Ec["menu-button"]} ${t?Ec.active:""} ${p} ${u}`,onClick:n,"aria-label":a,children:e}),r&&B.jsxs("div",{className:Ec["menu-button-tooltip"],children:[B.jsx("span",{className:Ec["menu-button-tooltip-text"],children:r}),B.jsx(ly,{position:"bottom"})]})]})});function Dg({isOpen:i,anchorRef:e,width:t=300,portalId:n="drawer-portal",className:a="",children:r}){const[l]=k.useState(()=>{const d=document.createElement("div");return d.id=n,d});if(k.useEffect(()=>(document.body.appendChild(l),()=>document.body.removeChild(l)),[l]),!i)return null;const u=e?.current?window.innerHeight-e.current.getBoundingClientRect().top+8:100;return VR.createPortal(B.jsx("div",{className:`${Ec.drawer} ${a}`,style:{position:"fixed",bottom:u,left:"50%",transform:"translateX(-50%)",width:t},children:r}),l)}function Ug({children:i}){return B.jsx("div",{className:Ec["drawer-title"],children:i})}function Og({maxHeight:i=280,gap:e=6,className:t="",children:n}){return B.jsx("div",{className:`${Ec["scroll-list"]} ${t}`,style:{maxHeight:i,gap:e,paddingRight:4},children:n})}const Ng=k.memo(function({svg:e,className:t=""}){const n=k.useMemo(()=>{if(!e)return null;const l=new DOMParser().parseFromString(e,"image/svg+xml").querySelector("svg");if(!l)return null;const u={};for(const d of l.attributes)if(d.name!=="width"&&d.name!=="height"){const p=d.name.replace(/-([a-z])/g,(x,g)=>g.toUpperCase());u[p]=d.value}return{attrs:u,innerHTML:l.innerHTML}},[e]);return n?B.jsx("svg",{...n.attrs,className:t,style:{pointerEvents:"none"},dangerouslySetInnerHTML:{__html:n.innerHTML}}):null}),EH="_rebinding_1rc54_157",oh={"keybind-row":"_keybind-row_1rc54_7","keybind-info":"_keybind-info_1rc54_35","keybind-slot":"_keybind-slot_1rc54_51","keybind-action":"_keybind-action_1rc54_65","keybind-key":"_keybind-key_1rc54_89",rebinding:EH,"reset-button":"_reset-button_1rc54_191"},sw="player_keymap",TH={0:"MouseLeft",1:"MouseMiddle",2:"MouseRight"},YE={MouseLeft:"LMB",MouseRight:"RMB",MouseMiddle:"MMB"},CH={slot_1:"KeyQ",slot_2:"KeyW",slot_3:"KeyE",slot_4:"KeyR",slot_lmb:"MouseLeft",slot_rmb:"MouseRight",slot_consumable_1:"KeyD",slot_consumable_2:"KeyF"},rw=()=>wg.map(i=>({name:i.id,keys:[CH[i.id]||""],label:i.id.replace("slot_","").replace("consumable_","C").toUpperCase()})),uy=i=>{try{localStorage.setItem(sw,JSON.stringify(i))}catch(e){console.warn("Failed to save keymap:",e)}},RH=()=>{const i=rw();try{const e=localStorage.getItem(sw);if(e){const t=JSON.parse(e),n=new Map(t.map(r=>[r.name,r])),a=i.map(r=>n.get(r.name)||r);return a.length!==t.length&&uy(a),a}}catch(e){console.warn("Failed to load keymap:",e)}return uy(i),i},wH=i=>i?YE[i]?YE[i]:i.replace("Key","").replace("Left","").replace("Right","").replace("Digit",""):"?",ow=k.createContext(null);function BH({children:i}){const[e,t]=k.useState(RH),[n,a]=k.useState(null),r=k.useCallback(_=>e.find(y=>y.name===_)?.keys[0]||null,[e]),l=k.useCallback(_=>wH(r(_)),[r]),u=k.useCallback((_,y)=>{t(b=>{const C=b.map(E=>E.name===_?{...E,keys:[y]}:E.keys[0]===y?{...E,keys:[]}:E);return uy(C),C})},[]),d=k.useCallback(_=>(a(_),new Promise(y=>{const b=w=>{w.preventDefault(),w.stopPropagation(),u(_,w.code),S(),y(w.code)},C=w=>{w.preventDefault(),w.stopPropagation(),w.stopImmediatePropagation();const D=TH[w.button];D&&(u(_,D),S(),y(D))},E=w=>{w.preventDefault(),w.stopPropagation()},S=()=>{a(null),document.removeEventListener("keydown",b,!0),document.removeEventListener("pointerdown",C,!0),document.removeEventListener("contextmenu",E,!0)};requestAnimationFrame(()=>{setTimeout(()=>{document.addEventListener("keydown",b,!0),document.addEventListener("pointerdown",C,!0),document.addEventListener("contextmenu",E,!0)},0)})})),[u]),p=k.useCallback(()=>a(null),[]),x=k.useCallback(()=>{const _=rw();t(_),uy(_)},[]),g=k.useMemo(()=>({keyMap:e,getKey:r,getDisplayKey:l,startRebind:d,cancelRebind:p,resetToDefaults:x,rebinding:n}),[e,r,l,d,p,x,n]);return B.jsx(ow.Provider,{value:g,children:i})}function Lg(){const i=k.useContext(ow);if(!i)throw new Error("useKeyMap must be used within a KeyMapProvider");return i}const DH=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\r
  <path d="M12 15a3 3 0 100-6 3 3 0 000 6z" />\r
  <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" />\r
</svg>\r
`,UH={slot_1:"Skill Slot 1",slot_2:"Skill Slot 2",slot_3:"Skill Slot 3",slot_4:"Skill Slot 4",slot_lmb:"Primary Attack",slot_rmb:"Secondary Attack",slot_consumable_1:"Consumable 1",slot_consumable_2:"Consumable 2"};function OH(){const[i,e]=k.useState(!1),t=k.useRef(null),{getDisplayKey:n,startRebind:a,rebinding:r,resetToDefaults:l}=Lg(),{getActionObjectForSlot:u}=ar();return B.jsxs(B.Fragment,{children:[B.jsx(Bg,{ref:t,icon:B.jsx(Ng,{svg:DH}),isOpen:i,onClick:()=>e(!i),label:"Toggle settings",tooltip:"Key Bindings",activeAnimation:"rotate"}),B.jsxs(Dg,{isOpen:i,anchorRef:t,width:300,portalId:"settings-portal",children:[B.jsx(Ug,{children:"Key Bindings"}),B.jsx(Og,{maxHeight:320,gap:6,children:wg.map(d=>{const p=u(d.id);return B.jsxs("div",{className:oh["keybind-row"],children:[B.jsxs("div",{className:oh["keybind-info"],children:[B.jsx("span",{className:oh["keybind-slot"],children:UH[d.id]}),p&&B.jsx("span",{className:oh["keybind-action"],children:p.label})]}),B.jsx("button",{className:`${oh["keybind-key"]} ${r===d.id?oh.rebinding:""}`,onClick:()=>a(d.id),children:r===d.id?"...":n(d.id)})]},d.id)})}),B.jsx("button",{className:oh["reset-button"],onClick:l,children:"Reset to Defaults"})]})]})}const NH="_locked_i4b8s_203",LH="_unlocked_i4b8s_213",lo={"drawer-header":"_drawer-header_i4b8s_7","drawer-progress":"_drawer-progress_i4b8s_45","progress-bar":"_progress-bar_i4b8s_83","progress-fill":"_progress-fill_i4b8s_113","achievement-row":"_achievement-row_i4b8s_165",locked:NH,unlocked:LH,"achievement-icon":"_achievement-icon_i4b8s_235","achievement-info":"_achievement-info_i4b8s_291","achievement-name":"_achievement-name_i4b8s_307","achievement-desc":"_achievement-desc_i4b8s_339","achievement-check":"_achievement-check_i4b8s_373"},lw="player_achievements",db={first_cast:{id:"first_cast",name:"Apprentice Mage",description:"Cast your first spell",icon:"",rarity:"common"},potion_master:{id:"potion_master",name:"Potion Master",description:"Use a health potion to restore your vitality",icon:"",rarity:"common"},first_pixie:{id:"first_pixie",name:"Fairy Friend",description:"Equip your first pixie companion",icon:"",rarity:"uncommon"},pixie_trio:{id:"pixie_trio",name:"Pixie Parade",description:"Equip three pixies at once",icon:"",rarity:"rare"}},fy={common:{primary:"#9d9d9d",glow:"rgba(157, 157, 157, 0.5)"},uncommon:{primary:"#1eff00",glow:"rgba(30, 255, 0, 0.5)"},rare:{primary:"#0070dd",glow:"rgba(0, 112, 221, 0.5)"},epic:{primary:"#a335ee",glow:"rgba(163, 53, 238, 0.5)"},legendary:{primary:"#ff8000",glow:"rgba(255, 128, 0, 0.6)"}},cw=k.createContext(null),IH=()=>{try{const i=localStorage.getItem(lw);if(i)return new Set(JSON.parse(i))}catch(i){console.warn("Failed to load achievements:",i)}return new Set},qE=i=>{try{localStorage.setItem(lw,JSON.stringify([...i]))}catch(e){console.warn("Failed to save achievements:",e)}};function PH({children:i}){const[e,t]=k.useState(IH),[n,a]=k.useState([]),[r,l]=k.useState(null),u=k.useRef(null),d=k.useRef(!1);k.useEffect(()=>{if(r===null&&n.length>0&&!d.current){d.current=!0;const E=setTimeout(()=>{const[S,...w]=n;l(S),a(w),u.current=setTimeout(()=>{l(null),d.current=!1},4e3)},300);return()=>clearTimeout(E)}},[r,n]);const p=k.useCallback(E=>e.has(E),[e]),x=k.useCallback(E=>{if(e.has(E))return!1;const S=db[E];return S?(t(w=>{const D=new Set(w);return D.add(E),qE(D),D}),a(w=>[...w,S]),!0):!1},[e]),g=k.useCallback(()=>{u.current&&clearTimeout(u.current),l(null)},[]),_=k.useCallback(()=>Object.values(db).map(E=>({...E,unlocked:e.has(E.id)})),[e]),y=k.useCallback(()=>{const E=Object.keys(db).length,S=e.size;return{unlocked:S,total:E,percent:Math.round(S/E*100)}},[e]),b=k.useCallback(()=>{const E=new Set;t(E),qE(E),a([]),l(null)},[]),C={unlock:x,isUnlocked:p,getAllAchievements:_,getProgress:y,currentToast:r,dismissToast:g,resetToDefaults:b};return B.jsx(cw.Provider,{value:C,children:i})}function Qy(){const i=k.useContext(cw);if(!i)throw new Error("useAchievements must be used within an AchievementProvider");return i}const FH=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\r
  <path d="M6 9H4.5a2.5 2.5 0 010-5H6" />\r
  <path d="M18 9h1.5a2.5 2.5 0 000-5H18" />\r
  <path d="M4 22h16" />\r
  <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" />\r
  <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" />\r
  <path d="M18 2H6v7a6 6 0 0012 0V2Z" />\r
</svg>\r
`;function zH(){const[i,e]=k.useState(!1),t=k.useRef(null),{getAllAchievements:n,getProgress:a}=Qy(),r=n(),l=a();return B.jsxs(B.Fragment,{children:[B.jsx(Bg,{ref:t,icon:B.jsx(Ng,{svg:FH}),isOpen:i,onClick:()=>e(!i),label:"Toggle achievements",tooltip:"Achievements"}),B.jsxs(Dg,{isOpen:i,anchorRef:t,width:320,portalId:"achievements-portal",children:[B.jsxs("div",{className:lo["drawer-header"],children:[B.jsx(Ug,{children:"Achievements"}),B.jsxs("div",{className:lo["drawer-progress"],children:[l.unlocked,"/",l.total]})]}),B.jsx("div",{className:lo["progress-bar"],children:B.jsx("div",{className:lo["progress-fill"],style:{width:`${l.percent}%`}})}),B.jsx(Og,{maxHeight:280,gap:6,children:r.map(u=>{const d=fy[u.rarity]||fy.common;return B.jsxs("div",{className:`${lo["achievement-row"]} ${u.unlocked?lo.unlocked:lo.locked}`,style:{"--rarity-color":d.primary,"--rarity-glow":d.glow},children:[B.jsx("div",{className:lo["achievement-icon"],children:u.icon}),B.jsxs("div",{className:lo["achievement-info"],children:[B.jsx("span",{className:lo["achievement-name"],children:u.name}),B.jsx("span",{className:lo["achievement-desc"],children:u.description})]}),u.unlocked&&B.jsx("div",{className:lo["achievement-check"],children:""})]},u.id)})})]})]})}const HH="_tab_cpnuc_7",GH="_dragging_cpnuc_163",VH="_assigned_cpnuc_171",li={"tab-bar":"_tab-bar_cpnuc_7",tab:HH,"tab-active":"_tab-active_cpnuc_75","spell-card":"_spell-card_cpnuc_97",dragging:GH,assigned:VH,"spell-header":"_spell-header_cpnuc_183","drag-hint":"_drag-hint_cpnuc_195","spell-icon":"_spell-icon_cpnuc_223","spell-info":"_spell-info_cpnuc_273","spell-name":"_spell-name_cpnuc_289","spell-badges":"_spell-badges_cpnuc_303","spell-element":"_spell-element_cpnuc_315","spell-type":"_spell-type_cpnuc_337","spell-assigned":"_spell-assigned_cpnuc_359","spell-desc":"_spell-desc_cpnuc_381","spell-stats":"_spell-stats_cpnuc_397","stat-label":"_stat-label_cpnuc_429","stat-mana":"_stat-mana_cpnuc_439","stat-mana-gain":"_stat-mana-gain_cpnuc_447","stat-health":"_stat-health_cpnuc_455","stat-heal":"_stat-heal_cpnuc_455","stat-buff":"_stat-buff_cpnuc_471","empty-state":"_empty-state_cpnuc_489"},kH=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\r
  <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />\r
  <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />\r
  <path d="M8 7h8M8 11h6" />\r
</svg>\r
`,jH=[{id:"all",label:"All",color:"#a89878"},{id:"ice",label:"Ice",color:Fa.ice.primary},{id:"fire",label:"Fire",color:Fa.fire.primary},{id:"arcane",label:"Arcane",color:Fa.arcane.primary},{id:"mana",label:"Mana",color:Fa.mana.primary}];function XH({action:i}){const e=i.element?Fa[i.element]:null,{handlers:t,isDragging:n}=iA(i),{getSlotForAction:a}=ar(),r=a(i.id);return B.jsxs("div",{className:`${li["spell-card"]} ${n?li.dragging:""} ${r?li.assigned:""}`,...t,children:[B.jsxs("div",{className:li["spell-header"],children:[i.icon&&B.jsx("div",{className:li["spell-icon"],style:{"--element-color":e?.primary||"#a89878"},children:B.jsx("img",{src:i.icon,alt:"",draggable:!1})}),B.jsxs("div",{className:li["spell-info"],children:[B.jsx("span",{className:li["spell-name"],children:i.label}),B.jsxs("div",{className:li["spell-badges"],children:[e&&B.jsx("span",{className:li["spell-element"],style:{"--element-color":e.primary},children:e.name}),B.jsx("span",{className:li["spell-type"],children:i.type}),r&&B.jsx("span",{className:li["spell-assigned"],children:"Equipped"})]})]}),B.jsx("div",{className:li["drag-hint"],children:""})]}),B.jsx("p",{className:li["spell-desc"],children:i.description}),B.jsxs("div",{className:li["spell-stats"],children:[i.manaCost>0&&B.jsxs("span",{className:li["stat-mana"],children:[B.jsx("span",{className:li["stat-label"],children:"Mana:"})," ",i.manaCost]}),i.manaGain>0&&B.jsxs("span",{className:li["stat-mana-gain"],children:[B.jsx("span",{className:li["stat-label"],children:"Mana:"})," +",i.manaGain]}),i.manaPerSecond>0&&B.jsxs("span",{className:li["stat-mana"],children:[B.jsx("span",{className:li["stat-label"],children:"Drain:"})," ",i.manaPerSecond,"/s"]}),i.healthCost>0&&B.jsxs("span",{className:li["stat-health"],children:[B.jsx("span",{className:li["stat-label"],children:"Health:"})," ",i.healthCost]}),i.buff&&B.jsxs(B.Fragment,{children:[B.jsxs("span",{className:li["stat-buff"],children:[B.jsx("span",{className:li["stat-label"],children:"Duration:"})," ",i.buff.duration,"s"]}),i.buff.manaRegenBonus>0&&B.jsxs("span",{className:li["stat-mana-gain"],children:[B.jsx("span",{className:li["stat-label"],children:"Mana Regen:"})," +",i.buff.manaRegenBonus,"/s"]}),i.buff.healthRegenBonus>0&&B.jsxs("span",{className:li["stat-heal"],children:[B.jsx("span",{className:li["stat-label"],children:"Health Regen:"})," +",i.buff.healthRegenBonus,"/s"]})]})]})]})}function YH(){const[i,e]=k.useState(!1),[t,n]=k.useState("all"),a=k.useRef(null),r=l6(),l=k.useMemo(()=>t==="all"?r:r.filter(u=>u.element===t),[t,r]);return B.jsxs(B.Fragment,{children:[B.jsx(Bg,{ref:a,icon:B.jsx(Ng,{svg:kH}),isOpen:i,onClick:()=>e(!i),label:"Toggle spell book",tooltip:"Spell Book"}),B.jsxs(Dg,{isOpen:i,anchorRef:a,width:380,portalId:"spellbook-portal",children:[B.jsx(Ug,{children:"Spell Book"}),B.jsx("div",{className:li["tab-bar"],children:jH.map(u=>B.jsx("button",{className:`${li.tab} ${t===u.id?li["tab-active"]:""}`,style:{"--tab-color":u.color},onClick:()=>n(u.id),children:u.label},u.id))}),B.jsx(Og,{maxHeight:320,gap:8,children:l.length===0?B.jsx("div",{className:li["empty-state"],children:"No spells in this category"}):l.map(u=>B.jsx(XH,{action:u},u.id))})]})]})}const qH="_tab_rjcem_7",KH="_hint_rjcem_97",JH="_dragging_rjcem_183",WH="_assigned_rjcem_191",Vi={"tab-bar":"_tab-bar_rjcem_7",tab:qH,"tab-active":"_tab-active_rjcem_75",hint:KH,"consumable-card":"_consumable-card_rjcem_117",dragging:JH,assigned:WH,"consumable-header":"_consumable-header_rjcem_203","drag-hint":"_drag-hint_rjcem_215","consumable-icon":"_consumable-icon_rjcem_243","consumable-info":"_consumable-info_rjcem_293","consumable-name":"_consumable-name_rjcem_307","consumable-badges":"_consumable-badges_rjcem_321","consumable-type":"_consumable-type_rjcem_333","consumable-assigned":"_consumable-assigned_rjcem_355","consumable-desc":"_consumable-desc_rjcem_377","consumable-stats":"_consumable-stats_rjcem_393","stat-label":"_stat-label_rjcem_425","stat-buff":"_stat-buff_rjcem_435","stat-heal":"_stat-heal_rjcem_443","stat-mana-gain":"_stat-mana-gain_rjcem_451","empty-state":"_empty-state_rjcem_459"},ZH=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\r
  <path d="M10 2v4.5" />\r
  <path d="M14 2v4.5" />\r
  <path d="M8.5 6.5h7" />\r
  <path d="M17.5 22h-11a2 2 0 0 1-1.8-2.9l3.3-6.6v-6h8v6l3.3 6.6a2 2 0 0 1-1.8 2.9z" />\r
  <path d="M7 15h10" />\r
</svg>\r
`,QH=[{id:"all",label:"All",color:"#a89878"},{id:"potion",label:"Potions",color:Fa.healing.primary},{id:"food",label:"Food",color:"#c9a55a"}];function $H({action:i}){const e=i.element?Fa[i.element]:null,{handlers:t,isDragging:n}=iA(i),{getSlotForAction:a}=ar(),r=a(i.id);return B.jsxs("div",{className:`${Vi["consumable-card"]} ${n?Vi.dragging:""} ${r?Vi.assigned:""}`,...t,children:[B.jsxs("div",{className:Vi["consumable-header"],children:[i.icon&&B.jsx("div",{className:Vi["consumable-icon"],style:{"--element-color":e?.primary||"#a89878"},children:B.jsx("img",{src:i.icon,alt:"",draggable:!1})}),B.jsxs("div",{className:Vi["consumable-info"],children:[B.jsx("span",{className:Vi["consumable-name"],children:i.label}),B.jsxs("div",{className:Vi["consumable-badges"],children:[B.jsx("span",{className:Vi["consumable-type"],children:i.type}),r&&B.jsx("span",{className:Vi["consumable-assigned"],children:"Equipped"})]})]}),B.jsx("div",{className:Vi["drag-hint"],children:""})]}),B.jsx("p",{className:Vi["consumable-desc"],children:i.description}),B.jsx("div",{className:Vi["consumable-stats"],children:i.buff&&B.jsxs(B.Fragment,{children:[B.jsxs("span",{className:Vi["stat-buff"],children:[B.jsx("span",{className:Vi["stat-label"],children:"Duration:"})," ",i.buff.duration,"s"]}),i.buff.healthRegenBonus>0&&B.jsxs("span",{className:Vi["stat-heal"],children:[B.jsx("span",{className:Vi["stat-label"],children:"Health Regen:"})," +",i.buff.healthRegenBonus,"/s"]}),i.buff.manaRegenBonus>0&&B.jsxs("span",{className:Vi["stat-mana-gain"],children:[B.jsx("span",{className:Vi["stat-label"],children:"Mana Regen:"})," +",i.buff.manaRegenBonus,"/s"]})]})})]})}function eG(){const[i,e]=k.useState(!1),[t,n]=k.useState("all"),a=k.useRef(null),r=c6(),l=k.useMemo(()=>t==="all"?r:r.filter(u=>u.id.includes(t)),[t,r]);return B.jsxs(B.Fragment,{children:[B.jsx(Bg,{ref:a,icon:B.jsx(Ng,{svg:ZH}),isOpen:i,onClick:()=>e(!i),label:"Toggle consumables",tooltip:"Consumables"}),B.jsxs(Dg,{isOpen:i,anchorRef:a,width:340,portalId:"consumables-portal",children:[B.jsx(Ug,{children:"Consumables"}),B.jsx("div",{className:Vi["tab-bar"],children:QH.map(u=>B.jsx("button",{className:`${Vi.tab} ${t===u.id?Vi["tab-active"]:""}`,style:{"--tab-color":u.color},onClick:()=>n(u.id),children:u.label},u.id))}),B.jsx("p",{className:Vi.hint,children:"Drag to consumable slots only"}),B.jsx(Og,{maxHeight:280,gap:8,children:l.length===0?B.jsx("div",{className:Vi["empty-state"],children:"No consumables in this category"}):l.map(u=>B.jsx($H,{action:u},u.id))})]})]})}const tG="_tab_pqm4s_7",nG="_dragging_pqm4s_163",iG="_assigned_pqm4s_171",Mi={"tab-bar":"_tab-bar_pqm4s_7",tab:tG,"tab-active":"_tab-active_pqm4s_75","pixie-card":"_pixie-card_pqm4s_97",dragging:nG,assigned:iG,"pixie-header":"_pixie-header_pqm4s_183","drag-hint":"_drag-hint_pqm4s_195","pixie-icon":"_pixie-icon_pqm4s_223","pixie-info":"_pixie-info_pqm4s_273","pixie-name":"_pixie-name_pqm4s_289","pixie-badges":"_pixie-badges_pqm4s_303","pixie-element":"_pixie-element_pqm4s_315","pixie-type":"_pixie-type_pqm4s_337","pixie-assigned":"_pixie-assigned_pqm4s_359","pixie-desc":"_pixie-desc_pqm4s_381","pixie-stats":"_pixie-stats_pqm4s_397","stat-label":"_stat-label_pqm4s_429","stat-buff":"_stat-buff_pqm4s_439","stat-passive":"_stat-passive_pqm4s_451","empty-state":"_empty-state_pqm4s_461","equipment-section":"_equipment-section_pqm4s_545","equipment-label":"_equipment-label_pqm4s_573","equipment-slots":"_equipment-slots_pqm4s_589","pixie-slot":"_pixie-slot_pqm4s_599","slot-hover":"_slot-hover_pqm4s_649","slot-filled":"_slot-filled_pqm4s_665","slot-number":"_slot-number_pqm4s_705"},aG=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\r
  <!-- Wings -->\r
  <ellipse cx="7" cy="10" rx="4" ry="5.5" />\r
  <ellipse cx="17" cy="10" rx="4" ry="5.5" />\r
  <!-- Body core -->\r
  <circle cx="12" cy="12" r="3" fill="currentColor" />\r
  <!-- Sparkles -->\r
  <circle cx="12" cy="4" r="1.2" fill="currentColor" stroke="none" />\r
  <circle cx="5" cy="18" r="1" fill="currentColor" stroke="none" />\r
  <circle cx="19" cy="18" r="1" fill="currentColor" stroke="none" />\r
</svg>\r
`,sG={healthRegen:{label:"Health Regen",suffix:"/sec",color:"#40ff80",name:"Healing"},manaRegen:{label:"Mana Regen",suffix:"/sec",color:"#40a0ff",name:"Mana"},maxHealth:{label:"Max Health",suffix:"",color:"#ff6040",name:"Vitality"},maxMana:{label:"Max Mana",suffix:"",color:"#a040ff",name:"Arcane"}},rG=[{id:"all",label:"All",color:"#a89878"},{id:"healthRegen",label:"Healing",color:"#40ff80"},{id:"manaRegen",label:"Mana",color:"#40a0ff"},{id:"maxMana",label:"Arcane",color:"#a040ff"},{id:"maxHealth",label:"Vitality",color:"#ff6040"}],oG=k.memo(function({slotId:e,slotIndex:t}){const{slotMap:n}=ar(),{ref:a,isHovered:r,isDragging:l}=JR(e),{startDrag:u}=Zy(),d=k.useRef(null),p=n?.[e]||null,x=p?Cc[p]:null,g=b=>{x&&(d.current={x:b.clientX,y:b.clientY})},_=b=>{if(!d.current||!x)return;const C=b.clientX-d.current.x,E=b.clientY-d.current.y;Math.sqrt(C*C+E*E)>5&&(u({id:x.id,icon:x.icon,label:x.name,dragType:"pixie"},{x:b.clientX,y:b.clientY},e),d.current=null)},y=()=>{d.current=null};return B.jsx("div",{ref:a,className:`${Mi["pixie-slot"]} ${r&&l?Mi["slot-hover"]:""} ${x?Mi["slot-filled"]:""}`,style:x?{"--element-color":x.color}:void 0,onPointerDown:g,onPointerMove:_,onPointerUp:y,onPointerCancel:y,children:x?B.jsx("img",{src:x.icon,alt:x.name,draggable:!1}):B.jsx("span",{className:Mi["slot-number"],children:t+1})})}),lG=k.memo(function({pixie:e}){const t=sG[e.buff.type],{slotMap:n}=ar(),a=k.useMemo(()=>({id:e.id,label:e.name,icon:e.icon,dragType:"pixie"}),[e]),{handlers:r,isDragging:l}=iA(a),u=k.useMemo(()=>{const p=Object.entries(n||{}).find(([x,g])=>g===e.id);return p?p[0]:null},[n,e.id]),d=u?Ih.findIndex(p=>p.id===u)+1:null;return B.jsxs("div",{className:`${Mi["pixie-card"]} ${l?Mi.dragging:""} ${u?Mi.assigned:""}`,...r,children:[B.jsxs("div",{className:Mi["pixie-header"],children:[e.icon&&B.jsx("div",{className:Mi["pixie-icon"],style:{"--element-color":e.color},children:B.jsx("img",{src:e.icon,alt:"",draggable:!1})}),B.jsxs("div",{className:Mi["pixie-info"],children:[B.jsx("span",{className:Mi["pixie-name"],children:e.name}),B.jsxs("div",{className:Mi["pixie-badges"],children:[B.jsx("span",{className:Mi["pixie-element"],style:{"--element-color":t.color},children:t.name}),B.jsx("span",{className:Mi["pixie-type"],children:"Pixie"}),d&&B.jsxs("span",{className:Mi["pixie-assigned"],children:["Slot ",d]})]})]}),B.jsx("div",{className:Mi["drag-hint"],children:""})]}),B.jsx("p",{className:Mi["pixie-desc"],children:e.description}),B.jsxs("div",{className:Mi["pixie-stats"],children:[B.jsxs("span",{className:Mi["stat-buff"],style:{color:t.color},children:[B.jsxs("span",{className:Mi["stat-label"],children:[t.label,":"]})," +",e.buff.value,t.suffix]}),B.jsx("span",{className:Mi["stat-passive"],children:"Passive Effect"})]})]})});function cG(){const[i,e]=k.useState(!1),[t,n]=k.useState("all"),a=k.useRef(null),{collected:r}=aA(),l=k.useMemo(()=>r.map(d=>Cc[d]).filter(Boolean),[r]),u=k.useMemo(()=>t==="all"?l:l.filter(d=>d.buff.type===t),[t,l]);return B.jsxs(B.Fragment,{children:[B.jsx(Bg,{ref:a,icon:B.jsx(Ng,{svg:aG}),isOpen:i,onClick:()=>e(!i),label:"Toggle pixies panel",tooltip:"Pixies"}),B.jsxs(Dg,{isOpen:i,anchorRef:a,width:380,portalId:"pixies-portal",children:[B.jsx(Ug,{children:"Pixies"}),B.jsxs("div",{className:Mi["equipment-section"],children:[B.jsx("div",{className:Mi["equipment-label"],children:"Equipped"}),B.jsx("div",{className:Mi["equipment-slots"],children:Ih.map((d,p)=>B.jsx(oG,{slotId:d.id,slotIndex:p},d.id))})]}),B.jsx("div",{className:Mi["tab-bar"],children:rG.map(d=>B.jsx("button",{className:`${Mi.tab} ${t===d.id?Mi["tab-active"]:""}`,style:{"--tab-color":d.color},onClick:()=>n(d.id),children:d.label},d.id))}),B.jsx(Og,{maxHeight:320,gap:8,children:u.length===0?B.jsx("div",{className:Mi["empty-state"],children:"No pixies in this category"}):u.map(d=>B.jsx(lG,{pixie:d},d.id))})]})]})}function uG(){return B.jsxs("div",{className:SH["menu-bar"],children:[B.jsx(YH,{}),B.jsx(eG,{}),B.jsx(cG,{}),B.jsx(zH,{}),B.jsx(OH,{})]})}const fG="_toast_6g6oy_1",hG="_iconPulse_6g6oy_1",dG="_progressShrink_6g6oy_1",pG="_entering_6g6oy_281",mG="_toastEnter_6g6oy_1",gG="_visible_6g6oy_289",vG="_exiting_6g6oy_299",xG="_toastExit_6g6oy_1",Ac={toast:fG,"toast-icon":"_toast-icon_6g6oy_91",iconPulse:hG,"toast-content":"_toast-content_6g6oy_149","toast-label":"_toast-label_6g6oy_161","toast-name":"_toast-name_6g6oy_183","toast-desc":"_toast-desc_6g6oy_203","toast-progress":"_toast-progress_6g6oy_217","toast-progress-fill":"_toast-progress-fill_6g6oy_241",progressShrink:dG,entering:pG,toastEnter:mG,visible:gG,exiting:vG,toastExit:xG};function _G(){const{currentToast:i,dismissToast:e}=Qy(),[t,n]=k.useState("hidden");if(k.useEffect(()=>{if(i){n("entering");const r=setTimeout(()=>{n("visible")},400),l=setTimeout(()=>{n("exiting")},3600),u=setTimeout(()=>{n("hidden")},4e3);return()=>{clearTimeout(r),clearTimeout(l),clearTimeout(u)}}else n("hidden")},[i]),!i||t==="hidden")return null;const a=fy[i.rarity]||fy.common;return B.jsxs("div",{className:`${Ac.toast} ${Ac[t]}`,style:{"--rarity-color":a.primary,"--rarity-glow":a.glow},onClick:e,children:[B.jsx("div",{className:Ac["toast-icon"],children:i.icon}),B.jsxs("div",{className:Ac["toast-content"],children:[B.jsx("div",{className:Ac["toast-label"],children:"Achievement Unlocked"}),B.jsx("div",{className:Ac["toast-name"],children:i.name}),B.jsx("div",{className:Ac["toast-desc"],children:i.description})]}),B.jsx("div",{className:Ac["toast-progress"],children:B.jsx("div",{className:Ac["toast-progress-fill"]})})]})}const uw=k.createContext(null),sA=()=>k.useContext(uw);function yG({children:i}){const[e,t]=k.useState(null),[n,a]=k.useState(null),r=k.useCallback(p=>a(p),[]),l=k.useCallback(()=>{a(null),t(null)},[]),u=k.useCallback(()=>e!==null,[e]),d=k.useMemo(()=>({target:e,setTarget:t,lockedTargetId:n,lockTarget:r,unlockTarget:l,hasTarget:u}),[e,n,r,l,u]);return B.jsx(uw.Provider,{value:d,children:i})}function fw({name:i="Unknown",health:e=100,maxHealth:t=100,level:n,type:a="enemy",buffs:r=[],debuffs:l=[],children:u}){const{setTarget:d,lockedTargetId:p,lockTarget:x}=sA()||{},{handleInput:g,mouseButtonActionsRef:_}=ps(),y=k.useRef(`${i}-${a}`).current,b=k.useRef(!1),C=p===y,E=k.useMemo(()=>({name:i,health:e,maxHealth:t,level:n,type:a,buffs:r,debuffs:l}),[i,e,t,n,a,r,l]);k.useEffect(()=>{(b.current||C)&&d&&d(E)},[E,C,d]);const S=ar(),w=S?.getActionForSlot?.("slot_lmb")??"primary_attack",D=S?.getActionForSlot?.("slot_rmb")??"secondary_attack",U=k.useCallback(()=>{x?.(y),d?.(E)},[x,d,y,E]),F=k.useCallback(P=>{P.stopPropagation(),!(p&&p!==y)&&(b.current=!0,d?.(E))},[p,y,d,E]),N=k.useCallback(P=>{P.stopPropagation(),b.current=!1,C||d?.(null)},[C,d]),z=k.useCallback(P=>{P.stopPropagation(),P.button===0&&(C||U(),w&&(_&&(_.current[0]=w),g?.(w,!0))),P.button===2&&(C||U(),D&&(_&&(_.current[2]=D),g?.(D,!0)))},[C,U,g,w,D,_]),j=k.useCallback(P=>{P.stopPropagation(),P.button===0&&w&&(g?.(w,!1),_&&(_.current[0]=null)),P.button===2&&D&&(g?.(D,!1),_&&(_.current[2]=null))},[g,w,D,_]),L=k.useCallback(P=>{P.stopPropagation(),P.nativeEvent?.preventDefault?.()},[]);return B.jsx("group",{onPointerEnter:F,onPointerLeave:N,onPointerDown:z,onPointerUp:j,onContextMenu:L,children:u})}const bG="_container_1fgd1_5",SG="_fadeIn_1fgd1_1",AG="_nameLabel_1fgd1_37",MG="_level_1fgd1_53",EG="_name_1fgd1_37",TG="_eliteBadge_1fgd1_81",CG="_bossBadge_1fgd1_105",RG="_frame_1fgd1_129",wG="_levelBox_1fgd1_189",BG="_barTrack_1fgd1_235",DG="_barFill_1fgd1_267",UG="_barShine_1fgd1_307",OG="_healthText_1fgd1_335",NG="_statusBar_1fgd1_559",LG="_statusIcon_1fgd1_575",IG="_buff_1fgd1_601",PG="_debuff_1fgd1_611",FG="_statusImage_1fgd1_621",zG="_statusSweep_1fgd1_635",HG="_statusTimer_1fgd1_657",Pa={container:bG,fadeIn:SG,nameLabel:AG,level:MG,name:EG,eliteBadge:TG,bossBadge:CG,frame:RG,levelBox:wG,barTrack:BG,barFill:DG,barShine:UG,healthText:OG,"type-enemy":"_type-enemy_1fgd1_373","type-elite":"_type-elite_1fgd1_405","type-boss":"_type-boss_1fgd1_455","type-friendly":"_type-friendly_1fgd1_513",statusBar:NG,statusIcon:LG,buff:IG,debuff:PG,statusImage:FG,statusSweep:zG,statusTimer:HG},KE=i=>Math.round(i).toLocaleString();function JE({status:i,now:e,isDebuff:t=!1}){const n=i.expiresAt?Math.max(0,(i.expiresAt-e)/1e3):null,a=n!==null?n/i.duration:1;return B.jsxs("div",{className:`${Pa.statusIcon} ${t?Pa.debuff:Pa.buff}`,children:[B.jsx("img",{src:i.icon,alt:i.name,className:Pa.statusImage}),i.duration&&B.jsxs(B.Fragment,{children:[B.jsx("div",{className:Pa.statusSweep,style:{"--progress":a}}),B.jsxs("span",{className:Pa.statusTimer,children:[Math.ceil(n),"s"]})]})]})}function GG(){const{target:i}=sA()||{},[e,t]=k.useState(Date.now()),n=i?.buffs?.some(u=>u.expiresAt)||i?.debuffs?.some(u=>u.expiresAt);if(k.useEffect(()=>{if(!n)return;const u=setInterval(()=>{t(Date.now())},100);return()=>clearInterval(u)},[n]),!i)return null;const a=i.health/i.maxHealth*100,r=Pa[`type-${i.type}`]||"",l=i.buffs?.length>0||i.debuffs?.length>0;return B.jsxs("div",{className:`${Pa.container} ${r}`,children:[B.jsxs("div",{className:Pa.nameLabel,children:[i.level&&B.jsxs("span",{className:Pa.level,children:["Lv.",i.level]}),B.jsx("span",{className:Pa.name,children:i.name}),i.type==="elite"&&B.jsx("span",{className:Pa.eliteBadge,children:"Elite"}),i.type==="boss"&&B.jsx("span",{className:Pa.bossBadge,children:"Boss"})]}),B.jsxs("div",{className:Pa.frame,children:[B.jsx(ly,{position:"left"}),B.jsxs("div",{className:Pa.barTrack,children:[B.jsx("div",{className:Pa.barFill,style:{width:`calc(${a}% - 2px)`}}),B.jsx("div",{className:Pa.barShine}),B.jsxs("span",{className:Pa.healthText,children:[KE(i.health)," / ",KE(i.maxHealth)]})]}),B.jsx(ly,{position:"right"})]}),l&&B.jsxs("div",{className:Pa.statusBar,children:[i.buffs?.map((u,d)=>B.jsx(JE,{status:u,now:e},u.id||d)),i.debuffs?.map((u,d)=>B.jsx(JE,{status:u,now:e,isDebuff:!0},u.id||d))]})]})}const t_=new ut(Fa.ice.primary),pb=new ut(Fa.ice.secondary),WE=4,VG=`
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  
  void main() {
    vNormal = normalize(normalMatrix * normal);
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
  }
`,kG=`
  uniform float uOpacity;
  uniform vec3 uColor;
  
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  
  void main() {
    vec3 viewDir = normalize(vViewPosition);
    float fresnel = pow(1.0 - abs(dot(viewDir, normalize(vNormal))), 2.5);
    
    float alpha = fresnel * uOpacity * 0.85;
    vec3 color = uColor + vec3(0.15, 0.2, 0.25) * fresnel;
    
    gl_FragColor = vec4(color, alpha);
  }
`,jG=`
  varying vec2 vUv;
  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
`,XG=`
  uniform float uProgress;
  uniform float uImpact;
  uniform vec3 uColor;
  uniform vec3 uColorSecondary;
  
  varying vec2 vUv;
  
  #define PI 3.14159265359
  
  // Crisp ring - LoL style sharp edges
  float ring(vec2 uv, float radius, float thickness) {
    float dist = length(uv);
    float inner = smoothstep(radius - thickness * 0.5, radius - thickness * 0.3, dist);
    float outer = smoothstep(radius + thickness * 0.3, radius + thickness * 0.5, dist);
    return inner - outer;
  }
  
  // Hash for pseudo-random
  float hash(float n) {
    return fract(sin(n) * 43758.5453);
  }
  
  // LoL-style sharp falloff for impact "pop"
  float sharpPop(float t) {
    return pow(max(0.0, 1.0 - t), 4.0);
  }
  
  void main() {
    vec2 uv = vUv * 2.0 - 1.0;
    float dist = length(uv);
    float angle = atan(uv.y, uv.x);
    
    float formProgress = clamp(uProgress / 0.55, 0.0, 1.0);
    
    // === ANTICIPATION PHASE (LoL: tighten/brighten before release) ===
    float anticipation = smoothstep(0.45, 0.55, uProgress) * (1.0 - step(0.55, uProgress));
    float anticipationPulse = 1.0 + anticipation * sin(uProgress * 60.0) * 0.08; // Quick vibration
    
    // Outer ring - tightens during anticipation (LoL squeeze)
    float outerRadius = 0.92 - anticipation * 0.04;
    float outerThickness = 0.03 + anticipation * 0.02; // Thickens = more energy
    float outerRing = ring(uv, outerRadius * anticipationPulse, outerThickness);
    outerRing *= 1.0 + anticipation * 0.8; // Brighter during charge
    
    // Inner ring - pulses with energy gathering
    float innerPulse = 1.0 + sin(formProgress * PI * 6.0) * 0.1 * formProgress;
    float innerRing = ring(uv, 0.55 * innerPulse, 0.025);
    
    // Progress arc fill
    float progressAngle = -PI + formProgress * 2.0 * PI;
    float progressRing = ring(uv, 0.73, 0.04);
    progressRing *= step(angle, progressAngle);
    
    // Hexagonal ice pattern - sharper
    float hexAngle = mod(angle + PI, PI / 3.0) - PI / 6.0;
    float hexPattern = step(0.45, dist) * step(dist, 0.85);
    hexPattern *= smoothstep(0.06, 0.0, abs(hexAngle)) * 0.5 * formProgress;
    
    // Radial lines - 6 sharp crystalline
    float numLines = 6.0;
    float lineAngle = mod(angle + formProgress * PI * 0.3, PI * 2.0 / numLines);
    float lines = smoothstep(0.012, 0.0, abs(lineAngle - PI / numLines));
    lines *= step(0.3, dist) * step(dist, 0.88) * formProgress * 0.7;
    
    // Center glow - LoL style bright core that intensifies
    float coreIntensity = formProgress * formProgress; // Accelerating brightness
    float centerGlow = smoothstep(0.4, 0.0, dist) * 0.5 * coreIntensity;
    centerGlow += smoothstep(0.2, 0.0, dist) * 0.3 * coreIntensity; // Hot white core
    
    // === IMPACT PHASE (LoL: sharp pop, hold, decay) ===
    
    // Impact timing curve - FAST attack, brief HOLD, smooth decay
    float impactAttack = smoothstep(0.0, 0.15, uImpact); // Fast 0-1
    float impactHold = smoothstep(0.0, 0.25, uImpact) * (1.0 - smoothstep(0.25, 0.4, uImpact));
    float impactDecay = smoothstep(0.3, 1.0, uImpact);
    
    // PRIMARY POP - bright sharp flash (LoL signature)
    float popIntensity = sharpPop(uImpact * 1.5) * impactAttack * 3.0;
    float impactPop = smoothstep(0.7, 0.0, dist) * popIntensity;
    impactPop += smoothstep(0.3, 0.0, dist) * popIntensity * 0.5; // White hot center
    
    // Shockwave ring - fast expand with sharp edge
    float shockRadius = pow(uImpact, 0.6) * 0.88; // Fast start, slows at edge
    float shockwave = ring(uv, shockRadius, 0.05 * (1.0 - uImpact * 0.5));
    shockwave *= (1.0 - impactDecay) * 2.0;
    
    // Ice crack lines - sharp crystalline fractures (LoL: directional, clean)
    float cracks = 0.0;
    for(float i = 0.0; i < 6.0; i++) {
      float crackAngle = i * PI / 3.0 + 0.15;
      float angleDiff = abs(mod(angle - crackAngle + PI, PI * 2.0) - PI);
      float crackWidth = 0.025;
      float crackLength = impactAttack * (0.7 + hash(i) * 0.18);
      float crackFade = 1.0 - impactDecay;
      cracks += smoothstep(crackWidth, 0.0, angleDiff) * step(dist, crackLength) * step(0.08, dist) * crackFade;
    }
    cracks *= 0.8;
    
    // Secondary crack details - thinner, between main cracks
    for(float i = 0.0; i < 6.0; i++) {
      float crackAngle = i * PI / 3.0 + PI / 6.0;
      float angleDiff = abs(mod(angle - crackAngle + PI, PI * 2.0) - PI);
      float crackLength = impactAttack * (0.4 + hash(i + 50.0) * 0.15);
      float crackFade = 1.0 - impactDecay * 1.2;
      cracks += smoothstep(0.015, 0.0, angleDiff) * step(dist, crackLength) * step(0.1, dist) * max(0.0, crackFade) * 0.5;
    }
    
    // Frost spread - fills from center (LoL: area denial feedback)
    float frostFill = smoothstep(impactAttack * 0.8, impactAttack * 0.8 - 0.15, dist);
    frostFill *= (1.0 - impactDecay * 0.7) * 0.35;
    
    // Outer ring FLASH on impact then fade
    float outerFlash = outerRing * impactHold * 2.0;
    
    // Combine all
    float visibility = smoothstep(0.0, 0.08, uProgress);
    
    // Base pattern (form phase)
    float pattern = outerRing + innerRing * 0.7 + progressRing * 0.8 + hexPattern + lines + centerGlow;
    
    // Impact additions
    pattern += impactPop + shockwave + cracks + frostFill + outerFlash;
    pattern *= visibility;
    
    // LoL Color hierarchy: white core > secondary > primary
    vec3 color = uColor;
    color = mix(color, uColorSecondary, centerGlow + frostFill);
    color = mix(color, vec3(1.0), impactPop * 0.6 + cracks * 0.2); // White pop
    
    gl_FragColor = vec4(color, pattern * 0.85);
  }
`,YG=`
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  
  void main() {
    vNormal = normalize(normalMatrix * normal);
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
  }
`,qG=`
  uniform float uTime;
  uniform float uOpacity;
  uniform vec3 uColor;
  
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  
  void main() {
    vec3 viewDir = normalize(vViewPosition);
    float fresnel = pow(1.0 - abs(dot(viewDir, normalize(vNormal))), 3.0);
    
    // Add some energy variation
    float pulse = sin(uTime * 5.0) * 0.12 + 0.88;
    float wave = sin(vNormal.y * 3.0 + uTime * 6.0) * 0.08 + 0.92;
    
    float alpha = fresnel * uOpacity * pulse * wave * 0.5;
    
    // Slight color shift based on fresnel
    vec3 color = uColor + vec3(0.1, 0.15, 0.25) * fresnel;
    
    gl_FragColor = vec4(color, alpha);
  }
`;function Bu(i,e,t){const n=Math.max(0,Math.min(1,(t-i)/(e-i)));return n*n*(3-2*n)}function n_(i,e=1.4){const t=e;return 1+(t+1)*Math.pow(i-1,3)+t*Math.pow(i-1,2)}function KG({targetPosition:i=[0,0,5]}){const{state:e,activeAction:t,castProgressRef:n,STATES:a}=ps(),r=k.useRef(),l=k.useRef(),u=k.useRef(),d=k.useRef(),p=k.useRef(),x=k.useRef(),g=k.useRef(),_=k.useRef(0),y=(e===a.CASTING||e===a.ATTACKING)&&t==="skill_1",b=k.useMemo(()=>new hi({vertexShader:VG,fragmentShader:kG,uniforms:{uOpacity:{value:0},uColor:{value:t_}},transparent:!0,depthWrite:!1,side:Oi,blending:ir}),[]),C=k.useMemo(()=>new hi({vertexShader:jG,fragmentShader:XG,uniforms:{uProgress:{value:0},uImpact:{value:0},uColor:{value:t_},uColorSecondary:{value:pb}},transparent:!0,depthWrite:!1,side:Oi,blending:ir}),[]),E=k.useMemo(()=>new hi({vertexShader:YG,fragmentShader:qG,uniforms:{uOpacity:{value:0},uTime:{value:0},uColor:{value:t_}},transparent:!0,depthWrite:!1,side:oa,blending:ir}),[]);Ns((D,U)=>{_.current+=U;const F=U*8,N=U*6;if(!y){if(C.uniforms.uProgress.value<.01&&b.uniforms.uOpacity.value<.01){C.uniforms.uProgress.value=0,C.uniforms.uImpact.value=0,b.uniforms.uOpacity.value=0,E.uniforms.uOpacity.value=0;return}if(C.uniforms.uProgress.value+=(0-C.uniforms.uProgress.value)*F,C.uniforms.uImpact.value+=(0-C.uniforms.uImpact.value)*F,b.uniforms.uOpacity.value+=(0-b.uniforms.uOpacity.value)*F,E.uniforms.uOpacity.value+=(0-E.uniforms.uOpacity.value)*F,d.current){const W=d.current.scale;W.x+=(.5-W.x)*N,W.y+=(.5-W.y)*N,W.z+=(.5-W.z)*N}if(p.current){const W=p.current.scale;W.x+=(.5-W.x)*N,W.y+=(.5-W.y)*N,W.z+=(.5-W.z)*N}return}const z=n.current;C.uniforms.uProgress.value=z,E.uniforms.uTime.value=_.current;const j=Bu(0,.55,z),L=Bu(.55,.8,z),P=Bu(.8,1,z),q=Math.pow(P,.7);C.uniforms.uImpact.value=q;const ie=j*Math.pow(1-L,2);E.uniforms.uOpacity.value=ie*1.2;const se=z<.85,ae=se?Bu(.05,.3,z):Math.pow(1-Bu(.8,.88,z),2);if(b.uniforms.uOpacity.value=ae,l.current){const K=Math.pow(L,1.5),W=WE*(1-K);l.current.position.y=W;const me=Bu(0,.3,z)*1.6,ve=1+Math.sin(j*Math.PI*4)*.08*j;l.current.scale.setScalar(me*ve);const Q=1+L*2;l.current.rotation.y=z*Math.PI*2*Q}if(u.current){const K=Math.pow(j,1.5)*(se?1:0);u.current.material.opacity=K*.8}let re;if(q>0){const K=1+(1-Math.pow(1-q,3))*.15,W=1-q*.1;re=K*W}else if(L>.5){const K=1-(L-.5)*.1;re=n_(j,1.15)*K}else re=n_(j,1.15);let H;if(q>0)H=Math.pow(1-q,2)*.8;else if(L>0){const K=1-L*.25;H=n_(j,1.2)*K}else H=n_(j,1.2);if(d.current){const K=d.current.scale,W=N;K.x+=(re-K.x)*W,K.y+=(re-K.y)*W,K.z+=(re-K.z)*W}if(p.current){const K=p.current.scale,W=N;K.x+=(H-K.x)*W,K.y+=(H-K.y)*W,K.z+=(H-K.z)*W}x.current&&(x.current.intensity=z*4),g.current&&(g.current.intensity=Bu(.8,.9,z)*(1-Bu(.9,1,z))*10)});const[S,,w]=i;return y?B.jsxs("group",{ref:r,position:[S,0,w],children:[B.jsx("mesh",{ref:d,rotation:[-Math.PI/2,0,0],position:[0,.02,0],material:C,scale:.5,children:B.jsx("planeGeometry",{args:[2.6,2.6]})}),B.jsx("group",{ref:p,position:[0,0,0],scale:.5,children:B.jsx("mesh",{position:[0,1.5,0],material:E,children:B.jsx("sphereGeometry",{args:[2,32,32,0,Math.PI*2,Math.PI*(2/3),Math.PI*(1/3)]})})}),B.jsxs("group",{ref:l,position:[0,WE,0],children:[B.jsx("mesh",{material:b,rotation:[Math.PI,0,0],position:[0,.3,0],children:B.jsx("coneGeometry",{args:[.25,1.8,6,1]})}),B.jsx("mesh",{material:b,position:[0,.7,0],children:B.jsx("octahedronGeometry",{args:[.35,0]})}),B.jsxs("mesh",{ref:u,position:[0,.5,0],children:[B.jsx("sphereGeometry",{args:[.15,16,16]}),B.jsx("meshBasicMaterial",{color:pb,transparent:!0,opacity:0,depthWrite:!1,blending:ir})]}),B.jsx("pointLight",{ref:x,color:t_,intensity:0,distance:3})]}),B.jsx("pointLight",{ref:g,color:pb,intensity:0,distance:4,decay:2,position:[0,.2,0]})]}):null}const i_=new ut(Fa.fire.primary),ZE=new ut(Fa.fire.secondary),mb=new ut("#ffdd44"),QE=8,JG=`
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  varying vec2 vUv;
  
  void main() {
    vNormal = normalize(normalMatrix * normal);
    vUv = uv;
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
  }
`,WG=`
  uniform float uOpacity;
  uniform float uHeat;
  uniform vec3 uColor;
  uniform vec3 uCoreColor;
  
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  varying vec2 vUv;
  
  void main() {
    vec3 viewDir = normalize(vViewPosition);
    float fresnel = pow(1.0 - abs(dot(viewDir, normalize(vNormal))), 2.0);
    
    // Fire crackling effect on surface
    float crackle = sin(vUv.x * 15.0 + vUv.y * 12.0) * sin(vUv.y * 18.0 - vUv.x * 10.0);
    crackle = smoothstep(0.3, 0.8, crackle * 0.5 + 0.5);
    
    // Heat intensifies toward impact
    float heatGlow = fresnel * uHeat + crackle * uHeat * 0.5;
    
    vec3 color = mix(uColor, uCoreColor, heatGlow);
    color += vec3(0.3, 0.15, 0.0) * fresnel * uHeat; // Orange rim
    
    float alpha = (fresnel * 0.6 + 0.4) * uOpacity;
    
    gl_FragColor = vec4(color, alpha);
  }
`,ZG=`
  varying vec2 vUv;
  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
`,QG=`
  uniform float uProgress;
  uniform float uImpact;
  uniform vec3 uColor;
  uniform vec3 uColorSecondary;
  
  varying vec2 vUv;
  
  #define PI 3.14159265359
  
  // Crisp ring - LoL style sharp edges
  float ring(vec2 uv, float radius, float thickness) {
    float dist = length(uv);
    float inner = smoothstep(radius - thickness * 0.5, radius - thickness * 0.3, dist);
    float outer = smoothstep(radius + thickness * 0.3, radius + thickness * 0.5, dist);
    return inner - outer;
  }
  
  // Hash for pseudo-random
  float hash(float n) {
    return fract(sin(n) * 43758.5453);
  }
  
  // LoL-style sharp falloff for impact "pop"
  float sharpPop(float t) {
    return pow(max(0.0, 1.0 - t), 4.0);
  }
  
  void main() {
    vec2 uv = vUv * 2.0 - 1.0;
    float dist = length(uv);
    float angle = atan(uv.y, uv.x);
    
    float formProgress = clamp(uProgress / 0.5, 0.0, 1.0);
    
    // === ANTICIPATION PHASE ===
    float anticipation = smoothstep(0.4, 0.5, uProgress) * (1.0 - step(0.5, uProgress));
    float anticipationPulse = 1.0 + anticipation * sin(uProgress * 50.0) * 0.1;
    
    // Outer ring - fire warning circle
    float outerRadius = 0.92 - anticipation * 0.05;
    float outerThickness = 0.035 + anticipation * 0.02;
    float outerRing = ring(uv, outerRadius * anticipationPulse, outerThickness);
    outerRing *= 1.0 + anticipation * 1.0;
    
    // Inner danger ring
    float innerPulse = 1.0 + sin(formProgress * PI * 5.0) * 0.12 * formProgress;
    float innerRing = ring(uv, 0.5 * innerPulse, 0.03);
    
    // Progress arc fill - flames circling
    float progressAngle = -PI + formProgress * 2.0 * PI;
    float progressRing = ring(uv, 0.7, 0.045);
    progressRing *= step(angle, progressAngle);
    
    // Fire pattern - wavy flames
    float flameAngle = sin(angle * 8.0 + formProgress * PI * 3.0) * 0.08;
    float flamePattern = step(0.4 + flameAngle, dist) * step(dist, 0.85 + flameAngle);
    flamePattern *= smoothstep(0.0, 0.3, formProgress) * 0.4;
    
    // Radial flame lines - 8 for fire
    float numLines = 8.0;
    float lineAngle = mod(angle + formProgress * PI * 0.4, PI * 2.0 / numLines);
    float lines = smoothstep(0.018, 0.0, abs(lineAngle - PI / numLines));
    lines *= step(0.25, dist) * step(dist, 0.88) * formProgress * 0.8;
    
    // Center glow - hot core intensifies
    float coreIntensity = formProgress * formProgress;
    float centerGlow = smoothstep(0.45, 0.0, dist) * 0.6 * coreIntensity;
    centerGlow += smoothstep(0.2, 0.0, dist) * 0.4 * coreIntensity;
    
    // === IMPACT PHASE ===
    float impactAttack = smoothstep(0.0, 0.12, uImpact);
    float impactHold = smoothstep(0.0, 0.2, uImpact) * (1.0 - smoothstep(0.2, 0.35, uImpact));
    float impactDecay = smoothstep(0.25, 1.0, uImpact);
    
    // PRIMARY EXPLOSION POP
    float popIntensity = sharpPop(uImpact * 1.3) * impactAttack * 4.0;
    float impactPop = smoothstep(0.8, 0.0, dist) * popIntensity;
    impactPop += smoothstep(0.35, 0.0, dist) * popIntensity * 0.6;
    
    // Explosion shockwave - fast ring
    float shockRadius = pow(uImpact, 0.5) * 0.9;
    float shockwave = ring(uv, shockRadius, 0.07 * (1.0 - uImpact * 0.4));
    shockwave *= (1.0 - impactDecay) * 2.5;
    
    // Fire burst rays - explosive flame lines
    float fireRays = 0.0;
    for(float i = 0.0; i < 8.0; i++) {
      float rayAngle = i * PI / 4.0 + 0.2;
      float angleDiff = abs(mod(angle - rayAngle + PI, PI * 2.0) - PI);
      float rayWidth = 0.04 + hash(i) * 0.02;
      float rayLength = impactAttack * (0.75 + hash(i + 10.0) * 0.15);
      float rayFade = 1.0 - impactDecay;
      fireRays += smoothstep(rayWidth, 0.0, angleDiff) * step(dist, rayLength) * step(0.1, dist) * rayFade;
    }
    fireRays *= 0.9;
    
    // Secondary smaller rays
    for(float i = 0.0; i < 8.0; i++) {
      float rayAngle = i * PI / 4.0 + PI / 8.0;
      float angleDiff = abs(mod(angle - rayAngle + PI, PI * 2.0) - PI);
      float rayLength = impactAttack * (0.45 + hash(i + 30.0) * 0.2);
      float rayFade = 1.0 - impactDecay * 1.3;
      fireRays += smoothstep(0.025, 0.0, angleDiff) * step(dist, rayLength) * step(0.08, dist) * max(0.0, rayFade) * 0.5;
    }
    
    // Scorch fill - ground burns from center
    float scorchFill = smoothstep(impactAttack * 0.85, impactAttack * 0.85 - 0.2, dist);
    scorchFill *= (1.0 - impactDecay * 0.5) * 0.4;
    
    // Ember particles floating up
    float embers = 0.0;
    for(float i = 0.0; i < 10.0; i++) {
      float eAngle = hash(i * 7.0) * PI * 2.0;
      float eDist = 0.15 + uImpact * (0.3 + hash(i + 40.0) * 0.4);
      vec2 ePos = vec2(cos(eAngle), sin(eAngle)) * eDist;
      float eSize = 0.03 - uImpact * 0.015;
      float eFade = sin(uImpact * PI) * (1.0 - hash(i + 50.0) * 0.3);
      embers += smoothstep(eSize, 0.0, length(uv - ePos)) * eFade;
    }
    embers *= 0.7;
    
    // Outer ring flash on impact
    float outerFlash = outerRing * impactHold * 2.5;
    
    // Combine all
    float visibility = smoothstep(0.0, 0.08, uProgress);
    
    float pattern = outerRing + innerRing * 0.7 + progressRing * 0.85 + flamePattern + lines + centerGlow;
    pattern += impactPop + shockwave + fireRays + scorchFill + embers + outerFlash;
    pattern *= visibility;
    
    // LoL Color hierarchy: white/yellow hot > orange > red
    vec3 color = uColor;
    color = mix(color, uColorSecondary, centerGlow + scorchFill);
    color = mix(color, vec3(1.0, 0.95, 0.7), impactPop * 0.7 + fireRays * 0.3); // Hot white-yellow
    
    gl_FragColor = vec4(color, pattern * 0.9);
  }
`,$G=`
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  
  void main() {
    vNormal = normalize(normalMatrix * normal);
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
  }
`,e9=`
  uniform float uTime;
  uniform float uOpacity;
  uniform vec3 uColor;
  
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  
  void main() {
    vec3 viewDir = normalize(vViewPosition);
    float fresnel = pow(1.0 - abs(dot(viewDir, normalize(vNormal))), 2.5);
    
    // Fire flicker
    float flicker = sin(uTime * 8.0) * 0.15 + sin(uTime * 13.0) * 0.1 + 0.75;
    float wave = sin(vNormal.y * 4.0 + uTime * 5.0) * 0.12 + 0.88;
    
    float alpha = fresnel * uOpacity * flicker * wave * 0.6;
    
    // Hot edge coloring
    vec3 color = uColor + vec3(0.2, 0.1, 0.0) * fresnel;
    
    gl_FragColor = vec4(color, alpha);
  }
`;function Du(i,e,t){const n=Math.max(0,Math.min(1,(t-i)/(e-i)));return n*n*(3-2*n)}function a_(i,e=1.4){const t=e;return 1+(t+1)*Math.pow(i-1,3)+t*Math.pow(i-1,2)}function t9({targetPosition:i=[0,0,5]}){const{state:e,activeAction:t,castProgressRef:n,STATES:a}=ps(),r=k.useRef(),l=k.useRef(),u=k.useRef(),d=k.useRef(),p=k.useRef();k.useRef();const x=k.useRef(),g=k.useRef(),_=k.useRef(0),y=(e===a.CASTING||e===a.ATTACKING)&&t==="skill_2",b=k.useMemo(()=>new hi({vertexShader:JG,fragmentShader:WG,uniforms:{uOpacity:{value:0},uHeat:{value:.5},uColor:{value:i_},uCoreColor:{value:mb}},transparent:!0,depthWrite:!1,side:Oi,blending:ir}),[]),C=k.useMemo(()=>new hi({vertexShader:ZG,fragmentShader:QG,uniforms:{uProgress:{value:0},uImpact:{value:0},uColor:{value:i_},uColorSecondary:{value:ZE}},transparent:!0,depthWrite:!1,side:Oi,blending:ir}),[]),E=k.useMemo(()=>new hi({vertexShader:$G,fragmentShader:e9,uniforms:{uOpacity:{value:0},uTime:{value:0},uColor:{value:i_}},transparent:!0,depthWrite:!1,side:oa,blending:ir}),[]);Ns((D,U)=>{_.current+=U;const F=U*8,N=U*6;if(!y){if(C.uniforms.uProgress.value<.01&&b.uniforms.uOpacity.value<.01){C.uniforms.uProgress.value=0,C.uniforms.uImpact.value=0,b.uniforms.uOpacity.value=0,E.uniforms.uOpacity.value=0;return}if(C.uniforms.uProgress.value+=(0-C.uniforms.uProgress.value)*F,C.uniforms.uImpact.value+=(0-C.uniforms.uImpact.value)*F,b.uniforms.uOpacity.value+=(0-b.uniforms.uOpacity.value)*F,E.uniforms.uOpacity.value+=(0-E.uniforms.uOpacity.value)*F,d.current){const W=d.current.scale;W.x+=(.5-W.x)*N,W.y+=(.5-W.y)*N,W.z+=(.5-W.z)*N}if(p.current){const W=p.current.scale;W.x+=(.5-W.x)*N,W.y+=(.5-W.y)*N,W.z+=(.5-W.z)*N}return}const z=n.current;C.uniforms.uProgress.value=z,E.uniforms.uTime.value=_.current;const j=Du(0,.5,z),L=Du(.5,.85,z),P=Du(.85,1,z),q=Math.pow(P,.6);C.uniforms.uImpact.value=q;const ie=j*Math.pow(1-L,1.5);E.uniforms.uOpacity.value=ie*1.3;const se=z<.9,ae=se?Du(.1,.35,z):Math.pow(1-Du(.85,.92,z),2);if(b.uniforms.uOpacity.value=ae,b.uniforms.uHeat.value=.4+L*.6,l.current){const K=Math.pow(L,2),W=QE*(1-K);l.current.position.y=W;const me=Du(0,.3,z)*.8,ve=1+L*.4;l.current.scale.setScalar(me*ve),l.current.rotation.x+=U*(2+L*4),l.current.rotation.z+=U*(1.5+L*3)}if(u.current){const K=Math.pow(j,1.2)*(se?1:0);u.current.material.opacity=K*.9,u.current.material.color.lerp(mb,L*.5)}let re;if(q>0){const K=1+(1-Math.pow(1-q,3))*.2,W=1-q*.15;re=K*W}else if(L>.5){const K=1-(L-.5)*.12;re=a_(j,1.15)*K}else re=a_(j,1.15);let H;if(q>0)H=Math.pow(1-q,2)*.7;else if(L>0){const K=1-L*.3;H=a_(j,1.2)*K}else H=a_(j,1.2);if(d.current){const K=d.current.scale,W=q>0?N*1.5:N;K.x+=(re-K.x)*W,K.y+=(re-K.y)*W,K.z+=(re-K.z)*W}if(p.current){const K=p.current.scale,W=q>0?N*1.8:N;K.x+=(H-K.x)*W,K.y+=(H-K.y)*W,K.z+=(H-K.z)*W}x.current&&(x.current.intensity=z*6),g.current&&(g.current.intensity=Du(.85,.92,z)*(1-Du(.92,1,z))*15)});const[S,,w]=i;return y?B.jsxs("group",{ref:r,position:[S,0,w],children:[B.jsx("mesh",{ref:d,rotation:[-Math.PI/2,0,0],position:[0,.02,0],material:C,scale:.5,children:B.jsx("planeGeometry",{args:[2.8,2.8]})}),B.jsx("group",{ref:p,position:[0,0,0],scale:.5,children:B.jsx("mesh",{position:[0,1.5,0],material:E,children:B.jsx("sphereGeometry",{args:[2,32,32,0,Math.PI*2,Math.PI*(2/3),Math.PI*(1/3)]})})}),B.jsxs("group",{ref:l,position:[0,QE,0],children:[B.jsx("mesh",{material:b,children:B.jsx("dodecahedronGeometry",{args:[.5,1]})}),B.jsxs("mesh",{ref:u,children:[B.jsx("sphereGeometry",{args:[.35,16,16]}),B.jsx("meshBasicMaterial",{color:ZE,transparent:!0,opacity:0,depthWrite:!1,blending:ir})]}),B.jsx("pointLight",{ref:x,color:i_,intensity:0,distance:5})]}),B.jsx("pointLight",{ref:g,color:mb,intensity:0,distance:6,decay:2,position:[0,.3,0]})]}):null}const n9="_overlay_1v1iw_7",i9="_fadeOut_1v1iw_37",a9="_container_1v1iw_47",s9="_visible_1v1iw_65",r9="_orbContainer_1v1iw_75",o9="_orb_1v1iw_75",l9="_orbInner_1v1iw_119",c9="_orbShine_1v1iw_133",u9="_orbGlow_1v1iw_153",f9="_particles_1v1iw_173",h9="_particle_1v1iw_173",d9="_title_1v1iw_221",p9="_progressContainer_1v1iw_251",m9="_progressTrack_1v1iw_261",g9="_progressFill_1v1iw_281",v9="_progressGlow_1v1iw_303",x9="_progressJewels_1v1iw_325",_9="_jewel_1v1iw_339",y9="_active_1v1iw_359",b9="_loadingText_1v1iw_373",S9="_buttonContainer_1v1iw_447",A9="_menuButton_1v1iw_473",M9="_menuButtonSecondary_1v1iw_565",Ai={overlay:n9,fadeOut:i9,container:a9,visible:s9,orbContainer:r9,orb:o9,orbInner:l9,orbShine:c9,orbGlow:u9,particles:f9,particle:h9,title:d9,progressContainer:p9,progressTrack:m9,progressFill:g9,progressGlow:v9,progressJewels:x9,jewel:_9,active:y9,loadingText:b9,buttonContainer:S9,menuButton:A9,menuButtonSecondary:M9},E9=1e3,rA="kuji_game_started",T9=()=>localStorage.getItem(rA)==="true",C9=()=>localStorage.setItem(rA,"true"),R9=()=>localStorage.removeItem(rA);function w9(){const{progress:i,active:e}=XP(),{resetToDefaults:t}=Lg(),{resetToDefaults:n}=ar(),{resetToDefaults:a}=Qy(),{resetToDefaults:r}=aA(),[l,u]=k.useState(!0),[d,p]=k.useState(!1),[x,g]=k.useState(!1),[_,y]=k.useState(!1),[b]=k.useState(Date.now()),[C]=k.useState(()=>T9());k.useEffect(()=>{document.fonts.ready.then(()=>{g(!0)})},[]),k.useEffect(()=>{if(i>=100&&!e){const w=Date.now()-b,D=Math.max(0,E9-w),U=setTimeout(()=>{y(!0)},D);return()=>clearTimeout(U)}},[i,e,b]);const E=k.useCallback(()=>{R9(),t(),n(),a(),r(),C9(),p(!0),setTimeout(()=>u(!1),500)},[t,n,a,r]),S=k.useCallback(()=>{p(!0),setTimeout(()=>u(!1),500)},[]);return l?B.jsx("div",{className:`${Ai.overlay} ${d?Ai.fadeOut:""}`,children:B.jsxs("div",{className:`${Ai.container} ${x?Ai.visible:""}`,children:[B.jsxs("div",{className:Ai.orbContainer,children:[B.jsxs("div",{className:Ai.orb,children:[B.jsx("div",{className:Ai.orbInner}),B.jsx("div",{className:Ai.orbShine})]}),B.jsx("div",{className:Ai.orbGlow}),B.jsx("div",{className:Ai.particles,children:[...Array(4)].map((w,D)=>B.jsx("div",{className:Ai.particle,style:{"--index":D}},D))})]}),B.jsx("h1",{className:Ai.title,children:"Kuji"}),B.jsxs("div",{className:Ai.progressContainer,children:[B.jsxs("div",{className:Ai.progressTrack,children:[B.jsx("div",{className:Ai.progressFill,style:{width:`${i}%`}}),B.jsx("div",{className:Ai.progressGlow,style:{width:`${i}%`}})]}),B.jsxs("div",{className:Ai.progressJewels,children:[B.jsx("div",{className:`${Ai.jewel} ${i>=0?Ai.active:""}`}),B.jsx("div",{className:`${Ai.jewel} ${i>=50?Ai.active:""}`}),B.jsx("div",{className:`${Ai.jewel} ${i>=100?Ai.active:""}`})]})]}),_?B.jsxs("div",{className:Ai.buttonContainer,children:[C&&B.jsx("button",{className:Ai.menuButton,onClick:S,children:"Continue"}),B.jsx("button",{className:`${Ai.menuButton} ${C?Ai.menuButtonSecondary:""}`,onClick:E,children:"New Game"})]}):B.jsx("p",{className:Ai.loadingText,children:"Channeling arcane energies..."})]})}):null}const $n={ground:new ra({color:"#3a2f20",roughness:.9}),dirt:new ra({color:"#4a3f30",roughness:.85}),stone:new ra({color:"#5a5550",roughness:.8}),wood:new ra({color:"#6b4423",roughness:.7}),darkWood:new ra({color:"#4a2f18",roughness:.75}),canvas:new ra({color:"#8b7355",roughness:.6,side:Oi}),straw:new ra({color:"#9b8b55",roughness:.9}),fire:new $a({color:"#ff6030"}),fireGlow:new $a({color:"#ffaa40"}),metal:new ra({color:"#4a4a50",roughness:.4,metalness:.6}),water:new ra({color:"#3a5a6a",roughness:.2,transparent:!0,opacity:.7})};function s_({position:i=[0,0,0],rotation:e=0,scale:t=1,color:n="#8b7355"}){const a=k.useMemo(()=>new ra({color:n,roughness:.6,side:Oi}),[n]);return B.jsxs("group",{position:i,rotation:[0,e,0],scale:t,children:[B.jsxs("mesh",{position:[-1.2,1,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.05,.08,2,6]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[1.2,1,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.05,.08,2,6]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[0,1.8,0],rotation:[0,0,Math.PI/2],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.04,.04,2.6,6]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[0,.9,.55],rotation:[1.05,0,0],castShadow:!0,receiveShadow:!0,children:[B.jsx("boxGeometry",{args:[2.8,.05,2.2]}),B.jsx("primitive",{object:a,attach:"material"})]}),B.jsxs("mesh",{position:[0,.9,-.55],rotation:[-1.05,0,0],castShadow:!0,receiveShadow:!0,children:[B.jsx("boxGeometry",{args:[2.8,.05,2.2]}),B.jsx("primitive",{object:a,attach:"material"})]})]})}function r_({position:i=[0,0,0],rotation:e=0,scale:t=1}){return B.jsxs("mesh",{position:i,rotation:[0,e,0],scale:t,castShadow:!0,receiveShadow:!0,children:[B.jsx("boxGeometry",{args:[.6,.6,.6]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]})}function o_({position:i=[0,0,0],scale:e=1}){return B.jsxs("group",{position:i,scale:e,children:[B.jsxs("mesh",{position:[0,.4,0],castShadow:!0,receiveShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.3,.35,.8,12]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]}),B.jsxs("mesh",{position:[0,.2,0],children:[B.jsx("torusGeometry",{args:[.32,.02,8,16]}),B.jsx("primitive",{object:$n.metal,attach:"material"})]}),B.jsxs("mesh",{position:[0,.6,0],children:[B.jsx("torusGeometry",{args:[.32,.02,8,16]}),B.jsx("primitive",{object:$n.metal,attach:"material"})]})]})}function B9({position:i=[0,0,0]}){const e=k.useRef(),t=k.useRef(),n=k.useRef(),a=k.useMemo(()=>Math.random()*100,[]),r=k.useMemo(()=>new ut("#ff6030"),[]),l=k.useMemo(()=>new ut("#ffaa40"),[]),u=k.useMemo(()=>new ut("#ff4010"),[]);return Ns(d=>{const p=d.clock.elapsedTime+a,x=1+Math.sin(p*8)*.1+Math.sin(p*13)*.05+Math.sin(p*21)*.03,g=1+Math.sin(p*6)*.15+Math.sin(p*11)*.08,_=2+Math.sin(p*4)*.8+Math.sin(p*7)*.4;e.current&&(e.current.scale.set(x,g,x),e.current.material.color.copy(r).multiplyScalar(_*1.2)),t.current&&(t.current.scale.set(x*1.1,g*.9,x*1.1),t.current.material.color.copy(l).multiplyScalar(_)),n.current&&(n.current.scale.setScalar(1+Math.sin(p*3)*.15),n.current.material.color.copy(u).multiplyScalar(_*.8))}),B.jsxs("group",{position:i,children:[[...Array(8)].map((d,p)=>{const x=p/8*Math.PI*2;return B.jsxs("mesh",{position:[Math.cos(x)*.5,.1,Math.sin(x)*.5],rotation:[0,x,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.25,.2,.15]}),B.jsx("primitive",{object:$n.stone,attach:"material"})]},p)}),B.jsx("group",{position:[0,.08,0],rotation:[0,0,.4],children:B.jsxs("mesh",{position:[0,.15,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.06,.08,.5,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]})}),B.jsx("group",{position:[0,.08,0],rotation:[0,Math.PI/3,.4],children:B.jsxs("mesh",{position:[0,.15,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.06,.08,.5,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]})}),B.jsx("group",{position:[0,.08,0],rotation:[0,-Math.PI/3,.4],children:B.jsxs("mesh",{position:[0,.15,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.06,.08,.5,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]})}),B.jsxs("mesh",{position:[0,.06,0],rotation:[Math.PI/2,0,.3],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.07,.09,.55,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]}),B.jsxs("mesh",{ref:e,position:[0,.3,0],children:[B.jsx("coneGeometry",{args:[.2,.5,8]}),B.jsx("meshBasicMaterial",{color:"#ff6030",toneMapped:!1})]}),B.jsxs("mesh",{ref:t,position:[0,.25,0],children:[B.jsx("coneGeometry",{args:[.15,.3,6]}),B.jsx("meshBasicMaterial",{color:"#ffaa40",toneMapped:!1})]})]})}function vp({position:i=[0,0,0],rotation:e=0,length:t=3}){const n=Math.ceil(t/1.5);return B.jsxs("group",{position:i,rotation:[0,e,0],children:[B.jsxs("mesh",{position:[t/2-.75,.3,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[t,.08,.06]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[t/2-.75,.7,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[t,.08,.06]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),[...Array(n)].map((a,r)=>B.jsxs("mesh",{position:[r*1.5,.5,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.1,1,.1]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]},r))]})}function Hm({position:i=[0,0,0],scale:e=1}){return B.jsxs("group",{position:i,scale:e,children:[B.jsxs("mesh",{position:[0,1.5,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.12,.25,3,8]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]}),B.jsx("group",{position:[.13,2.3,0],rotation:[0,0,1.1],children:B.jsxs("mesh",{position:[0,.4,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.02,.06,.8,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]})}),B.jsx("group",{position:[-.13,2,0],rotation:[0,0,-1],children:B.jsxs("mesh",{position:[0,.35,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.02,.05,.7,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]})}),B.jsx("group",{position:[0,2.5,-.12],rotation:[-1.1,0,0],children:B.jsxs("mesh",{position:[0,.25,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.015,.04,.5,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]})}),B.jsx("group",{position:[0,2.1,.14],rotation:[1,0,0],children:B.jsxs("mesh",{position:[0,.25,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.015,.04,.5,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]})}),B.jsx("group",{position:[.1,2.7,.08],rotation:[.5,0,.9],children:B.jsxs("mesh",{position:[0,.22,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.015,.035,.45,6]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]})})]})}function D9({position:i=[0,0,0]}){return B.jsxs("group",{position:i,children:[B.jsxs("mesh",{position:[0,.4,0],castShadow:!0,receiveShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.8,.9,.8,12]}),B.jsx("primitive",{object:$n.stone,attach:"material"})]}),B.jsxs("mesh",{position:[0,.3,0],children:[B.jsx("cylinderGeometry",{args:[.6,.6,.1,12]}),B.jsx("primitive",{object:$n.water,attach:"material"})]}),B.jsxs("mesh",{position:[-.6,1.2,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.1,1.6,.1]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[.6,1.2,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.1,1.6,.1]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[0,2,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[1.4,.1,.1]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[0,2.3,0],rotation:[0,0,0],castShadow:!0,children:[B.jsx("coneGeometry",{args:[.9,.5,4]}),B.jsx("primitive",{object:$n.straw,attach:"material"})]})]})}function U9({position:i=[0,0,0],rotation:e=0}){return B.jsxs("group",{position:i,rotation:[0,e,0],children:[B.jsxs("mesh",{position:[0,.5,0],castShadow:!0,receiveShadow:!0,children:[B.jsx("boxGeometry",{args:[2,.15,1]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[0,.75,.45],castShadow:!0,children:[B.jsx("boxGeometry",{args:[2,.4,.08]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[0,.75,-.45],castShadow:!0,children:[B.jsx("boxGeometry",{args:[2,.4,.08]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),B.jsxs("mesh",{position:[-.95,.75,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.08,.4,.9]}),B.jsx("primitive",{object:$n.wood,attach:"material"})]}),[[-.7,.3,.55],[-.7,.3,-.55],[.7,.3,.55],[.7,.3,-.55]].map((t,n)=>B.jsxs("mesh",{position:t,rotation:[Math.PI/2,0,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.3,.3,.1,12]}),B.jsx("primitive",{object:$n.darkWood,attach:"material"})]},n))]})}function O9(){return B.jsxs("group",{children:[B.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,0,0],receiveShadow:!0,children:[B.jsx("planeGeometry",{args:[50,50]}),B.jsx("primitive",{object:$n.ground,attach:"material"})]}),B.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,0],receiveShadow:!0,children:[B.jsx("planeGeometry",{args:[4,30]}),B.jsx("primitive",{object:$n.dirt,attach:"material"})]}),B.jsx(s_,{position:[-6,0,-3],rotation:.3,color:"#7b6345"}),B.jsx(s_,{position:[-5,0,4],rotation:-.2,scale:1.2,color:"#8b7355"}),B.jsx(s_,{position:[6,0,-2],rotation:Math.PI-.2,color:"#6b5335"}),B.jsx(s_,{position:[7,0,5],rotation:Math.PI+.3,scale:.9,color:"#9b8365"}),B.jsx(B9,{position:[-4,0,1]}),B.jsx(D9,{position:[3,0,-5]}),B.jsx(U9,{position:[-8,0,0],rotation:.4}),B.jsx(r_,{position:[-7,.3,-1],rotation:.2}),B.jsx(r_,{position:[-7.5,.3,-.5],rotation:-.3}),B.jsx(r_,{position:[-7.2,.9,-.7],rotation:.5,scale:.8}),B.jsx(o_,{position:[-6.5,0,.5]}),B.jsx(o_,{position:[-7.8,0,.8]}),B.jsx(r_,{position:[5,.3,3],rotation:.1}),B.jsx(o_,{position:[5.5,0,2.5]}),B.jsx(o_,{position:[4.5,0,3.5],scale:.9}),B.jsx(vp,{position:[-10,0,-8],rotation:0,length:6}),B.jsx(vp,{position:[-10,0,8],rotation:0,length:6}),B.jsx(vp,{position:[8,0,-8],rotation:0,length:4}),B.jsx(vp,{position:[8,0,7],rotation:0,length:4}),B.jsx(vp,{position:[-10,0,-8],rotation:Math.PI/2,length:4}),B.jsx(vp,{position:[12,0,-8],rotation:Math.PI/2,length:4}),B.jsx(Hm,{position:[-12,0,-5],scale:1.2}),B.jsx(Hm,{position:[14,0,2],scale:1}),B.jsx(Hm,{position:[-11,0,10],scale:.9}),B.jsx(Hm,{position:[13,0,-6],scale:1.1}),B.jsx(Hm,{position:[-14,0,0],scale:1.3})]})}const Ds={wood:new ra({color:"#6b4423",roughness:.7}),darkWood:new ra({color:"#4a2f18",roughness:.75}),straw:new ra({color:"#a89860",roughness:.9}),cloth:new ra({color:"#8b7355",roughness:.8}),rope:new ra({color:"#9b8b65",roughness:.85}),metal:new ra({color:"#5a5a60",roughness:.4,metalness:.5})};function N9({position:i=[0,0,0],rotation:e=0}){return B.jsxs("group",{position:i,rotation:[0,e,0],children:[B.jsxs("mesh",{position:[0,.05,0],castShadow:!0,receiveShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.5,.6,.1,8]}),B.jsx("primitive",{object:Ds.darkWood,attach:"material"})]}),B.jsxs("mesh",{position:[0,1,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.12,.15,2,8]}),B.jsx("primitive",{object:Ds.wood,attach:"material"})]}),B.jsxs("mesh",{position:[0,1.3,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.28,.25,.8,10]}),B.jsx("primitive",{object:Ds.straw,attach:"material"})]}),B.jsxs("mesh",{position:[0,1.4,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.3,.3,.3,10]}),B.jsx("primitive",{object:Ds.cloth,attach:"material"})]}),B.jsxs("mesh",{position:[0,1.1,0],children:[B.jsx("torusGeometry",{args:[.28,.025,6,16]}),B.jsx("primitive",{object:Ds.rope,attach:"material"})]}),B.jsxs("mesh",{position:[0,1.55,0],children:[B.jsx("torusGeometry",{args:[.3,.025,6,16]}),B.jsx("primitive",{object:Ds.rope,attach:"material"})]}),B.jsxs("mesh",{position:[0,1.5,0],rotation:[0,0,Math.PI/2],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.06,.06,1.2,6]}),B.jsx("primitive",{object:Ds.wood,attach:"material"})]}),B.jsxs("mesh",{position:[-.45,1.5,0],rotation:[0,0,Math.PI/2],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.12,.1,.25,8]}),B.jsx("primitive",{object:Ds.straw,attach:"material"})]}),B.jsxs("mesh",{position:[.45,1.5,0],rotation:[0,0,Math.PI/2],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.12,.1,.25,8]}),B.jsx("primitive",{object:Ds.straw,attach:"material"})]}),B.jsxs("mesh",{position:[0,2,0],castShadow:!0,children:[B.jsx("sphereGeometry",{args:[.2,10,8]}),B.jsx("primitive",{object:Ds.straw,attach:"material"})]}),B.jsxs("mesh",{position:[0,2.05,0],rotation:[.3,0,0],children:[B.jsx("torusGeometry",{args:[.15,.03,6,12]}),B.jsx("primitive",{object:Ds.cloth,attach:"material"})]}),B.jsxs("mesh",{position:[0,2.15,0],castShadow:!0,children:[B.jsx("cylinderGeometry",{args:[.18,.22,.2,8]}),B.jsx("primitive",{object:Ds.metal,attach:"material"})]}),B.jsxs("mesh",{position:[0,1.35,.26],rotation:[0,0,0],children:[B.jsx("ringGeometry",{args:[.08,.12,16]}),B.jsx("meshBasicMaterial",{color:"#cc3030",side:Oi})]}),B.jsxs("mesh",{position:[0,1.35,.265],children:[B.jsx("circleGeometry",{args:[.05,12]}),B.jsx("meshBasicMaterial",{color:"#ffcc00",side:Oi})]}),B.jsxs("mesh",{position:[.25,.25,.25],rotation:[.5,.785,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.06,.5,.06]}),B.jsx("primitive",{object:Ds.darkWood,attach:"material"})]}),B.jsxs("mesh",{position:[-.25,.25,.25],rotation:[.5,-.785,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.06,.5,.06]}),B.jsx("primitive",{object:Ds.darkWood,attach:"material"})]}),B.jsxs("mesh",{position:[.25,.25,-.25],rotation:[-.5,.785,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.06,.5,.06]}),B.jsx("primitive",{object:Ds.darkWood,attach:"material"})]}),B.jsxs("mesh",{position:[-.25,.25,-.25],rotation:[-.5,-.785,0],castShadow:!0,children:[B.jsx("boxGeometry",{args:[.06,.5,.06]}),B.jsx("primitive",{object:Ds.darkWood,attach:"material"})]})]})}const $E=[{x:0,y:3.2,z:-.8},{x:-.6,y:3,z:-.6},{x:.6,y:3,z:-.6}],L9=k.memo(function({pixieData:e,index:t,totalCount:n}){const a=k.useRef(),r=k.useRef(),l=k.useRef(),u=k.useRef(),d=$E[t]||$E[0],p=k.useMemo(()=>({phase:t*1.2,bobSpeed:1.5+Math.random()*.3,bobAmount:.03+Math.random()*.02,swaySpeed:.8+Math.random()*.2,swayAmount:.02,rotateSpeed:.5+Math.random()*.2}),[t]),x=k.useMemo(()=>new ut(e.color),[e.color]),g=k.useMemo(()=>new ut(e.glowColor),[e.glowColor]);return Ns(_=>{const y=_.clock.elapsedTime,{phase:b,bobSpeed:C,bobAmount:E,swaySpeed:S,swayAmount:w,rotateSpeed:D}=p;if(a.current){const F=Math.sin(y*C+b)*E,N=Math.sin(y*S+b)*w,z=Math.cos(y*S*.7+b)*w;a.current.position.set(d.x+N,d.y+F,d.z+z),a.current.rotation.y=y*D,a.current.rotation.x=Math.sin(y*.5+b)*.05}const U=1.5+Math.sin(y*4+b)*.5+Math.sin(y*7+b)*.3;r.current&&r.current.material.color.copy(x).multiplyScalar(U*2),l.current&&(l.current.material.color.copy(g).multiplyScalar(U*1.5),l.current.scale.setScalar(1+Math.sin(y*5+b)*.08)),u.current&&(u.current.material.opacity=.12+Math.sin(y*3+b)*.04,u.current.scale.setScalar(1+Math.sin(y*2+b)*.1))}),B.jsxs("group",{ref:a,children:[B.jsxs("mesh",{ref:r,children:[B.jsx("sphereGeometry",{args:[.05,8,8]}),B.jsx("meshBasicMaterial",{color:e.color,toneMapped:!1})]}),B.jsxs("mesh",{ref:l,children:[B.jsx("sphereGeometry",{args:[.09,8,8]}),B.jsx("meshBasicMaterial",{color:e.glowColor,transparent:!0,opacity:.5,toneMapped:!1})]}),B.jsxs("mesh",{ref:u,children:[B.jsx("sphereGeometry",{args:[.18,8,8]}),B.jsx("meshBasicMaterial",{color:e.color,transparent:!0,opacity:.12,toneMapped:!1})]}),[...Array(3)].map((_,y)=>{const b=y/3*Math.PI*2;return B.jsxs("mesh",{position:[Math.cos(b)*.08,0,Math.sin(b)*.08],children:[B.jsx("sphereGeometry",{args:[.012,4,4]}),B.jsx("meshBasicMaterial",{color:e.color,transparent:!0,opacity:.6,toneMapped:!1})]},y)})]})});function I9(){const{slotMap:i}=ar(),e=k.useMemo(()=>Ih.map(t=>i?.[t.id]).filter(Boolean).map(t=>Cc[t]).filter(Boolean),[i]);return e.length===0?null:B.jsx("group",{children:e.map((t,n)=>B.jsx(L9,{pixieData:t,index:n,totalCount:e.length},t.id))})}const hw=k.createContext(null);function P9({children:i}){const[e,t]=k.useState({}),[n,a]=k.useState({}),r=k.useCallback(g=>{t(_=>({..._,[g]:!0})),a(_=>({..._,[g]:!0}))},[]),l=k.useCallback(g=>{t(_=>({..._,[g]:!1})),a(_=>({..._,[g]:!1}))},[]),u=k.useCallback(g=>!!e[g],[e]),d=k.useCallback(g=>!!n[g],[n]),p=k.useCallback((g,_)=>{t(y=>y[g]===_?y:{...y,[g]:_})},[]),x=k.useMemo(()=>({activeInputs:e,pressAction:r,releaseAction:l,isActive:u,isUiTriggered:d,syncKeyboardState:p}),[e,r,l,u,d,p]);return B.jsx(hw.Provider,{value:x,children:i})}function F9(){const{syncKeyboardState:i}=dw(),e=Lr(u=>u.slot_1),t=Lr(u=>u.slot_2),n=Lr(u=>u.slot_3),a=Lr(u=>u.slot_4),r=Lr(u=>u.slot_consumable_1),l=Lr(u=>u.slot_consumable_2);return k.useEffect(()=>{i("slot_1",e)},[e,i]),k.useEffect(()=>{i("slot_2",t)},[t,i]),k.useEffect(()=>{i("slot_3",n)},[n,i]),k.useEffect(()=>{i("slot_4",a)},[a,i]),k.useEffect(()=>{i("slot_consumable_1",r)},[r,i]),k.useEffect(()=>{i("slot_consumable_2",l)},[l,i]),null}function dw(){const i=k.useContext(hw);if(!i)throw new Error("useInput must be used within an InputProvider");return i}function z9(i,e=null){const{isActive:t,pressAction:n,releaseAction:a}=dw(),{handleInput:r}=ps(),l=e||i,u=Lr(b=>b[l]),d=k.useRef(!1),p=k.useRef(!1),x=t(i)||u,g=k.useCallback(()=>{p.current||(p.current=!0,n(i),r(i,!0))},[i,n,r]),_=k.useCallback(()=>{p.current&&(p.current=!1,a(i),r(i,!1))},[i,a,r]),y=k.useMemo(()=>({onMouseDown:()=>{d.current||g()},onMouseUp:()=>{d.current||_()},onMouseLeave:()=>{d.current||_()},onTouchStart:b=>{b.preventDefault(),b.stopPropagation(),d.current=!0,g()},onTouchEnd:b=>{b.preventDefault(),b.stopPropagation(),_(),setTimeout(()=>{d.current=!1},300)},onTouchCancel:b=>{b.preventDefault(),b.stopPropagation(),_(),setTimeout(()=>{d.current=!1},300)},onKeyDown:b=>{(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),g())},onKeyUp:b=>{(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),_())},onContextMenu:b=>b.preventDefault()}),[g,_]);return{active:x,handlers:y}}const H9=()=>{const{state:i,activeAction:e,buffs:t}=ps(),{unlock:n}=Qy(),{slotMap:a}=ar(),r=k.useRef(!1),l=k.useRef(!1),u=k.useRef(!1),d=k.useRef(!1);return k.useEffect(()=>{!r.current&&(i==="casting"||i==="attacking")&&e&&["skill_1","skill_2","skill_3","skill_4","primary_attack","secondary_attack"].includes(e)&&(n("first_cast"),r.current=!0)},[i,e,n]),k.useEffect(()=>{!l.current&&t.some(p=>p.id==="health_potion")&&(n("potion_master"),l.current=!0)},[t,n]),k.useEffect(()=>{const p=Ih.map(x=>a?.[x.id]).filter(Boolean);!u.current&&p.length>=1&&(n("first_pixie"),u.current=!0),!d.current&&p.length>=3&&(n("pixie_trio"),d.current=!0)},[a,n]),null},G9=()=>{const{handleInput:i}=ps(),{getActionForSlot:e}=ar(),t=Lr(d=>d.slot_1),n=Lr(d=>d.slot_2),a=Lr(d=>d.slot_3),r=Lr(d=>d.slot_4),l=Lr(d=>d.slot_consumable_1),u=Lr(d=>d.slot_consumable_2);return k.useEffect(()=>{const d=e("slot_1");d&&i(d,t)},[t,i,e]),k.useEffect(()=>{const d=e("slot_2");d&&i(d,n)},[n,i,e]),k.useEffect(()=>{const d=e("slot_3");d&&i(d,a)},[a,i,e]),k.useEffect(()=>{const d=e("slot_4");d&&i(d,r)},[r,i,e]),k.useEffect(()=>{const d=e("slot_consumable_1");d&&i(d,l)},[l,i,e]),k.useEffect(()=>{const d=e("slot_consumable_2");d&&i(d,u)},[u,i,e]),null},pw=i=>{if(!i)return null;const e=eA(i.id);return{name:i.label,type:i.type,element:e,description:i.description,manaCost:i.manaCost,manaGain:i.manaGain,manaPerSecond:i.manaPerSecond,healthCost:i.healthCost,buff:i.buff}},mw=i=>{const{mana:e,health:t}=ps();if(!i)return!1;const n=i.manaCost??0,a=i.healthCost??0,r=i.manaPerSecond??0,l=n>0?n:r>0?1:0,u=e>=l,d=a>0?t>a:!0;return u&&d},gb=({slotId:i})=>{const{getDisplayKey:e}=Lg(),{getActionObjectForSlot:t}=ar(),n=t(i),{active:a,handlers:r}=z9(n?.id,i),l=mw(n);return B.jsx(WR,{slotId:i,actionId:n?.id,keyBind:e(i),icon:n?.icon,active:a,disabled:!n||!l,tooltip:pw(n),...r})},V9=({slotId:i})=>{const{getDisplayKey:e}=Lg(),{getActionObjectForSlot:t}=ar(),n=t(i),a=mw(n);return B.jsx(WR,{slotId:i,actionId:n?.id,keyBind:e(i),icon:n?.icon,disabled:!n||!a,tooltip:pw(n)})},k9=()=>B.jsxs(B.Fragment,{children:[B.jsx(GG,{}),B.jsxs(qz,{children:[B.jsx(HE,{type:"health",label:"Health"}),B.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",position:"relative"},children:[B.jsx(Z6,{}),B.jsx(X6,{}),B.jsx(uG,{}),B.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"flex-end"},children:[B.jsx(gb,{slotId:cy[0].id}),B.jsxs(x6,{children:[tA.map(i=>B.jsx(gb,{slotId:i.id},i.id)),nA.map(i=>B.jsx(V9,{slotId:i.id},i.id))]}),B.jsx(gb,{slotId:cy[1].id})]})]}),B.jsx(HE,{type:"mana",label:"Mana"})]})]}),j9=({children:i})=>{const{keyMap:e}=Lg();return B.jsx(KP,{map:e,children:B.jsxs(P9,{children:[i,B.jsx(F9,{}),B.jsx(G9,{}),B.jsx(H9,{}),B.jsx(k9,{})]})})},X9=({children:i})=>{const{health:e,maxHealth:t,buffs:n}=ps();return B.jsx(fw,{name:"Wizard",health:e,maxHealth:t,level:70,type:"friendly",buffs:n,children:i})},Y9=({children:i})=>B.jsx(fw,{name:"Training Dummy",health:75,maxHealth:100,level:72,type:"enemy",children:i}),q9=()=>{const{unlockTarget:i}=sA()||{};return B.jsxs(B.Fragment,{children:[B.jsx("color",{attach:"background",args:["#1a1a2e"]}),B.jsx("fog",{attach:"fog",args:["#1a1a2e",15,40]}),B.jsx(yF,{preset:"night",background:!1}),B.jsx("ambientLight",{intensity:.2}),B.jsx("directionalLight",{position:[5,10,5],intensity:.5,color:"#8b7355"}),B.jsx("pointLight",{position:[0,2,0],intensity:1,color:"#ff6b35",distance:10}),B.jsx(O9,{}),B.jsxs(X9,{children:[B.jsx(bH,{position:[0,0,0]}),B.jsx(I9,{})]}),B.jsx(Y9,{children:B.jsx(N9,{position:[0,0,3]})}),B.jsx(KG,{targetPosition:[0,0,3]}),B.jsx(t9,{targetPosition:[0,0,3]}),B.jsx(nF,{makeDefault:!0,minDistance:18,maxDistance:18,minPolarAngle:Math.PI/3,maxPolarAngle:Math.PI/3,minAzimuthAngle:Math.PI/4,maxAzimuthAngle:Math.PI/4,dollySpeed:0,truckSpeed:0}),B.jsx(Gz,{children:B.jsx(jz,{intensity:1.5,luminanceThreshold:.6,luminanceSmoothing:.9,mipmapBlur:!0})})]})};function K9(){return B.jsx(yG,{children:B.jsx(BH,{children:B.jsx(f6,{children:B.jsx(d6,{children:B.jsx(E6,{children:B.jsx(PH,{children:B.jsx(w6,{children:B.jsxs(j9,{children:[B.jsx(w9,{}),B.jsx(_G,{}),B.jsx("div",{style:{width:"100vw",height:"100vh"},children:B.jsx(VP,{flat:!0,camera:{fov:50,position:[11.02,10,11.02]},eventSource:document.getElementById("root"),eventPrefix:"client",children:B.jsx(k.Suspense,{fallback:null,children:B.jsx(q9,{})})})})]})})})})})})})})}pB.createRoot(document.getElementById("root")).render(B.jsx(k.StrictMode,{children:B.jsx(K9,{})}));
